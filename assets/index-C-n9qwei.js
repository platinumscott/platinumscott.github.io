const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-0KSKBJbL.js","assets/webworkerAll-BNWqjdfL.js","assets/colorToUniform-BXaCBwVl.js","assets/WebGPURenderer-Cip2e7ac.js","assets/SharedSystems-Cij-EzyV.js","assets/WebGLRenderer-KspsPE16.js"])))=>i.map(i=>d[i]);
var wu=Object.defineProperty;var vu=(s,t,e)=>t in s?wu(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var A=(s,t,e)=>vu(s,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();let _h=null;function Mt(){return _h}function Cu(s){_h=s}const Su="modulepreload",Au=function(s){return"/"+s},ea={},xi=function(t,e,i){let n=Promise.resolve();if(e&&e.length>0){let a=function(l){return Promise.all(l.map(c=>Promise.resolve(c).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),h=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=a(e.map(l=>{if(l=Au(l),l in ea)return;ea[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":Su,c||(d.as="script"),d.crossOrigin="",d.href=l,h&&d.setAttribute("nonce",h),document.head.appendChild(d),c)return new Promise((f,p)=>{d.addEventListener("load",f),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function r(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return n.then(a=>{for(const o of a||[])o.status==="rejected"&&r(o.reason);return t().catch(r)})};var I=(s=>(s.Application="application",s.WebGLPipes="webgl-pipes",s.WebGLPipesAdaptor="webgl-pipes-adaptor",s.WebGLSystem="webgl-system",s.WebGPUPipes="webgpu-pipes",s.WebGPUPipesAdaptor="webgpu-pipes-adaptor",s.WebGPUSystem="webgpu-system",s.CanvasSystem="canvas-system",s.CanvasPipesAdaptor="canvas-pipes-adaptor",s.CanvasPipes="canvas-pipes",s.Asset="asset",s.LoadParser="load-parser",s.ResolveParser="resolve-parser",s.CacheParser="cache-parser",s.DetectionParser="detection-parser",s.MaskEffect="mask-effect",s.BlendMode="blend-mode",s.TextureSource="texture-source",s.Environment="environment",s.ShapeBuilder="shape-builder",s.Batcher="batcher",s))(I||{});const kn=s=>{if(typeof s=="function"||typeof s=="object"&&s.extension){if(!s.extension)throw new Error("Extension class must have an extension object");s={...typeof s.extension!="object"?{type:s.extension}:s.extension,ref:s}}if(typeof s=="object")s={...s};else throw new Error("Invalid extension type");return typeof s.type=="string"&&(s.type=[s.type]),s},Ks=(s,t)=>kn(s).priority??t,X={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...s){return s.map(kn).forEach(t=>{t.type.forEach(e=>{var i,n;return(n=(i=this._removeHandlers)[e])==null?void 0:n.call(i,t)})}),this},add(...s){return s.map(kn).forEach(t=>{t.type.forEach(e=>{var r,a;const i=this._addHandlers,n=this._queue;i[e]?(a=i[e])==null||a.call(i,t):(n[e]=n[e]||[],(r=n[e])==null||r.push(t))})}),this},handle(s,t,e){var a;const i=this._addHandlers,n=this._removeHandlers;if(i[s]||n[s])throw new Error(`Extension type ${s} already has a handler`);i[s]=t,n[s]=e;const r=this._queue;return r[s]&&((a=r[s])==null||a.forEach(o=>t(o)),delete r[s]),this},handleByMap(s,t){return this.handle(s,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByNamedList(s,t,e=-1){return this.handle(s,i=>{t.findIndex(r=>r.name===i.name)>=0||(t.push({name:i.name,value:i.ref}),t.sort((r,a)=>Ks(a.value,e)-Ks(r.value,e)))},i=>{const n=t.findIndex(r=>r.name===i.name);n!==-1&&t.splice(n,1)})},handleByList(s,t,e=-1){return this.handle(s,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((n,r)=>Ks(r,e)-Ks(n,e)))},i=>{const n=t.indexOf(i.ref);n!==-1&&t.splice(n,1)})},mixin(s,...t){for(const e of t)Object.defineProperties(s.prototype,Object.getOwnPropertyDescriptors(e))}},Tu={extension:{type:I.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await xi(()=>import("./browserAll-0KSKBJbL.js"),__vite__mapDeps([0,1,2]))}},Pu={extension:{type:I.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await xi(()=>import("./webworkerAll-BNWqjdfL.js"),__vite__mapDeps([1,2]))}};class ot{constructor(t,e,i){this._x=e||0,this._y=i||0,this._observer=t}clone(t){return new ot(t??this._observer,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}function xh(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Wi={exports:{}},sa;function Mu(){return sa||(sa=1,function(s){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function n(h,l,c){this.fn=h,this.context=l,this.once=c||!1}function r(h,l,c,u,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new n(c,u||h,d),p=e?e+l:l;return h._events[p]?h._events[p].fn?h._events[p]=[h._events[p],f]:h._events[p].push(f):(h._events[p]=f,h._eventsCount++),h}function a(h,l){--h._eventsCount===0?h._events=new i:delete h._events[l]}function o(){this._events=new i,this._eventsCount=0}o.prototype.eventNames=function(){var l=[],c,u;if(this._eventsCount===0)return l;for(u in c=this._events)t.call(c,u)&&l.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},o.prototype.listeners=function(l){var c=e?e+l:l,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,f=u.length,p=new Array(f);d<f;d++)p[d]=u[d].fn;return p},o.prototype.listenerCount=function(l){var c=e?e+l:l,u=this._events[c];return u?u.fn?1:u.length:0},o.prototype.emit=function(l,c,u,d,f,p){var g=e?e+l:l;if(!this._events[g])return!1;var m=this._events[g],y=arguments.length,_,x;if(m.fn){switch(m.once&&this.removeListener(l,m.fn,void 0,!0),y){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,u),!0;case 4:return m.fn.call(m.context,c,u,d),!0;case 5:return m.fn.call(m.context,c,u,d,f),!0;case 6:return m.fn.call(m.context,c,u,d,f,p),!0}for(x=1,_=new Array(y-1);x<y;x++)_[x-1]=arguments[x];m.fn.apply(m.context,_)}else{var b=m.length,S;for(x=0;x<b;x++)switch(m[x].once&&this.removeListener(l,m[x].fn,void 0,!0),y){case 1:m[x].fn.call(m[x].context);break;case 2:m[x].fn.call(m[x].context,c);break;case 3:m[x].fn.call(m[x].context,c,u);break;case 4:m[x].fn.call(m[x].context,c,u,d);break;default:if(!_)for(S=1,_=new Array(y-1);S<y;S++)_[S-1]=arguments[S];m[x].fn.apply(m[x].context,_)}}return!0},o.prototype.on=function(l,c,u){return r(this,l,c,u,!1)},o.prototype.once=function(l,c,u){return r(this,l,c,u,!0)},o.prototype.removeListener=function(l,c,u,d){var f=e?e+l:l;if(!this._events[f])return this;if(!c)return a(this,f),this;var p=this._events[f];if(p.fn)p.fn===c&&(!d||p.once)&&(!u||p.context===u)&&a(this,f);else{for(var g=0,m=[],y=p.length;g<y;g++)(p[g].fn!==c||d&&!p[g].once||u&&p[g].context!==u)&&m.push(p[g]);m.length?this._events[f]=m.length===1?m[0]:m:a(this,f)}return this},o.prototype.removeAllListeners=function(l){var c;return l?(c=e?e+l:l,this._events[c]&&a(this,c)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=e,o.EventEmitter=o,s.exports=o}(Wi)),Wi.exports}var Eu=Mu();const gt=xh(Eu),ku=Math.PI*2,Iu=180/Math.PI,In=Math.PI/180;class mt{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new mt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return Gi.x=0,Gi.y=0,Gi}}const Gi=new mt;class U{constructor(t=1,e=0,i=0,n=1,r=0,a=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=a}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,n,r,a){return this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=a,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new mt;const i=t.x,n=t.y;return e.x=this.a*i+this.c*n+this.tx,e.y=this.b*i+this.d*n+this.ty,e}applyInverse(t,e){e=e||new mt;const i=this.a,n=this.b,r=this.c,a=this.d,o=this.tx,h=this.ty,l=1/(i*a+r*-n),c=t.x,u=t.y;return e.x=a*l*c+-r*l*u+(h*r-o*a)*l,e.y=i*l*u+-n*l*c+(-h*i+o*n)*l,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),n=this.a,r=this.c,a=this.tx;return this.a=n*e-this.b*i,this.b=n*i+this.b*e,this.c=r*e-this.d*i,this.d=r*i+this.d*e,this.tx=a*e-this.ty*i,this.ty=a*i+this.ty*e,this}append(t){const e=this.a,i=this.b,n=this.c,r=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*i+t.b*r,this.c=t.c*e+t.d*n,this.d=t.c*i+t.d*r,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*r+this.ty,this}appendFrom(t,e){const i=t.a,n=t.b,r=t.c,a=t.d,o=t.tx,h=t.ty,l=e.a,c=e.b,u=e.c,d=e.d;return this.a=i*l+n*u,this.b=i*c+n*d,this.c=r*l+a*u,this.d=r*c+a*d,this.tx=o*l+h*u+e.tx,this.ty=o*c+h*d+e.ty,this}setTransform(t,e,i,n,r,a,o,h,l){return this.a=Math.cos(o+l)*r,this.b=Math.sin(o+l)*r,this.c=-Math.sin(o-h)*a,this.d=Math.cos(o-h)*a,this.tx=t-(i*this.a+n*this.c),this.ty=e-(i*this.b+n*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const i=this.a,n=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,i=this.b,n=this.c,r=this.d,a=t.pivot,o=-Math.atan2(-n,r),h=Math.atan2(i,e),l=Math.abs(o+h);return l<1e-5||Math.abs(ku-l)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=h),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(n*n+r*r),t.position.x=this.tx+(a.x*e+a.y*n),t.position.y=this.ty+(a.x*i+a.y*r),t}invert(){const t=this.a,e=this.b,i=this.c,n=this.d,r=this.tx,a=t*n-e*i;return this.a=n/a,this.b=-e/a,this.c=-i/a,this.d=t/a,this.tx=(i*this.ty-n*r)/a,this.ty=-(t*this.ty-e*r)/a,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new U;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return Fu.identity()}static get shared(){return Ru.identity()}}const Ru=new U,Fu=new U,pe=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],me=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],ge=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ye=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Rn=[],bh=[],qs=Math.sign;function Vu(){for(let s=0;s<16;s++){const t=[];Rn.push(t);for(let e=0;e<16;e++){const i=qs(pe[s]*pe[e]+ge[s]*me[e]),n=qs(me[s]*pe[e]+ye[s]*me[e]),r=qs(pe[s]*ge[e]+ge[s]*ye[e]),a=qs(me[s]*ge[e]+ye[s]*ye[e]);for(let o=0;o<16;o++)if(pe[o]===i&&me[o]===n&&ge[o]===r&&ye[o]===a){t.push(o);break}}}for(let s=0;s<16;s++){const t=new U;t.set(pe[s],me[s],ge[s],ye[s],0,0),bh.push(t)}}Vu();const K={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:s=>pe[s],uY:s=>me[s],vX:s=>ge[s],vY:s=>ye[s],inv:s=>s&8?s&15:-s&7,add:(s,t)=>Rn[s][t],sub:(s,t)=>Rn[s][K.inv(t)],rotate180:s=>s^4,isVertical:s=>(s&3)===2,byDirection:(s,t)=>Math.abs(s)*2<=Math.abs(t)?t>=0?K.S:K.N:Math.abs(t)*2<=Math.abs(s)?s>0?K.E:K.W:t>0?s>0?K.SE:K.SW:s>0?K.NE:K.NW,matrixAppendRotationInv:(s,t,e=0,i=0)=>{const n=bh[K.inv(t)];n.tx=e,n.ty=i,s.append(n)}},Zs=[new mt,new mt,new mt,new mt];class j{constructor(t=0,e=0,i=0,n=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(n)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new j(0,0,0,0)}clone(){return new j(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}strokeContains(t,e,i,n=.5){const{width:r,height:a}=this;if(r<=0||a<=0)return!1;const o=this.x,h=this.y,l=i*(1-n),c=i-l,u=o-l,d=o+r+l,f=h-l,p=h+a+l,g=o+c,m=o+r-c,y=h+c,_=h+a-c;return t>=u&&t<=d&&e>=f&&e<=p&&!(t>g&&t<m&&e>y&&e<_)}intersects(t,e){if(!e){const T=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=T)return!1;const M=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>M}const i=this.left,n=this.right,r=this.top,a=this.bottom;if(n<=i||a<=r)return!1;const o=Zs[0].set(t.left,t.top),h=Zs[1].set(t.left,t.bottom),l=Zs[2].set(t.right,t.top),c=Zs[3].set(t.right,t.bottom);if(l.x<=o.x||h.y<=o.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(o,o),e.apply(h,h),e.apply(l,l),e.apply(c,c),Math.max(o.x,h.x,l.x,c.x)<=i||Math.min(o.x,h.x,l.x,c.x)>=n||Math.max(o.y,h.y,l.y,c.y)<=r||Math.min(o.y,h.y,l.y,c.y)>=a))return!1;const d=u*(h.y-o.y),f=u*(o.x-h.x),p=d*i+f*r,g=d*n+f*r,m=d*i+f*a,y=d*n+f*a;if(Math.max(p,g,m,y)<=d*o.x+f*o.y||Math.min(p,g,m,y)>=d*c.x+f*c.y)return!1;const _=u*(o.y-l.y),x=u*(l.x-o.x),b=_*i+x*r,S=_*n+x*r,w=_*i+x*a,v=_*n+x*a;return!(Math.max(b,S,w,v)<=_*o.x+x*o.y||Math.min(b,S,w,v)>=_*c.x+x*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),n=Math.max(this.y,t.y),r=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=n,this.height=Math.max(r-n,0),this}ceil(t=1,e=.001){const i=Math.ceil((this.x+this.width-e)*t)/t,n=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=n-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),r=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=n,this.height=r-n,this}getBounds(t){return t||(t=new j),t.copyFrom(this),t}containsRect(t){if(this.width<=0||this.height<=0)return!1;const e=t.x,i=t.y,n=t.x+t.width,r=t.y+t.height;return e>=this.x&&e<this.x+this.width&&i>=this.y&&i<this.y+this.height&&n>=this.x&&n<this.x+this.width&&r>=this.y&&r<this.y+this.height}set(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const Hi={default:-1};function st(s="default"){return Hi[s]===void 0&&(Hi[s]=-1),++Hi[s]}const ia={},W="8.0.0",Bu="8.3.4";function N(s,t,e=3){if(ia[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`):(i=i.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${s}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`),console.warn(i))),ia[t]=!0}const wh=()=>{};function We(s){return s+=s===0?1:0,--s,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s+1}function na(s){return!(s&s-1)&&!!s}function vh(s){const t={};for(const e in s)s[e]!==void 0&&(t[e]=s[e]);return t}const ra=Object.create(null);function Ou(s){const t=ra[s];return t===void 0&&(ra[s]=st("resource")),t}const Ch=class Sh extends gt{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,t={...Sh.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){N(W,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=Ou(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};Ch.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let Ge=Ch;const Ah=class Th extends gt{constructor(t={}){super(),this.options=t,this.uid=st("textureSource"),this._resourceType="textureSource",this._resourceId=st("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...Th.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new Ge(vh(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){var e,i;this.style!==t&&((e=this._style)==null||e.off("change",this._onStyleChange,this),this._style=t,(i=this._style)==null||i.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=st("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,i){i||(i=this._resolution),t||(t=this.width),e||(e=this.height);const n=Math.round(t*i),r=Math.round(e*i);return this.width=n/i,this.height=r/i,this._resolution=i,this.pixelWidth===n&&this.pixelHeight===r?!1:(this._refreshPOT(),this.pixelWidth=n,this.pixelHeight=r,this.emit("resize",this),this._resourceId=st("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=na(this.pixelWidth)&&na(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};Ah.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let It=Ah;class xr extends It{constructor(t){const e=t.resource||new Float32Array(t.width*t.height*4);let i=t.format;i||(e instanceof Float32Array?i="rgba32float":e instanceof Int32Array||e instanceof Uint32Array?i="rgba32uint":e instanceof Int16Array||e instanceof Uint16Array?i="rgba16uint":(e instanceof Int8Array,i="bgra8unorm")),super({...t,resource:e,format:i}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}xr.extension=I.TextureSource;const aa=new U;class Lu{constructor(t,e){this.mapCoord=new U,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof e>"u"?this.clampMargin=t.width<10?0:.5:this.clampMargin=e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){var e;this.texture!==t&&((e=this._texture)==null||e.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const i=this.mapCoord;for(let n=0;n<t.length;n+=2){const r=t[n],a=t[n+1];e[n]=r*i.a+a*i.c+i.tx,e[n+1]=r*i.b+a*i.d+i.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const i=t.orig,n=t.trim;n&&(aa.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(aa));const r=t.source,a=this.uClampFrame,o=this.clampMargin/r._resolution,h=this.clampOffset/r._resolution;return a[0]=(t.frame.x+o+h)/r.width,a[1]=(t.frame.y+o+h)/r.height,a[2]=(t.frame.x+t.frame.width-o+h)/r.width,a[3]=(t.frame.y+t.frame.height-o+h)/r.height,this.uClampOffset[0]=this.clampOffset/r.pixelWidth,this.uClampOffset[1]=this.clampOffset/r.pixelHeight,this.isSimple=t.frame.width===r.width&&t.frame.height===r.height&&t.rotate===0,!0}}class L extends gt{constructor({source:t,label:e,frame:i,orig:n,trim:r,defaultAnchor:a,defaultBorders:o,rotate:h,dynamic:l}={}){if(super(),this.uid=st("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new j,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=e,this.source=(t==null?void 0:t.source)??new It,this.noFrame=!i,i)this.frame.copyFrom(i);else{const{width:c,height:u}=this._source;this.frame.width=c,this.frame.height=u}this.orig=n||this.frame,this.trim=r,this.rotate=h??0,this.defaultAnchor=a,this.defaultBorders=o,this.destroyed=!1,this.dynamic=l||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new Lu(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:e}=this,{width:i,height:n}=this._source,r=e.x/i,a=e.y/n,o=e.width/i,h=e.height/n;let l=this.rotate;if(l){const c=o/2,u=h/2,d=r+c,f=a+u;l=K.add(l,K.NW),t.x0=d+c*K.uX(l),t.y0=f+u*K.uY(l),l=K.add(l,2),t.x1=d+c*K.uX(l),t.y1=f+u*K.uY(l),l=K.add(l,2),t.x2=d+c*K.uX(l),t.y2=f+u*K.uY(l),l=K.add(l,2),t.x3=d+c*K.uX(l),t.y3=f+u*K.uY(l)}else t.x0=r,t.y0=a,t.x1=r+o,t.y1=a,t.x2=r+o,t.y2=a+h,t.x3=r,t.y3=a+h}destroy(t=!1){this._source&&t&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return N(W,"Texture.baseTexture is now Texture.source"),this._source}}L.EMPTY=new L({label:"EMPTY",source:new It({label:"EMPTY"})});L.EMPTY.destroy=wh;L.WHITE=new L({source:new xr({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});L.WHITE.destroy=wh;function Du(s,t,e){const{width:i,height:n}=e.orig,r=e.trim;if(r){const a=r.width,o=r.height;s.minX=r.x-t._x*i,s.maxX=s.minX+a,s.minY=r.y-t._y*n,s.maxY=s.minY+o}else s.minX=-t._x*i,s.maxX=s.minX+i,s.minY=-t._y*n,s.maxY=s.minY+n}const oa=new U;class kt{constructor(t=1/0,e=1/0,i=-1/0,n=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=oa,this.minX=t,this.minY=e,this.maxX=i,this.maxY=n}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new j);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=oa,this}set(t,e,i,n){this.minX=t,this.minY=e,this.maxX=i,this.maxY=n}addFrame(t,e,i,n,r){r||(r=this.matrix);const a=r.a,o=r.b,h=r.c,l=r.d,c=r.tx,u=r.ty;let d=this.minX,f=this.minY,p=this.maxX,g=this.maxY,m=a*t+h*e+c,y=o*t+l*e+u;m<d&&(d=m),y<f&&(f=y),m>p&&(p=m),y>g&&(g=y),m=a*i+h*e+c,y=o*i+l*e+u,m<d&&(d=m),y<f&&(f=y),m>p&&(p=m),y>g&&(g=y),m=a*t+h*n+c,y=o*t+l*n+u,m<d&&(d=m),y<f&&(f=y),m>p&&(p=m),y>g&&(g=y),m=a*i+h*n+c,y=o*i+l*n+u,m<d&&(d=m),y<f&&(f=y),m>p&&(p=m),y>g&&(g=y),this.minX=d,this.minY=f,this.maxX=p,this.maxY=g}addRect(t,e){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,e)}addBounds(t,e){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,e)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,i=this.minY,n=this.maxX,r=this.maxY,{a,b:o,c:h,d:l,tx:c,ty:u}=t;let d=a*e+h*i+c,f=o*e+l*i+u;this.minX=d,this.minY=f,this.maxX=d,this.maxY=f,d=a*n+h*i+c,f=o*n+l*i+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=a*e+h*r+c,f=o*e+l*r+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=a*n+h*r+c,f=o*n+l*r+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,e,i,n){return this.minX<t&&(this.minX=t),this.maxX>e&&(this.maxX=e),this.minY<i&&(this.minY=i),this.maxY>n&&(this.maxY=n),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new kt(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}set x(t){const e=this.maxX-this.minX;this.minX=t,this.maxX=t+e}get y(){return this.minY}set y(t){const e=this.maxY-this.minY;this.minY=t,this.maxY=t+e}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,i,n){let r=this.minX,a=this.minY,o=this.maxX,h=this.maxY;n||(n=this.matrix);const l=n.a,c=n.b,u=n.c,d=n.d,f=n.tx,p=n.ty;for(let g=e;g<i;g+=2){const m=t[g],y=t[g+1],_=l*m+u*y+f,x=c*m+d*y+p;r=_<r?_:r,a=x<a?x:a,o=_>o?_:o,h=x>h?x:h}this.minX=r,this.minY=a,this.maxX=o,this.maxY=h}containsPoint(t,e){return this.minX<=t&&this.minY<=e&&this.maxX>=t&&this.maxY>=e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(t){return this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,this}}var Nu={grad:.9,turn:360,rad:360/(2*Math.PI)},zt=function(s){return typeof s=="string"?s.length>0:typeof s=="number"},ht=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*s)/e+0},wt=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),s>e?e:s>t?s:t},Ph=function(s){return(s=isFinite(s)?s%360:0)>0?s:s+360},ha=function(s){return{r:wt(s.r,0,255),g:wt(s.g,0,255),b:wt(s.b,0,255),a:wt(s.a)}},$i=function(s){return{r:ht(s.r),g:ht(s.g),b:ht(s.b),a:ht(s.a,3)}},Uu=/^#([0-9a-f]{3,8})$/i,Qs=function(s){var t=s.toString(16);return t.length<2?"0"+t:t},Mh=function(s){var t=s.r,e=s.g,i=s.b,n=s.a,r=Math.max(t,e,i),a=r-Math.min(t,e,i),o=a?r===t?(e-i)/a:r===e?2+(i-t)/a:4+(t-e)/a:0;return{h:60*(o<0?o+6:o),s:r?a/r*100:0,v:r/255*100,a:n}},Eh=function(s){var t=s.h,e=s.s,i=s.v,n=s.a;t=t/360*6,e/=100,i/=100;var r=Math.floor(t),a=i*(1-e),o=i*(1-(t-r)*e),h=i*(1-(1-t+r)*e),l=r%6;return{r:255*[i,o,a,a,h,i][l],g:255*[h,i,i,o,a,a][l],b:255*[a,a,h,i,i,o][l],a:n}},la=function(s){return{h:Ph(s.h),s:wt(s.s,0,100),l:wt(s.l,0,100),a:wt(s.a)}},ca=function(s){return{h:ht(s.h),s:ht(s.s),l:ht(s.l),a:ht(s.a,3)}},ua=function(s){return Eh((e=(t=s).s,{h:t.h,s:(e*=((i=t.l)<50?i:100-i)/100)>0?2*e/(i+e)*100:0,v:i+e,a:t.a}));var t,e,i},Ps=function(s){return{h:(t=Mh(s)).h,s:(n=(200-(e=t.s))*(i=t.v)/100)>0&&n<200?e*i/100/(n<=100?n:200-n)*100:0,l:n/2,a:t.a};var t,e,i,n},zu=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Wu=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Gu=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Hu=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Fn={string:[[function(s){var t=Uu.exec(s);return t?(s=t[1]).length<=4?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?ht(parseInt(s[3]+s[3],16)/255,2):1}:s.length===6||s.length===8?{r:parseInt(s.substr(0,2),16),g:parseInt(s.substr(2,2),16),b:parseInt(s.substr(4,2),16),a:s.length===8?ht(parseInt(s.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(s){var t=Gu.exec(s)||Hu.exec(s);return t?t[2]!==t[4]||t[4]!==t[6]?null:ha({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(s){var t=zu.exec(s)||Wu.exec(s);if(!t)return null;var e,i,n=la({h:(e=t[1],i=t[2],i===void 0&&(i="deg"),Number(e)*(Nu[i]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return ua(n)},"hsl"]],object:[[function(s){var t=s.r,e=s.g,i=s.b,n=s.a,r=n===void 0?1:n;return zt(t)&&zt(e)&&zt(i)?ha({r:Number(t),g:Number(e),b:Number(i),a:Number(r)}):null},"rgb"],[function(s){var t=s.h,e=s.s,i=s.l,n=s.a,r=n===void 0?1:n;if(!zt(t)||!zt(e)||!zt(i))return null;var a=la({h:Number(t),s:Number(e),l:Number(i),a:Number(r)});return ua(a)},"hsl"],[function(s){var t=s.h,e=s.s,i=s.v,n=s.a,r=n===void 0?1:n;if(!zt(t)||!zt(e)||!zt(i))return null;var a=function(o){return{h:Ph(o.h),s:wt(o.s,0,100),v:wt(o.v,0,100),a:wt(o.a)}}({h:Number(t),s:Number(e),v:Number(i),a:Number(r)});return Eh(a)},"hsv"]]},da=function(s,t){for(var e=0;e<t.length;e++){var i=t[e][0](s);if(i)return[i,t[e][1]]}return[null,void 0]},$u=function(s){return typeof s=="string"?da(s.trim(),Fn.string):typeof s=="object"&&s!==null?da(s,Fn.object):[null,void 0]},ji=function(s,t){var e=Ps(s);return{h:e.h,s:wt(e.s+100*t,0,100),l:e.l,a:e.a}},Yi=function(s){return(299*s.r+587*s.g+114*s.b)/1e3/255},fa=function(s,t){var e=Ps(s);return{h:e.h,s:e.s,l:wt(e.l+100*t,0,100),a:e.a}},Vn=function(){function s(t){this.parsed=$u(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return s.prototype.isValid=function(){return this.parsed!==null},s.prototype.brightness=function(){return ht(Yi(this.rgba),2)},s.prototype.isDark=function(){return Yi(this.rgba)<.5},s.prototype.isLight=function(){return Yi(this.rgba)>=.5},s.prototype.toHex=function(){return t=$i(this.rgba),e=t.r,i=t.g,n=t.b,a=(r=t.a)<1?Qs(ht(255*r)):"","#"+Qs(e)+Qs(i)+Qs(n)+a;var t,e,i,n,r,a},s.prototype.toRgb=function(){return $i(this.rgba)},s.prototype.toRgbString=function(){return t=$i(this.rgba),e=t.r,i=t.g,n=t.b,(r=t.a)<1?"rgba("+e+", "+i+", "+n+", "+r+")":"rgb("+e+", "+i+", "+n+")";var t,e,i,n,r},s.prototype.toHsl=function(){return ca(Ps(this.rgba))},s.prototype.toHslString=function(){return t=ca(Ps(this.rgba)),e=t.h,i=t.s,n=t.l,(r=t.a)<1?"hsla("+e+", "+i+"%, "+n+"%, "+r+")":"hsl("+e+", "+i+"%, "+n+"%)";var t,e,i,n,r},s.prototype.toHsv=function(){return t=Mh(this.rgba),{h:ht(t.h),s:ht(t.s),v:ht(t.v),a:ht(t.a,3)};var t},s.prototype.invert=function(){return Bt({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},s.prototype.saturate=function(t){return t===void 0&&(t=.1),Bt(ji(this.rgba,t))},s.prototype.desaturate=function(t){return t===void 0&&(t=.1),Bt(ji(this.rgba,-t))},s.prototype.grayscale=function(){return Bt(ji(this.rgba,-1))},s.prototype.lighten=function(t){return t===void 0&&(t=.1),Bt(fa(this.rgba,t))},s.prototype.darken=function(t){return t===void 0&&(t=.1),Bt(fa(this.rgba,-t))},s.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},s.prototype.alpha=function(t){return typeof t=="number"?Bt({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):ht(this.rgba.a,3);var e},s.prototype.hue=function(t){var e=Ps(this.rgba);return typeof t=="number"?Bt({h:t,s:e.s,l:e.l,a:e.a}):ht(e.h)},s.prototype.isEqual=function(t){return this.toHex()===Bt(t).toHex()},s}(),Bt=function(s){return s instanceof Vn?s:new Vn(s)},pa=[],ju=function(s){s.forEach(function(t){pa.indexOf(t)<0&&(t(Vn,Fn),pa.push(t))})};function Yu(s,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var n in e)i[e[n]]=n;var r={};s.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var o,h,l=i[this.toHex()];if(l)return l;if(a!=null&&a.closest){var c=this.toRgb(),u=1/0,d="black";if(!r.length)for(var f in e)r[f]=new s(e[f]).toRgb();for(var p in e){var g=(o=c,h=r[p],Math.pow(o.r-h.r,2)+Math.pow(o.g-h.g,2)+Math.pow(o.b-h.b,2));g<u&&(u=g,d=p)}return d}},t.string.push([function(a){var o=a.toLowerCase(),h=o==="transparent"?"#0000":e[o];return h?new s(h).toRgb():null},"name"])}ju([Yu]);const He=class bs{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof bs)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._value=this._cloneSource(t),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,e){const i=typeof t;if(i!==typeof e)return!1;if(i==="number"||i==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((r,a)=>r===e[a]);if(t!==null&&e!==null){const r=Object.keys(t),a=Object.keys(e);return r.length!==a.length?!1:r.every(o=>t[o]===e[o])}return t===e}toRgba(){const[t,e,i,n]=this._components;return{r:t,g:e,b:i,a:n}}toRgb(){const[t,e,i]=this._components;return{r:t,g:e,b:i}}toRgbaString(){const[t,e,i]=this.toUint8RgbArray();return`rgba(${t},${e},${i},${this.alpha})`}toUint8RgbArray(t){const[e,i,n]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb),t[0]=Math.round(e*255),t[1]=Math.round(i*255),t[2]=Math.round(n*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t||(t=this._arrayRgba);const[e,i,n,r]=this._components;return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb);const[e,i,n]=this._components;return t[0]=e,t[1]=i,t[2]=n,t}toNumber(){return this._int}toBgrNumber(){const[t,e,i]=this.toUint8RgbArray();return(i<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,i,n,r]=bs._temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=i,this._components[2]*=n,this._components[3]*=r,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let i=this._int>>16&255,n=this._int>>8&255,r=this._int&255;return e&&(i=i*t+.5|0,n=n*t+.5|0,r=r*t+.5|0),(t*255<<24)+(i<<16)+(n<<8)+r}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let e,i,n,r;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const a=t;e=(a>>16&255)/255,i=(a>>8&255)/255,n=(a&255)/255,r=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,i,n,r=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,i,n,r=255]=t,e/=255,i/=255,n/=255,r/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const o=bs.HEX_PATTERN.exec(t);o&&(t=`#${o[2]}`)}const a=Bt(t);a.isValid()&&({r:e,g:i,b:n,a:r}=a.rgba,e/=255,i/=255,n/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=i,this._components[2]=n,this._components[3]=r,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,e,i]=this._components;this._int=(t*255<<16)+(e*255<<8)+(i*255|0)}_clamp(t,e=0,i=1){return typeof t=="number"?Math.min(Math.max(t,e),i):(t.forEach((n,r)=>{t[r]=Math.min(Math.max(n,e),i)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof bs||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}};He.shared=new He;He._temp=new He;He.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let nt=He;const Xu={cullArea:null,cullable:!1,cullableChildren:!0};let Xi=0;const ma=500;function Y(...s){Xi!==ma&&(Xi++,Xi===ma?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...s))}class br{constructor(t,e){this._pool=[],this._count=0,this._index=0,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){var i;let e;return this._index>0?e=this._pool[--this._index]:e=new this._classType,(i=e.init)==null||i.call(e,t),e}return(t){var e;(e=t.reset)==null||e.call(t),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class Ku{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new br(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const i=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[i]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}}const Dt=new Ku,qu={get isCachedAsTexture(){var s;return!!((s=this.renderGroup)!=null&&s.isCachedAsTexture)},cacheAsTexture(s){typeof s=="boolean"&&s===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(s===!0?{}:s))},updateCacheTexture(){var s;(s=this.renderGroup)==null||s.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(s){N("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(s)}};function Zu(s,t,e){const i=s.length;let n;if(t>=i||e===0)return;e=t+e>i?i-t:e;const r=i-e;for(n=t;n<r;++n)s[n]=s[n+e];s.length=r}const Qu={allowChildren:!0,removeChildren(s=0,t){var r;const e=t??this.children.length,i=e-s,n=[];if(i>0&&i<=e){for(let o=e-1;o>=s;o--){const h=this.children[o];h&&(n.push(h),h.parent=null)}Zu(this.children,s,e);const a=this.renderGroup||this.parentRenderGroup;a&&a.removeChildren(n);for(let o=0;o<n.length;++o){const h=n[o];(r=h.parentRenderLayer)==null||r.detach(h),this.emit("childRemoved",h,this,o),n[o].emit("removed",this)}return n.length>0&&this._didViewChangeTick++,n}else if(i===0&&this.children.length===0)return n;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(s){const t=this.getChildAt(s);return this.removeChild(t)},getChildAt(s){if(s<0||s>=this.children.length)throw new Error(`getChildAt: Index (${s}) does not exist.`);return this.children[s]},setChildIndex(s,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(s),this.addChildAt(s,t)},getChildIndex(s){const t=this.children.indexOf(s);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(s,t){this.allowChildren||N(W,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:e}=this;if(t<0||t>e.length)throw new Error(`${s}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(s.parent){const n=s.parent.children.indexOf(s);if(s.parent===this&&n===t)return s;n!==-1&&s.parent.children.splice(n,1)}t===e.length?e.push(s):e.splice(t,0,s),s.parent=this,s.didChange=!0,s._updateFlags=15;const i=this.renderGroup||this.parentRenderGroup;return i&&i.addChild(s),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",s,this,t),s.emit("added",this),s},swapChildren(s,t){if(s===t)return;const e=this.getChildIndex(s),i=this.getChildIndex(t);this.children[e]=t,this.children[i]=s;const n=this.renderGroup||this.parentRenderGroup;n&&(n.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var s;(s=this.parent)==null||s.removeChild(this)},reparentChild(...s){return s.length===1?this.reparentChildAt(s[0],this.children.length):(s.forEach(t=>this.reparentChildAt(t,this.children.length)),s[0])},reparentChildAt(s,t){if(s.parent===this)return this.setChildIndex(s,t),s;const e=s.worldTransform.clone();s.removeFromParent(),this.addChildAt(s,t);const i=this.worldTransform.clone();return i.invert(),e.prepend(i),s.setFromMatrix(e),s},replaceChild(s,t){s.updateLocalTransform(),this.addChildAt(t,this.getChildIndex(s)),t.setFromMatrix(s.localTransform),t.updateLocalTransform(),this.removeChild(s)}},Ju={collectRenderables(s,t,e){this.parentRenderLayer&&this.parentRenderLayer!==e||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(s,t,e):this.renderGroup?t.renderPipes.renderGroup.addRenderGroup(this.renderGroup,s):this.collectRenderablesWithEffects(s,t,e))},collectRenderablesSimple(s,t,e){const i=this.children,n=i.length;for(let r=0;r<n;r++)i[r].collectRenderables(s,t,e)},collectRenderablesWithEffects(s,t,e){const{renderPipes:i}=t;for(let n=0;n<this.effects.length;n++){const r=this.effects[n];i[r.pipe].push(r,this,s)}this.collectRenderablesSimple(s,t,e);for(let n=this.effects.length-1;n>=0;n--){const r=this.effects[n];i[r.pipe].pop(r,this,s)}}};class ga{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}class td{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this._tests.length;e++){const i=this._tests[e];if(i.test(t))return Dt.get(i.maskClass,t)}return t}returnMaskEffect(t){Dt.return(t)}}const Bn=new td;X.handleByList(I.MaskEffect,Bn._effectClasses);const ed={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const s=this.renderGroup||this.parentRenderGroup;s&&(s.structureDidChange=!0)},addEffect(s){this.effects.indexOf(s)===-1&&(this.effects.push(s),this.effects.sort((e,i)=>e.priority-i.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(s){const t=this.effects.indexOf(s);t!==-1&&(this.effects.splice(t,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(s){const t=this._maskEffect;(t==null?void 0:t.mask)!==s&&(t&&(this.removeEffect(t),Bn.returnMaskEffect(t),this._maskEffect=null),s!=null&&(this._maskEffect=Bn.getMaskEffect(s),this.addEffect(this._maskEffect)))},get mask(){var s;return(s=this._maskEffect)==null?void 0:s.mask},setMask(s){this._maskOptions={...this._maskOptions,...s},s.mask&&(this.mask=s.mask),this._markStructureAsChanged()},set filters(s){var r;!Array.isArray(s)&&s&&(s=[s]);const t=this._filterEffect||(this._filterEffect=new ga);s=s;const e=(s==null?void 0:s.length)>0,i=((r=t.filters)==null?void 0:r.length)>0,n=e!==i;s=Array.isArray(s)?s.slice(0):s,t.filters=Object.freeze(s),n&&(e?this.addEffect(t):(this.removeEffect(t),t.filters=s??null))},get filters(){var s;return(s=this._filterEffect)==null?void 0:s.filters},set filterArea(s){this._filterEffect||(this._filterEffect=new ga),this._filterEffect.filterArea=s},get filterArea(){var s;return(s=this._filterEffect)==null?void 0:s.filterArea}},sd={label:null,get name(){return N(W,"Container.name property has been removed, use Container.label instead"),this.label},set name(s){N(W,"Container.name property has been removed, use Container.label instead"),this.label=s},getChildByName(s,t=!1){return this.getChildByLabel(s,t)},getChildByLabel(s,t=!1){const e=this.children;for(let i=0;i<e.length;i++){const n=e[i];if(n.label===s||s instanceof RegExp&&s.test(n.label))return n}if(t)for(let i=0;i<e.length;i++){const r=e[i].getChildByLabel(s,!0);if(r)return r}return null},getChildrenByLabel(s,t=!1,e=[]){const i=this.children;for(let n=0;n<i.length;n++){const r=i[n];(r.label===s||s instanceof RegExp&&s.test(r.label))&&e.push(r)}if(t)for(let n=0;n<i.length;n++)i[n].getChildrenByLabel(s,!0,e);return e}},yt=new br(U),$t=new br(kt),id=new U,nd={getFastGlobalBounds(s,t){t||(t=new kt),t.clear(),this._getGlobalBoundsRecursive(!!s,t,this.parentRenderLayer),t.isValid||t.set(0,0,0,0);const e=this.renderGroup||this.parentRenderGroup;return t.applyMatrix(e.worldTransform),t},_getGlobalBoundsRecursive(s,t,e){let i=t;if(s&&this.parentRenderLayer&&this.parentRenderLayer!==e||this.localDisplayStatus!==7||!this.measurable)return;const n=!!this.effects.length;if((this.renderGroup||n)&&(i=$t.get().clear()),this.boundsArea)t.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const a=this.bounds;i.addFrame(a.minX,a.minY,a.maxX,a.maxY,this.groupTransform)}const r=this.children;for(let a=0;a<r.length;a++)r[a]._getGlobalBoundsRecursive(s,i,e)}if(n){let r=!1;const a=this.renderGroup||this.parentRenderGroup;for(let o=0;o<this.effects.length;o++)this.effects[o].addBounds&&(r||(r=!0,i.applyMatrix(a.worldTransform)),this.effects[o].addBounds(i,!0));r&&(i.applyMatrix(a.worldTransform.copyTo(id).invert()),t.addBounds(i,this.relativeGroupTransform)),t.addBounds(i),$t.return(i)}else this.renderGroup&&(t.addBounds(i,this.relativeGroupTransform),$t.return(i))}};function kh(s,t,e){e.clear();let i,n;return s.parent?t?i=s.parent.worldTransform:(n=yt.get().identity(),i=wr(s,n)):i=U.IDENTITY,Ih(s,e,i,t),n&&yt.return(n),e.isValid||e.set(0,0,0,0),e}function Ih(s,t,e,i){var o,h;if(!s.visible||!s.measurable)return;let n;i?n=s.worldTransform:(s.updateLocalTransform(),n=yt.get(),n.appendFrom(s.localTransform,e));const r=t,a=!!s.effects.length;if(a&&(t=$t.get().clear()),s.boundsArea)t.addRect(s.boundsArea,n);else{s.bounds&&(t.matrix=n,t.addBounds(s.bounds));for(let l=0;l<s.children.length;l++)Ih(s.children[l],t,n,i)}if(a){for(let l=0;l<s.effects.length;l++)(h=(o=s.effects[l]).addBounds)==null||h.call(o,t);r.addBounds(t,U.IDENTITY),$t.return(t)}i||yt.return(n)}function wr(s,t){const e=s.parent;return e&&(wr(e,t),e.updateLocalTransform(),t.append(e.localTransform)),t}function Rh(s,t){if(s===16777215||!t)return t;if(t===16777215||!s)return s;const e=s>>16&255,i=s>>8&255,n=s&255,r=t>>16&255,a=t>>8&255,o=t&255,h=e*r/255|0,l=i*a/255|0,c=n*o/255|0;return(h<<16)+(l<<8)+c}const ya=16777215;function _a(s,t){return s===ya?t:t===ya?s:Rh(s,t)}function fi(s){return((s&255)<<16)+(s&65280)+(s>>16&255)}const rd={getGlobalAlpha(s){if(s)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let t=this.alpha,e=this.parent;for(;e;)t*=e.alpha,e=e.parent;return t},getGlobalTransform(s,t){if(t)return s.copyFrom(this.worldTransform);this.updateLocalTransform();const e=wr(this,yt.get().identity());return s.appendFrom(this.localTransform,e),yt.return(e),s},getGlobalTint(s){if(s)return this.renderGroup?fi(this.renderGroup.worldColor):this.parentRenderGroup?fi(_a(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let t=this.localColor,e=this.parent;for(;e;)t=_a(t,e.localColor),e=e.parent;return fi(t)}};function Fh(s,t,e){return t.clear(),e||(e=U.IDENTITY),Vh(s,t,e,s,!0),t.isValid||t.set(0,0,0,0),t}function Vh(s,t,e,i,n){var h,l;let r;if(n)r=yt.get(),r=e.copyTo(r);else{if(!s.visible||!s.measurable)return;s.updateLocalTransform();const c=s.localTransform;r=yt.get(),r.appendFrom(c,e)}const a=t,o=!!s.effects.length;if(o&&(t=$t.get().clear()),s.boundsArea)t.addRect(s.boundsArea,r);else{s.renderPipeId&&(t.matrix=r,t.addBounds(s.bounds));const c=s.children;for(let u=0;u<c.length;u++)Vh(c[u],t,r,i,!1)}if(o){for(let c=0;c<s.effects.length;c++)(l=(h=s.effects[c]).addLocalBounds)==null||l.call(h,t,i);a.addBounds(t,U.IDENTITY),$t.return(t)}yt.return(r)}function Bh(s,t){const e=s.children;for(let i=0;i<e.length;i++){const n=e[i],r=n.uid,a=(n._didViewChangeTick&65535)<<16|n._didContainerChangeTick&65535,o=t.index;(t.data[o]!==r||t.data[o+1]!==a)&&(t.data[t.index]=r,t.data[t.index+1]=a,t.didChange=!0),t.index=o+2,n.children.length&&Bh(n,t)}return t.didChange}const ad=new U,od={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(s,t){const e=Math.sign(this.scale.x)||1;t!==0?this.scale.x=s/t*e:this.scale.x=e},_setHeight(s,t){const e=Math.sign(this.scale.y)||1;t!==0?this.scale.y=s/t*e:this.scale.y=e},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new kt});const s=this._localBoundsCacheData;return s.index=1,s.didChange=!1,s.data[0]!==this._didViewChangeTick&&(s.didChange=!0,s.data[0]=this._didViewChangeTick),Bh(this,s),s.didChange&&Fh(this,s.localBounds,ad),s.localBounds},getBounds(s,t){return kh(this,s,t||new kt)}},hd={_onRender:null,set onRender(s){const t=this.renderGroup||this.parentRenderGroup;if(!s){this._onRender&&(t==null||t.removeOnRender(this)),this._onRender=null;return}this._onRender||t==null||t.addOnRender(this),this._onRender=s},get onRender(){return this._onRender}},ld={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(s){this._zIndex!==s&&(this._zIndex=s,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(cd))}};function cd(s,t){return s._zIndex-t._zIndex}const ud={getGlobalPosition(s=new mt,t=!1){return this.parent?this.parent.toGlobal(this._position,s,t):(s.x=this._position.x,s.y=this._position.y),s},toGlobal(s,t,e=!1){const i=this.getGlobalTransform(yt.get(),e);return t=i.apply(s,t),yt.return(i),t},toLocal(s,t,e,i){t&&(s=t.toGlobal(s,e,i));const n=this.getGlobalTransform(yt.get(),i);return e=n.applyInverse(s,e),yt.return(n),e}};class Oh{constructor(){this.uid=st("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let dd=0;class fd{constructor(t){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this.textureStyle=new Ge(this.textureOptions)}createTexture(t,e,i){const n=new It({...this.textureOptions,width:t,height:e,resolution:1,antialias:i,autoGarbageCollect:!1});return new L({source:n,label:`texturePool_${dd++}`})}getOptimalTexture(t,e,i=1,n){let r=Math.ceil(t*i-1e-6),a=Math.ceil(e*i-1e-6);r=We(r),a=We(a);const o=(r<<17)+(a<<1)+(n?1:0);this._texturePool[o]||(this._texturePool[o]=[]);let h=this._texturePool[o].pop();return h||(h=this.createTexture(r,a,n)),h.source._resolution=i,h.source.width=r/i,h.source.height=a/i,h.source.pixelWidth=r,h.source.pixelHeight=a,h.frame.x=0,h.frame.y=0,h.frame.width=t,h.frame.height=e,h.updateUvs(),this._poolKeyHash[h.uid]=o,h}getSameSizeTexture(t,e=!1){const i=t.source;return this.getOptimalTexture(t.width,t.height,i._resolution,e)}returnTexture(t,e=!1){const i=this._poolKeyHash[t.uid];e&&(t.source.style=this.textureStyle),this._texturePool[i].push(t)}clear(t){if(t=t!==!1,t)for(const e in this._texturePool){const i=this._texturePool[e];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0)}this._texturePool={}}}const pd=new fd;class md{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new U,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new Oh,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(t){this.root=t,t._onRender&&this.addOnRender(t),t.didChange=!0;const e=t.children;for(let i=0;i<e.length;i++){const n=e[i];n._updateFlags=15,this.addChild(n)}}enableCacheAsTexture(t={}){this.textureOptions=t,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(pd.returnTexture(this.texture),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const e=this.childrenToUpdate[t];e.list.fill(null),e.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){const e=this.renderGroupChildren.indexOf(t);e>-1&&this.renderGroupChildren.splice(e,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup){this.addRenderGroupChild(t.renderGroup);return}t._onRender&&this.addOnRender(t);const e=t.children;for(let i=0;i<e.length;i++)this.addChild(e[i])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup){this._removeRenderGroupChild(t.renderGroup);return}const e=t.children;for(let i=0;i<e.length;i++)this.removeChild(e[i])}removeChildren(t){for(let e=0;e<t.length;e++)this.removeChild(t[e])}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeRenderGroupDepth];e||(e=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(t){for(let e=0;e<this._onRenderContainers.length;e++)this._onRenderContainers[e]._onRender(t)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(t=[]){const e=this.root.children;for(let i=0;i<e.length;i++)this._getChildren(e[i],t);return t}_getChildren(t,e=[]){if(e.push(t),t.renderGroup)return e;const i=t.children;for(let n=0;n<i.length;n++)this._getChildren(i[n],e);return e}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new U),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new U),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const t=this._parentCacheAsTextureRenderGroup;return t?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new U),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(t.inverseWorldTransform).translate(-t._textureBounds.x,-t._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function gd(s,t,e={}){for(const i in t)!e[i]&&t[i]!==void 0&&(s[i]=t[i])}const Ki=new ot(null),Js=new ot(null),qi=new ot(null,1,1),ti=new ot(null),xa=1,yd=2,Zi=4;class it extends gt{constructor(t={}){var e,i;super(),this.uid=st("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new U,this.relativeGroupTransform=new U,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new ot(this,0,0),this._scale=qi,this._pivot=Js,this._origin=ti,this._skew=Ki,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],gd(this,t,{children:!0,parent:!0,effects:!0}),(e=t.children)==null||e.forEach(n=>this.addChild(n)),(i=t.parent)==null||i.addChild(this)}static mixin(t){N("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),X.mixin(it,t)}set _didChangeId(t){this._didViewChangeTick=t>>12&4095,this._didContainerChangeTick=t&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...t){if(this.allowChildren||N(W,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let n=0;n<t.length;n++)this.addChild(t[n]);return t[0]}const e=t[0],i=this.renderGroup||this.parentRenderGroup;return e.parent===this?(this.children.splice(this.children.indexOf(e),1),this.children.push(e),i&&(i.structureDidChange=!0),e):(e.parent&&e.parent.removeChild(e),this.children.push(e),this.sortableChildren&&(this.sortDirty=!0),e.parent=this,e.didChange=!0,e._updateFlags=15,i&&i.addChild(e),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this),this._didViewChangeTick++,e._zIndex!==0&&e.depthOfChildModified(),e)}removeChild(...t){if(t.length>1){for(let n=0;n<t.length;n++)this.removeChild(t[n]);return t[0]}const e=t[0],i=this.children.indexOf(e);return i>-1&&(this._didViewChangeTick++,this.children.splice(i,1),this.renderGroup?this.renderGroup.removeChild(e):this.parentRenderGroup&&this.parentRenderGroup.removeChild(e),e.parentRenderLayer&&e.parentRenderLayer.detach(e),e.parent=null,this.emit("childRemoved",e,this,i),e.emit("removed",this)),e}_onUpdate(t){t&&t===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),this.renderGroup=Dt.get(md,this),this.groupTransform=U.IDENTITY,t==null||t.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),Dt.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,t==null||t.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new U),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*Iu}set angle(t){this.rotation=t*In}get pivot(){return this._pivot===Js&&(this._pivot=new ot(this,0,0)),this._pivot}set pivot(t){this._pivot===Js&&(this._pivot=new ot(this,0,0),this._origin!==ti&&Y("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof t=="number"?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===Ki&&(this._skew=new ot(this,0,0)),this._skew}set skew(t){this._skew===Ki&&(this._skew=new ot(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===qi&&(this._scale=new ot(this,1,1)),this._scale}set scale(t){this._scale===qi&&(this._scale=new ot(this,0,0)),typeof t=="string"&&(t=parseFloat(t)),typeof t=="number"?this._scale.set(t):this._scale.copyFrom(t)}get origin(){return this._origin===ti&&(this._origin=new ot(this,0,0)),this._origin}set origin(t){this._origin===ti&&(this._origin=new ot(this,0,0),this._pivot!==Js&&Y("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof t=="number"?this._origin.set(t):this._origin.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const e=this.getLocalBounds().width;this._setWidth(t,e)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const e=this.getLocalBounds().height;this._setHeight(t,e)}getSize(t){t||(t={});const e=this.getLocalBounds();return t.width=Math.abs(this.scale.x*e.width),t.height=Math.abs(this.scale.y*e.height),t}setSize(t,e){const i=this.getLocalBounds();typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,i.width),e!==void 0&&this._setHeight(e,i.height)}_updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}updateTransform(t){return this.position.set(typeof t.x=="number"?t.x:this.position.x,typeof t.y=="number"?t.y:this.position.y),this.scale.set(typeof t.scaleX=="number"?t.scaleX||1:this.scale.x,typeof t.scaleY=="number"?t.scaleY||1:this.scale.y),this.rotation=typeof t.rotation=="number"?t.rotation:this.rotation,this.skew.set(typeof t.skewX=="number"?t.skewX:this.skew.x,typeof t.skewY=="number"?t.skewY:this.skew.y),this.pivot.set(typeof t.pivotX=="number"?t.pivotX:this.pivot.x,typeof t.pivotY=="number"?t.pivotY:this.pivot.y),this.origin.set(typeof t.originX=="number"?t.originX:this.origin.x,typeof t.originY=="number"?t.originY:this.origin.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this._didContainerChangeTick;if(this._didLocalTransformChangeId===t)return;this._didLocalTransformChangeId=t;const e=this.localTransform,i=this._scale,n=this._pivot,r=this._origin,a=this._position,o=i._x,h=i._y,l=n._x,c=n._y,u=-r._x,d=-r._y;e.a=this._cx*o,e.b=this._sx*o,e.c=this._cy*h,e.d=this._sy*h,e.tx=a._x-(l*e.a+c*e.c)+(u*e.a+d*e.c)-u*o,e.ty=a._y-(l*e.b+c*e.d)+(u*e.b+d*e.d)-d*h}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=xa,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const i=nt.shared.setValue(t??16777215).toBgrNumber();i!==this.localColor&&(this.localColor=i,this._updateFlags|=xa,this._onUpdate())}get tint(){return fi(this.localColor)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=yd,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(t){const e=t?2:0;(this.localDisplayStatus&2)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Zi,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(t){const e=t?0:4;(this.localDisplayStatus&4)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Zi,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(t){const e=t?1:0;(this.localDisplayStatus&1)!==e&&(this._updateFlags|=Zi,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(t=!1){var n;if(this.destroyed)return;this.destroyed=!0;let e;if(this.children.length&&(e=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._origin=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof t=="boolean"?t:t==null?void 0:t.children)&&e)for(let r=0;r<e.length;++r)e[r].destroy(t);(n=this.renderGroup)==null||n.destroy(),this.renderGroup=null}}X.mixin(it,Qu,nd,ud,hd,od,ed,sd,ld,Xu,qu,rd,Ju);class Vi extends it{constructor(t){super(t),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this._bounds=new kt(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const e=this.bounds,{x:i,y:n}=t;return i>=e.minX&&i<=e.maxX&&n>=e.minY&&n<=e.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}destroy(t){var e,i;super.destroy(t),this._bounds=null;for(const n in this._gpuData)(i=(e=this._gpuData[n]).destroy)==null||i.call(e);this._gpuData=null}collectRenderablesSimple(t,e,i){const{renderPipes:n}=e;n.blendMode.setBlendMode(this,this.groupBlendMode,t),n[this.renderPipeId].addRenderable(this,t),this.didViewUpdate=!1;const a=this.children,o=a.length;for(let h=0;h<o;h++)a[h].collectRenderables(t,e,i)}}class pt extends Vi{constructor(t=L.EMPTY){t instanceof L&&(t={texture:t});const{texture:e=L.EMPTY,anchor:i,roundPixels:n,width:r,height:a,...o}=t;super({label:"Sprite",...o}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new ot({_onUpdate:()=>{this.onViewUpdate()}}),i?this.anchor=i:e.defaultAnchor&&(this.anchor=e.defaultAnchor),this.texture=e,this.allowChildren=!1,this.roundPixels=n??!1,r!==void 0&&(this.width=r),a!==void 0&&(this.height=a)}static from(t,e=!1){return t instanceof L?new pt(t):new pt(L.from(t,e))}set texture(t){t||(t=L.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return Du(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return N("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const t=this._anchor,e=this._texture,i=this._bounds,{width:n,height:r}=e.orig;i.minX=-t._x*n,i.maxX=i.minX+n,i.minY=-t._y*r,i.maxY=i.minY+r}destroy(t=!1){if(super.destroy(t),typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(i)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null,this._gpuData=null}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width),this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height),this._height=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this._texture.orig.width),e!==void 0&&this._setHeight(e,this._texture.orig.height)}}const _d=new kt;function Lh(s,t,e){const i=_d;s.measurable=!0,kh(s,e,i),t.addBoundsMask(i),s.measurable=!1}function Dh(s,t,e){const i=$t.get();s.measurable=!0;const n=yt.get().identity(),r=Nh(s,e,n);Fh(s,i,r),s.measurable=!1,t.addBoundsMask(i),yt.return(n),$t.return(i)}function Nh(s,t,e){return s?(s!==t&&(Nh(s.parent,t,e),s.updateLocalTransform(),e.append(s.localTransform)),e):(Y("Mask bounds, renderable is not inside the root container"),e)}class Uh{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof pt),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(t,e){this.inverse||Lh(this.mask,t,e)}addLocalBounds(t,e){Dh(this.mask,t,e)}containsPoint(t,e){const i=this.mask;return e(i,t)}destroy(){this.reset()}static test(t){return t instanceof pt}}Uh.extension=I.MaskEffect;class zh{constructor(t){this.priority=0,this.pipe="colorMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return typeof t=="number"}}zh.extension=I.MaskEffect;class Wh{constructor(t){this.priority=0,this.pipe="stencilMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(t,e){Lh(this.mask,t,e)}addLocalBounds(t,e){Dh(this.mask,t,e)}containsPoint(t,e){const i=this.mask;return e(i,t)}destroy(){this.reset()}static test(t){return t instanceof it}}Wh.extension=I.MaskEffect;const xd={createCanvas:(s,t)=>{const e=document.createElement("canvas");return e.width=s,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(s,t)=>fetch(s,t),parseXML:s=>new DOMParser().parseFromString(s,"text/xml")};let ba=xd;const Z={get(){return ba},set(s){ba=s}};class Gh extends It{constructor(t){t.resource||(t.resource=Z.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity,this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,e=this.height,i=this._resolution){const n=super.resize(t,e,i);return n&&this.resizeCanvas(),n}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}Gh.extension=I.TextureSource;class Se extends It{constructor(t){super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}Se.extension=I.TextureSource;var bi=(s=>(s[s.INTERACTION=50]="INTERACTION",s[s.HIGH=25]="HIGH",s[s.NORMAL=0]="NORMAL",s[s.LOW=-25]="LOW",s[s.UTILITY=-50]="UTILITY",s))(bi||{});class Qi{constructor(t,e=null,i=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=e,this.priority=i,this._once=n}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const Hh=class xt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Qi(null,null,1/0),this.deltaMS=1/xt.targetFPMS,this.elapsedMS=1/xt.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,i=bi.NORMAL){return this._addListener(new Qi(t,e,i))}addOnce(t,e,i=bi.NORMAL){return this._addListener(new Qi(t,e,i,!0))}_addListener(t){let e=this._head.next,i=this._head;if(!e)t.connect(i);else{for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}return this._startIfPossible(),this}remove(t,e){let i=this._head.next;for(;i;)i.match(t,e)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*xt.targetFPMS;const i=this._head;let n=i.next;for(;n;)n=n.emit(this);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,xt.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!xt._shared){const t=xt._shared=new xt;t.autoStart=!0,t._protected=!0}return xt._shared}static get system(){if(!xt._system){const t=xt._system=new xt;t.autoStart=!0,t._protected=!0}return xt._system}};Hh.targetFPMS=.06;let vt=Hh,Ji;async function $h(){return Ji??(Ji=(async()=>{var a;const t=document.createElement("canvas").getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise(o=>{const h=document.createElement("video");h.onloadeddata=()=>o(h),h.onerror=()=>o(null),h.autoplay=!1,h.crossOrigin="anonymous",h.preload="auto",h.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",h.load()});if(!e)return"premultiply-alpha-on-upload";const i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i);const n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const r=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,r),t.deleteFramebuffer(n),t.deleteTexture(i),(a=t.getExtension("WEBGL_lose_context"))==null||a.loseContext(),r[0]<=r[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Ji}const Bi=class jh extends It{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...jh.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=vt.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await $h(),this._load=new Promise((i,n)=>{this.isValid?i(this):(this._resolve=i,this._reject=n,e.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(vt.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(vt.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(vt.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};Bi.extension=I.TextureSource;Bi.defaultOptions={...It.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};Bi.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let pi=Bi;const Et=(s,t,e=!1)=>(Array.isArray(s)||(s=[s]),t?s.map(i=>typeof i=="string"||e?t(i):i):s);class bd{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||Y(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const i=Et(t);let n;for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];if(l.test(e)){n=l.getCacheableAssets(i,e);break}}const r=new Map(Object.entries(n||{}));n||i.forEach(h=>{r.set(h,e)});const a=[...r.keys()],o={cacheKeys:a,keys:i};i.forEach(h=>{this._cacheMap.set(h,o)}),a.forEach(h=>{const l=n?n[h]:e;this._cache.has(h)&&this._cache.get(h)!==l&&Y("[Cache] already has key:",h),this._cache.set(h,r.get(h))})}remove(t){if(!this._cacheMap.has(t)){Y(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(n=>{this._cache.delete(n)}),e.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const et=new bd,On=[];X.handleByList(I.TextureSource,On);function Yh(s={}){const t=s&&s.resource,e=t?s.resource:s,i=t?s:{resource:s};for(let n=0;n<On.length;n++){const r=On[n];if(r.test(e))return new r(i)}throw new Error(`Could not find a source type for resource: ${i.resource}`)}function wd(s={},t=!1){const e=s&&s.resource,i=e?s.resource:s,n=e?s:{resource:s};if(!t&&et.has(i))return et.get(i);const r=new L({source:Yh(n)});return r.on("destroy",()=>{et.has(i)&&et.remove(i)}),t||et.set(i,r),r}function vd(s,t=!1){return typeof s=="string"?et.get(s):s instanceof It?new L({source:s}):wd(s,t)}L.from=vd;It.from=Yh;X.add(Uh,zh,Wh,pi,Se,Gh,xr);var qt=(s=>(s[s.Low=0]="Low",s[s.Normal=1]="Normal",s[s.High=2]="High",s))(qt||{});function Tt(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function rs(s){return s.split("?")[0].split("#")[0]}function Cd(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Sd(s,t,e){return s.replace(new RegExp(Cd(t),"g"),e)}function Ad(s,t){let e="",i=0,n=-1,r=0,a=-1;for(let o=0;o<=s.length;++o){if(o<s.length)a=s.charCodeAt(o);else{if(a===47)break;a=47}if(a===47){if(!(n===o-1||r===1))if(n!==o-1&&r===2){if(e.length<2||i!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const h=e.lastIndexOf("/");if(h!==e.length-1){h===-1?(e="",i=0):(e=e.slice(0,h),i=e.length-1-e.lastIndexOf("/")),n=o,r=0;continue}}else if(e.length===2||e.length===1){e="",i=0,n=o,r=0;continue}}}else e.length>0?e+=`/${s.slice(n+1,o)}`:e=s.slice(n+1,o),i=o-n-1;n=o,r=0}else a===46&&r!==-1?++r:r=-1}return e}const ut={toPosix(s){return Sd(s,"\\","/")},isUrl(s){return/^https?:/.test(this.toPosix(s))},isDataUrl(s){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(s)},isBlobUrl(s){return s.startsWith("blob:")},hasProtocol(s){return/^[^/:]+:/.test(this.toPosix(s))},getProtocol(s){Tt(s),s=this.toPosix(s);const t=/^file:\/\/\//.exec(s);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(s);return e?e[0]:""},toAbsolute(s,t,e){if(Tt(s),this.isDataUrl(s)||this.isBlobUrl(s))return s;const i=rs(this.toPosix(t??Z.get().getBaseUrl())),n=rs(this.toPosix(e??this.rootname(i)));return s=this.toPosix(s),s.startsWith("/")?ut.join(n,s.slice(1)):this.isAbsolute(s)?s:this.join(i,s)},normalize(s){if(Tt(s),s.length===0)return".";if(this.isDataUrl(s)||this.isBlobUrl(s))return s;s=this.toPosix(s);let t="";const e=s.startsWith("/");this.hasProtocol(s)&&(t=this.rootname(s),s=s.slice(t.length));const i=s.endsWith("/");return s=Ad(s),s.length>0&&i&&(s+="/"),e?`/${s}`:t+s},isAbsolute(s){return Tt(s),s=this.toPosix(s),this.hasProtocol(s)?!0:s.startsWith("/")},join(...s){if(s.length===0)return".";let t;for(let e=0;e<s.length;++e){const i=s[e];if(Tt(i),i.length>0)if(t===void 0)t=i;else{const n=s[e-1]??"";this.joinExtensions.includes(this.extname(n).toLowerCase())?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(s){if(Tt(s),s.length===0)return".";s=this.toPosix(s);let t=s.charCodeAt(0);const e=t===47;let i=-1,n=!0;const r=this.getProtocol(s),a=s;s=s.slice(r.length);for(let o=s.length-1;o>=1;--o)if(t=s.charCodeAt(o),t===47){if(!n){i=o;break}}else n=!1;return i===-1?e?"/":this.isUrl(a)?r+s:r:e&&i===1?"//":r+s.slice(0,i)},rootname(s){Tt(s),s=this.toPosix(s);let t="";if(s.startsWith("/")?t="/":t=this.getProtocol(s),this.isUrl(s)){const e=s.indexOf("/",t.length);e!==-1?t=s.slice(0,e):t=s,t.endsWith("/")||(t+="/")}return t},basename(s,t){Tt(s),t&&Tt(t),s=rs(this.toPosix(s));let e=0,i=-1,n=!0,r;if(t!==void 0&&t.length>0&&t.length<=s.length){if(t.length===s.length&&t===s)return"";let a=t.length-1,o=-1;for(r=s.length-1;r>=0;--r){const h=s.charCodeAt(r);if(h===47){if(!n){e=r+1;break}}else o===-1&&(n=!1,o=r+1),a>=0&&(h===t.charCodeAt(a)?--a===-1&&(i=r):(a=-1,i=o))}return e===i?i=o:i===-1&&(i=s.length),s.slice(e,i)}for(r=s.length-1;r>=0;--r)if(s.charCodeAt(r)===47){if(!n){e=r+1;break}}else i===-1&&(n=!1,i=r+1);return i===-1?"":s.slice(e,i)},extname(s){Tt(s),s=rs(this.toPosix(s));let t=-1,e=0,i=-1,n=!0,r=0;for(let a=s.length-1;a>=0;--a){const o=s.charCodeAt(a);if(o===47){if(!n){e=a+1;break}continue}i===-1&&(n=!1,i=a+1),o===46?t===-1?t=a:r!==1&&(r=1):t!==-1&&(r=-1)}return t===-1||i===-1||r===0||r===1&&t===i-1&&t===e+1?"":s.slice(t,i)},parse(s){Tt(s);const t={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return t;s=rs(this.toPosix(s));let e=s.charCodeAt(0);const i=this.isAbsolute(s);let n;t.root=this.rootname(s),i||this.hasProtocol(s)?n=1:n=0;let r=-1,a=0,o=-1,h=!0,l=s.length-1,c=0;for(;l>=n;--l){if(e=s.charCodeAt(l),e===47){if(!h){a=l+1;break}continue}o===-1&&(h=!1,o=l+1),e===46?r===-1?r=l:c!==1&&(c=1):r!==-1&&(c=-1)}return r===-1||o===-1||c===0||c===1&&r===o-1&&r===a+1?o!==-1&&(a===0&&i?t.base=t.name=s.slice(1,o):t.base=t.name=s.slice(a,o)):(a===0&&i?(t.name=s.slice(1,r),t.base=s.slice(1,o)):(t.name=s.slice(a,r),t.base=s.slice(a,o)),t.ext=s.slice(r,o)),t.dir=this.dirname(s),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function Xh(s,t,e,i,n){const r=t[e];for(let a=0;a<r.length;a++){const o=r[a];e<t.length-1?Xh(s.replace(i[e],o),t,e+1,i,n):n.push(s.replace(i[e],o))}}function Td(s){const t=/\{(.*?)\}/g,e=s.match(t),i=[];if(e){const n=[];e.forEach(r=>{const a=r.substring(1,r.length-1).split(",");n.push(a)}),Xh(s,n,0,e,i)}else i.push(s);return i}const wi=s=>!Array.isArray(s);class Ke{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`).join("&")}}getAlias(t){const{alias:e,src:i}=t;return Et(e||i,r=>typeof r=="string"?r:Array.isArray(r)?r.map(a=>(a==null?void 0:a.src)??a):r!=null&&r.src?r.src:r,!0)}addManifest(t){this._manifest&&Y("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const i=[];let n=e;Array.isArray(e)||(n=Object.entries(e).map(([r,a])=>typeof a=="string"||Array.isArray(a)?{alias:r,src:a}:{alias:r,...a})),n.forEach(r=>{const a=r.src,o=r.alias;let h;if(typeof o=="string"){const l=this._createBundleAssetId(t,o);i.push(l),h=[o,l]}else{const l=o.map(c=>this._createBundleAssetId(t,c));i.push(...l),h=[...o,...l]}this.add({...r,alias:h,src:a})}),this._bundles[t]=i}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);let i;i=r=>{this.hasKey(r)&&Y(`[Resolver] already has key: ${r} overwriting`)},Et(e).forEach(r=>{const{src:a}=r;let{data:o,format:h,loadParser:l}=r;const c=Et(a).map(f=>typeof f=="string"?Td(f):Array.isArray(f)?f:[f]),u=this.getAlias(r);Array.isArray(u)?u.forEach(i):i(u);const d=[];c.forEach(f=>{f.forEach(p=>{let g={};if(typeof p!="object"){g.src=p;for(let m=0;m<this._parsers.length;m++){const y=this._parsers[m];if(y.test(p)){g=y.parse(p);break}}}else o=p.data??o,h=p.format??h,l=p.loadParser??l,g={...g,...p};if(!u)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this._buildResolvedAsset(g,{aliases:u,data:o,format:h,loadParser:l}),d.push(g)})}),u.forEach(f=>{this._assetMap[f]=d})})}resolveBundle(t){const e=wi(t);t=Et(t);const i={};return t.forEach(n=>{const r=this._bundles[n];if(r){const a=this.resolve(r),o={};for(const h in a){const l=a[h];o[this._extractAssetIdFromBundle(n,h)]=l}i[n]=o}}),e?i[t[0]]:i}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const i={};for(const n in e)i[n]=e[n].src;return i}return e.src}resolve(t){const e=wi(t);t=Et(t);const i={};return t.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let r=this._assetMap[n];const a=this._getPreferredOrder(r);a==null||a.priority.forEach(o=>{a.params[o].forEach(h=>{const l=r.filter(c=>c[o]?c[o]===h:!1);l.length&&(r=l)})}),this._resolverHash[n]=r[0]}else this._resolverHash[n]=this._buildResolvedAsset({alias:[n],src:n},{});i[n]=this._resolverHash[n]}),e?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const i=t[e],n=this._preferredOrder.find(r=>r.params.format.includes(i.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:i,data:n,loadParser:r,format:a}=e;return(this._basePath||this._rootPath)&&(t.src=ut.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=i??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...n||{},...t.data},t.loadParser=r??t.loadParser,t.format=a??t.format??Pd(t.src),t}}Ke.RETINA_PREFIX=/@([0-9\.]+)x/;function Pd(s){return s.split(".").pop().split("?").shift().split("#").shift()}const Ln=(s,t)=>{const e=t.split("?")[1];return e&&(s+=`?${e}`),s},Kh=class ws{constructor(t,e){this.linkedSheets=[];let i=t;(t==null?void 0:t.source)instanceof It&&(i={texture:t,data:e});const{texture:n,data:r,cachePrefix:a=""}=i;this.cachePrefix=a,this._texture=n instanceof L?n:null,this.textureSource=n.source,this.textures={},this.animations={},this.data=r;const o=parseFloat(r.meta.scale);o?(this.resolution=o,n.source.resolution=this.resolution):this.resolution=n.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=ws.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const i=ws.BATCH_SIZE;for(;e-t<i&&e<this._frameKeys.length;){const n=this._frameKeys[e],r=this._frames[n],a=r.frame;if(a){let o=null,h=null;const l=r.trimmed!==!1&&r.sourceSize?r.sourceSize:r.frame,c=new j(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);r.rotated?o=new j(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):o=new j(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),r.trimmed!==!1&&r.spriteSourceSize&&(h=new j(Math.floor(r.spriteSourceSize.x)/this.resolution,Math.floor(r.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[n]=new L({source:this.textureSource,frame:o,orig:c,trim:h,rotate:r.rotated?2:0,defaultAnchor:r.anchor,defaultBorders:r.borders,label:n.toString()})}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let i=0;i<t[e].length;i++){const n=t[e][i];this.animations[e].push(this.textures[n])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*ws.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*ws.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};Kh.BATCH_SIZE=1e3;let wa=Kh;const Md=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function qh(s,t,e){const i={};if(s.forEach(n=>{i[n]=t}),Object.keys(t.textures).forEach(n=>{i[`${t.cachePrefix}${n}`]=t.textures[n]}),!e){const n=ut.dirname(s[0]);t.linkedSheets.forEach((r,a)=>{const o=qh([`${n}/${t.data.meta.related_multi_packs[a]}`],r,!0);Object.assign(i,o)})}return i}const Ed={extension:I.Asset,cache:{test:s=>s instanceof wa,getCacheableAssets:(s,t)=>qh(s,t,!1)},resolver:{extension:{type:I.ResolveParser,name:"resolveSpritesheet"},test:s=>{const e=s.split("?")[0].split("."),i=e.pop(),n=e.pop();return i==="json"&&Md.includes(n)},parse:s=>{var e;const t=s.split(".");return{resolution:parseFloat(((e=Ke.RETINA_PREFIX.exec(s))==null?void 0:e[1])??"1"),format:t[t.length-2],src:s}}},loader:{name:"spritesheetLoader",extension:{type:I.LoadParser,priority:qt.Normal,name:"spritesheetLoader"},async testParse(s,t){return ut.extname(t.src).toLowerCase()===".json"&&!!s.frames},async parse(s,t,e){var u,d;const{texture:i,imageFilename:n,textureOptions:r,cachePrefix:a}=(t==null?void 0:t.data)??{};let o=ut.dirname(t.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let h;if(i instanceof L)h=i;else{const f=Ln(o+(n??s.meta.image),t.src);h=(await e.load([{src:f,data:r}]))[f]}const l=new wa({texture:h.source,data:s,cachePrefix:a});await l.parse();const c=(u=s==null?void 0:s.meta)==null?void 0:u.related_multi_packs;if(Array.isArray(c)){const f=[];for(const g of c){if(typeof g!="string")continue;let m=o+g;(d=t.data)!=null&&d.ignoreMultiPack||(m=Ln(m,t.src),f.push(e.load({src:m,data:{textureOptions:r,ignoreMultiPack:!0}})))}const p=await Promise.all(f);l.linkedSheets=p,p.forEach(g=>{g.linkedSheets=[l].concat(l.linkedSheets.filter(m=>m!==g))})}return l},async unload(s,t,e){await e.unload(s.textureSource._sourceOrigin),s.destroy(!1)}}};X.add(Ed);var tn=/iPhone/i,va=/iPod/i,Ca=/iPad/i,Sa=/\biOS-universal(?:.+)Mac\b/i,en=/\bAndroid(?:.+)Mobile\b/i,Aa=/Android/i,Pe=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,ei=/Silk/i,Wt=/Windows Phone/i,Ta=/\bWindows(?:.+)ARM\b/i,Pa=/BlackBerry/i,Ma=/BB10/i,Ea=/Opera Mini/i,ka=/\b(CriOS|Chrome)(?:.+)Mobile/i,Ia=/Mobile(?:.+)Firefox\b/i,Ra=function(s){return typeof s<"u"&&s.platform==="MacIntel"&&typeof s.maxTouchPoints=="number"&&s.maxTouchPoints>1&&typeof MSStream>"u"};function kd(s){return function(t){return t.test(s)}}function Fa(s){var t={userAgent:"",platform:"",maxTouchPoints:0};!s&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof s=="string"?t.userAgent=s:s&&s.userAgent&&(t={userAgent:s.userAgent,platform:s.platform,maxTouchPoints:s.maxTouchPoints||0});var e=t.userAgent,i=e.split("[FBAN");typeof i[1]<"u"&&(e=i[0]),i=e.split("Twitter"),typeof i[1]<"u"&&(e=i[0]);var n=kd(e),r={apple:{phone:n(tn)&&!n(Wt),ipod:n(va),tablet:!n(tn)&&(n(Ca)||Ra(t))&&!n(Wt),universal:n(Sa),device:(n(tn)||n(va)||n(Ca)||n(Sa)||Ra(t))&&!n(Wt)},amazon:{phone:n(Pe),tablet:!n(Pe)&&n(ei),device:n(Pe)||n(ei)},android:{phone:!n(Wt)&&n(Pe)||!n(Wt)&&n(en),tablet:!n(Wt)&&!n(Pe)&&!n(en)&&(n(ei)||n(Aa)),device:!n(Wt)&&(n(Pe)||n(ei)||n(en)||n(Aa))||n(/\bokhttp\b/i)},windows:{phone:n(Wt),tablet:n(Ta),device:n(Wt)||n(Ta)},other:{blackberry:n(Pa),blackberry10:n(Ma),opera:n(Ea),firefox:n(Ia),chrome:n(ka),device:n(Pa)||n(Ma)||n(Ea)||n(Ia)||n(ka)},any:!1,phone:!1,tablet:!1};return r.any=r.apple.device||r.android.device||r.windows.device||r.other.device,r.phone=r.apple.phone||r.android.phone||r.windows.phone,r.tablet=r.apple.tablet||r.android.tablet||r.windows.tablet,r}const Id=Fa.default??Fa,De=Id(globalThis.navigator),sn=Object.create(null),Va=Object.create(null);function vr(s,t){let e=Va[s];return e===void 0&&(sn[t]===void 0&&(sn[t]=1),Va[s]=e=sn[t]++),e}let Me;function Zh(){return(!Me||Me!=null&&Me.isContextLost())&&(Me=Z.get().createCanvas().getContext("webgl",{})),Me}let si;function Rd(){if(!si){si="mediump";const s=Zh();s&&s.getShaderPrecisionFormat&&(si=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision?"highp":"mediump")}return si}function Fd(s,t,e){return t?s:e?(s=s.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${s}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${s}
        `}function Vd(s,t,e){const i=e?t.maxSupportedFragmentPrecision:t.maxSupportedVertexPrecision;if(s.substring(0,9)!=="precision"){let n=e?t.requestedFragmentPrecision:t.requestedVertexPrecision;return n==="highp"&&i!=="highp"&&(n="mediump"),`precision ${n} float;
${s}`}else if(i!=="highp"&&s.substring(0,15)==="precision highp")return s.replace("precision highp","precision mediump");return s}function Bd(s,t){return t?`#version 300 es
${s}`:s}const Od={},Ld={};function Dd(s,{name:t="pixi-program"},e=!0){t=t.replace(/\s+/g,"-"),t+=e?"-fragment":"-vertex";const i=e?Od:Ld;return i[t]?(i[t]++,t+=`-${i[t]}`):i[t]=1,s.indexOf("#define SHADER_NAME")!==-1?s:`${`#define SHADER_NAME ${t}`}
${s}`}function Nd(s,t){return t?s.replace("#version 300 es",""):s}const nn={stripVersion:Nd,ensurePrecision:Vd,addProgramDefines:Fd,setProgramName:Dd,insertVersion:Bd},rn=Object.create(null),Qh=class Dn{constructor(t){t={...Dn.defaultOptions,...t};const e=t.fragment.indexOf("#version 300 es")!==-1,i={stripVersion:e,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:Rd()},setProgramName:{name:t.name},addProgramDefines:e,insertVersion:e};let n=t.fragment,r=t.vertex;Object.keys(nn).forEach(a=>{const o=i[a];n=nn[a](n,o,!0),r=nn[a](r,o,!1)}),this.fragment=n,this.vertex=r,this.transformFeedbackVaryings=t.transformFeedbackVaryings,this._key=vr(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(t){const e=`${t.vertex}:${t.fragment}`;return rn[e]||(rn[e]=new Dn(t)),rn[e]}};Qh.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let Oi=Qh;const Ba={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function Ud(s){return Ba[s]??Ba.float32}const zd={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function Wd({source:s,entryPoint:t}){const e={},i=s.indexOf(`fn ${t}`);if(i!==-1){const n=s.indexOf("->",i);if(n!==-1){const r=s.substring(i,n),a=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let o;for(;(o=a.exec(r))!==null;){const h=zd[o[3]]??"float32";e[o[2]]={location:parseInt(o[1],10),format:h,stride:Ud(h).stride,offset:0,instance:!1,start:0}}}}return e}function an(s){var u,d;const t=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,e=/@group\((\d+)\)/,i=/@binding\((\d+)\)/,n=/var(<[^>]+>)? (\w+)/,r=/:\s*(\w+)/,a=/struct\s+(\w+)\s*{([^}]+)}/g,o=/(\w+)\s*:\s*([\w\<\>]+)/g,h=/struct\s+(\w+)/,l=(u=s.match(t))==null?void 0:u.map(f=>({group:parseInt(f.match(e)[1],10),binding:parseInt(f.match(i)[1],10),name:f.match(n)[2],isUniform:f.match(n)[1]==="<uniform>",type:f.match(r)[1]}));if(!l)return{groups:[],structs:[]};const c=((d=s.match(a))==null?void 0:d.map(f=>{const p=f.match(h)[1],g=f.match(o).reduce((m,y)=>{const[_,x]=y.split(":");return m[_.trim()]=x.trim(),m},{});return g?{name:p,members:g}:null}).filter(({name:f})=>l.some(p=>p.type===f)))??[];return{groups:l,structs:c}}var vs=(s=>(s[s.VERTEX=1]="VERTEX",s[s.FRAGMENT=2]="FRAGMENT",s[s.COMPUTE=4]="COMPUTE",s))(vs||{});function Gd({groups:s}){const t=[];for(let e=0;e<s.length;e++){const i=s[e];t[i.group]||(t[i.group]=[]),i.isUniform?t[i.group].push({binding:i.binding,visibility:vs.VERTEX|vs.FRAGMENT,buffer:{type:"uniform"}}):i.type==="sampler"?t[i.group].push({binding:i.binding,visibility:vs.FRAGMENT,sampler:{type:"filtering"}}):i.type==="texture_2d"&&t[i.group].push({binding:i.binding,visibility:vs.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return t}function Hd({groups:s}){const t=[];for(let e=0;e<s.length;e++){const i=s[e];t[i.group]||(t[i.group]={}),t[i.group][i.name]=i.binding}return t}function $d(s,t){const e=new Set,i=new Set,n=[...s.structs,...t.structs].filter(a=>e.has(a.name)?!1:(e.add(a.name),!0)),r=[...s.groups,...t.groups].filter(a=>{const o=`${a.name}-${a.binding}`;return i.has(o)?!1:(i.add(o),!0)});return{structs:n,groups:r}}const on=Object.create(null);class qe{constructor(t){var o,h;this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:e,vertex:i,layout:n,gpuLayout:r,name:a}=t;if(this.name=a,this.fragment=e,this.vertex=i,e.source===i.source){const l=an(e.source);this.structsAndGroups=l}else{const l=an(i.source),c=an(e.source);this.structsAndGroups=$d(l,c)}this.layout=n??Hd(this.structsAndGroups),this.gpuLayout=r??Gd(this.structsAndGroups),this.autoAssignGlobalUniforms=((o=this.layout[0])==null?void 0:o.globalUniforms)!==void 0,this.autoAssignLocalUniforms=((h=this.layout[1])==null?void 0:h.localUniforms)!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:t,fragment:e}=this,i=t.source+e.source+t.entryPoint+e.entryPoint;this._layoutKey=vr(i,"program")}get attributeData(){return this._attributeData??(this._attributeData=Wd(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(t){const e=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return on[e]||(on[e]=new qe(t)),on[e]}}const Jh=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],jd=Jh.reduce((s,t)=>(s[t]=!0,s),{});function Yd(s,t){switch(s){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*t);case"vec3<f32>":return new Float32Array(3*t);case"vec4<f32>":return new Float32Array(4*t);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const tl=class el{constructor(t,e){this._touched=0,this.uid=st("uniform"),this._resourceType="uniformGroup",this._resourceId=st("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,e={...el.defaultOptions,...e},this.uniformStructures=t;const i={};for(const n in t){const r=t[n];if(r.name=n,r.size=r.size??1,!jd[r.type])throw new Error(`Uniform type ${r.type} is not supported. Supported uniform types are: ${Jh.join(", ")}`);r.value??(r.value=Yd(r.type,r.size)),i[n]=r.value}this.uniforms=i,this._dirtyId=1,this.ubo=e.ubo,this.isStatic=e.isStatic,this._signature=vr(Object.keys(i).map(n=>`${n}-${t[n].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};tl.defaultOptions={ubo:!1,isStatic:!1};let sl=tl;class mi{constructor(t){this.resources=Object.create(null),this._dirty=!0;let e=0;for(const i in t){const n=t[i];this.setResource(n,e++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let e=0;for(const i in this.resources)t[e++]=this.resources[i]._resourceId;this._key=t.join("|")}setResource(t,e){var n,r;const i=this.resources[e];t!==i&&(i&&((n=t.off)==null||n.call(t,"change",this.onResourceChange,this)),(r=t.on)==null||r.call(t,"change",this.onResourceChange,this),this.resources[e]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t){const e=this.resources;for(const i in e)e[i]._touched=t}destroy(){var e;const t=this.resources;for(const i in t){const n=t[i];(e=n.off)==null||e.call(n,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){const e=this.resources;for(const i in e)e[i]===t&&(e[i]=null)}else this._updateKey()}}var Nn=(s=>(s[s.WEBGL=1]="WEBGL",s[s.WEBGPU=2]="WEBGPU",s[s.BOTH=3]="BOTH",s))(Nn||{});class Li extends gt{constructor(t){super(),this.uid=st("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:e,glProgram:i,groups:n,resources:r,compatibleRenderers:a,groupMap:o}=t;this.gpuProgram=e,this.glProgram=i,a===void 0&&(a=0,e&&(a|=Nn.WEBGPU),i&&(a|=Nn.WEBGL)),this.compatibleRenderers=a;const h={};if(!r&&!n&&(r={}),r&&n)throw new Error("[Shader] Cannot have both resources and groups");if(!e&&n&&!o)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!e&&n&&o)for(const l in o)for(const c in o[l]){const u=o[l][c];h[u]={group:l,binding:c,name:u}}else if(e&&n&&!o){const l=e.structsAndGroups.groups;o={},l.forEach(c=>{o[c.group]=o[c.group]||{},o[c.group][c.binding]=c.name,h[c.name]=c})}else if(r){n={},o={},e&&e.structsAndGroups.groups.forEach(u=>{o[u.group]=o[u.group]||{},o[u.group][u.binding]=u.name,h[u.name]=u});let l=0;for(const c in r)h[c]||(n[99]||(n[99]=new mi,this._ownedBindGroups.push(n[99])),h[c]={group:99,binding:l,name:c},o[99]=o[99]||{},o[99][l]=c,l++);for(const c in r){const u=c;let d=r[c];!d.source&&!d._resourceType&&(d=new sl(d));const f=h[u];f&&(n[f.group]||(n[f.group]=new mi,this._ownedBindGroups.push(n[f.group])),n[f.group].setResource(d,f.binding))}}this.groups=n,this._uniformBindMap=o,this.resources=this._buildResourceAccessor(n,h)}addResource(t,e,i){var n,r;(n=this._uniformBindMap)[e]||(n[e]={}),(r=this._uniformBindMap[e])[i]||(r[i]=t),this.groups[e]||(this.groups[e]=new mi,this._ownedBindGroups.push(this.groups[e]))}_buildResourceAccessor(t,e){const i={};for(const n in e){const r=e[n];Object.defineProperty(i,r.name,{get(){return t[r.group].getResource(r.binding)},set(a){t[r.group].setResource(a,r.binding)}})}return i}destroy(t=!1){var e,i;this.emit("destroy",this),t&&((e=this.gpuProgram)==null||e.destroy(),(i=this.glProgram)==null||i.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(n=>{n.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(t){const{gpu:e,gl:i,...n}=t;let r,a;return e&&(r=qe.from(e)),i&&(a=Oi.from(i)),new Li({gpuProgram:r,glProgram:a,...n})}}const Xd={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},hn=0,ln=1,cn=2,un=3,dn=4,fn=5,Un=class il{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<hn)}set blend(t){!!(this.data&1<<hn)!==t&&(this.data^=1<<hn)}get offsets(){return!!(this.data&1<<ln)}set offsets(t){!!(this.data&1<<ln)!==t&&(this.data^=1<<ln)}set cullMode(t){if(t==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=t==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<cn)}set culling(t){!!(this.data&1<<cn)!==t&&(this.data^=1<<cn)}get depthTest(){return!!(this.data&1<<un)}set depthTest(t){!!(this.data&1<<un)!==t&&(this.data^=1<<un)}get depthMask(){return!!(this.data&1<<fn)}set depthMask(t){!!(this.data&1<<fn)!==t&&(this.data^=1<<fn)}get clockwiseFrontFace(){return!!(this.data&1<<dn)}set clockwiseFrontFace(t){!!(this.data&1<<dn)!==t&&(this.data^=1<<dn)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!=="none",this._blendMode=t,this._blendModeId=Xd[t]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new il;return t.depthTest=!1,t.blend=!0,t}};Un.default2d=Un.for2d();let Kd=Un;const nl=class zn extends Li{constructor(t){t={...zn.defaultOptions,...t},super(t),this.enabled=!0,this._state=Kd.for2d(),this.blendMode=t.blendMode,this.padding=t.padding,typeof t.antialias=="boolean"?this.antialias=t.antialias?"on":"off":this.antialias=t.antialias,this.resolution=t.resolution,this.blendRequired=t.blendRequired,this.clipToViewport=t.clipToViewport,this.addResource("uTexture",0,1)}apply(t,e,i,n){t.applyFilter(this,e,i,n)}get blendMode(){return this._state.blendMode}set blendMode(t){this._state.blendMode=t}static from(t){const{gpu:e,gl:i,...n}=t;let r,a;return e&&(r=qe.from(e)),i&&(a=Oi.from(i)),new zn({gpuProgram:r,glProgram:a,...n})}};nl.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1,clipToViewport:!0};let qd=nl;const Wn=[];X.handleByNamedList(I.Environment,Wn);async function Zd(s){if(!s)for(let t=0;t<Wn.length;t++){const e=Wn[t];if(e.value.test()){await e.value.load();return}}}let as;function Qd(){if(typeof as=="boolean")return as;try{as=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{as=!1}return as}function Oa(s,t,e=2){const i=t&&t.length,n=i?t[0]*e:s.length;let r=rl(s,0,n,e,!0);const a=[];if(!r||r.next===r.prev)return a;let o,h,l;if(i&&(r=nf(s,t,r,e)),s.length>80*e){o=1/0,h=1/0;let c=-1/0,u=-1/0;for(let d=e;d<n;d+=e){const f=s[d],p=s[d+1];f<o&&(o=f),p<h&&(h=p),f>c&&(c=f),p>u&&(u=p)}l=Math.max(c-o,u-h),l=l!==0?32767/l:0}return Rs(r,a,e,o,h,l,0),a}function rl(s,t,e,i,n){let r;if(n===mf(s,t,e,i)>0)for(let a=t;a<e;a+=i)r=La(a/i|0,s[a],s[a+1],r);else for(let a=e-i;a>=t;a-=i)r=La(a/i|0,s[a],s[a+1],r);return r&&$e(r,r.next)&&(Vs(r),r=r.next),r}function Ae(s,t){if(!s)return s;t||(t=s);let e=s,i;do if(i=!1,!e.steiner&&($e(e,e.next)||q(e.prev,e,e.next)===0)){if(Vs(e),e=t=e.prev,e===e.next)break;i=!0}else e=e.next;while(i||e!==t);return t}function Rs(s,t,e,i,n,r,a){if(!s)return;!a&&r&&lf(s,i,n,r);let o=s;for(;s.prev!==s.next;){const h=s.prev,l=s.next;if(r?tf(s,i,n,r):Jd(s)){t.push(h.i,s.i,l.i),Vs(s),s=l.next,o=l.next;continue}if(s=l,s===o){a?a===1?(s=ef(Ae(s),t),Rs(s,t,e,i,n,r,2)):a===2&&sf(s,t,e,i,n,r):Rs(Ae(s),t,e,i,n,r,1);break}}}function Jd(s){const t=s.prev,e=s,i=s.next;if(q(t,e,i)>=0)return!1;const n=t.x,r=e.x,a=i.x,o=t.y,h=e.y,l=i.y,c=Math.min(n,r,a),u=Math.min(o,h,l),d=Math.max(n,r,a),f=Math.max(o,h,l);let p=i.next;for(;p!==t;){if(p.x>=c&&p.x<=d&&p.y>=u&&p.y<=f&&Cs(n,o,r,h,a,l,p.x,p.y)&&q(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function tf(s,t,e,i){const n=s.prev,r=s,a=s.next;if(q(n,r,a)>=0)return!1;const o=n.x,h=r.x,l=a.x,c=n.y,u=r.y,d=a.y,f=Math.min(o,h,l),p=Math.min(c,u,d),g=Math.max(o,h,l),m=Math.max(c,u,d),y=Gn(f,p,t,e,i),_=Gn(g,m,t,e,i);let x=s.prevZ,b=s.nextZ;for(;x&&x.z>=y&&b&&b.z<=_;){if(x.x>=f&&x.x<=g&&x.y>=p&&x.y<=m&&x!==n&&x!==a&&Cs(o,c,h,u,l,d,x.x,x.y)&&q(x.prev,x,x.next)>=0||(x=x.prevZ,b.x>=f&&b.x<=g&&b.y>=p&&b.y<=m&&b!==n&&b!==a&&Cs(o,c,h,u,l,d,b.x,b.y)&&q(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;x&&x.z>=y;){if(x.x>=f&&x.x<=g&&x.y>=p&&x.y<=m&&x!==n&&x!==a&&Cs(o,c,h,u,l,d,x.x,x.y)&&q(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=_;){if(b.x>=f&&b.x<=g&&b.y>=p&&b.y<=m&&b!==n&&b!==a&&Cs(o,c,h,u,l,d,b.x,b.y)&&q(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function ef(s,t){let e=s;do{const i=e.prev,n=e.next.next;!$e(i,n)&&ol(i,e,e.next,n)&&Fs(i,n)&&Fs(n,i)&&(t.push(i.i,e.i,n.i),Vs(e),Vs(e.next),e=s=n),e=e.next}while(e!==s);return Ae(e)}function sf(s,t,e,i,n,r){let a=s;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&df(a,o)){let h=hl(a,o);a=Ae(a,a.next),h=Ae(h,h.next),Rs(a,t,e,i,n,r,0),Rs(h,t,e,i,n,r,0);return}o=o.next}a=a.next}while(a!==s)}function nf(s,t,e,i){const n=[];for(let r=0,a=t.length;r<a;r++){const o=t[r]*i,h=r<a-1?t[r+1]*i:s.length,l=rl(s,o,h,i,!1);l===l.next&&(l.steiner=!0),n.push(uf(l))}n.sort(rf);for(let r=0;r<n.length;r++)e=af(n[r],e);return e}function rf(s,t){let e=s.x-t.x;if(e===0&&(e=s.y-t.y,e===0)){const i=(s.next.y-s.y)/(s.next.x-s.x),n=(t.next.y-t.y)/(t.next.x-t.x);e=i-n}return e}function af(s,t){const e=of(s,t);if(!e)return t;const i=hl(e,s);return Ae(i,i.next),Ae(e,e.next)}function of(s,t){let e=t;const i=s.x,n=s.y;let r=-1/0,a;if($e(s,e))return e;do{if($e(s,e.next))return e.next;if(n<=e.y&&n>=e.next.y&&e.next.y!==e.y){const u=e.x+(n-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(u<=i&&u>r&&(r=u,a=e.x<e.next.x?e:e.next,u===i))return a}e=e.next}while(e!==t);if(!a)return null;const o=a,h=a.x,l=a.y;let c=1/0;e=a;do{if(i>=e.x&&e.x>=h&&i!==e.x&&al(n<l?i:r,n,h,l,n<l?r:i,n,e.x,e.y)){const u=Math.abs(n-e.y)/(i-e.x);Fs(e,s)&&(u<c||u===c&&(e.x>a.x||e.x===a.x&&hf(a,e)))&&(a=e,c=u)}e=e.next}while(e!==o);return a}function hf(s,t){return q(s.prev,s,t.prev)<0&&q(t.next,s,s.next)<0}function lf(s,t,e,i){let n=s;do n.z===0&&(n.z=Gn(n.x,n.y,t,e,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==s);n.prevZ.nextZ=null,n.prevZ=null,cf(n)}function cf(s){let t,e=1;do{let i=s,n;s=null;let r=null;for(t=0;i;){t++;let a=i,o=0;for(let l=0;l<e&&(o++,a=a.nextZ,!!a);l++);let h=e;for(;o>0||h>0&&a;)o!==0&&(h===0||!a||i.z<=a.z)?(n=i,i=i.nextZ,o--):(n=a,a=a.nextZ,h--),r?r.nextZ=n:s=n,n.prevZ=r,r=n;i=a}r.nextZ=null,e*=2}while(t>1);return s}function Gn(s,t,e,i,n){return s=(s-e)*n|0,t=(t-i)*n|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,s|t<<1}function uf(s){let t=s,e=s;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==s);return e}function al(s,t,e,i,n,r,a,o){return(n-a)*(t-o)>=(s-a)*(r-o)&&(s-a)*(i-o)>=(e-a)*(t-o)&&(e-a)*(r-o)>=(n-a)*(i-o)}function Cs(s,t,e,i,n,r,a,o){return!(s===a&&t===o)&&al(s,t,e,i,n,r,a,o)}function df(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!ff(s,t)&&(Fs(s,t)&&Fs(t,s)&&pf(s,t)&&(q(s.prev,s,t.prev)||q(s,t.prev,t))||$e(s,t)&&q(s.prev,s,s.next)>0&&q(t.prev,t,t.next)>0)}function q(s,t,e){return(t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y)}function $e(s,t){return s.x===t.x&&s.y===t.y}function ol(s,t,e,i){const n=ni(q(s,t,e)),r=ni(q(s,t,i)),a=ni(q(e,i,s)),o=ni(q(e,i,t));return!!(n!==r&&a!==o||n===0&&ii(s,e,t)||r===0&&ii(s,i,t)||a===0&&ii(e,s,i)||o===0&&ii(e,t,i))}function ii(s,t,e){return t.x<=Math.max(s.x,e.x)&&t.x>=Math.min(s.x,e.x)&&t.y<=Math.max(s.y,e.y)&&t.y>=Math.min(s.y,e.y)}function ni(s){return s>0?1:s<0?-1:0}function ff(s,t){let e=s;do{if(e.i!==s.i&&e.next.i!==s.i&&e.i!==t.i&&e.next.i!==t.i&&ol(e,e.next,s,t))return!0;e=e.next}while(e!==s);return!1}function Fs(s,t){return q(s.prev,s,s.next)<0?q(s,t,s.next)>=0&&q(s,s.prev,t)>=0:q(s,t,s.prev)<0||q(s,s.next,t)<0}function pf(s,t){let e=s,i=!1;const n=(s.x+t.x)/2,r=(s.y+t.y)/2;do e.y>r!=e.next.y>r&&e.next.y!==e.y&&n<(e.next.x-e.x)*(r-e.y)/(e.next.y-e.y)+e.x&&(i=!i),e=e.next;while(e!==s);return i}function hl(s,t){const e=Hn(s.i,s.x,s.y),i=Hn(t.i,t.x,t.y),n=s.next,r=t.prev;return s.next=t,t.prev=s,e.next=n,n.prev=e,i.next=e,e.prev=i,r.next=i,i.prev=r,i}function La(s,t,e,i){const n=Hn(s,t,e);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function Vs(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Hn(s,t,e){return{i:s,x:t,y:e,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function mf(s,t,e,i){let n=0;for(let r=t,a=e-i;r<e;r+=i)n+=(s[a]-s[r])*(s[r+1]+s[a+1]),a=r;return n}const gf=Oa.default||Oa;var ll=(s=>(s[s.NONE=0]="NONE",s[s.COLOR=16384]="COLOR",s[s.STENCIL=1024]="STENCIL",s[s.DEPTH=256]="DEPTH",s[s.COLOR_DEPTH=16640]="COLOR_DEPTH",s[s.COLOR_STENCIL=17408]="COLOR_STENCIL",s[s.DEPTH_STENCIL=1280]="DEPTH_STENCIL",s[s.ALL=17664]="ALL",s))(ll||{});class yf{constructor(t){this.items=[],this._name=t}emit(t,e,i,n,r,a,o,h){const{name:l,items:c}=this;for(let u=0,d=c.length;u<d;u++)c[u][l](t,e,i,n,r,a,o,h);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&this.items.splice(e,1),this}contains(t){return this.items.indexOf(t)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const _f=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],cl=class ul extends gt{constructor(t){super(),this.uid=st("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const e=[..._f,...this.config.runners??[]];this._addRunners(...e),this._unsafeEvalCheck()}async init(t={}){const e=t.skipExtensionImports===!0?!0:t.manageImports===!1;await Zd(e),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const i in this._systemsHash)t={...this._systemsHash[i].constructor.defaultOptions,...t};t={...ul.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let i=0;i<this.runners.init.items.length;i++)await this.runners.init.items[i].init(t);this._initOptions=t}render(t,e){let i=t;if(i instanceof it&&(i={container:i},e&&(N(W,"passing a second argument is deprecated, please use render options instead"),i.target=e.renderTexture)),i.target||(i.target=this.view.renderTarget),i.target===this.view.renderTarget&&(this._lastObjectRendered=i.container,i.clearColor??(i.clearColor=this.background.colorRgba),i.clear??(i.clear=this.background.clearBeforeRender)),i.clearColor){const n=Array.isArray(i.clearColor)&&i.clearColor.length===4;i.clearColor=n?i.clearColor:nt.shared.setValue(i.clearColor).toArray()}i.transform||(i.container.updateLocalTransform(),i.transform=i.container.localTransform),i.container.enableRenderGroup(),this.runners.prerender.emit(i),this.runners.renderStart.emit(i),this.runners.render.emit(i),this.runners.renderEnd.emit(i),this.runners.postrender.emit(i)}resize(t,e,i){const n=this.view.resolution;this.view.resize(t,e,i),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),i!==void 0&&i!==n&&this.runners.resolutionChange.emit(i)}clear(t={}){const e=this;t.target||(t.target=e.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=ll.ALL);const{clear:i,clearColor:n,target:r}=t;nt.shared.setValue(n??this.background.colorRgba),e.renderTarget.clear(r,i,nt.shared.toArray())}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach(e=>{this.runners[e]=new yf(e)})}_addSystems(t){let e;for(e in t){const i=t[e];this._addSystem(i.value,i.name)}}_addSystem(t,e){const i=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=i,this._systemsHash[e]=i;for(const n in this.runners)this.runners[n].add(i);return this}_addPipes(t,e){const i=e.reduce((n,r)=>(n[r.name]=r.value,n),{});t.forEach(n=>{const r=n.value,a=n.name,o=i[a];this.renderPipes[a]=new r(this,o?new o:null)})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!Qd())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};cl.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let dl=cl,ri;function xf(s){return ri!==void 0||(ri=(()=>{var e;const t={stencil:!0,failIfMajorPerformanceCaveat:s??dl.defaultOptions.failIfMajorPerformanceCaveat};try{if(!Z.get().getWebGLRenderingContext())return!1;let n=Z.get().createCanvas().getContext("webgl",t);const r=!!((e=n==null?void 0:n.getContextAttributes())!=null&&e.stencil);if(n){const a=n.getExtension("WEBGL_lose_context");a&&a.loseContext()}return n=null,r}catch{return!1}})()),ri}let ai;async function bf(s={}){return ai!==void 0||(ai=await(async()=>{const t=Z.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(s)).requestDevice(),!0}catch{return!1}})()),ai}const Da=["webgl","webgpu","canvas"];async function wf(s){let t=[];s.preference?(t.push(s.preference),Da.forEach(r=>{r!==s.preference&&t.push(r)})):t=Da.slice();let e,i={};for(let r=0;r<t.length;r++){const a=t[r];if(a==="webgpu"&&await bf()){const{WebGPURenderer:o}=await xi(async()=>{const{WebGPURenderer:h}=await import("./WebGPURenderer-Cip2e7ac.js");return{WebGPURenderer:h}},__vite__mapDeps([3,2,4]));e=o,i={...s,...s.webgpu};break}else if(a==="webgl"&&xf(s.failIfMajorPerformanceCaveat??dl.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:o}=await xi(async()=>{const{WebGLRenderer:h}=await import("./WebGLRenderer-KspsPE16.js");return{WebGLRenderer:h}},__vite__mapDeps([5,2,4]));e=o,i={...s,...s.webgl};break}else if(a==="canvas")throw i={...s},new Error("CanvasRenderer is not yet implemented")}if(delete i.webgpu,delete i.webgl,!e)throw new Error("No available renderer for the current environment");const n=new e;return await n.init(i),n}const fl="8.11.0";class pl{static init(){var t;(t=globalThis.__PIXI_APP_INIT__)==null||t.call(globalThis,this,fl)}static destroy(){}}pl.extension=I.Application;class vf{constructor(t){this._renderer=t}init(){var t;(t=globalThis.__PIXI_RENDERER_INIT__)==null||t.call(globalThis,this._renderer,fl)}destroy(){this._renderer=null}}vf.extension={type:[I.WebGLSystem,I.WebGPUSystem],name:"initHook",priority:-10};const ml=class $n{constructor(...t){this.stage=new it,t[0]!==void 0&&N(W,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.renderer=await wf(t),$n._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return N(W,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,e=!1){const i=$n._plugins.slice(0);i.reverse(),i.forEach(n=>{n.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};ml._plugins=[];let gl=ml;X.handleByList(I.Application,gl._plugins);X.add(pl);class Cr{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this._cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this._cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this._cancelResize();let e,i;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,i=globalThis.innerHeight;else{const{clientWidth:n,clientHeight:r}=this._resizeTo;e=n,i=r}this.renderer.resize(e,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this._cancelResize(),this._cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}Cr.extension=I.Application;class yl{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,bi.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?vt.shared:new vt,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}yl.extension=I.Application;class _l extends gt{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return N(W,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return N(W,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return N(W,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return N(W,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return N(W,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(t=!1){var e;this.emit("destroy",this),this.removeAllListeners();for(const i in this.chars)(e=this.chars[i].texture)==null||e.destroy();this.chars=null,t&&(this.pages.forEach(i=>i.texture.destroy(!0)),this.pages=null)}}const Cf=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function vi(s){const t=typeof s.fontSize=="number"?`${s.fontSize}px`:s.fontSize;let e=s.fontFamily;Array.isArray(s.fontFamily)||(e=s.fontFamily.split(","));for(let i=e.length-1;i>=0;i--){let n=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!Cf.includes(n)&&(n=`"${n}"`),e[i]=n}return`${s.fontStyle} ${s.fontVariant} ${s.fontWeight} ${t} ${e.join(",")}`}const pn={willReadFrequently:!0},Ut=class R{static get experimentalLetterSpacingSupported(){let t=R._experimentalLetterSpacingSupported;if(t===void 0){const e=Z.get().getCanvasRenderingContext2D().prototype;t=R._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,i,n,r,a,o,h,l){this.text=t,this.style=e,this.width=i,this.height=n,this.lines=r,this.lineWidths=a,this.lineHeight=o,this.maxLineWidth=h,this.fontProperties=l}static measureText(t=" ",e,i=R._canvas,n=e.wordWrap){var y;const r=vi(e),a=R.measureFont(r);a.fontSize===0&&(a.fontSize=e.fontSize,a.ascent=e.fontSize);const o=R.__context;o.font=r;const l=(n?R._wordWrap(t,e,i):t).split(/(?:\r\n|\r|\n)/),c=new Array(l.length);let u=0;for(let _=0;_<l.length;_++){const x=R._measureText(l[_],e.letterSpacing,o);c[_]=x,u=Math.max(u,x)}const d=((y=e._stroke)==null?void 0:y.width)||0;let f=u+d;e.dropShadow&&(f+=e.dropShadow.distance);const p=e.lineHeight||a.fontSize;let g=Math.max(p,a.fontSize+d)+(l.length-1)*(p+e.leading);return e.dropShadow&&(g+=e.dropShadow.distance),new R(t,e,f,g,l,c,p+e.leading,u,a)}static _measureText(t,e,i){let n=!1;R.experimentalLetterSpacingSupported&&(R.experimentalLetterSpacing?(i.letterSpacing=`${e}px`,i.textLetterSpacing=`${e}px`,n=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));const r=i.measureText(t);let a=r.width;const o=-r.actualBoundingBoxLeft;let l=r.actualBoundingBoxRight-o;if(a>0)if(n)a-=e,l-=e;else{const c=(R.graphemeSegmenter(t).length-1)*e;a+=c,l+=c}return Math.max(a,l)}static _wordWrap(t,e,i=R._canvas){const n=i.getContext("2d",pn);let r=0,a="",o="";const h=Object.create(null),{letterSpacing:l,whiteSpace:c}=e,u=R._collapseSpaces(c),d=R._collapseNewlines(c);let f=!u;const p=e.wordWrapWidth+l,g=R._tokenize(t);for(let m=0;m<g.length;m++){let y=g[m];if(R._isNewline(y)){if(!d){o+=R._addLine(a),f=!u,a="",r=0;continue}y=" "}if(u){const x=R.isBreakingSpace(y),b=R.isBreakingSpace(a[a.length-1]);if(x&&b)continue}const _=R._getFromCache(y,l,h,n);if(_>p)if(a!==""&&(o+=R._addLine(a),a="",r=0),R.canBreakWords(y,e.breakWords)){const x=R.wordWrapSplit(y);for(let b=0;b<x.length;b++){let S=x[b],w=S,v=1;for(;x[b+v];){const k=x[b+v];if(!R.canBreakChars(w,k,y,b,e.breakWords))S+=k;else break;w=k,v++}b+=v-1;const T=R._getFromCache(S,l,h,n);T+r>p&&(o+=R._addLine(a),f=!1,a="",r=0),a+=S,r+=T}}else{a.length>0&&(o+=R._addLine(a),a="",r=0);const x=m===g.length-1;o+=R._addLine(y,!x),f=!1,a="",r=0}else _+r>p&&(f=!1,o+=R._addLine(a),a="",r=0),(a.length>0||!R.isBreakingSpace(y)||f)&&(a+=y,r+=_)}return o+=R._addLine(a,!1),o}static _addLine(t,e=!0){return t=R._trimRight(t),t=e?`${t}
`:t,t}static _getFromCache(t,e,i,n){let r=i[t];return typeof r!="number"&&(r=R._measureText(t,e,n)+e,i[t]=r),r}static _collapseSpaces(t){return t==="normal"||t==="pre-line"}static _collapseNewlines(t){return t==="normal"}static _trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const i=t[e];if(!R.isBreakingSpace(i))break;t=t.slice(0,-1)}return t}static _isNewline(t){return typeof t!="string"?!1:R._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:R._breakingSpaces.includes(t.charCodeAt(0))}static _tokenize(t){const e=[];let i="";if(typeof t!="string")return e;for(let n=0;n<t.length;n++){const r=t[n],a=t[n+1];if(R.isBreakingSpace(r,a)||R._isNewline(r)){i!==""&&(e.push(i),i=""),r==="\r"&&a===`
`?(e.push(`\r
`),n++):e.push(r);continue}i+=r}return i!==""&&e.push(i),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,i,n,r){return!0}static wordWrapSplit(t){return R.graphemeSegmenter(t)}static measureFont(t){if(R._fonts[t])return R._fonts[t];const e=R._context;e.font=t;const i=e.measureText(R.METRICS_STRING+R.BASELINE_SYMBOL),n={ascent:i.actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent,fontSize:i.actualBoundingBoxAscent+i.actualBoundingBoxDescent};return R._fonts[t]=n,n}static clearMetrics(t=""){t?delete R._fonts[t]:R._fonts={}}static get _canvas(){if(!R.__canvas){let t;try{const e=new OffscreenCanvas(0,0),i=e.getContext("2d",pn);if(i!=null&&i.measureText)return R.__canvas=e,e;t=Z.get().createCanvas()}catch{t=Z.get().createCanvas()}t.width=t.height=10,R.__canvas=t}return R.__canvas}static get _context(){return R.__context||(R.__context=R._canvas.getContext("2d",pn)),R.__context}};Ut.METRICS_STRING="|q";Ut.BASELINE_SYMBOL="M";Ut.BASELINE_MULTIPLIER=1.4;Ut.HEIGHT_MULTIPLIER=2;Ut.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const s=new Intl.Segmenter;return t=>{const e=s.segment(t),i=[];let n=0;for(const r of e)i[n++]=r.segment;return i}}return s=>[...s]})();Ut.experimentalLetterSpacing=!1;Ut._fonts={};Ut._newlines=[10,13];Ut._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let Lt=Ut;const Na=[{offset:0,color:"white"},{offset:1,color:"black"}],Sr=class jn{constructor(...t){this.uid=st("fillGradient"),this.type="linear",this.colorStops=[];let e=Sf(t);e={...e.type==="radial"?jn.defaultRadialOptions:jn.defaultLinearOptions,...vh(e)},this._textureSize=e.textureSize,this._wrapMode=e.wrapMode,e.type==="radial"?(this.center=e.center,this.outerCenter=e.outerCenter??this.center,this.innerRadius=e.innerRadius,this.outerRadius=e.outerRadius,this.scale=e.scale,this.rotation=e.rotation):(this.start=e.start,this.end=e.end),this.textureSpace=e.textureSpace,this.type=e.type,e.colorStops.forEach(n=>{this.addColorStop(n.offset,n.color)})}addColorStop(t,e){return this.colorStops.push({offset:t,color:nt.shared.setValue(e).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:t,y:e}=this.start,{x:i,y:n}=this.end,r=i-t,a=n-e;const o=r<0||a<0;if(this._wrapMode==="clamp-to-edge"){if(r<0){const m=t;t=i,i=m,r*=-1}if(a<0){const m=e;e=n,n=m,a*=-1}}const h=this.colorStops.length?this.colorStops:Na,l=this._textureSize,{canvas:c,context:u}=za(l,1),d=o?u.createLinearGradient(this._textureSize,0,0,0):u.createLinearGradient(0,0,this._textureSize,0);Ua(d,h),u.fillStyle=d,u.fillRect(0,0,l,1),this.texture=new L({source:new Se({resource:c,addressMode:this._wrapMode})});const f=Math.sqrt(r*r+a*a),p=Math.atan2(a,r),g=new U;g.scale(f/l,1),g.rotate(p),g.translate(t,e),this.textureSpace==="local"&&g.scale(l,l),this.transform=g}buildGradient(){this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:Na,e=this._textureSize,{canvas:i,context:n}=za(e,e),{x:r,y:a}=this.center,{x:o,y:h}=this.outerCenter,l=this.innerRadius,c=this.outerRadius,u=o-c,d=h-c,f=e/(c*2),p=(r-u)*f,g=(a-d)*f,m=n.createRadialGradient(p,g,l*f,(o-u)*f,(h-d)*f,c*f);Ua(m,t),n.fillStyle=t[t.length-1].color,n.fillRect(0,0,e,e),n.fillStyle=m,n.translate(p,g),n.rotate(this.rotation),n.scale(1,this.scale),n.translate(-p,-g),n.fillRect(0,0,e,e),this.texture=new L({source:new Se({resource:i,addressMode:this._wrapMode})});const y=new U;y.scale(1/f,1/f),y.translate(u,d),this.textureSpace==="local"&&y.scale(e,e),this.transform=y}get styleKey(){return this.uid}destroy(){var t;(t=this.texture)==null||t.destroy(!0),this.texture=null}};Sr.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};Sr.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let Yt=Sr;function Ua(s,t){for(let e=0;e<t.length;e++){const i=t[e];s.addColorStop(i.offset,i.color)}}function za(s,t){const e=Z.get().createCanvas(s,t),i=e.getContext("2d");return{canvas:e,context:i}}function Sf(s){let t=s[0]??{};return(typeof t=="number"||s[1])&&(N("8.5.2","use options object instead"),t={type:"linear",start:{x:s[0],y:s[1]},end:{x:s[2],y:s[3]},textureSpace:s[4],textureSize:s[5]??Yt.defaultLinearOptions.textureSize}),t}const Wa={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class Di{constructor(t,e){this.uid=st("fillPattern"),this.transform=new U,this._styleKey=null,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=Wa[e].addressModeU,t.source.style.addressModeV=Wa[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var mn,Ga;function Af(){if(Ga)return mn;Ga=1,mn=e;var s={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},t=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function e(r){var a=[];return r.replace(t,function(o,h,l){var c=h.toLowerCase();for(l=n(l),c=="m"&&l.length>2&&(a.push([h].concat(l.splice(0,2))),c="l",h=h=="m"?"l":"L");;){if(l.length==s[c])return l.unshift(h),a.push(l);if(l.length<s[c])throw new Error("malformed path data");a.push([h].concat(l.splice(0,s[c])))}}),a}var i=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function n(r){var a=r.match(i);return a?a.map(Number):[]}return mn}var Tf=Af();const Pf=xh(Tf);function Mf(s,t){const e=Pf(s),i=[];let n=null,r=0,a=0;for(let o=0;o<e.length;o++){const h=e[o],l=h[0],c=h;switch(l){case"M":r=c[1],a=c[2],t.moveTo(r,a);break;case"m":r+=c[1],a+=c[2],t.moveTo(r,a);break;case"H":r=c[1],t.lineTo(r,a);break;case"h":r+=c[1],t.lineTo(r,a);break;case"V":a=c[1],t.lineTo(r,a);break;case"v":a+=c[1],t.lineTo(r,a);break;case"L":r=c[1],a=c[2],t.lineTo(r,a);break;case"l":r+=c[1],a+=c[2],t.lineTo(r,a);break;case"C":r=c[5],a=c[6],t.bezierCurveTo(c[1],c[2],c[3],c[4],r,a);break;case"c":t.bezierCurveTo(r+c[1],a+c[2],r+c[3],a+c[4],r+c[5],a+c[6]),r+=c[5],a+=c[6];break;case"S":r=c[3],a=c[4],t.bezierCurveToShort(c[1],c[2],r,a);break;case"s":t.bezierCurveToShort(r+c[1],a+c[2],r+c[3],a+c[4]),r+=c[3],a+=c[4];break;case"Q":r=c[3],a=c[4],t.quadraticCurveTo(c[1],c[2],r,a);break;case"q":t.quadraticCurveTo(r+c[1],a+c[2],r+c[3],a+c[4]),r+=c[3],a+=c[4];break;case"T":r=c[1],a=c[2],t.quadraticCurveToShort(r,a);break;case"t":r+=c[1],a+=c[2],t.quadraticCurveToShort(r,a);break;case"A":r=c[6],a=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],r,a);break;case"a":r+=c[6],a+=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],r,a);break;case"Z":case"z":t.closePath(),i.length>0&&(n=i.pop(),n?(r=n.startX,a=n.startY):(r=0,a=0)),n=null;break;default:Y(`Unknown SVG path command: ${l}`)}l!=="Z"&&l!=="z"&&n===null&&(n={startX:r,startY:a},i.push(n))}return t}class Ar{constructor(t=0,e=0,i=0){this.type="circle",this.x=t,this.y=e,this.radius=i}clone(){return new Ar(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const i=this.radius*this.radius;let n=this.x-t,r=this.y-e;return n*=n,r*=r,n+r<=i}strokeContains(t,e,i,n=.5){if(this.radius===0)return!1;const r=this.x-t,a=this.y-e,o=this.radius,h=(1-n)*i,l=Math.sqrt(r*r+a*a);return l<=o+h&&l>o-(i-h)}getBounds(t){return t||(t=new j),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Tr{constructor(t=0,e=0,i=0,n=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=i,this.halfHeight=n}clone(){return new Tr(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let i=(t-this.x)/this.halfWidth,n=(e-this.y)/this.halfHeight;return i*=i,n*=n,i+n<=1}strokeContains(t,e,i,n=.5){const{halfWidth:r,halfHeight:a}=this;if(r<=0||a<=0)return!1;const o=i*(1-n),h=i-o,l=r-h,c=a-h,u=r+o,d=a+o,f=t-this.x,p=e-this.y,g=f*f/(l*l)+p*p/(c*c),m=f*f/(u*u)+p*p/(d*d);return g>1&&m<=1}getBounds(t){return t||(t=new j),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function Ef(s,t,e,i,n,r){const a=s-e,o=t-i,h=n-e,l=r-i,c=a*h+o*l,u=h*h+l*l;let d=-1;u!==0&&(d=c/u);let f,p;d<0?(f=e,p=i):d>1?(f=n,p=r):(f=e+d*h,p=i+d*l);const g=s-f,m=t-p;return g*g+m*m}let kf,If;class Ms{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const i=[];for(let n=0,r=e.length;n<r;n++)i.push(e[n].x,e[n].y);e=i}this.points=e,this.closePath=!0}isClockwise(){let t=0;const e=this.points,i=e.length;for(let n=0;n<i;n+=2){const r=e[n],a=e[n+1],o=e[(n+2)%i],h=e[(n+3)%i];t+=(o-r)*(h+a)}return t<0}containsPolygon(t){const e=this.getBounds(kf),i=t.getBounds(If);if(!e.containsRect(i))return!1;const n=t.points;for(let r=0;r<n.length;r+=2){const a=n[r],o=n[r+1];if(!this.contains(a,o))return!1}return!0}clone(){const t=this.points.slice(),e=new Ms(t);return e.closePath=this.closePath,e}contains(t,e){let i=!1;const n=this.points.length/2;for(let r=0,a=n-1;r<n;a=r++){const o=this.points[r*2],h=this.points[r*2+1],l=this.points[a*2],c=this.points[a*2+1];h>e!=c>e&&t<(l-o)*((e-h)/(c-h))+o&&(i=!i)}return i}strokeContains(t,e,i,n=.5){const r=i*i,a=r*(1-n),o=r-a,{points:h}=this,l=h.length-(this.closePath?0:2);for(let c=0;c<l;c+=2){const u=h[c],d=h[c+1],f=h[(c+2)%h.length],p=h[(c+3)%h.length],g=Ef(t,e,u,d,f,p),m=Math.sign((f-u)*(e-d)-(p-d)*(t-u));if(g<=(m<0?o:a))return!0}return!1}getBounds(t){t||(t=new j);const e=this.points;let i=1/0,n=-1/0,r=1/0,a=-1/0;for(let o=0,h=e.length;o<h;o+=2){const l=e[o],c=e[o+1];i=l<i?l:i,n=l>n?l:n,r=c<r?c:r,a=c>a?c:a}return t.x=i,t.width=n-i,t.y=r,t.height=a-r,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return N("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return N("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const oi=(s,t,e,i,n,r,a)=>{const o=s-e,h=t-i,l=Math.sqrt(o*o+h*h);return l>=n-r&&l<=n+a};class Pr{constructor(t=0,e=0,i=0,n=0,r=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=i,this.height=n,this.radius=r}getBounds(t){return t||(t=new j),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new Pr(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+i&&e<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let n=t-(this.x+i),r=e-(this.y+i);const a=i*i;if(n*n+r*r<=a||(n=t-(this.x+this.width-i),n*n+r*r<=a)||(r=e-(this.y+this.height-i),n*n+r*r<=a)||(n=t-(this.x+i),n*n+r*r<=a))return!0}return!1}strokeContains(t,e,i,n=.5){const{x:r,y:a,width:o,height:h,radius:l}=this,c=i*(1-n),u=i-c,d=r+l,f=a+l,p=o-l*2,g=h-l*2,m=r+o,y=a+h;return(t>=r-c&&t<=r+u||t>=m-u&&t<=m+c)&&e>=f&&e<=f+g||(e>=a-c&&e<=a+u||e>=y-u&&e<=y+c)&&t>=d&&t<=d+p?!0:t<d&&e<f&&oi(t,e,d,f,l,u,c)||t>m-l&&e<f&&oi(t,e,m-l,f,l,u,c)||t>m-l&&e>y-l&&oi(t,e,m-l,y-l,l,u,c)||t<d&&e>y-l&&oi(t,e,d,y-l,l,u,c)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const xl={};function Rf(s,t,e){let i=2166136261;for(let n=0;n<t;n++)i^=s[n].uid,i=Math.imul(i,16777619),i>>>=0;return xl[i]||Ff(s,t,i,e)}function Ff(s,t,e,i){const n={};let r=0;for(let o=0;o<i;o++){const h=o<t?s[o]:L.EMPTY.source;n[r++]=h.source,n[r++]=h.style}const a=new mi(n);return xl[e]=a,a}class Ha{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}function $a(s,t){const e=s.byteLength/8|0,i=new Float64Array(s,0,e);new Float64Array(t,0,e).set(i);const r=s.byteLength-e*8;if(r>0){const a=new Uint8Array(s,e*8,r);new Uint8Array(t,e*8,r).set(a)}}const Vf={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var Bf=(s=>(s[s.DISABLED=0]="DISABLED",s[s.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",s[s.MASK_ACTIVE=2]="MASK_ACTIVE",s[s.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",s[s.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",s[s.NONE=5]="NONE",s))(Bf||{});function ja(s,t){return t.alphaMode==="no-premultiply-alpha"&&Vf[s]||s}const Of=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Lf(s){let t="";for(let e=0;e<s;++e)e>0&&(t+=`
else `),e<s-1&&(t+=`if(test == ${e}.0){}`);return t}function Df(s,t){if(s===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);try{for(;;){const i=Of.replace(/%forloop%/gi,Lf(s));if(t.shaderSource(e,i),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))s=s/2|0;else break}}finally{t.deleteShader(e)}return s}let Ee=null;function Nf(){var t;if(Ee)return Ee;const s=Zh();return Ee=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),Ee=Df(Ee,s),(t=s.getExtension("WEBGL_lose_context"))==null||t.loseContext(),Ee}class Uf{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}}class zf{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new Uf,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const bl=[];let Yn=0;function Ya(){return Yn>0?bl[--Yn]:new zf}function Xa(s){bl[Yn++]=s}let os=0;const wl=class vl{constructor(t){this.uid=st("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],t={...vl.defaultOptions,...t},t.maxTextures||(N("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),t.maxTextures=Nf());const{maxTextures:e,attributesInitialSize:i,indicesInitialSize:n}=t;this.attributeBuffer=new Ha(i*4),this.indexBuffer=new Uint16Array(n),this.maxTextures=e}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)Xa(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,e){const i=t._batch.textures.ids[e._source.uid];return!i&&i!==0?!1:(t._textureId=i,t.texture=e,!0)}updateElement(t){this.dirty=!0;const e=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId)}break(t){const e=this._elements;if(!e[this.elementStart])return;let i=Ya(),n=i.textures;n.clear();const r=e[this.elementStart];let a=ja(r.blendMode,r.texture._source),o=r.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const h=this.attributeBuffer.float32View,l=this.attributeBuffer.uint32View,c=this.indexBuffer;let u=this._batchIndexSize,d=this._batchIndexStart,f="startBatch";const p=this.maxTextures;for(let g=this.elementStart;g<this.elementSize;++g){const m=e[g];e[g]=null;const _=m.texture._source,x=ja(m.blendMode,_),b=a!==x||o!==m.topology;if(_._batchTick===os&&!b){m._textureId=_._textureBindLocation,u+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,h,l,m._attributeStart,m._textureId),this.packQuadIndex(c,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,h,l,m._attributeStart,m._textureId),this.packIndex(m,c,m._indexStart,m._attributeStart/this.vertexSize)),m._batch=i;continue}_._batchTick=os,(n.count>=p||b)&&(this._finishBatch(i,d,u-d,n,a,o,t,f),f="renderBatch",d=u,a=x,o=m.topology,i=Ya(),n=i.textures,n.clear(),++os),m._textureId=_._textureBindLocation=n.count,n.ids[_.uid]=n.count,n.textures[n.count++]=_,m._batch=i,u+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,h,l,m._attributeStart,m._textureId),this.packQuadIndex(c,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,h,l,m._attributeStart,m._textureId),this.packIndex(m,c,m._indexStart,m._attributeStart/this.vertexSize))}n.count>0&&(this._finishBatch(i,d,u-d,n,a,o,t,f),d=u,++os),this.elementStart=this.elementSize,this._batchIndexStart=d,this._batchIndexSize=u}_finishBatch(t,e,i,n,r,a,o,h){t.gpuBindGroup=null,t.bindGroup=null,t.action=h,t.batcher=this,t.textures=n,t.blendMode=r,t.topology=a,t.start=e,t.size=i,++os,this.batches[this.batchIndex++]=t,o.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){t*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(t*4)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const e=Math.max(t,this.attributeBuffer.size*2),i=new Ha(e);$a(this.attributeBuffer.rawBinaryData,i.rawBinaryData),this.attributeBuffer=i}_resizeIndexBuffer(t){const e=this.indexBuffer;let i=Math.max(t,e.length*1.5);i+=i%2;const n=i>65535?new Uint32Array(i):new Uint16Array(i);if(n.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let r=0;r<e.length;r++)n[r]=e[r];else $a(e.buffer,n.buffer);this.indexBuffer=n}packQuadIndex(t,e,i){t[e]=i+0,t[e+1]=i+1,t[e+2]=i+2,t[e+3]=i+0,t[e+4]=i+2,t[e+5]=i+3}packIndex(t,e,i,n){const r=t.indices,a=t.indexSize,o=t.indexOffset,h=t.attributeOffset;for(let l=0;l<a;l++)e[i++]=n+r[l+o]-h}destroy(){for(let t=0;t<this.batches.length;t++)Xa(this.batches[t]);this.batches=null;for(let t=0;t<this._elements.length;t++)this._elements[t]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};wl.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let Wf=wl;var at=(s=>(s[s.MAP_READ=1]="MAP_READ",s[s.MAP_WRITE=2]="MAP_WRITE",s[s.COPY_SRC=4]="COPY_SRC",s[s.COPY_DST=8]="COPY_DST",s[s.INDEX=16]="INDEX",s[s.VERTEX=32]="VERTEX",s[s.UNIFORM=64]="UNIFORM",s[s.STORAGE=128]="STORAGE",s[s.INDIRECT=256]="INDIRECT",s[s.QUERY_RESOLVE=512]="QUERY_RESOLVE",s[s.STATIC=1024]="STATIC",s))(at||{});class ae extends gt{constructor(t){let{data:e,size:i}=t;const{usage:n,label:r,shrinkToFit:a}=t;super(),this.uid=st("buffer"),this._resourceType="buffer",this._resourceId=st("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,e instanceof Array&&(e=new Float32Array(e)),this._data=e,i??(i=e==null?void 0:e.byteLength);const o=!!e;this.descriptor={size:i,usage:n,mappedAtCreation:o,label:r},this.shrinkToFit=a??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&at.STATIC)}set static(t){t?this.descriptor.usage|=at.STATIC:this.descriptor.usage&=~at.STATIC}setDataWithSize(t,e,i){if(this._updateID++,this._updateSize=e*t.BYTES_PER_ELEMENT,this._data===t){i&&this.emit("update",this);return}const n=this._data;if(this._data=t,this._dataInt32=null,!n||n.length!==t.length){!this.shrinkToFit&&n&&t.byteLength<n.byteLength?i&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=st("resource"),this.emit("change",this));return}i&&this.emit("update",this)}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function Cl(s,t){if(!(s instanceof ae)){let e=t?at.INDEX:at.VERTEX;s instanceof Array&&(t?(s=new Uint32Array(s),e=at.INDEX|at.COPY_DST):(s=new Float32Array(s),e=at.VERTEX|at.COPY_DST)),s=new ae({data:s,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:e})}return s}function Gf(s,t,e){const i=s.getAttribute(t);if(!i)return e.minX=0,e.minY=0,e.maxX=0,e.maxY=0,e;const n=i.buffer.data;let r=1/0,a=1/0,o=-1/0,h=-1/0;const l=n.BYTES_PER_ELEMENT,c=(i.offset||0)/l,u=(i.stride||2*4)/l;for(let d=c;d<n.length;d+=u){const f=n[d],p=n[d+1];f>o&&(o=f),p>h&&(h=p),f<r&&(r=f),p<a&&(a=p)}return e.minX=r,e.minY=a,e.maxX=o,e.maxY=h,e}function Hf(s){return(s instanceof ae||Array.isArray(s)||s.BYTES_PER_ELEMENT)&&(s={buffer:s}),s.buffer=Cl(s.buffer,!1),s}class Sl extends gt{constructor(t={}){super(),this.uid=st("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new kt,this._boundsDirty=!0;const{attributes:e,indexBuffer:i,topology:n}=t;if(this.buffers=[],this.attributes={},e)for(const r in e)this.addAttribute(r,e[r]);this.instanceCount=t.instanceCount??1,i&&this.addIndex(i),this.topology=n||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return e.buffer.data.length/(e.stride/4||e.size)}return 0}addAttribute(t,e){const i=Hf(e);this.buffers.indexOf(i.buffer)===-1&&(this.buffers.push(i.buffer),i.buffer.on("update",this.onBufferUpdate,this),i.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=i}addIndex(t){this.indexBuffer=Cl(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,Gf(this,"aPosition",this._bounds)):this._bounds}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(e=>e.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const $f=new Float32Array(1),jf=new Uint32Array(1);class Yf extends Sl{constructor(){const e=new ae({data:$f,label:"attribute-batch-buffer",usage:at.VERTEX|at.COPY_DST,shrinkToFit:!1}),i=new ae({data:jf,label:"index-batch-buffer",usage:at.INDEX|at.COPY_DST,shrinkToFit:!1}),n=6*4;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:n,offset:0},aUV:{buffer:e,format:"float32x2",stride:n,offset:2*4},aColor:{buffer:e,format:"unorm8x4",stride:n,offset:4*4},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:n,offset:5*4}},indexBuffer:i})}}function Ka(s,t,e){if(s)for(const i in s){const n=i.toLocaleLowerCase(),r=t[n];if(r){let a=s[i];i==="header"&&(a=a.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),e&&r.push(`//----${e}----//`),r.push(a)}else Y(`${i} placement hook does not exist in shader`)}}const Xf=/\{\{(.*?)\}\}/g;function qa(s){var i;const t={};return(((i=s.match(Xf))==null?void 0:i.map(n=>n.replace(/[{()}]/g,"")))??[]).forEach(n=>{t[n]=[]}),t}function Za(s,t){let e;const i=/@in\s+([^;]+);/g;for(;(e=i.exec(s))!==null;)t.push(e[1])}function Qa(s,t,e=!1){const i=[];Za(t,i),s.forEach(o=>{o.header&&Za(o.header,i)});const n=i;e&&n.sort();const r=n.map((o,h)=>`       @location(${h}) ${o},`).join(`
`);let a=t.replace(/@in\s+[^;]+;\s*/g,"");return a=a.replace("{{in}}",`
${r}
`),a}function Ja(s,t){let e;const i=/@out\s+([^;]+);/g;for(;(e=i.exec(s))!==null;)t.push(e[1])}function Kf(s){const e=/\b(\w+)\s*:/g.exec(s);return e?e[1]:""}function qf(s){const t=/@.*?\s+/g;return s.replace(t,"")}function Zf(s,t){const e=[];Ja(t,e),s.forEach(h=>{h.header&&Ja(h.header,e)});let i=0;const n=e.sort().map(h=>h.indexOf("builtin")>-1?h:`@location(${i++}) ${h}`).join(`,
`),r=e.sort().map(h=>`       var ${qf(h)};`).join(`
`),a=`return VSOutput(
            ${e.sort().map(h=>` ${Kf(h)}`).join(`,
`)});`;let o=t.replace(/@out\s+[^;]+;\s*/g,"");return o=o.replace("{{struct}}",`
${n}
`),o=o.replace("{{start}}",`
${r}
`),o=o.replace("{{return}}",`
${a}
`),o}function to(s,t){let e=s;for(const i in t){const n=t[i];n.join(`
`).length?e=e.replace(`{{${i}}}`,`//-----${i} START-----//
${n.join(`
`)}
//----${i} FINISH----//`):e=e.replace(`{{${i}}}`,"")}return e}const re=Object.create(null),gn=new Map;let Qf=0;function Jf({template:s,bits:t}){const e=Al(s,t);if(re[e])return re[e];const{vertex:i,fragment:n}=ep(s,t);return re[e]=Tl(i,n,t),re[e]}function tp({template:s,bits:t}){const e=Al(s,t);return re[e]||(re[e]=Tl(s.vertex,s.fragment,t)),re[e]}function ep(s,t){const e=t.map(a=>a.vertex).filter(a=>!!a),i=t.map(a=>a.fragment).filter(a=>!!a);let n=Qa(e,s.vertex,!0);n=Zf(e,n);const r=Qa(i,s.fragment,!0);return{vertex:n,fragment:r}}function Al(s,t){return t.map(e=>(gn.has(e)||gn.set(e,Qf++),gn.get(e))).sort((e,i)=>e-i).join("-")+s.vertex+s.fragment}function Tl(s,t,e){const i=qa(s),n=qa(t);return e.forEach(r=>{Ka(r.vertex,i,r.name),Ka(r.fragment,n,r.name)}),{vertex:to(s,i),fragment:to(t,n)}}const sp=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,ip=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,np=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,rp=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,ap={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},op={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function hp({bits:s,name:t}){const e=Jf({template:{fragment:ip,vertex:sp},bits:[ap,...s]});return qe.from({name:t,vertex:{source:e.vertex,entryPoint:"main"},fragment:{source:e.fragment,entryPoint:"main"}})}function lp({bits:s,name:t}){return new Oi({name:t,...tp({template:{vertex:np,fragment:rp},bits:[op,...s]})})}const cp={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},up={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},yn={};function dp(s){const t=[];if(s===1)t.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),t.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let e=0;for(let i=0;i<s;i++)t.push(`@group(1) @binding(${e++}) var textureSource${i+1}: texture_2d<f32>;`),t.push(`@group(1) @binding(${e++}) var textureSampler${i+1}: sampler;`)}return t.join(`
`)}function fp(s){const t=[];if(s===1)t.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{t.push("switch vTextureId {");for(let e=0;e<s;e++)e===s-1?t.push("  default:{"):t.push(`  case ${e}:{`),t.push(`      outColor = textureSampleGrad(textureSource${e+1}, textureSampler${e+1}, vUV, uvDx, uvDy);`),t.push("      break;}");t.push("}")}return t.join(`
`)}function pp(s){return yn[s]||(yn[s]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${dp(s)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${fp(s)}
            `}}),yn[s]}const _n={};function mp(s){const t=[];for(let e=0;e<s;e++)e>0&&t.push("else"),e<s-1&&t.push(`if(vTextureId < ${e}.5)`),t.push("{"),t.push(`	outColor = texture(uTextures[${e}], vUV);`),t.push("}");return t.join(`
`)}function gp(s){return _n[s]||(_n[s]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${s}];

            `,main:`

                ${mp(s)}
            `}}),_n[s]}const yp={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},_p={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},eo={};function xp(s){let t=eo[s];if(t)return t;const e=new Int32Array(s);for(let i=0;i<s;i++)e[i]=i;return t=eo[s]=new sl({uTextures:{value:e,type:"i32",size:s}},{isStatic:!0}),t}class bp extends Li{constructor(t){const e=lp({name:"batch",bits:[up,gp(t),_p]}),i=hp({name:"batch",bits:[cp,pp(t),yp]});super({glProgram:e,gpuProgram:i,resources:{batchSamplers:xp(t)}})}}let xn=null;const Pl=class Ml extends Wf{constructor(t){super(t),this.geometry=new Yf,this.name=Ml.extension.name,this.vertexSize=6,xn??(xn=new bp(t.maxTextures)),this.shader=xn}packAttributes(t,e,i,n,r){const a=r<<16|t.roundPixels&65535,o=t.transform,h=o.a,l=o.b,c=o.c,u=o.d,d=o.tx,f=o.ty,{positions:p,uvs:g}=t,m=t.color,y=t.attributeOffset,_=y+t.attributeSize;for(let x=y;x<_;x++){const b=x*2,S=p[b],w=p[b+1];e[n++]=h*S+c*w+d,e[n++]=u*w+l*S+f,e[n++]=g[b],e[n++]=g[b+1],i[n++]=m,i[n++]=a}}packQuadAttributes(t,e,i,n,r){const a=t.texture,o=t.transform,h=o.a,l=o.b,c=o.c,u=o.d,d=o.tx,f=o.ty,p=t.bounds,g=p.maxX,m=p.minX,y=p.maxY,_=p.minY,x=a.uvs,b=t.color,S=r<<16|t.roundPixels&65535;e[n+0]=h*m+c*_+d,e[n+1]=u*_+l*m+f,e[n+2]=x.x0,e[n+3]=x.y0,i[n+4]=b,i[n+5]=S,e[n+6]=h*g+c*_+d,e[n+7]=u*_+l*g+f,e[n+8]=x.x1,e[n+9]=x.y1,i[n+10]=b,i[n+11]=S,e[n+12]=h*g+c*y+d,e[n+13]=u*y+l*g+f,e[n+14]=x.x2,e[n+15]=x.y2,i[n+16]=b,i[n+17]=S,e[n+18]=h*m+c*y+d,e[n+19]=u*y+l*m+f,e[n+20]=x.x3,e[n+21]=x.y3,i[n+22]=b,i[n+23]=S}};Pl.extension={type:[I.Batcher],name:"default"};let wp=Pl;function vp(s,t,e,i,n,r,a,o=null){let h=0;e*=t,n*=r;const l=o.a,c=o.b,u=o.c,d=o.d,f=o.tx,p=o.ty;for(;h<a;){const g=s[e],m=s[e+1];i[n]=l*g+u*m+f,i[n+1]=c*g+d*m+p,n+=r,e+=t,h++}}function Cp(s,t,e,i){let n=0;for(t*=e;n<i;)s[t]=0,s[t+1]=0,t+=e,n++}function El(s,t,e,i,n){const r=t.a,a=t.b,o=t.c,h=t.d,l=t.tx,c=t.ty;e||(e=0),i||(i=2),n||(n=s.length/i-e);let u=e*i;for(let d=0;d<n;d++){const f=s[u],p=s[u+1];s[u]=r*f+o*p+l,s[u+1]=a*f+h*p+c,u+=i}}const Sp=new U;class kl{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,e=t>>16|t&65280|(t&255)<<16,i=this.renderable;return i?Rh(e,i.groupColor)+(this.alpha*i.groupAlpha*255<<24):e+(this.alpha*255<<24)}get transform(){var t;return((t=this.renderable)==null?void 0:t.groupTransform)||Sp}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}const Bs={extension:{type:I.ShapeBuilder,name:"circle"},build(s,t){let e,i,n,r,a,o;if(s.type==="circle"){const b=s;if(a=o=b.radius,a<=0)return!1;e=b.x,i=b.y,n=r=0}else if(s.type==="ellipse"){const b=s;if(a=b.halfWidth,o=b.halfHeight,a<=0||o<=0)return!1;e=b.x,i=b.y,n=r=0}else{const b=s,S=b.width/2,w=b.height/2;e=b.x+S,i=b.y+w,a=o=Math.max(0,Math.min(b.radius,Math.min(S,w))),n=S-a,r=w-o}if(n<0||r<0)return!1;const h=Math.ceil(2.3*Math.sqrt(a+o)),l=h*8+(n?4:0)+(r?4:0);if(l===0)return!1;if(h===0)return t[0]=t[6]=e+n,t[1]=t[3]=i+r,t[2]=t[4]=e-n,t[5]=t[7]=i-r,!0;let c=0,u=h*4+(n?2:0)+2,d=u,f=l,p=n+a,g=r,m=e+p,y=e-p,_=i+g;if(t[c++]=m,t[c++]=_,t[--u]=_,t[--u]=y,r){const b=i-g;t[d++]=y,t[d++]=b,t[--f]=b,t[--f]=m}for(let b=1;b<h;b++){const S=Math.PI/2*(b/h),w=n+Math.cos(S)*a,v=r+Math.sin(S)*o,T=e+w,k=e-w,M=i+v,E=i-v;t[c++]=T,t[c++]=M,t[--u]=M,t[--u]=k,t[d++]=k,t[d++]=E,t[--f]=E,t[--f]=T}p=n,g=r+o,m=e+p,y=e-p,_=i+g;const x=i-g;return t[c++]=m,t[c++]=_,t[--f]=x,t[--f]=m,n&&(t[c++]=y,t[c++]=_,t[--f]=x,t[--f]=y),!0},triangulate(s,t,e,i,n,r){if(s.length===0)return;let a=0,o=0;for(let c=0;c<s.length;c+=2)a+=s[c],o+=s[c+1];a/=s.length/2,o/=s.length/2;let h=i;t[h*e]=a,t[h*e+1]=o;const l=h++;for(let c=0;c<s.length;c+=2)t[h*e]=s[c],t[h*e+1]=s[c+1],c>0&&(n[r++]=h,n[r++]=l,n[r++]=h-1),h++;n[r++]=l+1,n[r++]=l,n[r++]=h-1}},Ap={...Bs,extension:{...Bs.extension,name:"ellipse"}},Tp={...Bs,extension:{...Bs.extension,name:"roundedRectangle"}},Il=1e-4,so=1e-4;function Pp(s){const t=s.length;if(t<6)return 1;let e=0;for(let i=0,n=s[t-2],r=s[t-1];i<t;i+=2){const a=s[i],o=s[i+1];e+=(a-n)*(o+r),n=a,r=o}return e<0?-1:1}function io(s,t,e,i,n,r,a,o){const h=s-e*n,l=t-i*n,c=s+e*r,u=t+i*r;let d,f;a?(d=i,f=-e):(d=-i,f=e);const p=h+d,g=l+f,m=c+d,y=u+f;return o.push(p,g),o.push(m,y),2}function de(s,t,e,i,n,r,a,o){const h=e-s,l=i-t;let c=Math.atan2(h,l),u=Math.atan2(n-s,r-t);o&&c<u?c+=Math.PI*2:!o&&c>u&&(u+=Math.PI*2);let d=c;const f=u-c,p=Math.abs(f),g=Math.sqrt(h*h+l*l),m=(15*p*Math.sqrt(g)/Math.PI>>0)+1,y=f/m;if(d+=y,o){a.push(s,t),a.push(e,i);for(let _=1,x=d;_<m;_++,x+=y)a.push(s,t),a.push(s+Math.sin(x)*g,t+Math.cos(x)*g);a.push(s,t),a.push(n,r)}else{a.push(e,i),a.push(s,t);for(let _=1,x=d;_<m;_++,x+=y)a.push(s+Math.sin(x)*g,t+Math.cos(x)*g),a.push(s,t);a.push(n,r),a.push(s,t)}return m*2}function Mp(s,t,e,i,n,r){const a=Il;if(s.length===0)return;const o=t;let h=o.alignment;if(t.alignment!==.5){let H=Pp(s);h=(h-.5)*H+.5}const l=new mt(s[0],s[1]),c=new mt(s[s.length-2],s[s.length-1]),u=i,d=Math.abs(l.x-c.x)<a&&Math.abs(l.y-c.y)<a;if(u){s=s.slice(),d&&(s.pop(),s.pop(),c.set(s[s.length-2],s[s.length-1]));const H=(l.x+c.x)*.5,At=(c.y+l.y)*.5;s.unshift(H,At),s.push(H,At)}const f=n,p=s.length/2;let g=s.length;const m=f.length/2,y=o.width/2,_=y*y,x=o.miterLimit*o.miterLimit;let b=s[0],S=s[1],w=s[2],v=s[3],T=0,k=0,M=-(S-v),E=b-w,z=0,B=0,lt=Math.sqrt(M*M+E*E);M/=lt,E/=lt,M*=y,E*=y;const Zt=h,V=(1-Zt)*2,F=Zt*2;u||(o.cap==="round"?g+=de(b-M*(V-F)*.5,S-E*(V-F)*.5,b-M*V,S-E*V,b+M*F,S+E*F,f,!0)+2:o.cap==="square"&&(g+=io(b,S,M,E,V,F,!0,f))),f.push(b-M*V,S-E*V),f.push(b+M*F,S+E*F);for(let H=1;H<p-1;++H){b=s[(H-1)*2],S=s[(H-1)*2+1],w=s[H*2],v=s[H*2+1],T=s[(H+1)*2],k=s[(H+1)*2+1],M=-(S-v),E=b-w,lt=Math.sqrt(M*M+E*E),M/=lt,E/=lt,M*=y,E*=y,z=-(v-k),B=w-T,lt=Math.sqrt(z*z+B*B),z/=lt,B/=lt,z*=y,B*=y;const At=w-b,Qt=S-v,Jt=w-T,te=k-v,ns=At*Jt+Qt*te,Rt=Qt*Jt-te*At,Ft=Rt<0;if(Math.abs(Rt)<.001*Math.abs(ns)){f.push(w-M*V,v-E*V),f.push(w+M*F,v+E*F),ns>=0&&(o.join==="round"?g+=de(w,v,w-M*V,v-E*V,w-z*V,v-B*V,f,!1)+4:g+=2,f.push(w-z*F,v-B*F),f.push(w+z*V,v+B*V));continue}const oe=(-M+b)*(-E+v)-(-M+w)*(-E+S),ee=(-z+T)*(-B+v)-(-z+w)*(-B+k),Vt=(At*ee-Jt*oe)/Rt,Xs=(te*oe-Qt*ee)/Rt,zi=(Vt-w)*(Vt-w)+(Xs-v)*(Xs-v),he=w+(Vt-w)*V,le=v+(Xs-v)*V,ce=w-(Vt-w)*F,ue=v-(Xs-v)*F,xu=Math.min(At*At+Qt*Qt,Jt*Jt+te*te),ta=Ft?V:F,bu=xu+ta*ta*_;zi<=bu?o.join==="bevel"||zi/_>x?(Ft?(f.push(he,le),f.push(w+M*F,v+E*F),f.push(he,le),f.push(w+z*F,v+B*F)):(f.push(w-M*V,v-E*V),f.push(ce,ue),f.push(w-z*V,v-B*V),f.push(ce,ue)),g+=2):o.join==="round"?Ft?(f.push(he,le),f.push(w+M*F,v+E*F),g+=de(w,v,w+M*F,v+E*F,w+z*F,v+B*F,f,!0)+4,f.push(he,le),f.push(w+z*F,v+B*F)):(f.push(w-M*V,v-E*V),f.push(ce,ue),g+=de(w,v,w-M*V,v-E*V,w-z*V,v-B*V,f,!1)+4,f.push(w-z*V,v-B*V),f.push(ce,ue)):(f.push(he,le),f.push(ce,ue)):(f.push(w-M*V,v-E*V),f.push(w+M*F,v+E*F),o.join==="round"?Ft?g+=de(w,v,w+M*F,v+E*F,w+z*F,v+B*F,f,!0)+2:g+=de(w,v,w-M*V,v-E*V,w-z*V,v-B*V,f,!1)+2:o.join==="miter"&&zi/_<=x&&(Ft?(f.push(ce,ue),f.push(ce,ue)):(f.push(he,le),f.push(he,le)),g+=2),f.push(w-z*V,v-B*V),f.push(w+z*F,v+B*F),g+=2)}b=s[(p-2)*2],S=s[(p-2)*2+1],w=s[(p-1)*2],v=s[(p-1)*2+1],M=-(S-v),E=b-w,lt=Math.sqrt(M*M+E*E),M/=lt,E/=lt,M*=y,E*=y,f.push(w-M*V,v-E*V),f.push(w+M*F,v+E*F),u||(o.cap==="round"?g+=de(w-M*(V-F)*.5,v-E*(V-F)*.5,w-M*V,v-E*V,w+M*F,v+E*F,f,!1)+2:o.cap==="square"&&(g+=io(w,v,M,E,V,F,!1,f)));const St=so*so;for(let H=m;H<g+m-2;++H)b=f[H*2],S=f[H*2+1],w=f[(H+1)*2],v=f[(H+1)*2+1],T=f[(H+2)*2],k=f[(H+2)*2+1],!(Math.abs(b*(v-k)+w*(k-S)+T*(S-v))<St)&&r.push(H,H+1,H+2)}function Ep(s,t,e,i){const n=Il;if(s.length===0)return;const r=s[0],a=s[1],o=s[s.length-2],h=s[s.length-1],l=t||Math.abs(r-o)<n&&Math.abs(a-h)<n,c=e,u=s.length/2,d=c.length/2;for(let f=0;f<u;f++)c.push(s[f*2]),c.push(s[f*2+1]);for(let f=0;f<u-1;f++)i.push(d+f,d+f+1);l&&i.push(d+u-1,d)}function Rl(s,t,e,i,n,r,a){const o=gf(s,t,2);if(!o)return;for(let l=0;l<o.length;l+=3)r[a++]=o[l]+n,r[a++]=o[l+1]+n,r[a++]=o[l+2]+n;let h=n*i;for(let l=0;l<s.length;l+=2)e[h]=s[l],e[h+1]=s[l+1],h+=i}const kp=[],Ip={extension:{type:I.ShapeBuilder,name:"polygon"},build(s,t){for(let e=0;e<s.points.length;e++)t[e]=s.points[e];return!0},triangulate(s,t,e,i,n,r){Rl(s,kp,t,e,i,n,r)}},Rp={extension:{type:I.ShapeBuilder,name:"rectangle"},build(s,t){const e=s,i=e.x,n=e.y,r=e.width,a=e.height;return r>0&&a>0?(t[0]=i,t[1]=n,t[2]=i+r,t[3]=n,t[4]=i+r,t[5]=n+a,t[6]=i,t[7]=n+a,!0):!1},triangulate(s,t,e,i,n,r){let a=0;i*=e,t[i+a]=s[0],t[i+a+1]=s[1],a+=e,t[i+a]=s[2],t[i+a+1]=s[3],a+=e,t[i+a]=s[6],t[i+a+1]=s[7],a+=e,t[i+a]=s[4],t[i+a+1]=s[5],a+=e;const o=i/e;n[r++]=o,n[r++]=o+1,n[r++]=o+2,n[r++]=o+1,n[r++]=o+3,n[r++]=o+2}},Fp={extension:{type:I.ShapeBuilder,name:"triangle"},build(s,t){return t[0]=s.x,t[1]=s.y,t[2]=s.x2,t[3]=s.y2,t[4]=s.x3,t[5]=s.y3,!0},triangulate(s,t,e,i,n,r){let a=0;i*=e,t[i+a]=s[0],t[i+a+1]=s[1],a+=e,t[i+a]=s[2],t[i+a+1]=s[3],a+=e,t[i+a]=s[4],t[i+a+1]=s[5];const o=i/e;n[r++]=o,n[r++]=o+1,n[r++]=o+2}},Vp=new U,Bp=new j;function Op(s,t,e,i){const n=t.matrix?s.copyFrom(t.matrix).invert():s.identity();if(t.textureSpace==="local"){const a=e.getBounds(Bp);t.width&&a.pad(t.width);const{x:o,y:h}=a,l=1/a.width,c=1/a.height,u=-o*l,d=-h*c,f=n.a,p=n.b,g=n.c,m=n.d;n.a*=l,n.b*=l,n.c*=c,n.d*=c,n.tx=u*f+d*g+n.tx,n.ty=u*p+d*m+n.ty}else n.translate(t.texture.frame.x,t.texture.frame.y),n.scale(1/t.texture.source.width,1/t.texture.source.height);const r=t.texture.source.style;return!(t.fill instanceof Yt)&&r.addressMode==="clamp-to-edge"&&(r.addressMode="repeat",r.update()),i&&n.append(Vp.copyFrom(i).invert()),n}const Ni={};X.handleByMap(I.ShapeBuilder,Ni);X.add(Rp,Ip,Fp,Bs,Ap,Tp);const Lp=new j,Dp=new U;function Np(s,t){const{geometryData:e,batches:i}=t;i.length=0,e.indices.length=0,e.vertices.length=0,e.uvs.length=0;for(let n=0;n<s.instructions.length;n++){const r=s.instructions[n];if(r.action==="texture")Up(r.data,i,e);else if(r.action==="fill"||r.action==="stroke"){const a=r.action==="stroke",o=r.data.path.shapePath,h=r.data.style,l=r.data.hole;a&&l&&no(l.shapePath,h,!0,i,e),l&&(o.shapePrimitives[o.shapePrimitives.length-1].holes=l.shapePath.shapePrimitives),no(o,h,a,i,e)}}}function Up(s,t,e){const i=[],n=Ni.rectangle,r=Lp;r.x=s.dx,r.y=s.dy,r.width=s.dw,r.height=s.dh;const a=s.transform;if(!n.build(r,i))return;const{vertices:o,uvs:h,indices:l}=e,c=l.length,u=o.length/2;a&&El(i,a),n.triangulate(i,o,2,u,l,c);const d=s.image,f=d.uvs;h.push(f.x0,f.y0,f.x1,f.y1,f.x3,f.y3,f.x2,f.y2);const p=Dt.get(kl);p.indexOffset=c,p.indexSize=l.length-c,p.attributeOffset=u,p.attributeSize=o.length/2-u,p.baseColor=s.style,p.alpha=s.alpha,p.texture=d,p.geometryData=e,t.push(p)}function no(s,t,e,i,n){const{vertices:r,uvs:a,indices:o}=n;s.shapePrimitives.forEach(({shape:h,transform:l,holes:c})=>{const u=[],d=Ni[h.type];if(!d.build(h,u))return;const f=o.length,p=r.length/2;let g="triangle-list";if(l&&El(u,l),e){const x=h.closePath??!0,b=t;b.pixelLine?(Ep(u,x,r,o),g="line-list"):Mp(u,b,!1,x,r,o)}else if(c){const x=[],b=u.slice();zp(c).forEach(w=>{x.push(b.length/2),b.push(...w)}),Rl(b,x,r,2,p,o,f)}else d.triangulate(u,r,2,p,o,f);const m=a.length/2,y=t.texture;if(y!==L.WHITE){const x=Op(Dp,t,h,l);vp(r,2,p,a,m,2,r.length/2-p,x)}else Cp(a,m,2,r.length/2-p);const _=Dt.get(kl);_.indexOffset=f,_.indexSize=o.length-f,_.attributeOffset=p,_.attributeSize=r.length/2-p,_.baseColor=t.color,_.alpha=t.alpha,_.texture=y,_.geometryData=n,_.topology=g,i.push(_)})}function zp(s){const t=[];for(let e=0;e<s.length;e++){const i=s[e].shape,n=[];Ni[i.type].build(i,n)&&t.push(n)}return t}class Wp{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class Gp{constructor(){this.instructions=new Oh}init(t){this.batcher=new wp({maxTextures:t}),this.instructions.reset()}get geometry(){return N(Bu,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const Mr=class Xn{constructor(t){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._renderer=t,t.renderableGC.addManagedHash(this,"_gpuContextHash"),t.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(t){Xn.defaultOptions.bezierSmoothness=(t==null?void 0:t.bezierSmoothness)??Xn.defaultOptions.bezierSmoothness}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){e?this._cleanGraphicsContextData(t):e=this._initContext(t),Np(t,e);const i=t.batchMode;t.customShader||i==="no-batch"?e.isBatchable=!1:i==="auto"?e.isBatchable=e.geometryData.vertices.length<400:e.isBatchable=!0,t.dirty=!1}return e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_initContextRenderData(t){const e=Dt.get(Gp,{maxTextures:this._renderer.limits.maxBatchableTextures}),{batches:i,geometryData:n}=this._gpuContextHash[t.uid],r=n.vertices.length,a=n.indices.length;for(let c=0;c<i.length;c++)i[c].applyTransform=!1;const o=e.batcher;o.ensureAttributeBuffer(r),o.ensureIndexBuffer(a),o.begin();for(let c=0;c<i.length;c++){const u=i[c];o.add(u)}o.finish(e.instructions);const h=o.geometry;h.indexBuffer.setDataWithSize(o.indexBuffer,o.indexSize,!0),h.buffers[0].setDataWithSize(o.attributeBuffer.float32View,o.attributeSize,!0);const l=o.batches;for(let c=0;c<l.length;c++){const u=l[c];u.bindGroup=Rf(u.textures.textures,u.textures.count,this._renderer.limits.maxBatchableTextures)}return this._graphicsDataContextHash[t.uid]=e,e}_initContext(t){const e=new Wp;return e.context=t,this._gpuContextHash[t.uid]=e,t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(Dt.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach(i=>{Dt.return(i)})}destroy(){for(const t in this._gpuContextHash)this._gpuContextHash[t]&&this.onGraphicsContextDestroy(this._gpuContextHash[t].context)}};Mr.extension={type:[I.WebGLSystem,I.WebGPUSystem,I.CanvasSystem],name:"graphicsContext"};Mr.defaultOptions={bezierSmoothness:.5};let Fl=Mr;const Hp=8,hi=11920929e-14,$p=1;function Vl(s,t,e,i,n,r,a,o,h,l){const u=Math.min(.99,Math.max(0,l??Fl.defaultOptions.bezierSmoothness));let d=($p-u)/1;return d*=d,jp(t,e,i,n,r,a,o,h,s,d),s}function jp(s,t,e,i,n,r,a,o,h,l){Kn(s,t,e,i,n,r,a,o,h,l,0),h.push(a,o)}function Kn(s,t,e,i,n,r,a,o,h,l,c){if(c>Hp)return;const u=(s+e)/2,d=(t+i)/2,f=(e+n)/2,p=(i+r)/2,g=(n+a)/2,m=(r+o)/2,y=(u+f)/2,_=(d+p)/2,x=(f+g)/2,b=(p+m)/2,S=(y+x)/2,w=(_+b)/2;if(c>0){let v=a-s,T=o-t;const k=Math.abs((e-a)*T-(i-o)*v),M=Math.abs((n-a)*T-(r-o)*v);if(k>hi&&M>hi){if((k+M)*(k+M)<=l*(v*v+T*T)){h.push(S,w);return}}else if(k>hi){if(k*k<=l*(v*v+T*T)){h.push(S,w);return}}else if(M>hi){if(M*M<=l*(v*v+T*T)){h.push(S,w);return}}else if(v=S-(s+a)/2,T=w-(t+o)/2,v*v+T*T<=l){h.push(S,w);return}}Kn(s,t,u,d,y,_,S,w,h,l,c+1),Kn(S,w,x,b,g,m,a,o,h,l,c+1)}const Yp=8,Xp=11920929e-14,Kp=1;function qp(s,t,e,i,n,r,a,o){const l=Math.min(.99,Math.max(0,o??Fl.defaultOptions.bezierSmoothness));let c=(Kp-l)/1;return c*=c,Zp(t,e,i,n,r,a,s,c),s}function Zp(s,t,e,i,n,r,a,o){qn(a,s,t,e,i,n,r,o,0),a.push(n,r)}function qn(s,t,e,i,n,r,a,o,h){if(h>Yp)return;const l=(t+i)/2,c=(e+n)/2,u=(i+r)/2,d=(n+a)/2,f=(l+u)/2,p=(c+d)/2;let g=r-t,m=a-e;const y=Math.abs((i-r)*m-(n-a)*g);if(y>Xp){if(y*y<=o*(g*g+m*m)){s.push(f,p);return}}else if(g=f-(t+r)/2,m=p-(e+a)/2,g*g+m*m<=o){s.push(f,p);return}qn(s,t,e,l,c,f,p,o,h+1),qn(s,f,p,u,d,r,a,o,h+1)}function Bl(s,t,e,i,n,r,a,o){let h=Math.abs(n-r);(!a&&n>r||a&&r>n)&&(h=2*Math.PI-h),o||(o=Math.max(6,Math.floor(6*Math.pow(i,1/3)*(h/Math.PI)))),o=Math.max(o,3);let l=h/o,c=n;l*=a?-1:1;for(let u=0;u<o+1;u++){const d=Math.cos(c),f=Math.sin(c),p=t+d*i,g=e+f*i;s.push(p,g),c+=l}}function Qp(s,t,e,i,n,r){const a=s[s.length-2],h=s[s.length-1]-e,l=a-t,c=n-e,u=i-t,d=Math.abs(h*u-l*c);if(d<1e-8||r===0){(s[s.length-2]!==t||s[s.length-1]!==e)&&s.push(t,e);return}const f=h*h+l*l,p=c*c+u*u,g=h*c+l*u,m=r*Math.sqrt(f)/d,y=r*Math.sqrt(p)/d,_=m*g/f,x=y*g/p,b=m*u+y*l,S=m*c+y*h,w=l*(y+_),v=h*(y+_),T=u*(m+x),k=c*(m+x),M=Math.atan2(v-S,w-b),E=Math.atan2(k-S,T-b);Bl(s,b+t,S+e,r,M,E,l*c>u*h)}const Es=Math.PI*2,bn={centerX:0,centerY:0,ang1:0,ang2:0},wn=({x:s,y:t},e,i,n,r,a,o,h)=>{s*=e,t*=i;const l=n*s-r*t,c=r*s+n*t;return h.x=l+a,h.y=c+o,h};function Jp(s,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),i=t===1.5707963267948966?.551915024494:e,n=Math.cos(s),r=Math.sin(s),a=Math.cos(s+t),o=Math.sin(s+t);return[{x:n-r*i,y:r+n*i},{x:a+o*i,y:o-a*i},{x:a,y:o}]}const ro=(s,t,e,i)=>{const n=s*i-t*e<0?-1:1;let r=s*e+t*i;return r>1&&(r=1),r<-1&&(r=-1),n*Math.acos(r)},tm=(s,t,e,i,n,r,a,o,h,l,c,u,d)=>{const f=Math.pow(n,2),p=Math.pow(r,2),g=Math.pow(c,2),m=Math.pow(u,2);let y=f*p-f*m-p*g;y<0&&(y=0),y/=f*m+p*g,y=Math.sqrt(y)*(a===o?-1:1);const _=y*n/r*u,x=y*-r/n*c,b=l*_-h*x+(s+e)/2,S=h*_+l*x+(t+i)/2,w=(c-_)/n,v=(u-x)/r,T=(-c-_)/n,k=(-u-x)/r,M=ro(1,0,w,v);let E=ro(w,v,T,k);o===0&&E>0&&(E-=Es),o===1&&E<0&&(E+=Es),d.centerX=b,d.centerY=S,d.ang1=M,d.ang2=E};function em(s,t,e,i,n,r,a,o=0,h=0,l=0){if(r===0||a===0)return;const c=Math.sin(o*Es/360),u=Math.cos(o*Es/360),d=u*(t-i)/2+c*(e-n)/2,f=-c*(t-i)/2+u*(e-n)/2;if(d===0&&f===0)return;r=Math.abs(r),a=Math.abs(a);const p=Math.pow(d,2)/Math.pow(r,2)+Math.pow(f,2)/Math.pow(a,2);p>1&&(r*=Math.sqrt(p),a*=Math.sqrt(p)),tm(t,e,i,n,r,a,h,l,c,u,d,f,bn);let{ang1:g,ang2:m}=bn;const{centerX:y,centerY:_}=bn;let x=Math.abs(m)/(Es/4);Math.abs(1-x)<1e-7&&(x=1);const b=Math.max(Math.ceil(x),1);m/=b;let S=s[s.length-2],w=s[s.length-1];const v={x:0,y:0};for(let T=0;T<b;T++){const k=Jp(g,m),{x:M,y:E}=wn(k[0],r,a,u,c,y,_,v),{x:z,y:B}=wn(k[1],r,a,u,c,y,_,v),{x:lt,y:Zt}=wn(k[2],r,a,u,c,y,_,v);Vl(s,S,w,M,E,z,B,lt,Zt),S=lt,w=Zt,g+=m}}function sm(s,t,e){const i=(a,o)=>{const h=o.x-a.x,l=o.y-a.y,c=Math.sqrt(h*h+l*l),u=h/c,d=l/c;return{len:c,nx:u,ny:d}},n=(a,o)=>{a===0?s.moveTo(o.x,o.y):s.lineTo(o.x,o.y)};let r=t[t.length-1];for(let a=0;a<t.length;a++){const o=t[a%t.length],h=o.radius??e;if(h<=0){n(a,o),r=o;continue}const l=t[(a+1)%t.length],c=i(o,r),u=i(o,l);if(c.len<1e-4||u.len<1e-4){n(a,o),r=o;continue}let d=Math.asin(c.nx*u.ny-c.ny*u.nx),f=1,p=!1;c.nx*u.nx-c.ny*-u.ny<0?d<0?d=Math.PI+d:(d=Math.PI-d,f=-1,p=!0):d>0&&(f=-1,p=!0);const g=d/2;let m,y=Math.abs(Math.cos(g)*h/Math.sin(g));y>Math.min(c.len/2,u.len/2)?(y=Math.min(c.len/2,u.len/2),m=Math.abs(y*Math.sin(g)/Math.cos(g))):m=h;const _=o.x+u.nx*y+-u.ny*m*f,x=o.y+u.ny*y+u.nx*m*f,b=Math.atan2(c.ny,c.nx)+Math.PI/2*f,S=Math.atan2(u.ny,u.nx)-Math.PI/2*f;a===0&&s.moveTo(_+Math.cos(b)*m,x+Math.sin(b)*m),s.arc(_,x,m,b,S,p),r=o}}function im(s,t,e,i){const n=(o,h)=>Math.sqrt((o.x-h.x)**2+(o.y-h.y)**2),r=(o,h,l)=>({x:o.x+(h.x-o.x)*l,y:o.y+(h.y-o.y)*l}),a=t.length;for(let o=0;o<a;o++){const h=t[(o+1)%a],l=h.radius??e;if(l<=0){o===0?s.moveTo(h.x,h.y):s.lineTo(h.x,h.y);continue}const c=t[o],u=t[(o+2)%a],d=n(c,h);let f;if(d<1e-4)f=h;else{const m=Math.min(d/2,l);f=r(h,c,m/d)}const p=n(u,h);let g;if(p<1e-4)g=h;else{const m=Math.min(p/2,l);g=r(h,u,m/p)}o===0?s.moveTo(f.x,f.y):s.lineTo(f.x,f.y),s.quadraticCurveTo(h.x,h.y,g.x,g.y,i)}}const nm=new j;class rm{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new kt,this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const i=this._currentPoly.points,n=i[i.length-2],r=i[i.length-1];return(n!==t||r!==e)&&i.push(t,e),this}arc(t,e,i,n,r,a){this._ensurePoly(!1);const o=this._currentPoly.points;return Bl(o,t,e,i,n,r,a),this}arcTo(t,e,i,n,r){this._ensurePoly();const a=this._currentPoly.points;return Qp(a,t,e,i,n,r),this}arcToSvg(t,e,i,n,r,a,o){const h=this._currentPoly.points;return em(h,this._currentPoly.lastX,this._currentPoly.lastY,a,o,t,e,i,n,r),this}bezierCurveTo(t,e,i,n,r,a,o){this._ensurePoly();const h=this._currentPoly;return Vl(this._currentPoly.points,h.lastX,h.lastY,t,e,i,n,r,a,o),this}quadraticCurveTo(t,e,i,n,r){this._ensurePoly();const a=this._currentPoly;return qp(this._currentPoly.points,a.lastX,a.lastY,t,e,i,n,r),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));const i=this.shapePrimitives,n=i.length;for(let r=0;r<t.instructions.length;r++){const a=t.instructions[r];this[a.action](...a.data)}if(t.checkForHoles&&i.length-n>1){let r=null;for(let a=n;a<i.length;a++){const o=i[a];if(o.shape.type==="polygon"){const h=o.shape,l=r==null?void 0:r.shape;l&&l.containsPolygon(h)?(r.holes||(r.holes=[]),r.holes.push(o),i.copyWithin(a,a+1),i.length--,a--):r=o}}}return this}finish(t=!1){this.endPoly(t)}rect(t,e,i,n,r){return this.drawShape(new j(t,e,i,n),r),this}circle(t,e,i,n){return this.drawShape(new Ar(t,e,i),n),this}poly(t,e,i){const n=new Ms(t);return n.closePath=e,this.drawShape(n,i),this}regularPoly(t,e,i,n,r=0,a){n=Math.max(n|0,3);const o=-1*Math.PI/2+r,h=Math.PI*2/n,l=[];for(let c=0;c<n;c++){const u=o-c*h;l.push(t+i*Math.cos(u),e+i*Math.sin(u))}return this.poly(l,!0,a),this}roundPoly(t,e,i,n,r,a=0,o){if(n=Math.max(n|0,3),r<=0)return this.regularPoly(t,e,i,n,a);const h=i*Math.sin(Math.PI/n)-.001;r=Math.min(r,h);const l=-1*Math.PI/2+a,c=Math.PI*2/n,u=(n-2)*Math.PI/n/2;for(let d=0;d<n;d++){const f=d*c+l,p=t+i*Math.cos(f),g=e+i*Math.sin(f),m=f+Math.PI+u,y=f-Math.PI-u,_=p+r*Math.cos(m),x=g+r*Math.sin(m),b=p+r*Math.cos(y),S=g+r*Math.sin(y);d===0?this.moveTo(_,x):this.lineTo(_,x),this.quadraticCurveTo(p,g,b,S,o)}return this.closePath()}roundShape(t,e,i=!1,n){return t.length<3?this:(i?im(this,t,e,n):sm(this,t,e),this.closePath())}filletRect(t,e,i,n,r){if(r===0)return this.rect(t,e,i,n);const a=Math.min(i,n)/2,o=Math.min(a,Math.max(-a,r)),h=t+i,l=e+n,c=o<0?-o:0,u=Math.abs(o);return this.moveTo(t,e+u).arcTo(t+c,e+c,t+u,e,u).lineTo(h-u,e).arcTo(h-c,e+c,h,e+u,u).lineTo(h,l-u).arcTo(h-c,l-c,t+i-u,l,u).lineTo(t+u,l).arcTo(t+c,l-c,t,l-u,u).closePath()}chamferRect(t,e,i,n,r,a){if(r<=0)return this.rect(t,e,i,n);const o=Math.min(r,Math.min(i,n)/2),h=t+i,l=e+n,c=[t+o,e,h-o,e,h,e+o,h,l-o,h-o,l,t+o,l,t,l-o,t,e+o];for(let u=c.length-1;u>=2;u-=2)c[u]===c[u-2]&&c[u-1]===c[u-3]&&c.splice(u-1,2);return this.poly(c,!0,a)}ellipse(t,e,i,n,r){return this.drawShape(new Tr(t,e,i,n),r),this}roundRect(t,e,i,n,r,a){return this.drawShape(new Pr(t,e,i,n,r),a),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let i=this._currentPoly;return i&&this.endPoly(),i=new Ms,i.points.push(t,e),this._currentPoly=i,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new Ms,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let i=e.shape.x,n=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const r=e.transform,a=i;i=r.a*i+r.c*n+r.tx,n=r.b*a+r.d*n+r.ty}this._currentPoly.points.push(i,n)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const i=t.instructions[e];this[i.action](...i.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let i=0;i<e.length;i++){const n=e[i],r=n.shape.getBounds(nm);n.transform?t.addRect(r,n.transform):t.addRect(r)}return t}}class je{constructor(t,e=!1){this.instructions=[],this.uid=st("graphicsPath"),this._dirty=!0,this.checkForHoles=e,typeof t=="string"?Mf(t,this):this.instructions=(t==null?void 0:t.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new rm(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,i,n,r){const a=this.instructions[this.instructions.length-1],o=this.getLastPoint(mt.shared);let h=0,l=0;if(!a||a.action!=="bezierCurveTo")h=o.x,l=o.y;else{h=a.data[2],l=a.data[3];const c=o.x,u=o.y;h=c+(c-h),l=u+(u-l)}return this.instructions.push({action:"bezierCurveTo",data:[h,l,t,e,i,n,r]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,i){const n=this.instructions[this.instructions.length-1],r=this.getLastPoint(mt.shared);let a=0,o=0;if(!n||n.action!=="quadraticCurveTo")a=r.x,o=r.y;else{a=n.data[0],o=n.data[1];const h=r.x,l=r.y;a=h+(h-a),o=l+(l-o)}return this.instructions.push({action:"quadraticCurveTo",data:[a,o,t,e,i]}),this._dirty=!0,this}rect(t,e,i,n,r){return this.instructions.push({action:"rect",data:[t,e,i,n,r]}),this._dirty=!0,this}circle(t,e,i,n){return this.instructions.push({action:"circle",data:[t,e,i,n]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,i,n,r,a,o){r||(r=n/2);const h=-1*Math.PI/2+a,l=i*2,c=Math.PI*2/l,u=[];for(let d=0;d<l;d++){const f=d%2?r:n,p=d*c+h;u.push(t+f*Math.cos(p),e+f*Math.sin(p))}return this.poly(u,!0,o),this}clone(t=!1){const e=new je;if(e.checkForHoles=this.checkForHoles,!t)e.instructions=this.instructions.slice();else for(let i=0;i<this.instructions.length;i++){const n=this.instructions[i];e.instructions.push({action:n.action,data:n.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,i=t.b,n=t.c,r=t.d,a=t.tx,o=t.ty;let h=0,l=0,c=0,u=0,d=0,f=0,p=0,g=0;for(let m=0;m<this.instructions.length;m++){const y=this.instructions[m],_=y.data;switch(y.action){case"moveTo":case"lineTo":h=_[0],l=_[1],_[0]=e*h+n*l+a,_[1]=i*h+r*l+o;break;case"bezierCurveTo":c=_[0],u=_[1],d=_[2],f=_[3],h=_[4],l=_[5],_[0]=e*c+n*u+a,_[1]=i*c+r*u+o,_[2]=e*d+n*f+a,_[3]=i*d+r*f+o,_[4]=e*h+n*l+a,_[5]=i*h+r*l+o;break;case"quadraticCurveTo":c=_[0],u=_[1],h=_[2],l=_[3],_[0]=e*c+n*u+a,_[1]=i*c+r*u+o,_[2]=e*h+n*l+a,_[3]=i*h+r*l+o;break;case"arcToSvg":h=_[5],l=_[6],p=_[0],g=_[1],_[0]=e*p+n*g,_[1]=i*p+r*g,_[5]=e*h+n*l+a,_[6]=i*h+r*l+o;break;case"circle":_[4]=hs(_[3],t);break;case"rect":_[4]=hs(_[4],t);break;case"ellipse":_[8]=hs(_[8],t);break;case"roundRect":_[5]=hs(_[5],t);break;case"addPath":_[0].transform(t);break;case"poly":_[2]=hs(_[2],t);break;default:Y("unknown transform action",y.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,i=this.instructions[e];if(!i)return t.x=0,t.y=0,t;for(;i.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;i=this.instructions[e]}switch(i.action){case"moveTo":case"lineTo":t.x=i.data[0],t.y=i.data[1];break;case"quadraticCurveTo":t.x=i.data[2],t.y=i.data[3];break;case"bezierCurveTo":t.x=i.data[4],t.y=i.data[5];break;case"arc":case"arcToSvg":t.x=i.data[5],t.y=i.data[6];break;case"addPath":i.data[0].getLastPoint(t);break}return t}}function hs(s,t){return s?s.prepend(t):t.clone()}function Q(s,t,e){const i=s.getAttribute(t);return i?Number(i):e}function am(s,t){const e=s.querySelectorAll("defs");for(let i=0;i<e.length;i++){const n=e[i];for(let r=0;r<n.children.length;r++){const a=n.children[r];switch(a.nodeName.toLowerCase()){case"lineargradient":t.defs[a.id]=om(a);break;case"radialgradient":t.defs[a.id]=hm();break}}}}function om(s){const t=Q(s,"x1",0),e=Q(s,"y1",0),i=Q(s,"x2",1),n=Q(s,"y2",0),r=s.getAttribute("gradientUnits")||"objectBoundingBox",a=new Yt(t,e,i,n,r==="objectBoundingBox"?"local":"global");for(let o=0;o<s.children.length;o++){const h=s.children[o],l=Q(h,"offset",0),c=nt.shared.setValue(h.getAttribute("stop-color")).toNumber();a.addColorStop(l,c)}return a}function hm(s){return Y("[SVG Parser] Radial gradients are not yet supported"),new Yt(0,0,1,0)}function ao(s){const t=s.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}const oo={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function Ol(s,t){const e=s.getAttribute("style"),i={},n={},r={strokeStyle:i,fillStyle:n,useFill:!1,useStroke:!1};for(const a in oo){const o=s.getAttribute(a);o&&ho(t,r,a,o.trim())}if(e){const a=e.split(";");for(let o=0;o<a.length;o++){const h=a[o].trim(),[l,c]=h.split(":");oo[l]&&ho(t,r,l,c.trim())}}return{strokeStyle:r.useStroke?i:null,fillStyle:r.useFill?n:null,useFill:r.useFill,useStroke:r.useStroke}}function ho(s,t,e,i){switch(e){case"stroke":if(i!=="none"){if(i.startsWith("url(")){const n=ao(i);t.strokeStyle.fill=s.defs[n]}else t.strokeStyle.color=nt.shared.setValue(i).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(i);break;case"fill":if(i!=="none"){if(i.startsWith("url(")){const n=ao(i);t.fillStyle.fill=s.defs[n]}else t.fillStyle.color=nt.shared.setValue(i).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(i);break;case"stroke-opacity":t.strokeStyle.alpha=Number(i);break;case"opacity":t.fillStyle.alpha=Number(i),t.strokeStyle.alpha=Number(i);break}}function lm(s,t){if(typeof s=="string"){const a=document.createElement("div");a.innerHTML=s.trim(),s=a.querySelector("svg")}const e={context:t,defs:{},path:new je};am(s,e);const i=s.children,{fillStyle:n,strokeStyle:r}=Ol(s,e);for(let a=0;a<i.length;a++){const o=i[a];o.nodeName.toLowerCase()!=="defs"&&Ll(o,e,n,r)}return t}function Ll(s,t,e,i){const n=s.children,{fillStyle:r,strokeStyle:a}=Ol(s,t);r&&e?e={...e,...r}:r&&(e=r),a&&i?i={...i,...a}:a&&(i=a);const o=!e&&!i;o&&(e={color:0});let h,l,c,u,d,f,p,g,m,y,_,x,b,S,w,v,T;switch(s.nodeName.toLowerCase()){case"path":S=s.getAttribute("d"),s.getAttribute("fill-rule")==="evenodd"&&Y("SVG Evenodd fill rule not supported, your svg may render incorrectly"),w=new je(S,!0),t.context.path(w),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"circle":p=Q(s,"cx",0),g=Q(s,"cy",0),m=Q(s,"r",0),t.context.ellipse(p,g,m,m),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"rect":h=Q(s,"x",0),l=Q(s,"y",0),v=Q(s,"width",0),T=Q(s,"height",0),y=Q(s,"rx",0),_=Q(s,"ry",0),y||_?t.context.roundRect(h,l,v,T,y||_):t.context.rect(h,l,v,T),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"ellipse":p=Q(s,"cx",0),g=Q(s,"cy",0),y=Q(s,"rx",0),_=Q(s,"ry",0),t.context.beginPath(),t.context.ellipse(p,g,y,_),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"line":c=Q(s,"x1",0),u=Q(s,"y1",0),d=Q(s,"x2",0),f=Q(s,"y2",0),t.context.beginPath(),t.context.moveTo(c,u),t.context.lineTo(d,f),i&&t.context.stroke(i);break;case"polygon":b=s.getAttribute("points"),x=b.match(/\d+/g).map(k=>parseInt(k,10)),t.context.poly(x,!0),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"polyline":b=s.getAttribute("points"),x=b.match(/\d+/g).map(k=>parseInt(k,10)),t.context.poly(x,!1),i&&t.context.stroke(i);break;case"g":case"svg":break;default:{Y(`[SVG parser] <${s.nodeName}> elements unsupported`);break}}o&&(e=null);for(let k=0;k<n.length;k++)Ll(n[k],t,e,i)}function cm(s){return nt.isColorLike(s)}function lo(s){return s instanceof Di}function co(s){return s instanceof Yt}function um(s){return s instanceof L}function dm(s,t,e){const i=nt.shared.setValue(t??0);return s.color=i.toNumber(),s.alpha=i.alpha===1?e.alpha:i.alpha,s.texture=L.WHITE,{...e,...s}}function fm(s,t,e){return s.texture=t,{...e,...s}}function uo(s,t,e){return s.fill=t,s.color=16777215,s.texture=t.texture,s.matrix=t.transform,{...e,...s}}function fo(s,t,e){return t.buildGradient(),s.fill=t,s.color=16777215,s.texture=t.texture,s.matrix=t.transform,s.textureSpace=t.textureSpace,{...e,...s}}function pm(s,t){const e={...t,...s},i=nt.shared.setValue(e.color);return e.alpha*=i.alpha,e.color=i.toNumber(),e}function _e(s,t){if(s==null)return null;const e={},i=s;return cm(s)?dm(e,s,t):um(s)?fm(e,s,t):lo(s)?uo(e,s,t):co(s)?fo(e,s,t):i.fill&&lo(i.fill)?uo(i,i.fill,t):i.fill&&co(i.fill)?fo(i,i.fill,t):pm(i,t)}function Ci(s,t){const{width:e,alignment:i,miterLimit:n,cap:r,join:a,pixelLine:o,...h}=t,l=_e(s,h);return l?{width:e,alignment:i,miterLimit:n,cap:r,join:a,pixelLine:o,...l}:null}const mm=new mt,po=new U,Er=class Ot extends gt{constructor(){super(...arguments),this.uid=st("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new je,this._transform=new U,this._fillStyle={...Ot.defaultFillStyle},this._strokeStyle={...Ot.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new kt,this._boundsDirty=!0}clone(){const t=new Ot;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=_e(t,Ot.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=Ci(t,Ot.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=_e(t,Ot.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=_e(t,Ot.defaultStrokeStyle),this}texture(t,e,i,n,r,a){return this.instructions.push({action:"texture",data:{image:t,dx:i||0,dy:n||0,dw:r||t.frame.width,dh:a||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?nt.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new je,this}fill(t,e){let i;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n&&n.action==="stroke"?i=n.data.path:i=this._activePath.clone(),i?(t!=null&&(e!==void 0&&typeof t=="number"&&(N(W,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=_e(t,Ot.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:i}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(mt.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const i=this.instructions[this.instructions.length-1];return this._tick===0&&i&&i.action==="fill"?e=i.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=Ci(t,Ot.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],i=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(i);else{e.data.hole=i;break}}return this._initNextPathLocation(),this}arc(t,e,i,n,r,a){this._tick++;const o=this._transform;return this._activePath.arc(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,i,n,r,a),this}arcTo(t,e,i,n,r){this._tick++;const a=this._transform;return this._activePath.arcTo(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,a.a*i+a.c*n+a.tx,a.b*i+a.d*n+a.ty,r),this}arcToSvg(t,e,i,n,r,a,o){this._tick++;const h=this._transform;return this._activePath.arcToSvg(t,e,i,n,r,h.a*a+h.c*o+h.tx,h.b*a+h.d*o+h.ty),this}bezierCurveTo(t,e,i,n,r,a,o){this._tick++;const h=this._transform;return this._activePath.bezierCurveTo(h.a*t+h.c*e+h.tx,h.b*t+h.d*e+h.ty,h.a*i+h.c*n+h.tx,h.b*i+h.d*n+h.ty,h.a*r+h.c*a+h.tx,h.b*r+h.d*a+h.ty,o),this}closePath(){var t;return this._tick++,(t=this._activePath)==null||t.closePath(),this}ellipse(t,e,i,n){return this._tick++,this._activePath.ellipse(t,e,i,n,this._transform.clone()),this}circle(t,e,i){return this._tick++,this._activePath.circle(t,e,i,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const i=this._transform;return this._activePath.lineTo(i.a*t+i.c*e+i.tx,i.b*t+i.d*e+i.ty),this}moveTo(t,e){this._tick++;const i=this._transform,n=this._activePath.instructions,r=i.a*t+i.c*e+i.tx,a=i.b*t+i.d*e+i.ty;return n.length===1&&n[0].action==="moveTo"?(n[0].data[0]=r,n[0].data[1]=a,this):(this._activePath.moveTo(r,a),this)}quadraticCurveTo(t,e,i,n,r){this._tick++;const a=this._transform;return this._activePath.quadraticCurveTo(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,a.a*i+a.c*n+a.tx,a.b*i+a.d*n+a.ty,r),this}rect(t,e,i,n){return this._tick++,this._activePath.rect(t,e,i,n,this._transform.clone()),this}roundRect(t,e,i,n,r){return this._tick++,this._activePath.roundRect(t,e,i,n,r,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,i,n,r=0,a){return this._tick++,this._activePath.regularPoly(t,e,i,n,r,a),this}roundPoly(t,e,i,n,r,a){return this._tick++,this._activePath.roundPoly(t,e,i,n,r,a),this}roundShape(t,e,i,n){return this._tick++,this._activePath.roundShape(t,e,i,n),this}filletRect(t,e,i,n,r){return this._tick++,this._activePath.filletRect(t,e,i,n,r),this}chamferRect(t,e,i,n,r,a){return this._tick++,this._activePath.chamferRect(t,e,i,n,r,a),this}star(t,e,i,n,r=0,a=0){return this._tick++,this._activePath.star(t,e,i,n,r,a,this._transform.clone()),this}svg(t){return this._tick++,lm(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,i,n,r,a){return t instanceof U?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,i,n,r,a),this)}transform(t,e,i,n,r,a){return t instanceof U?(this._transform.append(t),this):(po.set(t,e,i,n,r,a),this._transform.append(po),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const i=this.instructions[e],n=i.action;if(n==="fill"){const r=i.data;t.addBounds(r.path.bounds)}else if(n==="texture"){const r=i.data;t.addFrame(r.dx,r.dy,r.dx+r.dw,r.dy+r.dh,r.transform)}if(n==="stroke"){const r=i.data,a=r.style.alignment,o=r.style.width*(1-a),h=r.path.bounds;t.addFrame(h.minX-o,h.minY-o,h.maxX+o,h.maxY+o)}}return t}containsPoint(t){var n;if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let i=!1;for(let r=0;r<e.length;r++){const a=e[r],o=a.data,h=o.path;if(!a.action||!h)continue;const l=o.style,c=h.shapePath.shapePrimitives;for(let u=0;u<c.length;u++){const d=c[u].shape;if(!l||!d)continue;const f=c[u].transform,p=f?f.applyInverse(t,mm):t;if(a.action==="fill")i=d.contains(p.x,p.y);else{const m=l;i=d.strokeContains(p.x,p.y,m.width,m.alignment)}const g=o.hole;if(g){const m=(n=g.shapePath)==null?void 0:n.shapePrimitives;if(m)for(let y=0;y<m.length;y++)m[y].shape.contains(p.x,p.y)&&(i=!1)}if(i)return!0}}return i}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(i),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(i)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Er.defaultFillStyle={color:16777215,alpha:1,texture:L.WHITE,matrix:null,fill:null,textureSpace:"local"};Er.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:L.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let bt=Er;const mo=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function gm(s){const t=[];let e=0;for(let i=0;i<mo.length;i++){const n=`_${mo[i]}`;t[e++]=s[n]}return e=Dl(s._fill,t,e),e=_m(s._stroke,t,e),e=xm(s.dropShadow,t,e),e=ym(s.filters,t,e),t.join("-")}function ym(s,t,e){if(!s)return e;for(const i of s)t[e++]=i.uid;return e}function Dl(s,t,e){var i;return s&&(t[e++]=s.color,t[e++]=s.alpha,t[e++]=(i=s.fill)==null?void 0:i.styleKey),e}function _m(s,t,e){return s&&(e=Dl(s,t,e),t[e++]=s.width,t[e++]=s.alignment,t[e++]=s.cap,t[e++]=s.join,t[e++]=s.miterLimit),e}function xm(s,t,e){return s&&(t[e++]=s.alpha,t[e++]=s.angle,t[e++]=s.blur,t[e++]=s.distance,t[e++]=nt.shared.setValue(s.color).toNumber()),e}const kr=class Fe extends gt{constructor(t={}){super(),bm(t);const e={...Fe.defaultTextStyle,...t};for(const i in e){const n=i;this[n]=e[i]}this.update()}get align(){return this._align}set align(t){this._align=t,this.update()}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords=t,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(t){t!==null&&typeof t=="object"?this._dropShadow=this._createProxy({...Fe.defaultDropShadow,...t}):this._dropShadow=t?this._createProxy({...Fe.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t,this.update()}get fontSize(){return this._fontSize}set fontSize(t){typeof t=="string"?this._fontSize=parseInt(t,10):this._fontSize=t,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t,this.update()}get leading(){return this._leading}set leading(t){this._leading=t,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing=t,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t,this.update()}get padding(){return this._padding}set padding(t){this._padding=t,this.update()}get filters(){return this._filters}set filters(t){this._filters=t,this.update()}get trim(){return this._trim}set trim(t){this._trim=t,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace=t,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap=t,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth=t,this.update()}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._isFillStyle(t)&&(this._originalFill=this._createProxy({...bt.defaultFillStyle,...t},()=>{this._fill=_e({...this._originalFill},bt.defaultFillStyle)})),this._fill=_e(t===0?"black":t,bt.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._isFillStyle(t)&&(this._originalStroke=this._createProxy({...bt.defaultStrokeStyle,...t},()=>{this._stroke=Ci({...this._originalStroke},bt.defaultStrokeStyle)})),this._stroke=Ci(t,bt.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=gm(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const t=Fe.defaultTextStyle;for(const e in t)this[e]=t[e]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new Fe({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let t=0;if(this._filters)for(let e=0;e<this._filters.length;e++)t+=this._filters[e].padding;return Math.max(this._padding,t)}destroy(t=!1){var i,n,r,a;if(this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const o=typeof t=="boolean"?t:t==null?void 0:t.textureSource;(i=this._fill)!=null&&i.texture&&this._fill.texture.destroy(o),(n=this._originalFill)!=null&&n.texture&&this._originalFill.texture.destroy(o),(r=this._stroke)!=null&&r.texture&&this._stroke.texture.destroy(o),(a=this._originalStroke)!=null&&a.texture&&this._originalStroke.texture.destroy(o)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(t,e){return new Proxy(t,{set:(i,n,r)=>(i[n]=r,e==null||e(n,r),this.update(),!0)})}_isFillStyle(t){return(t??null)!==null&&!(nt.isColorLike(t)||t instanceof Yt||t instanceof Di)}};kr.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};kr.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Ye=kr;function bm(s){const t=s;if(typeof t.dropShadow=="boolean"&&t.dropShadow){const e=Ye.defaultDropShadow;s.dropShadow={alpha:t.dropShadowAlpha??e.alpha,angle:t.dropShadowAngle??e.angle,blur:t.dropShadowBlur??e.blur,color:t.dropShadowColor??e.color,distance:t.dropShadowDistance??e.distance}}if(t.strokeThickness!==void 0){N(W,"strokeThickness is now a part of stroke");const e=t.stroke;let i={};if(nt.isColorLike(e))i.color=e;else if(e instanceof Yt||e instanceof Di)i.fill=e;else if(Object.hasOwnProperty.call(e,"color")||Object.hasOwnProperty.call(e,"fill"))i=e;else throw new Error("Invalid stroke value.");s.stroke={...i,width:t.strokeThickness}}if(Array.isArray(t.fillGradientStops)){N(W,"gradient fill is now a fill pattern: `new FillGradient(...)`");let e;s.fontSize==null?s.fontSize=Ye.defaultTextStyle.fontSize:typeof s.fontSize=="string"?e=parseInt(s.fontSize,10):e=s.fontSize;const i=new Yt({start:{x:0,y:0},end:{x:0,y:(e||0)*1.7}}),n=t.fillGradientStops.map(r=>nt.shared.setValue(r).toNumber());n.forEach((r,a)=>{const o=a/(n.length-1);i.addColorStop(o,r)}),s.fill={fill:i}}}class wm{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,e){const i=Z.get().createCanvas();i.width=t,i.height=e;const n=i.getContext("2d");return{canvas:i,context:n}}getOptimalCanvasAndContext(t,e,i=1){t=Math.ceil(t*i-1e-6),e=Math.ceil(e*i-1e-6),t=We(t),e=We(e);const n=(t<<17)+(e<<1);this._canvasPool[n]||(this._canvasPool[n]=[]);let r=this._canvasPool[n].pop();return r||(r=this._createCanvasAndContext(t,e)),r}returnCanvasAndContext(t){const e=t.canvas,{width:i,height:n}=e,r=(i<<17)+(n<<1);t.context.resetTransform(),t.context.clearRect(0,0,i,n),this._canvasPool[r].push(t)}clear(){this._canvasPool={}}}const Si=new wm,go=1e5;function Ai(s,t,e,i=0){if(s.texture===L.WHITE&&!s.fill)return nt.shared.setValue(s.color).setAlpha(s.alpha??1).toHexa();if(s.fill){if(s.fill instanceof Di){const n=s.fill,r=t.createPattern(n.texture.source.resource,"repeat"),a=n.transform.copyTo(U.shared);return a.scale(n.texture.frame.width,n.texture.frame.height),r.setTransform(a),r}else if(s.fill instanceof Yt){const n=s.fill,r=n.type==="linear",a=n.textureSpace==="local";let o=1,h=1;a&&e&&(o=e.width+i,h=e.height+i);let l,c=!1;if(r){const{start:u,end:d}=n;l=t.createLinearGradient(u.x*o,u.y*h,d.x*o,d.y*h),c=Math.abs(d.x-u.x)<Math.abs((d.y-u.y)*.1)}else{const{center:u,innerRadius:d,outerCenter:f,outerRadius:p}=n;l=t.createRadialGradient(u.x*o,u.y*h,d*o,f.x*o,f.y*h,p*o)}if(c&&a&&e){const u=e.lineHeight/h;for(let d=0;d<e.lines.length;d++){const f=(d*e.lineHeight+i/2)/h;n.colorStops.forEach(p=>{const g=f+p.offset*u;l.addColorStop(Math.floor(g*go)/go,nt.shared.setValue(p.color).toHex())})}}else n.colorStops.forEach(u=>{l.addColorStop(u.offset,nt.shared.setValue(u.color).toHex())});return l}}else{const n=t.createPattern(s.texture.source.resource,"repeat"),r=s.matrix.copyTo(U.shared);return r.scale(s.texture.frame.width,s.texture.frame.height),n.setTransform(r),n}return Y("FillStyle not recognised",s),"red"}const Nl=class Ul extends _l{constructor(t){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentMaxCharHeight=0,this._currentPageIndex=-1,this._skipKerning=!1;const e={...Ul.defaultOptions,...t};this._textureSize=e.textureSize,this._mipmap=e.mipmap;const i=e.style.clone();e.overrideFill&&(i._fill.color=16777215,i._fill.alpha=1,i._fill.texture=L.WHITE,i._fill.fill=null),this.applyFillAsTint=e.overrideFill;const n=i.fontSize;i.fontSize=this.baseMeasurementFontSize;const r=vi(i);e.overrideSize?i._stroke&&(i._stroke.width*=this.baseRenderedFontSize/n):i.fontSize=this.baseRenderedFontSize=n,this._style=i,this._skipKerning=e.skipKerning??!1,this.resolution=e.resolution??1,this._padding=e.padding??4,e.textureStyle&&(this._textureStyle=e.textureStyle instanceof Ge?e.textureStyle:new Ge(e.textureStyle)),this.fontMetrics=Lt.measureFont(r),this.lineHeight=i.lineHeight||this.fontMetrics.fontSize||i.fontSize}ensureCharacters(t){var m,y;const e=Lt.graphemeSegmenter(t).filter(_=>!this._currentChars.includes(_)).filter((_,x,b)=>b.indexOf(_)===x);if(!e.length)return;this._currentChars=[...this._currentChars,...e];let i;this._currentPageIndex===-1?i=this._nextPage():i=this.pages[this._currentPageIndex];let{canvas:n,context:r}=i.canvasAndContext,a=i.texture.source;const o=this._style;let h=this._currentX,l=this._currentY,c=this._currentMaxCharHeight;const u=this.baseRenderedFontSize/this.baseMeasurementFontSize,d=this._padding*u;let f=!1;const p=n.width/this.resolution,g=n.height/this.resolution;for(let _=0;_<e.length;_++){const x=e[_],b=Lt.measureText(x,o,n,!1);b.lineHeight=b.height;const S=b.width*u,w=Math.ceil((o.fontStyle==="italic"?2:1)*S),v=b.height*u,T=w+d*2,k=v+d*2;if(f=!1,x!==`
`&&x!=="\r"&&x!=="	"&&x!==" "&&(f=!0,c=Math.ceil(Math.max(k,c))),h+T>p&&(l+=c,c=k,h=0,l+c>g)){a.update();const E=this._nextPage();n=E.canvasAndContext.canvas,r=E.canvasAndContext.context,a=E.texture.source,h=0,l=0,c=0}const M=S/u-(((m=o.dropShadow)==null?void 0:m.distance)??0)-(((y=o._stroke)==null?void 0:y.width)??0);if(this.chars[x]={id:x.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:M,kerning:{}},f){this._drawGlyph(r,b,h+d,l+d,u,o);const E=a.width*u,z=a.height*u,B=new j(h/E*a.width,l/z*a.height,T/E*a.width,k/z*a.height);this.chars[x].texture=new L({source:a,frame:B}),h+=Math.ceil(T)}}a.update(),this._currentX=h,this._currentY=l,this._currentMaxCharHeight=c,this._skipKerning&&this._applyKerning(e,r)}get pageTextures(){return N(W,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(t,e){const i=this._measureCache;for(let n=0;n<t.length;n++){const r=t[n];for(let a=0;a<this._currentChars.length;a++){const o=this._currentChars[a];let h=i[r];h||(h=i[r]=e.measureText(r).width);let l=i[o];l||(l=i[o]=e.measureText(o).width);let c=e.measureText(r+o).width,u=c-(h+l);u&&(this.chars[r].kerning[o]=u),c=e.measureText(r+o).width,u=c-(h+l),u&&(this.chars[o].kerning[r]=u)}}}_nextPage(){this._currentPageIndex++;const t=this.resolution,e=Si.getOptimalCanvasAndContext(this._textureSize,this._textureSize,t);this._setupContext(e.context,this._style,t);const i=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),n=new L({source:new Se({resource:e.canvas,resolution:i,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})});this._textureStyle&&(n.source.style=this._textureStyle);const r={canvasAndContext:e,texture:n};return this.pages[this._currentPageIndex]=r,r}_setupContext(t,e,i){e.fontSize=this.baseRenderedFontSize,t.scale(i,i),t.font=vi(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;const n=e._stroke,r=(n==null?void 0:n.width)??0;if(n&&(t.lineWidth=r,t.lineJoin=n.join,t.miterLimit=n.miterLimit,t.strokeStyle=Ai(n,t)),e._fill&&(t.fillStyle=Ai(e._fill,t)),e.dropShadow){const a=e.dropShadow,o=nt.shared.setValue(a.color).toArray(),h=a.blur*i,l=a.distance*i;t.shadowColor=`rgba(${o[0]*255},${o[1]*255},${o[2]*255},${a.alpha})`,t.shadowBlur=h,t.shadowOffsetX=Math.cos(a.angle)*l,t.shadowOffsetY=Math.sin(a.angle)*l}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}_drawGlyph(t,e,i,n,r,a){const o=e.text,h=e.fontProperties,l=a._stroke,c=((l==null?void 0:l.width)??0)*r,u=i+c/2,d=n-c/2,f=h.descent*r,p=e.lineHeight*r;let g=!1;a.stroke&&c&&(g=!0,t.strokeText(o,u,d+p-f));const{shadowBlur:m,shadowOffsetX:y,shadowOffsetY:_}=t;a._fill&&(g&&(t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),t.fillText(o,u,d+p-f)),g&&(t.shadowBlur=m,t.shadowOffsetX=y,t.shadowOffsetY=_)}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{canvasAndContext:e,texture:i}=this.pages[t];Si.returnCanvasAndContext(e),i.destroy(!0)}this.pages=null}};Nl.defaultOptions={textureSize:512,style:new Ye,mipmap:!0};let yo=Nl;function vm(s,t,e,i){const n={width:0,height:0,offsetY:0,scale:t.fontSize/e.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};n.offsetY=e.baseLineOffset;let r=n.lines[0],a=null,o=!0;const h={width:0,start:0,index:0,positions:[],chars:[]},l=m=>{const y=r.width;for(let _=0;_<h.index;_++){const x=m.positions[_];r.chars.push(m.chars[_]),r.charPositions.push(x+y)}r.width+=m.width,o=!1,h.width=0,h.index=0,h.chars.length=0},c=()=>{let m=r.chars.length-1;if(i){let y=r.chars[m];for(;y===" ";)r.width-=e.chars[y].xAdvance,y=r.chars[--m]}n.width=Math.max(n.width,r.width),r={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},o=!0,n.lines.push(r),n.height+=e.lineHeight},u=e.baseMeasurementFontSize/t.fontSize,d=t.letterSpacing*u,f=t.wordWrapWidth*u,p=t.wordWrap&&t.breakWords,g=m=>m-d>f;for(let m=0;m<s.length+1;m++){let y;const _=m===s.length;_||(y=s[m]);const x=e.chars[y]||e.chars[" "];if(/(?:\s)/.test(y)||y==="\r"||y===`
`||_){if(!o&&t.wordWrap&&g(r.width+h.width)?(c(),l(h),_||r.charPositions.push(0)):(h.start=r.width,l(h),_||r.charPositions.push(0)),y==="\r"||y===`
`)r.width!==0&&c();else if(!_){const v=x.xAdvance+(x.kerning[a]||0)+d;r.width+=v,r.spaceWidth=v,r.spacesIndex.push(r.charPositions.length),r.chars.push(y)}}else{const w=x.kerning[a]||0,v=x.xAdvance+w+d;p&&g(r.width+h.width+v)&&(l(h),c()),h.positions[h.index++]=h.width+w,h.chars.push(y),h.width+=v}a=y}return c(),t.align==="center"?Cm(n):t.align==="right"?Sm(n):t.align==="justify"&&Am(n),n}function Cm(s){for(let t=0;t<s.lines.length;t++){const e=s.lines[t],i=s.width/2-e.width/2;for(let n=0;n<e.charPositions.length;n++)e.charPositions[n]+=i}}function Sm(s){for(let t=0;t<s.lines.length;t++){const e=s.lines[t],i=s.width-e.width;for(let n=0;n<e.charPositions.length;n++)e.charPositions[n]+=i}}function Am(s){const t=s.width;for(let e=0;e<s.lines.length;e++){const i=s.lines[e];let n=0,r=i.spacesIndex[n++],a=0;const o=i.spacesIndex.length,l=(t-i.width)/o;for(let c=0;c<i.charPositions.length;c++)c===r&&(r=i.spacesIndex[n++],a+=l),i.charPositions[c]+=a}}function Tm(s){if(s==="")return[];typeof s=="string"&&(s=[s]);const t=[];for(let e=0,i=s.length;e<i;e++){const n=s[e];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);if(n[0].length===0||n[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const r=n[0].charCodeAt(0),a=n[1].charCodeAt(0);if(a<r)throw new Error("[BitmapFont]: Invalid character range.");for(let o=r,h=a;o<=h;o++)t.push(String.fromCharCode(o))}else t.push(...Array.from(n))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}let li=0;class Pm{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null}}getFont(t,e){var a;let i=`${e.fontFamily}-bitmap`,n=!0;if(e._fill.fill&&!e._stroke)i+=e._fill.fill.styleKey,n=!1;else if(e._stroke||e.dropShadow){let o=e.styleKey;o=o.substring(0,o.lastIndexOf("-")),i=`${o}-bitmap`,n=!1}if(!et.has(i)){const o=new yo({style:e,overrideFill:n,overrideSize:!0,...this.defaultOptions});li++,li>50&&Y("BitmapText",`You have dynamically created ${li} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),o.once("destroy",()=>{li--,et.remove(i)}),et.set(i,o)}const r=et.get(i);return(a=r.ensureCharacters)==null||a.call(r,t),r}getLayout(t,e,i=!0){const n=this.getFont(t,e),r=Lt.graphemeSegmenter(t);return vm(r,e,n,i)}measureText(t,e,i=!0){return this.getLayout(t,e,i)}install(...t){var l,c,u,d;let e=t[0];typeof e=="string"&&(e={name:e,style:t[1],chars:(l=t[2])==null?void 0:l.chars,resolution:(c=t[2])==null?void 0:c.resolution,padding:(u=t[2])==null?void 0:u.padding,skipKerning:(d=t[2])==null?void 0:d.skipKerning},N(W,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const i=e==null?void 0:e.name;if(!i)throw new Error("[BitmapFontManager] Property `name` is required.");e={...this.defaultOptions,...e};const n=e.style,r=n instanceof Ye?n:new Ye(n),a=r._fill.fill!==null&&r._fill.fill!==void 0,o=new yo({style:r,overrideFill:a,skipKerning:e.skipKerning,padding:e.padding,resolution:e.resolution,overrideSize:!1,textureStyle:e.textureStyle}),h=Tm(e.chars);return o.ensureCharacters(h.join("")),et.set(`${i}-bitmap`,o),o.once("destroy",()=>et.remove(`${i}-bitmap`)),o}uninstall(t){const e=`${t}-bitmap`,i=et.get(e);i&&i.destroy()}}const _o=new Pm;class zl extends _l{constructor(t,e){super();const{textures:i,data:n}=t;Object.keys(n.pages).forEach(r=>{const a=n.pages[parseInt(r,10)],o=i[a.id];this.pages.push({texture:o})}),Object.keys(n.chars).forEach(r=>{const a=n.chars[r],{frame:o,source:h}=i[a.page],l=new j(a.x+o.x,a.y+o.y,a.width,a.height),c=new L({source:h,frame:l});this.chars[r]={id:r.codePointAt(0),xOffset:a.xOffset,yOffset:a.yOffset,xAdvance:a.xAdvance,kerning:a.kerning??{},texture:c}}),this.baseRenderedFontSize=n.fontSize,this.baseMeasurementFontSize=n.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:n.fontSize},this.baseLineOffset=n.baseLineOffset,this.lineHeight=n.lineHeight,this.fontFamily=n.fontFamily,this.distanceField=n.distanceField??{type:"none",range:0},this.url=e}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{texture:e}=this.pages[t];e.destroy(!0)}this.pages=null}static install(t){_o.install(t)}static uninstall(t){_o.uninstall(t)}}const vn={test(s){return typeof s=="string"&&s.startsWith("info face=")},parse(s){const t=s.match(/^[a-z]+\s+.+$/gm),e={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const u in t){const d=t[u].match(/^[a-z]+/gm)[0],f=t[u].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),p={};for(const g in f){const m=f[g].split("="),y=m[0],_=m[1].replace(/"/gm,""),x=parseFloat(_),b=isNaN(x)?_:x;p[y]=b}e[d].push(p)}const i={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[n]=e.info,[r]=e.common,[a]=e.distanceField??[];a&&(i.distanceField={range:parseInt(a.distanceRange,10),type:a.fieldType}),i.fontSize=parseInt(n.size,10),i.fontFamily=n.face,i.lineHeight=parseInt(r.lineHeight,10);const o=e.page;for(let u=0;u<o.length;u++)i.pages.push({id:parseInt(o[u].id,10)||0,file:o[u].file});const h={};i.baseLineOffset=i.lineHeight-parseInt(r.base,10);const l=e.char;for(let u=0;u<l.length;u++){const d=l[u],f=parseInt(d.id,10);let p=d.letter??d.char??String.fromCharCode(f);p==="space"&&(p=" "),h[f]=p,i.chars[p]={id:f,page:parseInt(d.page,10)||0,x:parseInt(d.x,10),y:parseInt(d.y,10),width:parseInt(d.width,10),height:parseInt(d.height,10),xOffset:parseInt(d.xoffset,10),yOffset:parseInt(d.yoffset,10),xAdvance:parseInt(d.xadvance,10),kerning:{}}}const c=e.kerning||[];for(let u=0;u<c.length;u++){const d=parseInt(c[u].first,10),f=parseInt(c[u].second,10),p=parseInt(c[u].amount,10);i.chars[h[f]].kerning[h[d]]=p}return i}},xo={test(s){const t=s;return typeof t!="string"&&"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(s){const t={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},e=s.getElementsByTagName("info")[0],i=s.getElementsByTagName("common")[0],n=s.getElementsByTagName("distanceField")[0];n&&(t.distanceField={type:n.getAttribute("fieldType"),range:parseInt(n.getAttribute("distanceRange"),10)});const r=s.getElementsByTagName("page"),a=s.getElementsByTagName("char"),o=s.getElementsByTagName("kerning");t.fontSize=parseInt(e.getAttribute("size"),10),t.fontFamily=e.getAttribute("face"),t.lineHeight=parseInt(i.getAttribute("lineHeight"),10);for(let l=0;l<r.length;l++)t.pages.push({id:parseInt(r[l].getAttribute("id"),10)||0,file:r[l].getAttribute("file")});const h={};t.baseLineOffset=t.lineHeight-parseInt(i.getAttribute("base"),10);for(let l=0;l<a.length;l++){const c=a[l],u=parseInt(c.getAttribute("id"),10);let d=c.getAttribute("letter")??c.getAttribute("char")??String.fromCharCode(u);d==="space"&&(d=" "),h[u]=d,t.chars[d]={id:u,page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xOffset:parseInt(c.getAttribute("xoffset"),10),yOffset:parseInt(c.getAttribute("yoffset"),10),xAdvance:parseInt(c.getAttribute("xadvance"),10),kerning:{}}}for(let l=0;l<o.length;l++){const c=parseInt(o[l].getAttribute("first"),10),u=parseInt(o[l].getAttribute("second"),10),d=parseInt(o[l].getAttribute("amount"),10);t.chars[h[u]].kerning[h[c]]=d}return t}},bo={test(s){return typeof s=="string"&&s.includes("<font>")?xo.test(Z.get().parseXML(s)):!1},parse(s){return xo.parse(Z.get().parseXML(s))}},Mm=[".xml",".fnt"],Em={extension:{type:I.CacheParser,name:"cacheBitmapFont"},test:s=>s instanceof zl,getCacheableAssets(s,t){const e={};return s.forEach(i=>{e[i]=t,e[`${i}-bitmap`]=t}),e[`${t.fontFamily}-bitmap`]=t,e}},km={extension:{type:I.LoadParser,priority:qt.Normal},name:"loadBitmapFont",test(s){return Mm.includes(ut.extname(s).toLowerCase())},async testParse(s){return vn.test(s)||bo.test(s)},async parse(s,t,e){const i=vn.test(s)?vn.parse(s):bo.parse(s),{src:n}=t,{pages:r}=i,a=[],o=i.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let u=0;u<r.length;++u){const d=r[u].file;let f=ut.join(ut.dirname(n),d);f=Ln(f,n),a.push({src:f,data:o})}const h=await e.load(a),l=a.map(u=>h[u.src]);return new zl({data:i,textures:l},n)},async load(s,t){return await(await Z.get().fetch(s)).text()},async unload(s,t,e){await Promise.all(s.pages.map(i=>e.unload(i.texture.source._sourceOrigin))),s.destroy()}};class Im{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<e;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}const Rm={extension:{type:I.CacheParser,name:"cacheTextureArray"},test:s=>Array.isArray(s)&&s.every(t=>t instanceof L),getCacheableAssets:(s,t)=>{const e={};return s.forEach(i=>{t.forEach((n,r)=>{e[i+(r===0?"":r+1)]=n})}),e}};async function Wl(s){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=s});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(s)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const Fm={extension:{type:I.DetectionParser,priority:1},test:async()=>Wl("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async s=>[...s,"avif"],remove:async s=>s.filter(t=>t!=="avif")},wo=["png","jpg","jpeg"],Vm={extension:{type:I.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async s=>[...s,...wo],remove:async s=>s.filter(t=>!wo.includes(t))},Bm="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Ir(s){return Bm?!1:document.createElement("video").canPlayType(s)!==""}const Om={extension:{type:I.DetectionParser,priority:0},test:async()=>Ir("video/mp4"),add:async s=>[...s,"mp4","m4v"],remove:async s=>s.filter(t=>t!=="mp4"&&t!=="m4v")},Lm={extension:{type:I.DetectionParser,priority:0},test:async()=>Ir("video/ogg"),add:async s=>[...s,"ogv"],remove:async s=>s.filter(t=>t!=="ogv")},Dm={extension:{type:I.DetectionParser,priority:0},test:async()=>Ir("video/webm"),add:async s=>[...s,"webm"],remove:async s=>s.filter(t=>t!=="webm")},Nm={extension:{type:I.DetectionParser,priority:0},test:async()=>Wl("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async s=>[...s,"webp"],remove:async s=>s.filter(t=>t!=="webp")};class Um{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,i)=>(this._parsersValidated=!1,t[e]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const i={promise:null,parser:null};return i.promise=(async()=>{var a,o;let n=null,r=null;if(e.loadParser&&(r=this._parserHash[e.loadParser],r||Y(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!r){for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];if(l.load&&((a=l.test)!=null&&a.call(l,t,e,this))){r=l;break}}if(!r)return Y(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await r.load(t,e,this),i.parser=r;for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];l.parse&&l.parse&&await((o=l.testParse)==null?void 0:o.call(l,n,e,this))&&(n=await l.parse(n,e,this)||n,i.parser=l)}return n})(),i}async load(t,e){this._parsersValidated||this._validateParsers();let i=0;const n={},r=wi(t),a=Et(t,l=>({alias:[l],src:l,data:{}})),o=a.length,h=a.map(async l=>{const c=ut.toAbsolute(l.src);if(!n[l.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,l)),n[l.src]=await this.promiseCache[c].promise,e&&e(++i/o)}catch(u){throw delete this.promiseCache[c],delete n[l.src],new Error(`[Loader.load] Failed to load ${c}.
${u}`)}});return await Promise.all(h),r?n[a[0].src]:n}async unload(t){const i=Et(t,n=>({alias:[n],src:n})).map(async n=>{var o,h;const r=ut.toAbsolute(n.src),a=this.promiseCache[r];if(a){const l=await a.promise;delete this.promiseCache[r],await((h=(o=a.parser)==null?void 0:o.unload)==null?void 0:h.call(o,l,n,this))}});await Promise.all(i)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(e.name?t[e.name]&&Y(`[Assets] loadParser name conflict "${e.name}"`):Y("[Assets] loadParser should have a name"),{...t,[e.name]:e}),{})}}function Ze(s,t){if(Array.isArray(t)){for(const e of t)if(s.startsWith(`data:${e}`))return!0;return!1}return s.startsWith(`data:${t}`)}function Qe(s,t){const e=s.split("?")[0],i=ut.extname(e).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}const zm=".json",Wm="application/json",Gm={extension:{type:I.LoadParser,priority:qt.Low},name:"loadJson",test(s){return Ze(s,Wm)||Qe(s,zm)},async load(s){return await(await Z.get().fetch(s)).json()}},Hm=".txt",$m="text/plain",jm={name:"loadTxt",extension:{type:I.LoadParser,priority:qt.Low,name:"loadTxt"},test(s){return Ze(s,$m)||Qe(s,Hm)},async load(s){return await(await Z.get().fetch(s)).text()}},Ym=["normal","bold","100","200","300","400","500","600","700","800","900"],Xm=[".ttf",".otf",".woff",".woff2"],Km=["font/ttf","font/otf","font/woff","font/woff2"],qm=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function Zm(s){const t=ut.extname(s),n=ut.basename(s,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1));let r=n.length>0;for(const o of n)if(!o.match(qm)){r=!1;break}let a=n.join(" ");return r||(a=`"${a.replace(/[\\"]/g,"\\$&")}"`),a}const Qm=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function Jm(s){return Qm.test(s)?s:encodeURI(s)}const tg={extension:{type:I.LoadParser,priority:qt.Low},name:"loadWebFont",test(s){return Ze(s,Km)||Qe(s,Xm)},async load(s,t){var i,n,r;const e=Z.get().getFontFaceSet();if(e){const a=[],o=((i=t.data)==null?void 0:i.family)??Zm(s),h=((r=(n=t.data)==null?void 0:n.weights)==null?void 0:r.filter(c=>Ym.includes(c)))??["normal"],l=t.data??{};for(let c=0;c<h.length;c++){const u=h[c],d=new FontFace(o,`url(${Jm(s)})`,{...l,weight:u});await d.load(),e.add(d),a.push(d)}return et.set(`${o}-and-url`,{url:s,fontFaces:a}),a.length===1?a[0]:a}return Y("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(s){(Array.isArray(s)?s:[s]).forEach(t=>{et.remove(`${t.family}-and-url`),Z.get().getFontFaceSet().delete(t)})}};function Rr(s,t=1){var i;const e=(i=Ke.RETINA_PREFIX)==null?void 0:i.exec(s);return e?parseFloat(e[1]):t}function Fr(s,t,e){s.label=e,s._sourceOrigin=e;const i=new L({source:s,label:e}),n=()=>{delete t.promiseCache[e],et.has(e)&&et.remove(e)};return i.source.once("destroy",()=>{t.promiseCache[e]&&(Y("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),n())}),i.once("destroy",()=>{s.destroyed||(Y("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),n())}),i}const eg=".svg",sg="image/svg+xml",ig={extension:{type:I.LoadParser,priority:qt.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(s){return Ze(s,sg)||Qe(s,eg)},async load(s,t,e){var i;return((i=t.data)==null?void 0:i.parseAsGraphicsContext)??this.config.parseAsGraphicsContext?rg(s):ng(s,t,e,this.config.crossOrigin)},unload(s){s.destroy(!0)}};async function ng(s,t,e,i){var m,y,_;const r=await(await Z.get().fetch(s)).blob(),a=URL.createObjectURL(r),o=new Image;o.src=a,o.crossOrigin=i,await o.decode(),URL.revokeObjectURL(a);const h=document.createElement("canvas"),l=h.getContext("2d"),c=((m=t.data)==null?void 0:m.resolution)||Rr(s),u=((y=t.data)==null?void 0:y.width)??o.width,d=((_=t.data)==null?void 0:_.height)??o.height;h.width=u*c,h.height=d*c,l.drawImage(o,0,0,u*c,d*c);const{parseAsGraphicsContext:f,...p}=t.data??{},g=new Se({resource:h,alphaMode:"premultiply-alpha-on-upload",resolution:c,...p});return Fr(g,e,s)}async function rg(s){const e=await(await Z.get().fetch(s)).text(),i=new bt;return i.svg(e),i}const ag=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let Ne=null,Zn=class{constructor(){Ne||(Ne=URL.createObjectURL(new Blob([ag],{type:"application/javascript"}))),this.worker=new Worker(Ne)}};Zn.revokeObjectURL=function(){Ne&&(URL.revokeObjectURL(Ne),Ne=null)};const og=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let Ue=null;class Gl{constructor(){Ue||(Ue=URL.createObjectURL(new Blob([og],{type:"application/javascript"}))),this.worker=new Worker(Ue)}}Gl.revokeObjectURL=function(){Ue&&(URL.revokeObjectURL(Ue),Ue=null)};let vo=0,Cn;class hg{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new Zn;e.addEventListener("message",i=>{e.terminate(),Zn.revokeObjectURL(),t(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t,e){var i;return this._run("loadImageBitmap",[t,(i=e==null?void 0:e.data)==null?void 0:i.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){Cn===void 0&&(Cn=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<Cn&&(this._createdWorkers++,t=new Gl().worker,t.addEventListener("message",e=>{this._complete(e.data),this._returnWorker(e.target),this._next()})),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){t.error!==void 0?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),this._resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const i=new Promise((n,r)=>{this._queue.push({id:t,arguments:e,resolve:n,reject:r})});return this._next(),i}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const e=this._queue.pop(),i=e.id;this._resolveHash[vo]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:vo++,id:i})}}const Co=new hg,lg=[".jpeg",".jpg",".png",".webp",".avif"],cg=["image/jpeg","image/png","image/webp","image/avif"];async function ug(s,t){var n;const e=await Z.get().fetch(s);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${s}: ${e.status} ${e.statusText}`);const i=await e.blob();return((n=t==null?void 0:t.data)==null?void 0:n.alphaMode)==="premultiplied-alpha"?createImageBitmap(i,{premultiplyAlpha:"none"}):createImageBitmap(i)}const Hl={name:"loadTextures",extension:{type:I.LoadParser,priority:qt.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(s){return Ze(s,cg)||Qe(s,lg)},async load(s,t,e){var r;let i=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Co.isImageBitmapSupported()?i=await Co.loadImageBitmap(s,t):i=await ug(s,t):i=await new Promise((a,o)=>{i=new Image,i.crossOrigin=this.config.crossOrigin,i.src=s,i.complete?a(i):(i.onload=()=>{a(i)},i.onerror=o)});const n=new Se({resource:i,alphaMode:"premultiply-alpha-on-upload",resolution:((r=t.data)==null?void 0:r.resolution)||Rr(s),...t.data});return Fr(n,e,s)},unload(s){s.destroy(!0)}},$l=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],dg=$l.map(s=>`video/${s.substring(1)}`);function fg(s,t,e){e===void 0&&!t.startsWith("data:")?s.crossOrigin=mg(t):e!==!1&&(s.crossOrigin=typeof e=="string"?e:"anonymous")}function pg(s){return new Promise((t,e)=>{s.addEventListener("canplaythrough",i),s.addEventListener("error",n),s.load();function i(){r(),t()}function n(a){r(),e(a)}function r(){s.removeEventListener("canplaythrough",i),s.removeEventListener("error",n)}})}function mg(s,t=globalThis.location){if(s.startsWith("data:"))return"";t||(t=globalThis.location);const e=new URL(s,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}const gg={name:"loadVideo",extension:{type:I.LoadParser,name:"loadVideo"},test(s){const t=Ze(s,dg),e=Qe(s,$l);return t||e},async load(s,t,e){var h,l;const i={...pi.defaultOptions,resolution:((h=t.data)==null?void 0:h.resolution)||Rr(s),alphaMode:((l=t.data)==null?void 0:l.alphaMode)||await $h(),...t.data},n=document.createElement("video"),r={preload:i.autoLoad!==!1?"auto":void 0,"webkit-playsinline":i.playsinline!==!1?"":void 0,playsinline:i.playsinline!==!1?"":void 0,muted:i.muted===!0?"":void 0,loop:i.loop===!0?"":void 0,autoplay:i.autoPlay!==!1?"":void 0};Object.keys(r).forEach(c=>{const u=r[c];u!==void 0&&n.setAttribute(c,u)}),i.muted===!0&&(n.muted=!0),fg(n,s,i.crossorigin);const a=document.createElement("source");let o;if(s.startsWith("data:"))o=s.slice(5,s.indexOf(";"));else if(!s.startsWith("blob:")){const c=s.split("?")[0].slice(s.lastIndexOf(".")+1).toLowerCase();o=pi.MIME_TYPES[c]||`video/${c}`}return a.src=s,o&&(a.type=o),new Promise(c=>{const u=async()=>{const d=new pi({...i,resource:n});n.removeEventListener("canplay",u),t.data.preload&&await pg(n),c(Fr(d,e,s))};i.preload&&!i.autoPlay&&n.load(),n.addEventListener("canplay",u),n.appendChild(a)})},unload(s){s.destroy(!0)}},jl={extension:{type:I.ResolveParser,name:"resolveTexture"},test:Hl.test,parse:s=>{var t;return{resolution:parseFloat(((t=Ke.RETINA_PREFIX.exec(s))==null?void 0:t[1])??"1"),format:s.split(".").pop(),src:s}}},yg={extension:{type:I.ResolveParser,priority:-2,name:"resolveJson"},test:s=>Ke.RETINA_PREFIX.test(s)&&s.endsWith(".json"),parse:jl.parse};class _g{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Ke,this.loader=new Um,this.cache=et,this._backgroundLoader=new Im(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var r,a;if(this._initialized){Y("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let o=t.manifest;typeof o=="string"&&(o=await this.load(o)),this.resolver.addManifest(o)}const e=((r=t.texturePreference)==null?void 0:r.resolution)??1,i=typeof e=="number"?[e]:e,n=await this._detectFormats({preferredFormats:(a=t.texturePreference)==null?void 0:a.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:n,resolution:i}}),t.preferences&&this.setPreferences(t.preferences)}add(t){this.resolver.add(t)}async load(t,e){this._initialized||await this.init();const i=wi(t),n=Et(t).map(o=>{if(typeof o!="string"){const h=this.resolver.getAlias(o);return h.some(l=>!this.resolver.hasKey(l))&&this.add(o),Array.isArray(h)?h[0]:h}return this.resolver.hasKey(o)||this.add({alias:o,src:o}),o}),r=this.resolver.resolve(n),a=await this._mapLoadToResolve(r,e);return i?a[n[0]]:a}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);const n=this.resolver.resolveBundle(t),r={},a=Object.keys(n);let o=0,h=0;const l=()=>{e==null||e(++o/h)},c=a.map(u=>{const d=n[u];return h+=Object.keys(d).length,this._mapLoadToResolve(d,l).then(f=>{r[u]=f})});return await Promise.all(c),i?r[t[0]]:r}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return et.get(t);const e={};for(let i=0;i<t.length;i++)e[i]=et.get(t[i]);return e}async _mapLoadToResolve(t,e){const i=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const n=await this.loader.load(i,e);this._backgroundLoader.active=!0;const r={};return i.forEach(a=>{const o=n[a.src],h=[a.src];a.alias&&h.push(...a.alias),h.forEach(l=>{r[l]=o}),et.set(h,o)}),r}async unload(t){this._initialized||await this.init();const e=Et(t).map(n=>typeof n!="string"?n.src:n),i=this.resolver.resolve(e);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=Et(t);const e=this.resolver.resolveBundle(t),i=Object.keys(e).map(n=>this._unloadFromResolved(e[n]));await Promise.all(i)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(i=>{et.remove(i.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const i of t.detections)t.skipDetections||await i.test()?e=await i.add(e):t.skipDetections||(e=await i.remove(e));return e=e.filter((i,n)=>e.indexOf(i)===n),e}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(i=>i in t).forEach(i=>{e.config[i]=t[i]})})}}const ct=new _g;X.handleByList(I.LoadParser,ct.loader.parsers).handleByList(I.ResolveParser,ct.resolver.parsers).handleByList(I.CacheParser,ct.cache.parsers).handleByList(I.DetectionParser,ct.detections);X.add(Rm,Vm,Fm,Nm,Om,Lm,Dm,Gm,jm,tg,ig,Hl,gg,km,Em,jl,yg);const So={loader:I.LoadParser,resolver:I.ResolveParser,cache:I.CacheParser,detection:I.DetectionParser};X.handle(I.Asset,s=>{const t=s.ref;Object.entries(So).filter(([e])=>!!t[e]).forEach(([e,i])=>X.add(Object.assign(t[e],{extension:t[e].extension??i})))},s=>{const t=s.ref;Object.keys(So).filter(e=>!!t[e]).forEach(e=>X.remove(t[e]))});class Xe extends Vi{constructor(t){t instanceof bt&&(t={context:t});const{context:e,roundPixels:i,...n}=t||{};super({label:"Graphics",...n}),this.renderPipeId="graphics",e?this._context=e:this._context=this._ownedContext=new bt,this._context.on("update",this.onViewUpdate,this),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=i??!1}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(t===!0||(t==null?void 0:t.context)===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new Xe(this._context.clone()):(this._ownedContext=null,new Xe(this._context))}lineStyle(t,e,i){N(W,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const n={};return t&&(n.width=t),e&&(n.color=e),i&&(n.alpha=i),this.context.strokeStyle=n,this}beginFill(t,e){N(W,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const i={};return t!==void 0&&(i.color=t),e!==void 0&&(i.alpha=e),this.context.fillStyle=i,this}endFill(){N(W,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return(t.width!==bt.defaultStrokeStyle.width||t.color!==bt.defaultStrokeStyle.color||t.alpha!==bt.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return N(W,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return N(W,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return N(W,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return N(W,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return N(W,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return N(W,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}const Yl=class Xl extends Sl{constructor(...t){let e=t[0]??{};e instanceof Float32Array&&(N(W,"use new MeshGeometry({ positions, uvs, indices }) instead"),e={positions:e,uvs:t[1],indices:t[2]}),e={...Xl.defaultOptions,...e};const i=e.positions||new Float32Array([0,0,1,0,1,1,0,1]);let n=e.uvs;n||(e.positions?n=new Float32Array(i.length):n=new Float32Array([0,0,1,0,1,1,0,1]));const r=e.indices||new Uint32Array([0,1,2,0,2,3]),a=e.shrinkBuffersToFit,o=new ae({data:i,label:"attribute-mesh-positions",shrinkToFit:a,usage:at.VERTEX|at.COPY_DST}),h=new ae({data:n,label:"attribute-mesh-uvs",shrinkToFit:a,usage:at.VERTEX|at.COPY_DST}),l=new ae({data:r,label:"index-mesh-buffer",shrinkToFit:a,usage:at.INDEX|at.COPY_DST});super({attributes:{aPosition:{buffer:o,format:"float32x2",stride:2*4,offset:0},aUV:{buffer:h,format:"float32x2",stride:2*4,offset:0}},indexBuffer:l,topology:e.topology}),this.batchMode="auto"}get positions(){return this.attributes.aPosition.buffer.data}set positions(t){this.attributes.aPosition.buffer.data=t}get uvs(){return this.attributes.aUV.buffer.data}set uvs(t){this.attributes.aUV.buffer.data=t}get indices(){return this.indexBuffer.data}set indices(t){this.indexBuffer.data=t}};Yl.defaultOptions={topology:"triangle-list",shrinkBuffersToFit:!1};let xg=Yl;class bg extends Vi{constructor(t,e){const{text:i,resolution:n,style:r,anchor:a,width:o,height:h,roundPixels:l,...c}=t;super({...c}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=e,this.text=i??"",this.style=r,this.resolution=n??null,this.allowChildren=!1,this._anchor=new ot({_onUpdate:()=>{this.onViewUpdate()}}),a&&(this.anchor=a),this.roundPixels=l??!1,o!==void 0&&(this.width=o),h!==void 0&&(this.height=h)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}set text(t){t=t.toString(),this._text!==t&&(this._text=t,this.onViewUpdate())}get text(){return this._text}set resolution(t){this._autoResolution=t===null,this._resolution=t,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(t){var e;t||(t={}),(e=this._style)==null||e.off("update",this.onViewUpdate,this),t instanceof this._styleClass?this._style=t:this._style=new this._styleClass(t),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(t){this._setWidth(t,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(t){this._setHeight(t,this.bounds.height)}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this.bounds.width,t.height=Math.abs(this.scale.y)*this.bounds.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this.bounds.width),e!==void 0&&this._setHeight(e,this.bounds.height)}containsPoint(t){const e=this.bounds.width,i=this.bounds.height,n=-e*this.anchor.x;let r=0;return t.x>=n&&t.x<=n+e&&(r=-i*this.anchor.y,t.y>=r&&t.y<=r+i)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}destroy(t=!1){super.destroy(t),this.owner=null,this._bounds=null,this._anchor=null,(typeof t=="boolean"?t:t!=null&&t.style)&&this._style.destroy(t),this._style=null,this._text=null}}function wg(s,t){let e=s[0]??{};return(typeof e=="string"||s[1])&&(N(W,`use new ${t}({ text: "hi!", style }) instead`),e={text:e,style:s[1]}),e}let fe=null,Gt=null;function vg(s,t){fe||(fe=Z.get().createCanvas(256,128),Gt=fe.getContext("2d",{willReadFrequently:!0}),Gt.globalCompositeOperation="copy",Gt.globalAlpha=1),(fe.width<s||fe.height<t)&&(fe.width=We(s),fe.height=We(t))}function Ao(s,t,e){for(let i=0,n=4*e*t;i<t;++i,n+=4)if(s[n+3]!==0)return!1;return!0}function To(s,t,e,i,n){const r=4*t;for(let a=i,o=i*r+4*e;a<=n;++a,o+=r)if(s[o+3]!==0)return!1;return!0}function Cg(...s){let t=s[0];t.canvas||(t={canvas:s[0],resolution:s[1]});const{canvas:e}=t,i=Math.min(t.resolution??1,1),n=t.width??e.width,r=t.height??e.height;let a=t.output;if(vg(n,r),!Gt)throw new TypeError("Failed to get canvas 2D context");Gt.drawImage(e,0,0,n,r,0,0,n*i,r*i);const h=Gt.getImageData(0,0,n,r).data;let l=0,c=0,u=n-1,d=r-1;for(;c<r&&Ao(h,n,c);)++c;if(c===r)return j.EMPTY;for(;Ao(h,n,d);)--d;for(;To(h,n,l,c,d);)++l;for(;To(h,n,u,c,d);)--u;return++u,++d,Gt.globalCompositeOperation="source-over",Gt.strokeRect(l,c,u-l,d-c),Gt.globalCompositeOperation="copy",a??(a=new j),a.set(l/i,c/i,(u-l)/i,(d-c)/i),a}const Po=new j;class Sg{getCanvasAndContext(t){const{text:e,style:i,resolution:n=1}=t,r=i._getFinalPadding(),a=Lt.measureText(e||" ",i),o=Math.ceil(Math.ceil(Math.max(1,a.width)+r*2)*n),h=Math.ceil(Math.ceil(Math.max(1,a.height)+r*2)*n),l=Si.getOptimalCanvasAndContext(o,h);this._renderTextToCanvas(e,i,r,n,l);const c=i.trim?Cg({canvas:l.canvas,width:o,height:h,resolution:1,output:Po}):Po.set(0,0,o,h);return{canvasAndContext:l,frame:c}}returnCanvasAndContext(t){Si.returnCanvasAndContext(t)}_renderTextToCanvas(t,e,i,n,r){var x,b,S,w;const{canvas:a,context:o}=r,h=vi(e),l=Lt.measureText(t||" ",e),c=l.lines,u=l.lineHeight,d=l.lineWidths,f=l.maxLineWidth,p=l.fontProperties,g=a.height;if(o.resetTransform(),o.scale(n,n),o.textBaseline=e.textBaseline,(x=e._stroke)!=null&&x.width){const v=e._stroke;o.lineWidth=v.width,o.miterLimit=v.miterLimit,o.lineJoin=v.join,o.lineCap=v.cap}o.font=h;let m,y;const _=e.dropShadow?2:1;for(let v=0;v<_;++v){const T=e.dropShadow&&v===0,k=T?Math.ceil(Math.max(1,g)+i*2):0,M=k*n;if(T){o.fillStyle="black",o.strokeStyle="black";const B=e.dropShadow,lt=B.color,Zt=B.alpha;o.shadowColor=nt.shared.setValue(lt).setAlpha(Zt).toRgbaString();const V=B.blur*n,F=B.distance*n;o.shadowBlur=V,o.shadowOffsetX=Math.cos(B.angle)*F,o.shadowOffsetY=Math.sin(B.angle)*F+M}else{if(o.fillStyle=e._fill?Ai(e._fill,o,l):null,(b=e._stroke)!=null&&b.width){const B=e._stroke.width*e._stroke.alignment;o.strokeStyle=Ai(e._stroke,o,l,B)}o.shadowColor="black"}let E=(u-p.fontSize)/2;u-p.fontSize<0&&(E=0);const z=((S=e._stroke)==null?void 0:S.width)??0;for(let B=0;B<c.length;B++)m=z/2,y=z/2+B*u+p.ascent+E,e.align==="right"?m+=f-d[B]:e.align==="center"&&(m+=(f-d[B])/2),(w=e._stroke)!=null&&w.width&&this._drawLetterSpacing(c[B],e,r,m+i,y+i-k,!0),e._fill!==void 0&&this._drawLetterSpacing(c[B],e,r,m+i,y+i-k)}}_drawLetterSpacing(t,e,i,n,r,a=!1){const{context:o}=i,h=e.letterSpacing;let l=!1;if(Lt.experimentalLetterSpacingSupported&&(Lt.experimentalLetterSpacing?(o.letterSpacing=`${h}px`,o.textLetterSpacing=`${h}px`,l=!0):(o.letterSpacing="0px",o.textLetterSpacing="0px")),h===0||l){a?o.strokeText(t,n,r):o.fillText(t,n,r);return}let c=n;const u=Lt.graphemeSegmenter(t);let d=o.measureText(t).width,f=0;for(let p=0;p<u.length;++p){const g=u[p];a?o.strokeText(g,c,r):o.fillText(g,c,r);let m="";for(let y=p+1;y<u.length;++y)m+=u[y];f=o.measureText(m).width,c+=d-f+h,d=f}}}const Mo=new Sg;class ft extends bg{constructor(...t){const e=wg(t,"Text");super(e,Ye),this.renderPipeId="text",e.textureStyle&&(this.textureStyle=e.textureStyle instanceof Ge?e.textureStyle:new Ge(e.textureStyle))}updateBounds(){const t=this._bounds,e=this._anchor;let i=0,n=0;if(this._style.trim){const{frame:r,canvasAndContext:a}=Mo.getCanvasAndContext({text:this.text,style:this._style,resolution:1});Mo.returnCanvasAndContext(a),i=r.width,n=r.height}else{const r=Lt.measureText(this._text,this._style);i=r.width,n=r.height}t.minX=-e._x*i,t.maxX=t.minX+i,t.minY=-e._y*n,t.maxY=t.minY+n}}const Kl=class ql extends xg{constructor(...t){super({});let e=t[0]??{};typeof e=="number"&&(N(W,"PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead"),e={width:e,height:t[1],verticesX:t[2],verticesY:t[3]}),this.build(e)}build(t){t={...ql.defaultOptions,...t},this.verticesX=this.verticesX??t.verticesX,this.verticesY=this.verticesY??t.verticesY,this.width=this.width??t.width,this.height=this.height??t.height;const e=this.verticesX*this.verticesY,i=[],n=[],r=[],a=this.verticesX-1,o=this.verticesY-1,h=this.width/a,l=this.height/o;for(let u=0;u<e;u++){const d=u%this.verticesX,f=u/this.verticesX|0;i.push(d*h,f*l),n.push(d/a,f/o)}const c=a*o;for(let u=0;u<c;u++){const d=u%a,f=u/a|0,p=f*this.verticesX+d,g=f*this.verticesX+d+1,m=(f+1)*this.verticesX+d,y=(f+1)*this.verticesX+d+1;r.push(p,g,m,g,y,m)}this.buffers[0].data=new Float32Array(i),this.buffers[1].data=new Float32Array(n),this.indexBuffer.data=new Uint32Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}};Kl.defaultOptions={width:100,height:100,verticesX:10,verticesY:10};let Ag=Kl;const Zl=class Ql extends Ag{constructor(t={}){t={...Ql.defaultOptions,...t},super({width:t.width,height:t.height,verticesX:4,verticesY:4}),this.update(t)}update(t){var e,i;this.width=t.width??this.width,this.height=t.height??this.height,this._originalWidth=t.originalWidth??this._originalWidth,this._originalHeight=t.originalHeight??this._originalHeight,this._leftWidth=t.leftWidth??this._leftWidth,this._rightWidth=t.rightWidth??this._rightWidth,this._topHeight=t.topHeight??this._topHeight,this._bottomHeight=t.bottomHeight??this._bottomHeight,this._anchorX=(e=t.anchor)==null?void 0:e.x,this._anchorY=(i=t.anchor)==null?void 0:i.y,this.updateUvs(),this.updatePositions()}updatePositions(){const t=this.positions,{width:e,height:i,_leftWidth:n,_rightWidth:r,_topHeight:a,_bottomHeight:o,_anchorX:h,_anchorY:l}=this,c=n+r,u=e>c?1:e/c,d=a+o,f=i>d?1:i/d,p=Math.min(u,f),g=h*e,m=l*i;t[0]=t[8]=t[16]=t[24]=-g,t[2]=t[10]=t[18]=t[26]=n*p-g,t[4]=t[12]=t[20]=t[28]=e-r*p-g,t[6]=t[14]=t[22]=t[30]=e-g,t[1]=t[3]=t[5]=t[7]=-m,t[9]=t[11]=t[13]=t[15]=a*p-m,t[17]=t[19]=t[21]=t[23]=i-o*p-m,t[25]=t[27]=t[29]=t[31]=i-m,this.getBuffer("aPosition").update()}updateUvs(){const t=this.uvs;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1;const e=1/this._originalWidth,i=1/this._originalHeight;t[2]=t[10]=t[18]=t[26]=e*this._leftWidth,t[9]=t[11]=t[13]=t[15]=i*this._topHeight,t[4]=t[12]=t[20]=t[28]=1-e*this._rightWidth,t[17]=t[19]=t[21]=t[23]=1-i*this._bottomHeight,this.getBuffer("aUV").update()}};Zl.defaultOptions={width:100,height:100,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10,originalWidth:100,originalHeight:100};let ke=Zl;const Jl=class tc extends Vi{constructor(t){var d,f,p,g;t instanceof L&&(t={texture:t});const{width:e,height:i,anchor:n,leftWidth:r,rightWidth:a,topHeight:o,bottomHeight:h,texture:l,roundPixels:c,...u}=t;super({label:"NineSliceSprite",...u}),this.renderPipeId="nineSliceSprite",this.batched=!0,this._leftWidth=r??((d=l==null?void 0:l.defaultBorders)==null?void 0:d.left)??ke.defaultOptions.leftWidth,this._topHeight=o??((f=l==null?void 0:l.defaultBorders)==null?void 0:f.top)??ke.defaultOptions.topHeight,this._rightWidth=a??((p=l==null?void 0:l.defaultBorders)==null?void 0:p.right)??ke.defaultOptions.rightWidth,this._bottomHeight=h??((g=l==null?void 0:l.defaultBorders)==null?void 0:g.bottom)??ke.defaultOptions.bottomHeight,this._width=e??l.width??ke.defaultOptions.width,this._height=i??l.height??ke.defaultOptions.height,this.allowChildren=!1,this.texture=l??tc.defaultOptions.texture,this.roundPixels=c??!1,this._anchor=new ot({_onUpdate:()=>{this.onViewUpdate()}}),n?this.anchor=n:this.texture.defaultAnchor&&(this.anchor=this.texture.defaultAnchor)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return this._width}set width(t){this._width=t,this.onViewUpdate()}get height(){return this._height}set height(t){this._height=t,this.onViewUpdate()}setSize(t,e){typeof t=="object"&&(e=t.height??t.width,t=t.width),this._width=t,this._height=e??t,this.onViewUpdate()}getSize(t){return t||(t={}),t.width=this._width,t.height=this._height,t}get leftWidth(){return this._leftWidth}set leftWidth(t){this._leftWidth=t,this.onViewUpdate()}get topHeight(){return this._topHeight}set topHeight(t){this._topHeight=t,this.onViewUpdate()}get rightWidth(){return this._rightWidth}set rightWidth(t){this._rightWidth=t,this.onViewUpdate()}get bottomHeight(){return this._bottomHeight}set bottomHeight(t){this._bottomHeight=t,this.onViewUpdate()}get texture(){return this._texture}set texture(t){t||(t=L.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this.onViewUpdate())}get originalWidth(){return this._texture.width}get originalHeight(){return this._texture.height}destroy(t){if(super.destroy(t),typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(i)}this._texture=null}updateBounds(){const t=this._bounds,e=this._anchor,i=this._width,n=this._height;t.minX=-e._x*i,t.maxX=t.minX+i,t.minY=-e._y*n,t.maxY=t.minY+n}};Jl.defaultOptions={texture:L.EMPTY};let Eo=Jl;X.add(Tu,Pu);var Sn={},ls={},ko;function Gs(){if(ko)return ls;ko=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.Collector=void 0;let s=class{constructor(e){this.emit=(...i)=>{e.emitCollecting(this,i)}}};return ls.Collector=s,ls}var cs={},Io;function Tg(){if(Io)return cs;Io=1,Object.defineProperty(cs,"__esModule",{value:!0}),cs.CollectorArray=void 0;const s=Gs();let t=class extends s.Collector{constructor(){super(...arguments),this.result=[]}handleResult(i){return this.result.push(i),!0}getResult(){return this.result}reset(){this.result.length=0}};return cs.CollectorArray=t,cs}var us={},Ro;function Pg(){if(Ro)return us;Ro=1,Object.defineProperty(us,"__esModule",{value:!0}),us.CollectorLast=void 0;const s=Gs();let t=class extends s.Collector{handleResult(i){return this.result=i,!0}getResult(){return this.result}reset(){delete this.result}};return us.CollectorLast=t,us}var ds={},Fo;function Mg(){if(Fo)return ds;Fo=1,Object.defineProperty(ds,"__esModule",{value:!0}),ds.CollectorUntil0=void 0;const s=Gs();let t=class extends s.Collector{constructor(){super(...arguments),this.result=!1}handleResult(i){return this.result=i,this.result}getResult(){return this.result}reset(){this.result=!1}};return ds.CollectorUntil0=t,ds}var fs={},Vo;function Eg(){if(Vo)return fs;Vo=1,Object.defineProperty(fs,"__esModule",{value:!0}),fs.CollectorWhile0=void 0;const s=Gs();let t=class extends s.Collector{constructor(){super(...arguments),this.result=!1}handleResult(i){return this.result=i,!this.result}getResult(){return this.result}reset(){this.result=!1}};return fs.CollectorWhile0=t,fs}var ps={},ms={},Bo;function kg(){if(Bo)return ms;Bo=1,Object.defineProperty(ms,"__esModule",{value:!0}),ms.SignalConnectionImpl=void 0;class s{constructor(e,i){this.link=e,this.parentCleanup=i}disconnect(){return this.link!==null?(this.link.unlink(),this.link=null,this.parentCleanup(),this.parentCleanup=null,!0):!1}set enabled(e){this.link&&this.link.setEnabled(e)}get enabled(){return this.link!==null&&this.link.isEnabled()}}return ms.SignalConnectionImpl=s,ms}var gs={},Oo;function Ig(){if(Oo)return gs;Oo=1,Object.defineProperty(gs,"__esModule",{value:!0}),gs.SignalLink=void 0;let s=class ec{constructor(e=null,i=null,n=0){this.enabled=!0,this.newLink=!1,this.callback=null,this.prev=e??this,this.next=i??this,this.order=n}isEnabled(){return this.enabled&&!this.newLink}setEnabled(e){this.enabled=e}unlink(){this.callback=null,this.next.prev=this.prev,this.prev.next=this.next}insert(e,i){let n=this.prev;for(;n!==this&&!(n.order<=i);)n=n.prev;const r=new ec(n,n.next,i);return r.callback=e,n.next=r,r.next.prev=r,r}};return gs.SignalLink=s,gs}var Lo;function Rg(){if(Lo)return ps;Lo=1,Object.defineProperty(ps,"__esModule",{value:!0}),ps.Signal=void 0;const s=kg(),t=Ig();let e=class{constructor(){this.head=new t.SignalLink,this.hasNewLinks=!1,this.emitDepth=0,this.connectionsCount=0}getConnectionsCount(){return this.connectionsCount}hasConnections(){return this.connectionsCount>0}connect(n,r=0){this.connectionsCount++;const a=this.head.insert(n,r);return this.emitDepth>0&&(this.hasNewLinks=!0,a.newLink=!0),new s.SignalConnectionImpl(a,()=>this.decrementConnectionCount())}decrementConnectionCount(){this.connectionsCount--}disconnect(n){for(let r=this.head.next;r!==this.head;r=r.next)if(r.callback===n)return this.decrementConnectionCount(),r.unlink(),!0;return!1}disconnectAll(){for(;this.head.next!==this.head;)this.head.next.unlink();this.connectionsCount=0}emit(...n){this.emitDepth++;for(let r=this.head.next;r!==this.head;r=r.next)r.isEnabled()&&r.callback&&r.callback.apply(null,n);this.emitDepth--,this.unsetNewLink()}emitCollecting(n,r){this.emitDepth++;for(let a=this.head.next;a!==this.head;a=a.next)if(a.isEnabled()&&a.callback){const o=a.callback.apply(null,r);if(!n.handleResult(o))break}this.emitDepth--,this.unsetNewLink()}unsetNewLink(){if(this.hasNewLinks&&this.emitDepth===0){for(let n=this.head.next;n!==this.head;n=n.next)n.newLink=!1;this.hasNewLinks=!1}}};return ps.Signal=e,ps}var ys={},Do;function Fg(){if(Do)return ys;Do=1,Object.defineProperty(ys,"__esModule",{value:!0}),ys.SignalConnections=void 0;let s=class{constructor(){this.list=[]}add(e){this.list.push(e)}disconnectAll(){for(const e of this.list)e.disconnect();this.list=[]}getCount(){return this.list.length}isEmpty(){return this.list.length===0}};return ys.SignalConnections=s,ys}var No;function Vg(){return No||(No=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.SignalConnections=s.Signal=s.CollectorWhile0=s.CollectorUntil0=s.CollectorLast=s.CollectorArray=s.Collector=void 0;var t=Gs();Object.defineProperty(s,"Collector",{enumerable:!0,get:function(){return t.Collector}});var e=Tg();Object.defineProperty(s,"CollectorArray",{enumerable:!0,get:function(){return e.CollectorArray}});var i=Pg();Object.defineProperty(s,"CollectorLast",{enumerable:!0,get:function(){return i.CollectorLast}});var n=Mg();Object.defineProperty(s,"CollectorUntil0",{enumerable:!0,get:function(){return n.CollectorUntil0}});var r=Eg();Object.defineProperty(s,"CollectorWhile0",{enumerable:!0,get:function(){return r.CollectorWhile0}});var a=Rg();Object.defineProperty(s,"Signal",{enumerable:!0,get:function(){return a.Signal}});var o=Fg();Object.defineProperty(s,"SignalConnections",{enumerable:!0,get:function(){return o.SignalConnections}})}(Sn)),Sn}var Ie=Vg(),Bg=Object.defineProperty,Og=(s,t,e)=>t in s?Bg(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,se=(s,t,e)=>Og(s,typeof t!="symbol"?t+"":t,e);class Lg{constructor(){se(this,"_isMouseIn"),se(this,"_isDown"),se(this,"onDown"),se(this,"onUp"),se(this,"onUpOut"),se(this,"onOut"),se(this,"onPress"),se(this,"onHover"),this.onPress=new Ie.Signal,this.onDown=new Ie.Signal,this.onUp=new Ie.Signal,this.onHover=new Ie.Signal,this.onOut=new Ie.Signal,this.onUpOut=new Ie.Signal}connectEvents(t){De.any?(t.on("pointerdown",this.processDown,this),t.on("pointerup",this.processUp,this),t.on("pointerupoutside",this.processUpOut,this),t.on("pointerout",this.processOut,this),t.on("pointertap",this.processPress,this),t.on("pointerover",this.processOver,this)):(t.on("mousedown",this.processDown,this),t.on("mouseup",this.processUp,this),t.on("mouseupoutside",this.processUpOut,this),t.on("mouseout",this.processOut,this),t.on("click",this.processPress,this),t.on("mouseover",this.processOver,this))}disconnectEvents(t){De.any?(t.off("pointerdown",this.processDown,this),t.off("pointerup",this.processUp,this),t.off("pointerupoutside",this.processUpOut,this),t.off("pointerout",this.processOut,this),t.off("pointertap",this.processPress,this),t.off("pointerover",this.processOver,this)):(t.off("mousedown",this.processDown,this),t.off("mouseup",this.processUp,this),t.off("mouseupoutside",this.processUpOut,this),t.off("mouseout",this.processOut,this),t.off("click",this.processPress,this),t.off("mouseover",this.processOver,this))}processDown(t){this._isDown=!0,this.onDown.emit(this,t),this.down(t)}processUp(t){this._isDown&&(this.onUp.emit(this,t),this.up(t)),this._isDown=!1}processUpOut(t){this._isDown&&(this.onUp.emit(this,t),this.onUpOut.emit(this,t),this.up(t),this.upOut(t)),this._isDown=!1}processOut(t){this._isMouseIn&&(this._isMouseIn=!1,this.onOut.emit(this,t),this.out(t))}processPress(t){this._isDown=!1,this.onPress.emit(this,t),this.press(t)}processOver(t){De.any||(this._isMouseIn=!0,this.onHover.emit(this,t),this.hover(t))}down(t){}up(t){}upOut(t){}out(t){}press(t){}hover(t){}get isDown(){return this._isDown}}var Dg=Object.defineProperty,Ng=(s,t,e)=>t in s?Dg(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,ie=(s,t,e)=>Ng(s,typeof t!="symbol"?t+"":t,e);let Qn=class extends Lg{constructor(t){super(),ie(this,"_view"),t&&(this.view=t,this.enabled=!0)}set view(t){!!this._view&&this.disconnectEvents(this._view),this._view=t,this.connectEvents(this._view)}get view(){return this._view}set enabled(t){if(!this.view){console.error("Button view is not set. Please set it before enabling the button.");return}this.view.eventMode=t?"static":"auto",this.view.cursor=t?"pointer":"default",!t&&this.isDown&&this.processUp()}get enabled(){return this.view.eventMode==="static"}};class Ug extends it{constructor(t){super(),ie(this,"button"),ie(this,"onDown"),ie(this,"onUp"),ie(this,"onUpOut"),ie(this,"onOut"),ie(this,"onPress"),ie(this,"onHover"),this.button=new Qn(this),this.button.enabled=!0,t&&this.addChild(t),this.onPress=this.button.onPress,this.onDown=this.button.onDown,this.onUp=this.button.onUp,this.onHover=this.button.onHover,this.onOut=this.button.onOut,this.onUpOut=this.button.onUpOut}set enabled(t){this.button.enabled=t}get enabled(){return this.button.enabled}}function Uo(s){return typeof s=="string"?pt.from(s):s instanceof L?new pt(s):s}var zg=Object.defineProperty,Wg=(s,t,e)=>t in s?zg(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,_s=(s,t,e)=>Wg(s,typeof t!="symbol"?t+"":t,e);class Gg extends it{constructor(t){super(),_s(this,"_progress",0),_s(this,"options"),_s(this,"bgCircle",new Xe),_s(this,"fillCircle",new Xe),_s(this,"innerView",new it),this.options=t,this.addChild(this.innerView),this.innerView.addChild(this.bgCircle,this.fillCircle),this.addBackground(),t.value&&(this.progress=t.value)}addBackground(){const{backgroundColor:t,lineWidth:e,radius:i,backgroundAlpha:n}=this.options;let r=1;n>0&&(r=n),t===void 0&&(r=1e-6),this.bgCircle.circle(0,0,i).stroke({width:e,color:t,alpha:r})}set progress(t){t>100&&(t=100),t<0&&(t=0),this._progress=t;const{lineWidth:e,radius:i,fillColor:n,fillAlpha:r,cap:a}=this.options;if(t===0&&r===0){this.fillCircle.clear();return}const o=0,h=360/100*t;this.fillCircle.clear().arc(0,0,i,(-90+o)*In,(-90+o+h)*In).stroke({width:e,color:n,cap:a,alpha:r})}get progress(){return this._progress}}/*!
 * tweedle.js - v2.1.0
 * Compiled Wed, 05 Apr 2023 15:21:25 UTC
 *
 * tweedle.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 * 
 * Copyright 2019-2021, Milton Candelero <miltoncandelero@gmail.com>, All Rights Reserved
 */let Ss;typeof self>"u"&&typeof process<"u"&&process.hrtime?Ss=function(){const s=process.hrtime();return s[0]*1e3+s[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?Ss=self.performance.now.bind(self.performance):Date.now!==void 0?Ss=Date.now:Ss=function(){return new Date().getTime()};class Pt{constructor(){Pt.prototype.__init.call(this),Pt.prototype.__init2.call(this),Pt.prototype.__init3.call(this),Pt.prototype.__init4.call(this)}__init(){this._tweens={}}static get shared(){return Pt._shared||(Pt._shared=new Pt),Pt._shared}__init2(){this._paused=!1}isPaused(){return this._paused}pause(){this._paused=!0}resume(){this._paused=!1}__init3(){this._lastUpdateTime=void 0}__init4(){this.now=Ss}getAll(){return Object.keys(this._tweens).map(t=>this._tweens[t])}removeAll(){this._tweens={}}add(t){this._tweens[t.getId()]=t}remove(t){delete this._tweens[t.getId()]}update(t,e=!1){if(t==null&&(this._lastUpdateTime==null?(this._lastUpdateTime=this.now(),t=0):t=this.now()-this._lastUpdateTime),this._lastUpdateTime=this.now(),this._paused)return!1;const i=Object.keys(this._tweens);if(i.length==0)return!1;for(let n=0;n<i.length;n++){const r=this._tweens[i[n]];r&&r.update(t,!0)==!1&&!e&&delete this._tweens[i[n]]}return!0}}const Hg={Linear:{None(s){return s}}},sc={Geom:{Linear(s,t){const e=s.length-1,i=e*t,n=Math.floor(i),r=sc.Utils.Linear;return t<0?r(s[0],s[1],i):t>1?r(s[e],s[e-1],e-i):r(s[n],s[n+1>e?e:n+1],i-n)}},Utils:{Linear(s,t,e){return(t-s)*e+s}}};class Ui{static __initStatic(){this._nextId=0}static nextId(){return Ui._nextId++}}Ui.__initStatic();const ci={safetyCheckFunction:s=>!0,easingFunction:Hg.Linear.None,yoyoEasingFunction:void 0,interpolationFunction:sc.Geom.Linear};class ${__init(){this._isPaused=!1}__init2(){this._valuesStart={}}__init3(){this._valuesEnd={}}__init4(){this._valuesStartRepeat={}}__init5(){this._duration=0}__init6(){this._repeatCount=0}__init7(){this._repeat=0}__init8(){this._yoyo=!1}__init9(){this._isPlaying=!1}get _reversed(){return this.yoyo&&this._repeatCount%2!==0}__init10(){this._delayTime=0}__init11(){this._startTime=0}__init12(){this._elapsedTime=0}__init13(){this._timescale=1}__init14(){this._safetyCheckFunction=ci.safetyCheckFunction}__init15(){this._easingFunction=ci.easingFunction}__init16(){this._yoyoEasingFunction=ci.yoyoEasingFunction}__init17(){this._interpolationFunction=ci.interpolationFunction}__init18(){this._chainedTweens=[]}__init19(){this._onStartCallbackFired=!1}__init20(){this._onAfterDelayCallbackFired=!1}__init21(){this._id=Ui.nextId()}__init22(){this._isChainStopped=!1}get _group(){return this._groupRef?this._groupRef:Pt.shared}set _group(t){this._groupRef=t}constructor(t,e){$.prototype.__init.call(this),$.prototype.__init2.call(this),$.prototype.__init3.call(this),$.prototype.__init4.call(this),$.prototype.__init5.call(this),$.prototype.__init6.call(this),$.prototype.__init7.call(this),$.prototype.__init8.call(this),$.prototype.__init9.call(this),$.prototype.__init10.call(this),$.prototype.__init11.call(this),$.prototype.__init12.call(this),$.prototype.__init13.call(this),$.prototype.__init14.call(this),$.prototype.__init15.call(this),$.prototype.__init16.call(this),$.prototype.__init17.call(this),$.prototype.__init18.call(this),$.prototype.__init19.call(this),$.prototype.__init20.call(this),$.prototype.__init21.call(this),$.prototype.__init22.call(this),this._object=t,this._group=e}getId(){return this._id}getGroup(){return this._group}getTimescale(){return this._timescale}isPlaying(){return this._isPlaying}isPaused(){return this._isPaused}from(t){try{JSON.stringify(t)}catch{throw new Error("The object you provided to the from() method has a circular reference!")}return this._setupProperties(t,this._valuesStart,t,this._valuesStartRepeat,!0),this}to(t,e){try{this._valuesEnd=JSON.parse(JSON.stringify(t))}catch{return console.warn("The object you provided to the to() method has a circular reference!. It can't be cloned. Falling back to dynamic targeting"),this.dynamicTo(t,e)}return e!==void 0&&(this._duration=e),this}dynamicTo(t,e){return this._valuesEnd=t,e!==void 0&&(this._duration=e),this}duration(t){return this._duration=t,this}start(t){return this._isPlaying?this:(t!=null&&(this._delayTime=t),this._group.add(this),this._reversed&&(this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat))),this._repeatCount=0,this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onAfterDelayCallbackFired=!1,this._isChainStopped=!1,this._startTime=-this._delayTime,this._elapsedTime=0,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,!1),this)}restart(t){return this.reset(),this.start(t)}reset(){return this._isPlaying&&this.stop(),this._valuesStart={},this._valuesStartRepeat={},this}rewind(){this._isPlaying&&this.stop(),this._reversed&&this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd);const t=this._easingFunction(0);return this._updateProperties(this._object,this._valuesStart,this._valuesEnd,t),this}_setupProperties(t,e,i,n,r){for(const a in i){const o=t[a],h=Array.isArray(o),l=!Number.isNaN(Number(o)),c=h?"array":typeof o,u=c=="object",d=typeof i[a]=="object",f=!h&&Array.isArray(i[a]);c=="undefined"||c=="function"||i[a]==null||!h&&!l&&!u||((u||h||d)&&o&&!f?(typeof e[a]>"u"&&(e[a]=h?[]:{}),typeof n[a]>"u"&&(n[a]=h?[]:{}),this._setupProperties(o,e[a],i[a],n[a],r)):((typeof e[a]>"u"||r)&&(e[a]=o),(typeof n[a]>"u"||r)&&(f?n[a]=i[a].slice().reverse()[0]:n[a]=e[a]||0)))}}stop(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object,this),this):this}end(t=!1){let e=[];if(t||(e=this._chainedTweens,this._chainedTweens=[]),this.resume(),this.update(1/0),!t){this._chainedTweens=e;for(let i=0,n=this._chainedTweens.length;i<n;i++)this._chainedTweens[i].start()}return this}skip(t,e=!1){return this.resume(),this.update(t*this._duration-(e?this._elapsedTime:0)),this}pause(){return this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._group.remove(this),this)}resume(){return!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._group.add(this),this)}stopChainedTweens(){for(let t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this}startChainedTweens(t=!1){t&&this.stop();for(let e=0,i=this._chainedTweens.length;e<i;e++)this._chainedTweens[e].start();return this}group(t){return this._group=t,this}delay(t){return this._delayTime=t,this}timescale(t){return this._timescale=t,this}repeat(t=1/0){return this._repeat=t,this}repeatDelay(t){return this._repeatDelayTime=t,this}yoyo(t=!0){return this._yoyo=t,this}easing(t){return this._easingFunction=t,this}safetyCheck(t){return this._safetyCheckFunction=t,this}yoyoEasing(t){return this._yoyoEasingFunction=t,this}interpolation(t){return this._interpolationFunction=t,this}chain(...t){return this._chainedTweens=t,this}onStart(t){return this._onStartCallback=t,this}onAfterDelay(t){return this._onAfterDelayCallback=t,this}onUpdate(t){return this._onUpdateCallback=t,this}onRepeat(t){return this._onRepeatCallback=t,this}onComplete(t){return this._onCompleteCallback=t,this}onStop(t){return this._onStopCallback=t,this}update(t,e=!1){const i=this._internalUpdate(t);return!i&&!e&&this._group.remove(this),i}_internalUpdate(t){if(!this._safetyCheckFunction(this._object)||this._isPaused)return!1;t*=this._timescale;let e;this._elapsedTime+=t;const i=this._duration,n=this._startTime+this._elapsedTime;if(n>i&&!this._isPlaying)return!1;this.isPlaying||this.start(),this._onStartCallbackFired==!1&&(this._onStartCallback&&this._onStartCallback(this._object,this),this._onStartCallbackFired=!0),this._onAfterDelayCallbackFired==!1&&n>=0&&(this._onAfterDelayCallback&&this._onAfterDelayCallback(this._object,this),this._onAfterDelayCallbackFired=!0),e=n/this._duration,this._duration==0&&(n>=0?e=1:e=0),e=Math.min(1,e),e=Math.max(0,e);let r=Number.isFinite(n)?n%this._duration:n;Number.isNaN(r)&&(r=0);const a=Math.floor(n/this._duration);let o;if(this._reversed&&this._yoyoEasingFunction?o=this._yoyoEasingFunction(e):o=this._easingFunction(e),this._updateProperties(this._object,this._valuesStart,this._valuesEnd,o),this._onUpdateCallback&&(e!=1||this._repeat-this._repeatCount<=0)&&this._onUpdateCallback(this._object,e,this),e==1){if(this._repeat-this._repeatCount>0){const h=this._repeatCount;if(this._repeatCount=Math.min(this._repeat+1,this._repeatCount+a),this._onUpdateCallback&&(this._repeat-this._repeatCount<0||r<=0)&&this._onUpdateCallback(this._object,e,this),this._yoyo?this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd):this._moveForwardStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat)),this._repeatDelayTime!==void 0?this._startTime=-this._repeatDelayTime:this._startTime=0,this._onRepeatCallback){let l=1;Number.isFinite(a)?l=this._repeatCount-h:Number.isFinite(this._repeat)&&(l=this._repeat-h);for(let c=0;c<l;c++)this._onRepeatCallback(this._object,h+1+c,this)}if(this._elapsedTime=0,this._repeat-this._repeatCount>=0)return r>0&&Number.isFinite(this._repeat)&&this._internalUpdate(r),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object,this);for(let h=0,l=this._chainedTweens.length;h<l;h++)this._chainedTweens[h].start(),r>0&&this._chainedTweens[h].update(r);return this._isPlaying=!1,!1}return!0}_updateProperties(t,e,i,n){for(const r in i){if(e[r]==null)continue;const a=e[r];let o=i[r];const h=Array.isArray(t[r]),l=Array.isArray(o);!h&&l?this._reversed?t[r]=this._interpolationFunction(o.concat([a]),n):t[r]=this._interpolationFunction([a].concat(o),n):typeof o=="object"&&o?this._updateProperties(t[r],a,o,n):(o=this._handleRelativeValue(a,o),typeof o=="number"&&(typeof a=="number"||typeof a=="string")&&(t[r]=Number(a)+(o-Number(a))*n,typeof a=="string"&&(t[r]=String(t[r]))))}}_handleRelativeValue(t,e){return typeof e!="string"?e:e.charAt(0)=="+"||e.charAt(0)=="-"?t+Number(e):Number(e)}_swapEndStartRepeatValues(t,e){for(const i in t){const n=!Array.isArray(t[i])&&Array.isArray(e[i]);if(typeof t[i]=="object")this._swapEndStartRepeatValues(t[i],e[i]);else{const r=t[i];if(typeof e[i]=="string")t[i]=Number(t[i])+Number(e[i]),e[i]=r;else if(n){const a=e[i].slice().reverse();t[i]=a[0],e[i]=a}else t[i]=e[i],e[i]=r}}}_moveForwardStartRepeatValues(t,e){for(const i in t)typeof e[i]=="object"?this._moveForwardStartRepeatValues(t[i],e[i]):typeof e[i]=="string"&&(t[i]=Number(t[i])+Number(e[i]))}}function zo(s,t,e=0,i=!0){let n=t.scale.x,r=t.scale.y;if(!s)throw new Error("Parent is not defined");const a=s.width-e*2,o=s.height-e*2,h=a-Math.round(t.width),l=o-Math.round(t.height);if(h<0&&(n=a/(t.width/n)),l<0&&(r=o/(t.height/r)),n<=0||r<=0){t.scale.set(0);return}if(i||t.scale.x===t.scale.y){const c=Math.min(n,r);t.scale.set(c,c)}else{const c=t.scale.x/t.scale.y;h<l?t.scale.set(n,n/c):t.scale.set(r*c,r)}}function $g(s){return typeof s=="string"||typeof s=="number"?new ft({text:String(s)}):s}var jg=Object.defineProperty,Yg=(s,t,e)=>t in s?jg(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,dt=(s,t,e)=>Yg(s,typeof t!="symbol"?t+"":t,e);class Xg extends Ug{constructor(t){super(),dt(this,"animations"),dt(this,"originalInnerViewState"),dt(this,"defaultDuration",100),dt(this,"options"),dt(this,"_padding"),dt(this,"_offset"),dt(this,"_textOffset"),dt(this,"iconOffset"),dt(this,"innerView",new it),dt(this,"_views",{}),dt(this,"state"),dt(this,"anchor"),dt(this,"_defaultTextScale",{x:1,y:1}),dt(this,"_defaultIconScale",{x:1,y:1}),dt(this,"_defaultTextAnchor",{x:.5,y:.5}),dt(this,"_defaultIconAnchor",{x:.5,y:.5}),this.options=t??{};const{defaultView:e,hoverView:i,pressedView:n,disabledView:r,text:a,padding:o,offset:h,textOffset:l,iconOffset:c,defaultTextScale:u,defaultIconScale:d,defaultTextAnchor:f,defaultIconAnchor:p,scale:g,anchor:m,anchorX:y,anchorY:_,icon:x,animations:b}=t??{};this.addChild(this.innerView),this.anchor=new ot({_onUpdate:()=>this.updateAnchor()}),this.anchor.set(y??m??0,_??m??0),this.padding=o??0,this.offset=h,this.textOffset=l,this.iconOffset=c,this.defaultTextScale=u,this.defaultIconScale=d,this.defaultTextAnchor=f,this.defaultIconAnchor=p,this.scale.set(g??1),b&&(this.animations=b,vt.shared.add(()=>Pt.shared.update())),this.setState("default"),this.defaultView=e,this.hoverView=i,this.pressedView=n,this.disabledView=r,this.text=a,this.iconView=x,this.initStateControl()}set text(t){if(!t||t===0){this.removeView("textView");return}if(!this._views.textView){this.createTextView(t);return}this._views.textView.text=t.toString()}get text(){var t;return(t=this._views.textView)==null?void 0:t.text}set enabled(t){this.button.enabled=t,this.setState(t?"default":"disabled")}get enabled(){return this.button.enabled}setState(t,e=!1){if(!e&&this.state===t)return;const i=this.getStateView(this.state);i&&(i.visible=!1),this.state=t;const n=this.getStateView(t);n&&(this.setOffset(n,t,this.offset),n.visible=!0),this.updateAnchor(),this.playAnimations(t)}createTextView(t){var e;if(this._views.textView=$g(t),((e=this.options)==null?void 0:e.defaultTextScale)===void 0){const{x:i,y:n}=this._views.textView.scale;this._defaultTextScale={x:i,y:n}}this.innerView.addChild(this._views.textView),this.adjustTextView(this.state)}setOffset(t,e,i){const n=i?i[e]:{x:0,y:0},r=i==null?void 0:i.default;n?(t.x+=n.x??0,t.y+=n.y??0):r?(t.x+=r.x??0,t.y+=r.y??0):(i.x||i.y)&&(t.x+=i.x??0,t.y+=i.y??0)}getStateView(t){if(this._views)switch(t){case"hover":return this._views.hoverView??this._views.defaultView??void 0;case"pressed":return this._views.pressedView??this._views.hoverView??this._views.defaultView??void 0;case"disabled":return this._views.disabledView??this._views.defaultView??void 0;case"default":return this._views.defaultView??void 0;default:return}}adjustTextView(t){if(!this.text)return;const e=this.getStateView(this.state),{x:i,y:n}=this._defaultTextAnchor;if(e){if(this.options.ignoreRefitting||this._views.textView.scale.set(this._defaultTextScale.x,this._defaultTextScale.y),this.contentFittingMode==="default"&&zo(e,this._views.textView,this.padding,!1),this.contentFittingMode==="fill"){this._views.textView.scale.set(1);const r=e.width-this.padding*2,a=e.height-this.padding*2,o=r/this._views.textView.width,h=a/this._views.textView.height,l=Math.min(o,h);this._views.textView.scale.set(l*this._defaultTextScale.x,l*this._defaultTextScale.y)}this._views.textView.x=e.x+e.width/2,this._views.textView.y=e.y+e.height/2}this._views.textView.anchor.set(i,n),this.setOffset(this._views.textView,t,this.textOffset)}adjustIconView(t){if(!this._views.iconView)return;const e=this.getStateView(t);if(!e)return;if(this.options.ignoreRefitting||this._views.iconView.scale.set(this._defaultIconScale.x,this._defaultIconScale.y),this.contentFittingMode==="default"&&zo(e,this._views.iconView,this.padding,!1),this.contentFittingMode==="fill"){this._views.iconView.scale.set(1);const r=e.width-this.padding*2,a=e.height-this.padding*2,o=r/this._views.iconView.width,h=a/this._views.iconView.height,l=Math.min(o,h);this._views.iconView.scale.set(l*this._defaultIconScale.x,l*this._defaultIconScale.y)}const{x:i,y:n}=this._defaultIconAnchor;"anchor"in this._views.iconView?this._views.iconView.anchor.set(i,n):this._views.iconView.pivot.set(i*(this._views.iconView.width/this._views.iconView.scale.x),n*(this._views.iconView.height/this._views.iconView.scale.y)),this._views.iconView.x=e.x+e.width/2,this._views.iconView.y=e.y+e.height/2,this.setOffset(this._views.iconView,t,this.iconOffset)}updateAnchor(){if(!this._views)return;const t=this.anchor.x??0,e=this.anchor.y??0;if([this._views.defaultView,this._views.hoverView,this._views.pressedView,this._views.disabledView].forEach(n=>{var r;n&&((r=n.anchor)==null||r.set(0),n.x=-n.width*t,n.y=-n.height*e)}),this._views.defaultView){const{x:n,y:r,width:a,height:o}=this._views.defaultView;this.hitArea=new j(n,r,a,o)}this.adjustIconView(this.state),this.adjustTextView(this.state)}set contentFittingMode(t){this.options.contentFittingMode=t}get contentFittingMode(){return this.options.contentFittingMode??"default"}set defaultView(t){this.updateView("defaultView",t),this._views.disabledView&&this.state!=="default"&&(this._views.disabledView.visible=!1)}get defaultView(){return this._views.defaultView}set hoverView(t){this.updateView("hoverView",t),this._views.hoverView&&this.state!=="hover"&&(this._views.hoverView.visible=!1)}get hoverView(){return this._views.hoverView}set pressedView(t){this.updateView("pressedView",t),this._views.pressedView&&this.state!=="pressed"&&(this._views.pressedView.visible=!1)}get pressedView(){return this._views.pressedView}set disabledView(t){this.updateView("disabledView",t),this._views.disabledView&&this.state!=="disabled"&&(this._views.disabledView.visible=!1)}get disabledView(){return this._views.disabledView}updateView(t,e){var i;e!==void 0&&(this.removeView(t),e!==null&&((i=this.options)!=null&&i.nineSliceSprite&&(typeof e=="string"?this._views[t]=new Eo({texture:L.from(e),leftWidth:this.options.nineSliceSprite[0],topHeight:this.options.nineSliceSprite[1],rightWidth:this.options.nineSliceSprite[2],bottomHeight:this.options.nineSliceSprite[3]}):e instanceof L?this._views[t]=new Eo({texture:e,leftWidth:this.options.nineSliceSprite[0],topHeight:this.options.nineSliceSprite[1],rightWidth:this.options.nineSliceSprite[2],bottomHeight:this.options.nineSliceSprite[3]}):console.warn("NineSliceSprite can not be used with views set as Container. Pass the texture or texture name as instead of the Container extended instance.")),this._views[t]||(this._views[t]=Uo(e)),this.setOffset(this._views[t],this.state,this.offset),this._views[t].parent||this.innerView.addChild(this._views[t]),this.updateAnchor(),this._views.iconView&&this.innerView.addChild(this._views.iconView),this._views.textView&&this.innerView.addChild(this._views.textView),this.setState(this.state,!0)))}removeView(t){this._views[t]&&(this.innerView.removeChild(this._views[t]),this._views[t]=null)}set textView(t){t!==void 0&&(this.removeView("textView"),t!==null&&this.createTextView(t))}get textView(){return this._views.textView}set iconView(t){var e;if(t!==void 0&&(this.removeView("iconView"),t!==null)){if(this._views.iconView=Uo(t),((e=this.options)==null?void 0:e.defaultIconScale)===void 0){const{x:i,y:n}=this._views.iconView.scale;this._defaultIconScale={x:i,y:n}}this._views.iconView.parent||this.innerView.addChild(this._views.iconView),this.setState(this.state,!0)}}get iconView(){return this._views.iconView}playAnimations(t){var i;if(!this.animations)return;if(t==="default"&&!this.originalInnerViewState){this.originalInnerViewState={x:this.innerView.x,y:this.innerView.y,width:this.innerView.width,height:this.innerView.height,scale:{x:this.innerView.scale.x,y:this.innerView.scale.y}};const n=(i=this.animations)==null?void 0:i.default;if(n){this.innerView.x=n.props.x??this.originalInnerViewState.x,this.innerView.y=n.props.y??this.originalInnerViewState.y,this.innerView.width=n.props.width??this.originalInnerViewState.width,this.innerView.height=n.props.height??this.originalInnerViewState.height,this.innerView.scale.x=n.props.scale.x??this.originalInnerViewState.scale.x,this.innerView.scale.y=n.props.scale.y??this.originalInnerViewState.scale.y;return}}const e=this.animations[t]??this.animations.default;if(e){const n=e;this.defaultDuration=n.duration,new $(this.innerView).to(n.props,n.duration).start();return}new $(this.innerView).to(this.originalInnerViewState,this.defaultDuration).start()}initStateControl(){this.onDown.connect(()=>{this.setState("pressed")}),this.onUp.connect(()=>{De.any?this.setState("default"):this.setState("hover")}),this.onUpOut.connect(()=>{this.setState("default")}),this.onOut.connect(()=>{this.button.isDown||this.setState("default")}),this.onPress.connect(()=>{De.any?this.setState("default"):this.setState("hover")}),this.onHover.connect(()=>{this.button.isDown||(De.any?this.setState("default"):this.setState("hover"))})}set padding(t){this._padding=t,this.adjustTextView(this.state),this.adjustIconView(this.state)}get padding(){return this._padding}set offset(t){this._offset=t,this.updateAnchor()}get offset(){return this._offset}set textOffset(t){this._textOffset=t,this.adjustTextView(this.state)}get textOffset(){return this._textOffset}set defaultTextScale(t){if(t===void 0)return;this.options.defaultTextScale=t;const e=typeof t=="number";this._defaultTextScale.x=e?t:t.x??1,this._defaultTextScale.y=e?t:t.y??1,this.adjustTextView(this.state)}get defaultTextScale(){return this.defaultTextScale}set defaultIconScale(t){if(t===void 0)return;this.options.defaultIconScale=t;const e=typeof t=="number";this._defaultIconScale.x=e?t:t.x??1,this._defaultIconScale.y=e?t:t.y??1,this.adjustIconView(this.state)}get defaultIconScale(){return this.defaultIconScale}set defaultTextAnchor(t){if(t===void 0)return;this.options.defaultTextAnchor=t;const e=typeof t=="number";this._defaultTextAnchor.x=e?t:t.x??1,this._defaultTextAnchor.y=e?t:t.y??1,this.adjustTextView(this.state)}get defaultTextAnchor(){return this.defaultTextAnchor}set defaultIconAnchor(t){if(t===void 0)return;this.options.defaultIconAnchor=t;const e=typeof t=="number";this._defaultIconAnchor.x=e?t:t.x??1,this._defaultIconAnchor.y=e?t:t.y??1,this.adjustIconView(this.state)}get defaultIconAnchor(){return this.defaultIconAnchor}set width(t){var e;(e=this.options)!=null&&e.nineSliceSprite?(this._views.defaultView&&(this._views.defaultView.width=t),this._views.hoverView&&(this._views.hoverView.width=t),this._views.pressedView&&(this._views.pressedView.width=t),this._views.disabledView&&(this._views.disabledView.width=t),this.adjustTextView(this.state),this.adjustIconView(this.state),this.updateAnchor()):super.width=t}get width(){return super.width}set height(t){var e;(e=this.options)!=null&&e.nineSliceSprite?(this._views.defaultView&&(this._views.defaultView.height=t),this._views.hoverView&&(this._views.hoverView.height=t),this._views.pressedView&&(this._views.pressedView.height=t),this._views.disabledView&&(this._views.disabledView.height=t),this.adjustTextView(this.state),this.adjustIconView(this.state),this.updateAnchor()):super.height=t}get height(){return super.height}setSize(t,e){var i;(i=this.options)!=null&&i.nineSliceSprite?(this._views.defaultView&&this._views.defaultView.setSize(t,e),this._views.hoverView&&this._views.hoverView.setSize(t,e),this._views.pressedView&&this._views.pressedView.setSize(t,e),this._views.disabledView&&this._views.disabledView.setSize(t,e),this.adjustTextView(this.state),this.adjustIconView(this.state),this.updateAnchor()):super.setSize(t,e)}}function Kg(s,t){s.indexOf(t)===-1&&s.push(t)}function ic(s,t){const e=s.indexOf(t);e>-1&&s.splice(e,1)}const Te=(s,t,e)=>e>t?t:e<s?s:e;let Vr=()=>{};const Xt={},nc=s=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(s);function rc(s){return typeof s=="object"&&s!==null}const ac=s=>/^0[^.\s]+$/u.test(s);function Br(s){let t;return()=>(t===void 0&&(t=s()),t)}const Je=s=>s,qg=(s,t)=>e=>t(s(e)),Or=(...s)=>s.reduce(qg),Lr=(s,t,e)=>{const i=t-s;return i===0?1:(e-s)/i};class oc{constructor(){this.subscriptions=[]}add(t){return Kg(this.subscriptions,t),()=>ic(this.subscriptions,t)}notify(t,e,i){const n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](t,e,i);else for(let r=0;r<n;r++){const a=this.subscriptions[r];a&&a(t,e,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Nt=s=>s*1e3,jt=s=>s/1e3;function hc(s,t){return t?s*(1e3/t):0}const Zg=(s,t,e)=>{const i=t-s;return((e-s)%i+i)%i+s},lc=(s,t,e)=>(((1-3*e+3*t)*s+(3*e-6*t))*s+3*t)*s,Qg=1e-7,Jg=12;function ty(s,t,e,i,n){let r,a,o=0;do a=t+(e-t)/2,r=lc(a,i,n)-s,r>0?e=a:t=a;while(Math.abs(r)>Qg&&++o<Jg);return a}function Hs(s,t,e,i){if(s===t&&e===i)return Je;const n=r=>ty(r,0,1,s,e);return r=>r===0||r===1?r:lc(n(r),t,i)}const cc=s=>t=>t<=.5?s(2*t)/2:(2-s(2*(1-t)))/2,uc=s=>t=>1-s(1-t),dc=Hs(.33,1.53,.69,.99),Dr=uc(dc),fc=cc(Dr),pc=s=>(s*=2)<1?.5*Dr(s):.5*(2-Math.pow(2,-10*(s-1))),Nr=s=>1-Math.sin(Math.acos(s)),ey=uc(Nr),mc=cc(Nr),sy=Hs(.42,0,1,1),iy=Hs(0,0,.58,1),gc=Hs(.42,0,.58,1),yc=s=>Array.isArray(s)&&typeof s[0]!="number";function _c(s,t){return yc(s)?s[Zg(0,s.length,t)]:s}const xc=s=>Array.isArray(s)&&typeof s[0]=="number",ny={linear:Je,easeIn:sy,easeInOut:gc,easeOut:iy,circIn:Nr,circInOut:mc,circOut:ey,backIn:Dr,backInOut:fc,backOut:dc,anticipate:pc},ry=s=>typeof s=="string",Wo=s=>{if(xc(s)){Vr(s.length===4);const[t,e,i,n]=s;return Hs(t,e,i,n)}else if(ry(s))return ny[s];return s},ui=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function ay(s,t){let e=new Set,i=new Set,n=!1,r=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function h(c){a.has(c)&&(l.schedule(c),s()),c(o)}const l={schedule:(c,u=!1,d=!1)=>{const p=d&&n?e:i;return u&&a.add(c),p.has(c)||p.add(c),c},cancel:c=>{i.delete(c),a.delete(c)},process:c=>{if(o=c,n){r=!0;return}n=!0,[e,i]=[i,e],e.forEach(h),e.clear(),n=!1,r&&(r=!1,l.process(c))}};return l}const oy=40;function hy(s,t){let e=!1,i=!0;const n={delta:0,timestamp:0,isProcessing:!1},r=()=>e=!0,a=ui.reduce((x,b)=>(x[b]=ay(r),x),{}),{setup:o,read:h,resolveKeyframes:l,preUpdate:c,update:u,preRender:d,render:f,postRender:p}=a,g=()=>{const x=Xt.useManualTiming?n.timestamp:performance.now();e=!1,Xt.useManualTiming||(n.delta=i?1e3/60:Math.max(Math.min(x-n.timestamp,oy),1)),n.timestamp=x,n.isProcessing=!0,o.process(n),h.process(n),l.process(n),c.process(n),u.process(n),d.process(n),f.process(n),p.process(n),n.isProcessing=!1,e&&t&&(i=!1,s(g))},m=()=>{e=!0,i=!0,n.isProcessing||s(g)};return{schedule:ui.reduce((x,b)=>{const S=a[b];return x[b]=(w,v=!1,T=!1)=>(e||m(),S.schedule(w,v,T)),x},{}),cancel:x=>{for(let b=0;b<ui.length;b++)a[ui[b]].cancel(x)},state:n,steps:a}}const{schedule:Kt,cancel:Jn,state:Ti}=hy(typeof requestAnimationFrame<"u"?requestAnimationFrame:Je,!0);let gi;function ly(){gi=void 0}const Ct={now:()=>(gi===void 0&&Ct.set(Ti.isProcessing||Xt.useManualTiming?Ti.timestamp:performance.now()),gi),set:s=>{gi=s,queueMicrotask(ly)}},bc=s=>t=>typeof t=="string"&&t.startsWith(s),wc=bc("--"),cy=bc("var(--"),Ur=s=>cy(s)?uy.test(s.split("/*")[0].trim()):!1,uy=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,ts={test:s=>typeof s=="number",parse:parseFloat,transform:s=>s},Os={...ts,transform:s=>Te(0,1,s)},di={...ts,default:1},ks=s=>Math.round(s*1e5)/1e5,zr=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function dy(s){return s==null}const fy=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Wr=(s,t)=>e=>!!(typeof e=="string"&&fy.test(e)&&e.startsWith(s)||t&&!dy(e)&&Object.prototype.hasOwnProperty.call(e,t)),vc=(s,t,e)=>i=>{if(typeof i!="string")return i;const[n,r,a,o]=i.match(zr);return{[s]:parseFloat(n),[t]:parseFloat(r),[e]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},py=s=>Te(0,255,s),An={...ts,transform:s=>Math.round(py(s))},xe={test:Wr("rgb","red"),parse:vc("red","green","blue"),transform:({red:s,green:t,blue:e,alpha:i=1})=>"rgba("+An.transform(s)+", "+An.transform(t)+", "+An.transform(e)+", "+ks(Os.transform(i))+")"};function my(s){let t="",e="",i="",n="";return s.length>5?(t=s.substring(1,3),e=s.substring(3,5),i=s.substring(5,7),n=s.substring(7,9)):(t=s.substring(1,2),e=s.substring(2,3),i=s.substring(3,4),n=s.substring(4,5),t+=t,e+=e,i+=i,n+=n),{red:parseInt(t,16),green:parseInt(e,16),blue:parseInt(i,16),alpha:n?parseInt(n,16)/255:1}}const tr={test:Wr("#"),parse:my,transform:xe.transform},$s=s=>({test:t=>typeof t=="string"&&t.endsWith(s)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${s}`}),ne=$s("deg"),ze=$s("%"),O=$s("px"),gy=$s("vh"),yy=$s("vw"),Go={...ze,parse:s=>ze.parse(s)/100,transform:s=>ze.transform(s*100)},Be={test:Wr("hsl","hue"),parse:vc("hue","saturation","lightness"),transform:({hue:s,saturation:t,lightness:e,alpha:i=1})=>"hsla("+Math.round(s)+", "+ze.transform(ks(t))+", "+ze.transform(ks(e))+", "+ks(Os.transform(i))+")"},rt={test:s=>xe.test(s)||tr.test(s)||Be.test(s),parse:s=>xe.test(s)?xe.parse(s):Be.test(s)?Be.parse(s):tr.parse(s),transform:s=>typeof s=="string"?s:s.hasOwnProperty("red")?xe.transform(s):Be.transform(s),getAnimatableNone:s=>{const t=rt.parse(s);return t.alpha=0,rt.transform(t)}},_y=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function xy(s){var t,e;return isNaN(s)&&typeof s=="string"&&(((t=s.match(zr))==null?void 0:t.length)||0)+(((e=s.match(_y))==null?void 0:e.length)||0)>0}const Cc="number",Sc="color",by="var",wy="var(",Ho="${}",vy=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ls(s){const t=s.toString(),e=[],i={color:[],number:[],var:[]},n=[];let r=0;const o=t.replace(vy,h=>(rt.test(h)?(i.color.push(r),n.push(Sc),e.push(rt.parse(h))):h.startsWith(wy)?(i.var.push(r),n.push(by),e.push(h)):(i.number.push(r),n.push(Cc),e.push(parseFloat(h))),++r,Ho)).split(Ho);return{values:e,split:o,indexes:i,types:n}}function Ac(s){return Ls(s).values}function Tc(s){const{split:t,types:e}=Ls(s),i=t.length;return n=>{let r="";for(let a=0;a<i;a++)if(r+=t[a],n[a]!==void 0){const o=e[a];o===Cc?r+=ks(n[a]):o===Sc?r+=rt.transform(n[a]):r+=n[a]}return r}}const Cy=s=>typeof s=="number"?0:rt.test(s)?rt.getAnimatableNone(s):s;function Sy(s){const t=Ac(s);return Tc(s)(t.map(Cy))}const es={test:xy,parse:Ac,createTransformer:Tc,getAnimatableNone:Sy};function Tn(s,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?s+(t-s)*6*e:e<1/2?t:e<2/3?s+(t-s)*(2/3-e)*6:s}function Ay({hue:s,saturation:t,lightness:e,alpha:i}){s/=360,t/=100,e/=100;let n=0,r=0,a=0;if(!t)n=r=a=e;else{const o=e<.5?e*(1+t):e+t-e*t,h=2*e-o;n=Tn(h,o,s+1/3),r=Tn(h,o,s),a=Tn(h,o,s-1/3)}return{red:Math.round(n*255),green:Math.round(r*255),blue:Math.round(a*255),alpha:i}}function Pi(s,t){return e=>e>0?t:s}const js=(s,t,e)=>s+(t-s)*e,Pn=(s,t,e)=>{const i=s*s,n=e*(t*t-i)+i;return n<0?0:Math.sqrt(n)},Ty=[tr,xe,Be],Py=s=>Ty.find(t=>t.test(s));function $o(s){const t=Py(s);if(!t)return!1;let e=t.parse(s);return t===Be&&(e=Ay(e)),e}const jo=(s,t)=>{const e=$o(s),i=$o(t);if(!e||!i)return Pi(s,t);const n={...e};return r=>(n.red=Pn(e.red,i.red,r),n.green=Pn(e.green,i.green,r),n.blue=Pn(e.blue,i.blue,r),n.alpha=js(e.alpha,i.alpha,r),xe.transform(n))},er=new Set(["none","hidden"]);function My(s,t){return er.has(s)?e=>e<=0?s:t:e=>e>=1?t:s}function Ey(s,t){return e=>js(s,t,e)}function Gr(s){return typeof s=="number"?Ey:typeof s=="string"?Ur(s)?Pi:rt.test(s)?jo:Ry:Array.isArray(s)?Pc:typeof s=="object"?rt.test(s)?jo:ky:Pi}function Pc(s,t){const e=[...s],i=e.length,n=s.map((r,a)=>Gr(r)(r,t[a]));return r=>{for(let a=0;a<i;a++)e[a]=n[a](r);return e}}function ky(s,t){const e={...s,...t},i={};for(const n in e)s[n]!==void 0&&t[n]!==void 0&&(i[n]=Gr(s[n])(s[n],t[n]));return n=>{for(const r in i)e[r]=i[r](n);return e}}function Iy(s,t){const e=[],i={color:0,var:0,number:0};for(let n=0;n<t.values.length;n++){const r=t.types[n],a=s.indexes[r][i[r]],o=s.values[a]??0;e[n]=o,i[r]++}return e}const Ry=(s,t)=>{const e=es.createTransformer(t),i=Ls(s),n=Ls(t);return i.indexes.var.length===n.indexes.var.length&&i.indexes.color.length===n.indexes.color.length&&i.indexes.number.length>=n.indexes.number.length?er.has(s)&&!n.values.length||er.has(t)&&!i.values.length?My(s,t):Or(Pc(Iy(i,n),n.values),e):Pi(s,t)};function Mc(s,t,e){return typeof s=="number"&&typeof t=="number"&&typeof e=="number"?js(s,t,e):Gr(s)(s,t)}const Fy=s=>{const t=({timestamp:e})=>s(e);return{start:(e=!0)=>Kt.update(t,e),stop:()=>Jn(t),now:()=>Ti.isProcessing?Ti.timestamp:Ct.now()}},Ec=(s,t,e=10)=>{let i="";const n=Math.max(Math.round(t/e),2);for(let r=0;r<n;r++)i+=Math.round(s(r/(n-1))*1e4)/1e4+", ";return`linear(${i.substring(0,i.length-2)})`},Mi=2e4;function Hr(s){let t=0;const e=50;let i=s.next(t);for(;!i.done&&t<Mi;)t+=e,i=s.next(t);return t>=Mi?1/0:t}function kc(s,t=100,e){const i=e({...s,keyframes:[0,t]}),n=Math.min(Hr(i),Mi);return{type:"keyframes",ease:r=>i.next(n*r).value/t,duration:jt(n)}}const Vy=5;function Ic(s,t,e){const i=Math.max(t-Vy,0);return hc(e-s(i),t-i)}const J={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Mn=.001;function By({duration:s=J.duration,bounce:t=J.bounce,velocity:e=J.velocity,mass:i=J.mass}){let n,r,a=1-t;a=Te(J.minDamping,J.maxDamping,a),s=Te(J.minDuration,J.maxDuration,jt(s)),a<1?(n=l=>{const c=l*a,u=c*s,d=c-e,f=sr(l,a),p=Math.exp(-u);return Mn-d/f*p},r=l=>{const u=l*a*s,d=u*e+e,f=Math.pow(a,2)*Math.pow(l,2)*s,p=Math.exp(-u),g=sr(Math.pow(l,2),a);return(-n(l)+Mn>0?-1:1)*((d-f)*p)/g}):(n=l=>{const c=Math.exp(-l*s),u=(l-e)*s+1;return-Mn+c*u},r=l=>{const c=Math.exp(-l*s),u=(e-l)*(s*s);return c*u});const o=5/s,h=Ly(n,r,o);if(s=Nt(s),isNaN(h))return{stiffness:J.stiffness,damping:J.damping,duration:s};{const l=Math.pow(h,2)*i;return{stiffness:l,damping:a*2*Math.sqrt(i*l),duration:s}}}const Oy=12;function Ly(s,t,e){let i=e;for(let n=1;n<Oy;n++)i=i-s(i)/t(i);return i}function sr(s,t){return s*Math.sqrt(1-t*t)}const Dy=["duration","bounce"],Ny=["stiffness","damping","mass"];function Yo(s,t){return t.some(e=>s[e]!==void 0)}function Uy(s){let t={velocity:J.velocity,stiffness:J.stiffness,damping:J.damping,mass:J.mass,isResolvedFromDuration:!1,...s};if(!Yo(s,Ny)&&Yo(s,Dy))if(s.visualDuration){const e=s.visualDuration,i=2*Math.PI/(e*1.2),n=i*i,r=2*Te(.05,1,1-(s.bounce||0))*Math.sqrt(n);t={...t,mass:J.mass,stiffness:n,damping:r}}else{const e=By(s);t={...t,...e,mass:J.mass},t.isResolvedFromDuration=!0}return t}function Ds(s=J.visualDuration,t=J.bounce){const e=typeof s!="object"?{visualDuration:s,keyframes:[0,1],bounce:t}:s;let{restSpeed:i,restDelta:n}=e;const r=e.keyframes[0],a=e.keyframes[e.keyframes.length-1],o={done:!1,value:r},{stiffness:h,damping:l,mass:c,duration:u,velocity:d,isResolvedFromDuration:f}=Uy({...e,velocity:-jt(e.velocity||0)}),p=d||0,g=l/(2*Math.sqrt(h*c)),m=a-r,y=jt(Math.sqrt(h/c)),_=Math.abs(m)<5;i||(i=_?J.restSpeed.granular:J.restSpeed.default),n||(n=_?J.restDelta.granular:J.restDelta.default);let x;if(g<1){const S=sr(y,g);x=w=>{const v=Math.exp(-g*y*w);return a-v*((p+g*y*m)/S*Math.sin(S*w)+m*Math.cos(S*w))}}else if(g===1)x=S=>a-Math.exp(-y*S)*(m+(p+y*m)*S);else{const S=y*Math.sqrt(g*g-1);x=w=>{const v=Math.exp(-g*y*w),T=Math.min(S*w,300);return a-v*((p+g*y*m)*Math.sinh(T)+S*m*Math.cosh(T))/S}}const b={calculatedDuration:f&&u||null,next:S=>{const w=x(S);if(f)o.done=S>=u;else{let v=S===0?p:0;g<1&&(v=S===0?Nt(p):Ic(x,S,w));const T=Math.abs(v)<=i,k=Math.abs(a-w)<=n;o.done=T&&k}return o.value=o.done?a:w,o},toString:()=>{const S=Math.min(Hr(b),Mi),w=Ec(v=>b.next(S*v).value,S,30);return S+"ms "+w},toTransition:()=>{}};return b}Ds.applyToOptions=s=>{const t=kc(s,100,Ds);return s.ease=t.ease,s.duration=Nt(t.duration),s.type="keyframes",s};function ir({keyframes:s,velocity:t=0,power:e=.8,timeConstant:i=325,bounceDamping:n=10,bounceStiffness:r=500,modifyTarget:a,min:o,max:h,restDelta:l=.5,restSpeed:c}){const u=s[0],d={done:!1,value:u},f=T=>o!==void 0&&T<o||h!==void 0&&T>h,p=T=>o===void 0?h:h===void 0||Math.abs(o-T)<Math.abs(h-T)?o:h;let g=e*t;const m=u+g,y=a===void 0?m:a(m);y!==m&&(g=y-u);const _=T=>-g*Math.exp(-T/i),x=T=>y+_(T),b=T=>{const k=_(T),M=x(T);d.done=Math.abs(k)<=l,d.value=d.done?y:M};let S,w;const v=T=>{f(d.value)&&(S=T,w=Ds({keyframes:[d.value,p(d.value)],velocity:Ic(x,T,d.value),damping:n,stiffness:r,restDelta:l,restSpeed:c}))};return v(0),{calculatedDuration:null,next:T=>{let k=!1;return!w&&S===void 0&&(k=!0,b(T),v(T)),S!==void 0&&T>=S?w.next(T-S):(!k&&b(T),d)}}}function zy(s,t,e){const i=[],n=e||Xt.mix||Mc,r=s.length-1;for(let a=0;a<r;a++){let o=n(s[a],s[a+1]);if(t){const h=Array.isArray(t)?t[a]||Je:t;o=Or(h,o)}i.push(o)}return i}function Wy(s,t,{clamp:e=!0,ease:i,mixer:n}={}){const r=s.length;if(Vr(r===t.length),r===1)return()=>t[0];if(r===2&&t[0]===t[1])return()=>t[1];const a=s[0]===s[1];s[0]>s[r-1]&&(s=[...s].reverse(),t=[...t].reverse());const o=zy(t,i,n),h=o.length,l=c=>{if(a&&c<s[0])return t[0];let u=0;if(h>1)for(;u<s.length-2&&!(c<s[u+1]);u++);const d=Lr(s[u],s[u+1],c);return o[u](d)};return e?c=>l(Te(s[0],s[r-1],c)):l}function Rc(s,t){const e=s[s.length-1];for(let i=1;i<=t;i++){const n=Lr(0,t,i);s.push(js(e,1,n))}}function Fc(s){const t=[0];return Rc(t,s.length-1),t}function Gy(s,t){return s.map(e=>e*t)}function Hy(s,t){return s.map(()=>t||gc).splice(0,s.length-1)}function Is({duration:s=300,keyframes:t,times:e,ease:i="easeInOut"}){const n=yc(i)?i.map(Wo):Wo(i),r={done:!1,value:t[0]},a=Gy(e&&e.length===t.length?e:Fc(t),s),o=Wy(a,t,{ease:Array.isArray(n)?n:Hy(t,n)});return{calculatedDuration:s,next:h=>(r.value=o(h),r.done=h>=s,r)}}const $y=s=>s!==null;function $r(s,{repeat:t,repeatType:e="loop"},i,n=1){const r=s.filter($y),o=n<0||t&&e!=="loop"&&t%2===1?0:r.length-1;return!o||i===void 0?r[o]:i}const jy={decay:ir,inertia:ir,tween:Is,keyframes:Is,spring:Ds};function Vc(s){typeof s.type=="string"&&(s.type=jy[s.type])}class jr{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,e){return this.finished.then(t,e)}}const Yy=s=>s/100;class Yr extends jr{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var i,n;const{motionValue:e}=this.options;e&&e.updatedAt!==Ct.now()&&this.tick(Ct.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(n=(i=this.options).onStop)==null||n.call(i))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;Vc(t);const{type:e=Is,repeat:i=0,repeatDelay:n=0,repeatType:r,velocity:a=0}=t;let{keyframes:o}=t;const h=e||Is;h!==Is&&typeof o[0]!="number"&&(this.mixKeyframes=Or(Yy,Mc(o[0],o[1])),o=[0,100]);const l=h({...t,keyframes:o});r==="mirror"&&(this.mirroredGenerator=h({...t,keyframes:[...o].reverse(),velocity:-a})),l.calculatedDuration===null&&(l.calculatedDuration=Hr(l));const{calculatedDuration:c}=l;this.calculatedDuration=c,this.resolvedDuration=c+n,this.totalDuration=this.resolvedDuration*(i+1)-n,this.generator=l}updateTime(t){const e=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=e}tick(t,e=!1){const{generator:i,totalDuration:n,mixKeyframes:r,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:h}=this;if(this.startTime===null)return i.next(0);const{delay:l=0,keyframes:c,repeat:u,repeatType:d,repeatDelay:f,type:p,onUpdate:g,finalKeyframe:m}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-n/this.speed,this.startTime)),e?this.currentTime=t:this.updateTime(t);const y=this.currentTime-l*(this.playbackSpeed>=0?1:-1),_=this.playbackSpeed>=0?y<0:y>n;this.currentTime=Math.max(y,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=n);let x=this.currentTime,b=i;if(u){const T=Math.min(this.currentTime,n)/o;let k=Math.floor(T),M=T%1;!M&&T>=1&&(M=1),M===1&&k--,k=Math.min(k,u+1),!!(k%2)&&(d==="reverse"?(M=1-M,f&&(M-=f/o)):d==="mirror"&&(b=a)),x=Te(0,1,M)*o}const S=_?{done:!1,value:c[0]}:b.next(x);r&&(S.value=r(S.value));let{done:w}=S;!_&&h!==null&&(w=this.playbackSpeed>=0?this.currentTime>=n:this.currentTime<=0);const v=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&w);return v&&p!==ir&&(S.value=$r(c,this.options,m,this.speed)),g&&g(S.value),v&&this.finish(),S}then(t,e){return this.finished.then(t,e)}get duration(){return jt(this.calculatedDuration)}get time(){return jt(this.currentTime)}set time(t){var e;t=Nt(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(e=this.driver)==null||e.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Ct.now());const e=this.playbackSpeed!==t;this.playbackSpeed=t,e&&(this.time=jt(this.currentTime))}play(){var n,r;if(this.isStopped)return;const{driver:t=Fy,startTime:e}=this.options;this.driver||(this.driver=t(a=>this.tick(a))),(r=(n=this.options).onPlay)==null||r.call(n);const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=e??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ct.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,e;this.notifyFinished(),this.teardown(),this.state="finished",(e=(t=this.options).onComplete)==null||e.call(t)}cancel(){var t,e;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(e=(t=this.options).onCancel)==null||e.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var e;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(e=this.driver)==null||e.stop(),t.observe(this)}}function Xy(s){for(let t=1;t<s.length;t++)s[t]??(s[t]=s[t-1])}const be=s=>s*180/Math.PI,nr=s=>{const t=be(Math.atan2(s[1],s[0]));return rr(t)},Ky={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:s=>(Math.abs(s[0])+Math.abs(s[3]))/2,rotate:nr,rotateZ:nr,skewX:s=>be(Math.atan(s[1])),skewY:s=>be(Math.atan(s[2])),skew:s=>(Math.abs(s[1])+Math.abs(s[2]))/2},rr=s=>(s=s%360,s<0&&(s+=360),s),Xo=nr,Ko=s=>Math.sqrt(s[0]*s[0]+s[1]*s[1]),qo=s=>Math.sqrt(s[4]*s[4]+s[5]*s[5]),qy={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Ko,scaleY:qo,scale:s=>(Ko(s)+qo(s))/2,rotateX:s=>rr(be(Math.atan2(s[6],s[5]))),rotateY:s=>rr(be(Math.atan2(-s[2],s[0]))),rotateZ:Xo,rotate:Xo,skewX:s=>be(Math.atan(s[4])),skewY:s=>be(Math.atan(s[1])),skew:s=>(Math.abs(s[1])+Math.abs(s[4]))/2};function ar(s){return s.includes("scale")?1:0}function or(s,t){if(!s||s==="none")return ar(t);const e=s.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,n;if(e)i=qy,n=e;else{const o=s.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=Ky,n=o}if(!n)return ar(t);const r=i[t],a=n[1].split(",").map(Qy);return typeof r=="function"?r(a):a[r]}const Zy=(s,t)=>{const{transform:e="none"}=getComputedStyle(s);return or(e,t)};function Qy(s){return parseFloat(s.trim())}const ss=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],is=new Set(ss),Zo=s=>s===ts||s===O,Jy=new Set(["x","y","z"]),t_=ss.filter(s=>!Jy.has(s));function e_(s){const t=[];return t_.forEach(e=>{const i=s.getValue(e);i!==void 0&&(t.push([e,i.get()]),i.set(e.startsWith("scale")?1:0))}),t}const we={width:({x:s},{paddingLeft:t="0",paddingRight:e="0"})=>s.max-s.min-parseFloat(t)-parseFloat(e),height:({y:s},{paddingTop:t="0",paddingBottom:e="0"})=>s.max-s.min-parseFloat(t)-parseFloat(e),top:(s,{top:t})=>parseFloat(t),left:(s,{left:t})=>parseFloat(t),bottom:({y:s},{top:t})=>parseFloat(t)+(s.max-s.min),right:({x:s},{left:t})=>parseFloat(t)+(s.max-s.min),x:(s,{transform:t})=>or(t,"x"),y:(s,{transform:t})=>or(t,"y")};we.translateX=we.x;we.translateY=we.y;const ve=new Set;let hr=!1,lr=!1,cr=!1;function Bc(){if(lr){const s=Array.from(ve).filter(i=>i.needsMeasurement),t=new Set(s.map(i=>i.element)),e=new Map;t.forEach(i=>{const n=e_(i);n.length&&(e.set(i,n),i.render())}),s.forEach(i=>i.measureInitialState()),t.forEach(i=>{i.render();const n=e.get(i);n&&n.forEach(([r,a])=>{var o;(o=i.getValue(r))==null||o.set(a)})}),s.forEach(i=>i.measureEndState()),s.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}lr=!1,hr=!1,ve.forEach(s=>s.complete(cr)),ve.clear()}function Oc(){ve.forEach(s=>{s.readKeyframes(),s.needsMeasurement&&(lr=!0)})}function s_(){cr=!0,Oc(),Bc(),cr=!1}class Xr{constructor(t,e,i,n,r,a=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=e,this.name=i,this.motionValue=n,this.element=r,this.isAsync=a}scheduleResolve(){this.state="scheduled",this.isAsync?(ve.add(this),hr||(hr=!0,Kt.read(Oc),Kt.resolveKeyframes(Bc))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:e,element:i,motionValue:n}=this;if(t[0]===null){const r=n==null?void 0:n.get(),a=t[t.length-1];if(r!==void 0)t[0]=r;else if(i&&e){const o=i.readValue(e,a);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=a),n&&r===void 0&&n.set(t[0])}Xy(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),ve.delete(this)}cancel(){this.state==="scheduled"&&(ve.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const i_=s=>s.startsWith("--");function n_(s,t,e){i_(t)?s.style.setProperty(t,e):s.style[t]=e}const r_=Br(()=>window.ScrollTimeline!==void 0),a_={};function o_(s,t){const e=Br(s);return()=>a_[t]??e()}const Lc=o_(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),As=([s,t,e,i])=>`cubic-bezier(${s}, ${t}, ${e}, ${i})`,Qo={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:As([0,.65,.55,1]),circOut:As([.55,0,1,.45]),backIn:As([.31,.01,.66,-.59]),backOut:As([.33,1.53,.69,.99])};function Dc(s,t){if(s)return typeof s=="function"?Lc()?Ec(s,t):"ease-out":xc(s)?As(s):Array.isArray(s)?s.map(e=>Dc(e,t)||Qo.easeOut):Qo[s]}function h_(s,t,e,{delay:i=0,duration:n=300,repeat:r=0,repeatType:a="loop",ease:o="easeOut",times:h}={},l=void 0){const c={[t]:e};h&&(c.offset=h);const u=Dc(o,n);Array.isArray(u)&&(c.easing=u);const d={delay:i,duration:n,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:r+1,direction:a==="reverse"?"alternate":"normal"};return l&&(d.pseudoElement=l),s.animate(c,d)}function Kr(s){return typeof s=="function"&&"applyToOptions"in s}function l_({type:s,...t}){return Kr(s)&&Lc()?s.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class c_ extends jr{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:e,name:i,keyframes:n,pseudoElement:r,allowFlatten:a=!1,finalKeyframe:o,onComplete:h}=t;this.isPseudoElement=!!r,this.allowFlatten=a,this.options=t,Vr(typeof t.type!="string");const l=l_(t);this.animation=h_(e,i,n,l,r),l.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!r){const c=$r(n,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(c):n_(e,i,c),this.animation.cancel()}h==null||h(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,e;(e=(t=this.animation).finish)==null||e.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,e;this.isPseudoElement||(e=(t=this.animation).commitStyles)==null||e.call(t)}get duration(){var e,i;const t=((i=(e=this.animation.effect)==null?void 0:e.getComputedTiming)==null?void 0:i.call(e).duration)||0;return jt(Number(t))}get time(){return jt(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Nt(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:e}){var i;return this.allowFlatten&&((i=this.animation.effect)==null||i.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&r_()?(this.animation.timeline=t,Je):e(this)}}const Nc={anticipate:pc,backInOut:fc,circInOut:mc};function u_(s){return s in Nc}function d_(s){typeof s.ease=="string"&&u_(s.ease)&&(s.ease=Nc[s.ease])}const Jo=10;class f_ extends c_{constructor(t){d_(t),Vc(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:e,onUpdate:i,onComplete:n,element:r,...a}=this.options;if(!e)return;if(t!==void 0){e.set(t);return}const o=new Yr({...a,autoplay:!1}),h=Nt(this.finishedTime??this.time);e.setWithVelocity(o.sample(h-Jo).value,o.sample(h).value,Jo),o.stop()}}const th=(s,t)=>t==="zIndex"?!1:!!(typeof s=="number"||Array.isArray(s)||typeof s=="string"&&(es.test(s)||s==="0")&&!s.startsWith("url("));function p_(s){const t=s[0];if(s.length===1)return!0;for(let e=0;e<s.length;e++)if(s[e]!==t)return!0}function m_(s,t,e,i){const n=s[0];if(n===null)return!1;if(t==="display"||t==="visibility")return!0;const r=s[s.length-1],a=th(n,t),o=th(r,t);return!a||!o?!1:p_(s)||(e==="spring"||Kr(e))&&i}function g_(s){return rc(s)&&"offsetHeight"in s}const y_=new Set(["opacity","clipPath","filter","transform"]),__=Br(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function x_(s){var l;const{motionValue:t,name:e,repeatDelay:i,repeatType:n,damping:r,type:a}=s;if(!g_((l=t==null?void 0:t.owner)==null?void 0:l.current))return!1;const{onUpdate:o,transformTemplate:h}=t.owner.getProps();return __()&&e&&y_.has(e)&&(e!=="transform"||!h)&&!o&&!i&&n!=="mirror"&&r!==0&&a!=="inertia"}const b_=40;class w_ extends jr{constructor({autoplay:t=!0,delay:e=0,type:i="keyframes",repeat:n=0,repeatDelay:r=0,repeatType:a="loop",keyframes:o,name:h,motionValue:l,element:c,...u}){var p;super(),this.stop=()=>{var g,m;this._animation&&(this._animation.stop(),(g=this.stopTimeline)==null||g.call(this)),(m=this.keyframeResolver)==null||m.cancel()},this.createdAt=Ct.now();const d={autoplay:t,delay:e,type:i,repeat:n,repeatDelay:r,repeatType:a,name:h,motionValue:l,element:c,...u},f=(c==null?void 0:c.KeyframeResolver)||Xr;this.keyframeResolver=new f(o,(g,m,y)=>this.onKeyframesResolved(g,m,d,!y),h,l,c),(p=this.keyframeResolver)==null||p.scheduleResolve()}onKeyframesResolved(t,e,i,n){this.keyframeResolver=void 0;const{name:r,type:a,velocity:o,delay:h,isHandoff:l,onUpdate:c}=i;this.resolvedAt=Ct.now(),m_(t,r,a,o)||((Xt.instantAnimations||!h)&&(c==null||c($r(t,i,e))),t[0]=t[t.length-1],i.duration=0,i.repeat=0);const d={startTime:n?this.resolvedAt?this.resolvedAt-this.createdAt>b_?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:e,...i,keyframes:t},f=!l&&x_(d)?new f_({...d,element:d.motionValue.owner.current}):new Yr(d);f.finished.then(()=>this.notifyFinished()).catch(Je),this.pendingTimeline&&(this.stopTimeline=f.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=f}get finished(){return this._animation?this.animation.finished:this._finished}then(t,e){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),s_()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}class v_{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>t.finished))}getAll(t){return this.animations[0][t]}setAll(t,e){for(let i=0;i<this.animations.length;i++)this.animations[i][t]=e}attachTimeline(t){const e=this.animations.map(i=>i.attachTimeline(t));return()=>{e.forEach((i,n)=>{i&&i(),this.animations[n].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get state(){return this.getAll("state")}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let e=0;e<this.animations.length;e++)t=Math.max(t,this.animations[e].duration);return t}runAll(t){this.animations.forEach(e=>e[t]())}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class C_ extends v_{then(t,e){return this.finished.finally(t).then(()=>{})}}const S_=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function A_(s){const t=S_.exec(s);if(!t)return[,];const[,e,i,n]=t;return[`--${e??i}`,n]}function Uc(s,t,e=1){const[i,n]=A_(s);if(!i)return;const r=window.getComputedStyle(t).getPropertyValue(i);if(r){const a=r.trim();return nc(a)?parseFloat(a):a}return Ur(n)?Uc(n,t,e+1):n}function zc(s,t){return(s==null?void 0:s[t])??(s==null?void 0:s.default)??s}const Wc=new Set(["width","height","top","left","right","bottom",...ss]),T_={test:s=>s==="auto",parse:s=>s},Gc=s=>t=>t.test(s),Hc=[ts,O,ze,ne,yy,gy,T_],eh=s=>Hc.find(Gc(s));function P_(s){return typeof s=="number"?s===0:s!==null?s==="none"||s==="0"||ac(s):!0}const M_=new Set(["brightness","contrast","saturate","opacity"]);function E_(s){const[t,e]=s.slice(0,-1).split("(");if(t==="drop-shadow")return s;const[i]=e.match(zr)||[];if(!i)return s;const n=e.replace(i,"");let r=M_.has(t)?1:0;return i!==e&&(r*=100),t+"("+r+n+")"}const k_=/\b([a-z-]*)\(.*?\)/gu,ur={...es,getAnimatableNone:s=>{const t=s.match(k_);return t?t.map(E_).join(" "):s}},sh={...ts,transform:Math.round},I_={rotate:ne,rotateX:ne,rotateY:ne,rotateZ:ne,scale:di,scaleX:di,scaleY:di,scaleZ:di,skew:ne,skewX:ne,skewY:ne,distance:O,translateX:O,translateY:O,translateZ:O,x:O,y:O,z:O,perspective:O,transformPerspective:O,opacity:Os,originX:Go,originY:Go,originZ:O},qr={borderWidth:O,borderTopWidth:O,borderRightWidth:O,borderBottomWidth:O,borderLeftWidth:O,borderRadius:O,radius:O,borderTopLeftRadius:O,borderTopRightRadius:O,borderBottomRightRadius:O,borderBottomLeftRadius:O,width:O,maxWidth:O,height:O,maxHeight:O,top:O,right:O,bottom:O,left:O,padding:O,paddingTop:O,paddingRight:O,paddingBottom:O,paddingLeft:O,margin:O,marginTop:O,marginRight:O,marginBottom:O,marginLeft:O,backgroundPositionX:O,backgroundPositionY:O,...I_,zIndex:sh,fillOpacity:Os,strokeOpacity:Os,numOctaves:sh},R_={...qr,color:rt,backgroundColor:rt,outlineColor:rt,fill:rt,stroke:rt,borderColor:rt,borderTopColor:rt,borderRightColor:rt,borderBottomColor:rt,borderLeftColor:rt,filter:ur,WebkitFilter:ur},$c=s=>R_[s];function jc(s,t){let e=$c(s);return e!==ur&&(e=es),e.getAnimatableNone?e.getAnimatableNone(t):void 0}const F_=new Set(["auto","none","0"]);function V_(s,t,e){let i=0,n;for(;i<s.length&&!n;){const r=s[i];typeof r=="string"&&!F_.has(r)&&Ls(r).values.length&&(n=s[i]),i++}if(n&&e)for(const r of t)s[r]=jc(e,n)}class B_ extends Xr{constructor(t,e,i,n,r){super(t,e,i,n,r,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:e,name:i}=this;if(!e||!e.current)return;super.readKeyframes();for(let h=0;h<t.length;h++){let l=t[h];if(typeof l=="string"&&(l=l.trim(),Ur(l))){const c=Uc(l,e.current);c!==void 0&&(t[h]=c),h===t.length-1&&(this.finalKeyframe=l)}}if(this.resolveNoneKeyframes(),!Wc.has(i)||t.length!==2)return;const[n,r]=t,a=eh(n),o=eh(r);if(a!==o)if(Zo(a)&&Zo(o))for(let h=0;h<t.length;h++){const l=t[h];typeof l=="string"&&(t[h]=parseFloat(l))}else we[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:e}=this,i=[];for(let n=0;n<t.length;n++)(t[n]===null||P_(t[n]))&&i.push(n);i.length&&V_(t,i,e)}measureInitialState(){const{element:t,unresolvedKeyframes:e,name:i}=this;if(!t||!t.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=we[i](t.measureViewportBox(),window.getComputedStyle(t.current)),e[0]=this.measuredOrigin;const n=e[e.length-1];n!==void 0&&t.getValue(i,n).jump(n,!1)}measureEndState(){var o;const{element:t,name:e,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const n=t.getValue(e);n&&n.jump(this.measuredOrigin,!1);const r=i.length-1,a=i[r];i[r]=we[e](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([h,l])=>{t.getValue(h).set(l)}),this.resolveNoneKeyframes()}}function O_(s,t,e){if(s instanceof EventTarget)return[s];if(typeof s=="string"){let i=document;const n=(e==null?void 0:e[s])??i.querySelectorAll(s);return n?Array.from(n):[]}return Array.from(s)}const Yc=(s,t)=>t&&typeof s=="number"?t.transform(s):s,ih=30,L_=s=>!isNaN(parseFloat(s));class D_{constructor(t,e={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,n=!0)=>{var a,o;const r=Ct.now();if(this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current),this.dependents))for(const h of this.dependents)h.dirty();n&&((o=this.events.renderRequest)==null||o.notify(this.current))},this.hasAnimated=!1,this.setCurrent(t),this.owner=e.owner}setCurrent(t){this.current=t,this.updatedAt=Ct.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=L_(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,e){this.events[t]||(this.events[t]=new oc);const i=this.events[t].add(e);return t==="change"?()=>{i(),Kt.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,e){this.passiveEffect=t,this.stopPassiveEffect=e}set(t,e=!0){!e||!this.passiveEffect?this.updateAndNotify(t,e):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,e,i){this.set(e),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-i}jump(t,e=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,e&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Ct.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>ih)return 0;const e=Math.min(this.updatedAt-this.prevUpdatedAt,ih);return hc(parseFloat(this.current)-parseFloat(this.prevFrameValue),e)}start(t){return this.stop(),new Promise(e=>{this.hasAnimated=!0,this.animation=t(e),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,e;(t=this.dependents)==null||t.clear(),(e=this.events.destroy)==null||e.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ns(s,t){return new D_(s,t)}function Xc(s){return rc(s)&&"ownerSVGElement"in s}function N_(s){return Xc(s)&&s.tagName==="svg"}const _t=s=>!!(s&&s.getVelocity),U_=[...Hc,rt,es],z_=s=>U_.find(Gc(s));function Zr(s){return typeof s=="object"&&!Array.isArray(s)}function Kc(s,t,e,i){return typeof s=="string"&&Zr(t)?O_(s,e,i):s instanceof NodeList?Array.from(s):Array.isArray(s)?s:[s]}function W_(s,t,e){return s*(t+1)}function nh(s,t,e,i){return typeof t=="number"?t:t.startsWith("-")||t.startsWith("+")?Math.max(0,s+parseFloat(t)):t==="<"?e:t.startsWith("<")?Math.max(0,e+parseFloat(t.slice(1))):i.get(t)??s}function G_(s,t,e){for(let i=0;i<s.length;i++){const n=s[i];n.at>t&&n.at<e&&(ic(s,n),i--)}}function H_(s,t,e,i,n,r){G_(s,n,r);for(let a=0;a<t.length;a++)s.push({value:t[a],at:js(n,r,i[a]),easing:_c(e,a)})}function $_(s,t){for(let e=0;e<s.length;e++)s[e]=s[e]/(t+1)}function j_(s,t){return s.at===t.at?s.value===null?1:t.value===null?-1:0:s.at-t.at}const Y_="easeInOut";function X_(s,{defaultTransition:t={},...e}={},i,n){const r=t.duration||.3,a=new Map,o=new Map,h={},l=new Map;let c=0,u=0,d=0;for(let f=0;f<s.length;f++){const p=s[f];if(typeof p=="string"){l.set(p,u);continue}else if(!Array.isArray(p)){l.set(p.name,nh(u,p.at,c,l));continue}let[g,m,y={}]=p;y.at!==void 0&&(u=nh(u,y.at,c,l));let _=0;const x=(b,S,w,v=0,T=0)=>{const k=K_(b),{delay:M=0,times:E=Fc(k),type:z="keyframes",repeat:B,repeatType:lt,repeatDelay:Zt=0,...V}=S;let{ease:F=t.ease||"easeOut",duration:St}=S;const H=typeof M=="function"?M(v,T):M,At=k.length,Qt=Kr(z)?z:n==null?void 0:n[z||"keyframes"];if(At<=2&&Qt){let Rt=100;if(At===2&&Q_(k)){const ee=k[1]-k[0];Rt=Math.abs(ee)}const Ft={...V};St!==void 0&&(Ft.duration=Nt(St));const oe=kc(Ft,Rt,Qt);F=oe.ease,St=oe.duration}St??(St=r);const Jt=u+H;E.length===1&&E[0]===0&&(E[1]=1);const te=E.length-k.length;if(te>0&&Rc(E,te),k.length===1&&k.unshift(null),B){St=W_(St,B);const Rt=[...k],Ft=[...E];F=Array.isArray(F)?[...F]:[F];const oe=[...F];for(let ee=0;ee<B;ee++){k.push(...Rt);for(let Vt=0;Vt<Rt.length;Vt++)E.push(Ft[Vt]+(ee+1)),F.push(Vt===0?"linear":_c(oe,Vt-1))}$_(E,B)}const ns=Jt+St;H_(w,k,F,E,Jt,ns),_=Math.max(H+St,_),d=Math.max(ns,d)};if(_t(g)){const b=rh(g,o);x(m,y,ah("default",b))}else{const b=Kc(g,m,i,h),S=b.length;for(let w=0;w<S;w++){m=m,y=y;const v=b[w],T=rh(v,o);for(const k in m)x(m[k],q_(y,k),ah(k,T),w,S)}}c=u,u+=_}return o.forEach((f,p)=>{for(const g in f){const m=f[g];m.sort(j_);const y=[],_=[],x=[];for(let S=0;S<m.length;S++){const{at:w,value:v,easing:T}=m[S];y.push(v),_.push(Lr(0,d,w)),x.push(T||"easeOut")}_[0]!==0&&(_.unshift(0),y.unshift(y[0]),x.unshift(Y_)),_[_.length-1]!==1&&(_.push(1),y.push(null)),a.has(p)||a.set(p,{keyframes:{},transition:{}});const b=a.get(p);b.keyframes[g]=y,b.transition[g]={...t,duration:d,ease:x,times:_,...e}}}),a}function rh(s,t){return!t.has(s)&&t.set(s,{}),t.get(s)}function ah(s,t){return t[s]||(t[s]=[]),t[s]}function K_(s){return Array.isArray(s)?s:[s]}function q_(s,t){return s&&s[t]?{...s,...s[t]}:{...s}}const Z_=s=>typeof s=="number",Q_=s=>s.every(Z_),Us=new WeakMap,J_=s=>Array.isArray(s);function oh(s){const t=[{},{}];return s==null||s.values.forEach((e,i)=>{t[0][i]=e.get(),t[1][i]=e.getVelocity()}),t}function qc(s,t,e,i){if(typeof t=="function"){const[n,r]=oh(i);t=t(e!==void 0?e:s.custom,n,r)}if(typeof t=="string"&&(t=s.variants&&s.variants[t]),typeof t=="function"){const[n,r]=oh(i);t=t(e!==void 0?e:s.custom,n,r)}return t}function tx(s,t,e){const i=s.getProps();return qc(i,t,i.custom,s)}function ex(s,t,e){s.hasValue(t)?s.getValue(t).set(e):s.addValue(t,Ns(e))}function sx(s){return J_(s)?s[s.length-1]||0:s}function ix(s,t){const e=tx(s,t);let{transitionEnd:i={},transition:n={},...r}=e||{};r={...r,...i};for(const a in r){const o=sx(r[a]);ex(s,a,o)}}function nx(s){return!!(_t(s)&&s.add)}function rx(s,t){const e=s.getValue("willChange");if(nx(e))return e.add(t);if(!e&&Xt.WillChange){const i=new Xt.WillChange("auto");s.addValue("willChange",i),i.add(t)}}const Qr=s=>s.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),ax="framerAppearId",ox="data-"+Qr(ax);function hx(s){return s.props[ox]}const lx=s=>s!==null;function cx(s,{repeat:t,repeatType:e="loop"},i){const n=s.filter(lx),r=t&&e!=="loop"&&t%2===1?0:n.length-1;return n[r]}const ux={type:"spring",stiffness:500,damping:25,restSpeed:10},dx=s=>({type:"spring",stiffness:550,damping:s===0?2*Math.sqrt(550):30,restSpeed:10}),fx={type:"keyframes",duration:.8},px={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},mx=(s,{keyframes:t})=>t.length>2?fx:is.has(s)?s.startsWith("scale")?dx(t[1]):ux:px;function gx({when:s,delay:t,delayChildren:e,staggerChildren:i,staggerDirection:n,repeat:r,repeatType:a,repeatDelay:o,from:h,elapsed:l,...c}){return!!Object.keys(c).length}const Zc=(s,t,e,i={},n,r)=>a=>{const o=zc(i,s)||{},h=o.delay||i.delay||0;let{elapsed:l=0}=i;l=l-Nt(h);const c={keyframes:Array.isArray(e)?e:[null,e],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-l,onUpdate:d=>{t.set(d),o.onUpdate&&o.onUpdate(d)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:s,motionValue:t,element:r?void 0:n};gx(o)||Object.assign(c,mx(s,c)),c.duration&&(c.duration=Nt(c.duration)),c.repeatDelay&&(c.repeatDelay=Nt(c.repeatDelay)),c.from!==void 0&&(c.keyframes[0]=c.from);let u=!1;if((c.type===!1||c.duration===0&&!c.repeatDelay)&&(c.duration=0,c.delay===0&&(u=!0)),(Xt.instantAnimations||Xt.skipAnimations)&&(u=!0,c.duration=0,c.delay=0),c.allowFlatten=!o.type&&!o.ease,u&&!r&&t.get()!==void 0){const d=cx(c.keyframes,o);if(d!==void 0){Kt.update(()=>{c.onUpdate(d),c.onComplete()});return}}return o.isSync?new Yr(c):new w_(c)};function yx({protectedKeys:s,needsAnimating:t},e){const i=s.hasOwnProperty(e)&&t[e]!==!0;return t[e]=!1,i}function _x(s,t,{delay:e=0,transitionOverride:i,type:n}={}){let{transition:r=s.getDefaultTransition(),transitionEnd:a,...o}=t;i&&(r=i);const h=[],l=n&&s.animationState&&s.animationState.getState()[n];for(const c in o){const u=s.getValue(c,s.latestValues[c]??null),d=o[c];if(d===void 0||l&&yx(l,c))continue;const f={delay:e,...zc(r||{},c)},p=u.get();if(p!==void 0&&!u.isAnimating&&!Array.isArray(d)&&d===p&&!f.velocity)continue;let g=!1;if(window.MotionHandoffAnimation){const y=hx(s);if(y){const _=window.MotionHandoffAnimation(y,c,Kt);_!==null&&(f.startTime=_,g=!0)}}rx(s,c),u.start(Zc(c,u,d,s.shouldReduceMotion&&Wc.has(c)?{type:!1}:f,s,g));const m=u.animation;m&&h.push(m)}return a&&Promise.all(h).then(()=>{Kt.update(()=>{a&&ix(s,a)})}),h}function xx({top:s,left:t,right:e,bottom:i}){return{x:{min:t,max:e},y:{min:s,max:i}}}function bx(s,t){if(!t)return s;const e=t({x:s.left,y:s.top}),i=t({x:s.right,y:s.bottom});return{top:e.y,left:e.x,bottom:i.y,right:i.x}}function wx(s,t){return xx(bx(s.getBoundingClientRect(),t))}const hh={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},dr={};for(const s in hh)dr[s]={isEnabled:t=>hh[s].some(e=>!!t[e])};const lh=()=>({min:0,max:0}),Jr=()=>({x:lh(),y:lh()}),vx=typeof window<"u",fr={current:null},Qc={current:!1};function Cx(){if(Qc.current=!0,!!vx)if(window.matchMedia){const s=window.matchMedia("(prefers-reduced-motion)"),t=()=>fr.current=s.matches;s.addEventListener("change",t),t()}else fr.current=!1}function Sx(s){return s!==null&&typeof s=="object"&&typeof s.start=="function"}function Ax(s){return typeof s=="string"||Array.isArray(s)}const Tx=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Px=["initial",...Tx];function Jc(s){return Sx(s.animate)||Px.some(t=>Ax(s[t]))}function Mx(s){return!!(Jc(s)||s.variants)}function Ex(s,t,e){for(const i in t){const n=t[i],r=e[i];if(_t(n))s.addValue(i,n);else if(_t(r))s.addValue(i,Ns(n,{owner:s}));else if(r!==n)if(s.hasValue(i)){const a=s.getValue(i);a.liveStyle===!0?a.jump(n):a.hasAnimated||a.set(n)}else{const a=s.getStaticValue(i);s.addValue(i,Ns(a!==void 0?a:n,{owner:s}))}}for(const i in e)t[i]===void 0&&s.removeValue(i);return t}const ch=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class tu{scrapeMotionValuesFromProps(t,e,i){return{}}constructor({parent:t,props:e,presenceContext:i,reducedMotionConfig:n,blockInitialAnimation:r,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Xr,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const d=Ct.now();this.renderScheduledAt<d&&(this.renderScheduledAt=d,Kt.render(this.render,!1,!0))};const{latestValues:h,renderState:l}=a;this.latestValues=h,this.baseTarget={...h},this.initialValues=e.initial?{...h}:{},this.renderState=l,this.parent=t,this.props=e,this.presenceContext=i,this.depth=t?t.depth+1:0,this.reducedMotionConfig=n,this.options=o,this.blockInitialAnimation=!!r,this.isControllingVariants=Jc(e),this.isVariantNode=Mx(e),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:c,...u}=this.scrapeMotionValuesFromProps(e,{},this);for(const d in u){const f=u[d];h[d]!==void 0&&_t(f)&&f.set(h[d],!1)}}mount(t){this.current=t,Us.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,i)=>this.bindToMotionValue(i,e)),Qc.current||Cx(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:fr.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Jn(this.notifyUpdate),Jn(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const e=this.features[t];e&&(e.unmount(),e.isMounted=!1)}this.current=null}bindToMotionValue(t,e){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const i=is.has(t);i&&this.onBindTransform&&this.onBindTransform();const n=e.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&Kt.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),r=e.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,e)),this.valueSubscriptions.set(t,()=>{n(),r(),a&&a(),e.owner&&e.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in dr){const e=dr[t];if(!e)continue;const{isEnabled:i,Feature:n}=e;if(!this.features[t]&&n&&i(this.props)&&(this.features[t]=new n(this)),this.features[t]){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Jr()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,e){this.latestValues[t]=e}update(t,e){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=e;for(let i=0;i<ch.length;i++){const n=ch[i];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const r="on"+n,a=t[r];a&&(this.propEventSubscriptions[n]=this.on(n,a))}this.prevMotionValues=Ex(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const e=this.getClosestVariantNode();if(e)return e.variantChildren&&e.variantChildren.add(t),()=>e.variantChildren.delete(t)}addValue(t,e){const i=this.values.get(t);e!==i&&(i&&this.removeValue(t),this.bindToMotionValue(t,e),this.values.set(t,e),this.latestValues[t]=e.get())}removeValue(t){this.values.delete(t);const e=this.valueSubscriptions.get(t);e&&(e(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,e){if(this.props.values&&this.props.values[t])return this.props.values[t];let i=this.values.get(t);return i===void 0&&e!==void 0&&(i=Ns(e===null?void 0:e,{owner:this}),this.addValue(t,i)),i}readValue(t,e){let i=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return i!=null&&(typeof i=="string"&&(nc(i)||ac(i))?i=parseFloat(i):!z_(i)&&es.test(e)&&(i=jc(t,e)),this.setBaseTarget(t,_t(i)?i.get():i)),_t(i)?i.get():i}setBaseTarget(t,e){this.baseTarget[t]=e}getBaseTarget(t){var r;const{initial:e}=this.props;let i;if(typeof e=="string"||typeof e=="object"){const a=qc(this.props,e,(r=this.presenceContext)==null?void 0:r.custom);a&&(i=a[t])}if(e&&i!==void 0)return i;const n=this.getBaseTargetFromProps(this.props,t);return n!==void 0&&!_t(n)?n:this.initialValues[t]!==void 0&&i===void 0?void 0:this.baseTarget[t]}on(t,e){return this.events[t]||(this.events[t]=new oc),this.events[t].add(e)}notify(t,...e){this.events[t]&&this.events[t].notify(...e)}}class eu extends tu{constructor(){super(...arguments),this.KeyframeResolver=B_}sortInstanceNodePosition(t,e){return t.compareDocumentPosition(e)&2?1:-1}getBaseTargetFromProps(t,e){return t.style?t.style[e]:void 0}removeValueFromRenderState(t,{vars:e,style:i}){delete e[t],delete i[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;_t(t)&&(this.childSubscription=t.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}const kx={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Ix=ss.length;function Rx(s,t,e){let i="",n=!0;for(let r=0;r<Ix;r++){const a=ss[r],o=s[a];if(o===void 0)continue;let h=!0;if(typeof o=="number"?h=o===(a.startsWith("scale")?1:0):h=parseFloat(o)===0,!h||e){const l=Yc(o,qr[a]);if(!h){n=!1;const c=kx[a]||a;i+=`${c}(${l}) `}e&&(t[a]=l)}}return i=i.trim(),e?i=e(t,n?"":i):n&&(i="none"),i}function su(s,t,e){const{style:i,vars:n,transformOrigin:r}=s;let a=!1,o=!1;for(const h in t){const l=t[h];if(is.has(h)){a=!0;continue}else if(wc(h)){n[h]=l;continue}else{const c=Yc(l,qr[h]);h.startsWith("origin")?(o=!0,r[h]=c):i[h]=c}}if(t.transform||(a||e?i.transform=Rx(t,s.transform,e):i.transform&&(i.transform="none")),o){const{originX:h="50%",originY:l="50%",originZ:c=0}=r;i.transformOrigin=`${h} ${l} ${c}`}}function iu(s,{style:t,vars:e},i,n){const r=s.style;let a;for(a in t)r[a]=t[a];n==null||n.applyProjectionStyles(r,i);for(a in e)r.setProperty(a,e[a])}const Fx={};function Vx(s,{layout:t,layoutId:e}){return is.has(s)||s.startsWith("origin")||(t||e!==void 0)&&(!!Fx[s]||s==="opacity")}function nu(s,t,e){var r;const{style:i}=s,n={};for(const a in i)(_t(i[a])||t.style&&_t(t.style[a])||Vx(a,s)||((r=e==null?void 0:e.getValue(a))==null?void 0:r.liveStyle)!==void 0)&&(n[a]=i[a]);return n}function Bx(s){return window.getComputedStyle(s)}class Ox extends eu{constructor(){super(...arguments),this.type="html",this.renderInstance=iu}readValueFromInstance(t,e){var i;if(is.has(e))return(i=this.projection)!=null&&i.isProjecting?ar(e):Zy(t,e);{const n=Bx(t),r=(wc(e)?n.getPropertyValue(e):n[e])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(t,{transformPagePoint:e}){return wx(t,e)}build(t,e,i){su(t,e,i.transformTemplate)}scrapeMotionValuesFromProps(t,e,i){return nu(t,e,i)}}function Lx(s,t){return s in t}class Dx extends tu{constructor(){super(...arguments),this.type="object"}readValueFromInstance(t,e){if(Lx(e,t)){const i=t[e];if(typeof i=="string"||typeof i=="number")return i}}getBaseTargetFromProps(){}removeValueFromRenderState(t,e){delete e.output[t]}measureInstanceViewportBox(){return Jr()}build(t,e){Object.assign(t.output,e)}renderInstance(t,{output:e}){Object.assign(t,e)}sortInstanceNodePosition(){return 0}}const Nx={offset:"stroke-dashoffset",array:"stroke-dasharray"},Ux={offset:"strokeDashoffset",array:"strokeDasharray"};function zx(s,t,e=1,i=0,n=!0){s.pathLength=1;const r=n?Nx:Ux;s[r.offset]=O.transform(-i);const a=O.transform(t),o=O.transform(e);s[r.array]=`${a} ${o}`}function Wx(s,{attrX:t,attrY:e,attrScale:i,pathLength:n,pathSpacing:r=1,pathOffset:a=0,...o},h,l,c){if(su(s,o,l),h){s.style.viewBox&&(s.attrs.viewBox=s.style.viewBox);return}s.attrs=s.style,s.style={};const{attrs:u,style:d}=s;u.transform&&(d.transform=u.transform,delete u.transform),(d.transform||u.transformOrigin)&&(d.transformOrigin=u.transformOrigin??"50% 50%",delete u.transformOrigin),d.transform&&(d.transformBox=(c==null?void 0:c.transformBox)??"fill-box",delete u.transformBox),t!==void 0&&(u.x=t),e!==void 0&&(u.y=e),i!==void 0&&(u.scale=i),n!==void 0&&zx(u,n,r,a,!1)}const ru=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),Gx=s=>typeof s=="string"&&s.toLowerCase()==="svg";function Hx(s,t,e,i){iu(s,t,void 0,i);for(const n in t.attrs)s.setAttribute(ru.has(n)?n:Qr(n),t.attrs[n])}function $x(s,t,e){const i=nu(s,t,e);for(const n in s)if(_t(s[n])||_t(t[n])){const r=ss.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;i[r]=s[n]}return i}class jx extends eu{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Jr}getBaseTargetFromProps(t,e){return t[e]}readValueFromInstance(t,e){if(is.has(e)){const i=$c(e);return i&&i.default||0}return e=ru.has(e)?e:Qr(e),t.getAttribute(e)}scrapeMotionValuesFromProps(t,e,i){return $x(t,e,i)}build(t,e,i){Wx(t,e,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(t,e,i,n){Hx(t,e,i,n)}mount(t){this.isSVGTag=Gx(t.tagName),super.mount(t)}}function Yx(s){const t={presenceContext:null,props:{},visualState:{renderState:{transform:{},transformOrigin:{},style:{},vars:{},attrs:{}},latestValues:{}}},e=Xc(s)&&!N_(s)?new jx(t):new Ox(t);e.mount(s),Us.set(s,e)}function Xx(s){const t={presenceContext:null,props:{},visualState:{renderState:{output:{}},latestValues:{}}},e=new Dx(t);e.mount(s),Us.set(s,e)}function Kx(s,t,e){const i=_t(s)?s:Ns(s);return i.start(Zc("",i,t,e)),i.animation}function qx(s,t){return _t(s)||typeof s=="number"||typeof s=="string"&&!Zr(t)}function au(s,t,e,i){const n=[];if(qx(s,t))n.push(Kx(s,Zr(t)&&t.default||t,e&&(e.default||e)));else{const r=Kc(s,t,i),a=r.length;for(let o=0;o<a;o++){const h=r[o],l=h instanceof Element?Yx:Xx;Us.has(h)||l(h);const c=Us.get(h),u={...e};"delay"in u&&typeof u.delay=="function"&&(u.delay=u.delay(o,a)),n.push(..._x(c,{...t,transition:u},{}))}}return n}function Zx(s,t,e){const i=[];return X_(s,t,e,{spring:Ds}).forEach(({keyframes:r,transition:a},o)=>{i.push(...au(o,r,a))}),i}function Qx(s){return Array.isArray(s)&&s.some(Array.isArray)}function Jx(s){function t(e,i,n){let r=[];return Qx(e)?r=Zx(e,i,s):r=au(e,i,n,s),new C_(r)}return t}const pr=Jx();class ou extends it{constructor(){super();A(this,"pixiLogo");A(this,"progressBar");this.progressBar=new Gg({backgroundColor:"#3d3d3d",fillColor:"#e72264",radius:100,lineWidth:15,value:20,backgroundAlpha:.5,fillAlpha:.8,cap:"round"}),this.progressBar.x+=this.progressBar.width/2,this.progressBar.y+=-this.progressBar.height/2,this.addChild(this.progressBar),this.pixiLogo=new pt({texture:L.from("logo.svg"),anchor:.5,scale:.2}),this.addChild(this.pixiLogo)}onLoad(e){this.progressBar.progress=e}resize(e,i){this.pixiLogo.position.set(e*.5,i*.5),this.progressBar.position.set(e*.5,i*.5)}async show(){this.alpha=1}async hide(){await pr(this,{alpha:0},{duration:.3,ease:"linear",delay:1})}}A(ou,"assetBundles",["preload"]);class G{constructor(t,e,i,n,r,a,o,h=0,l=0,c=0,u=0){A(this,"id");A(this,"name");A(this,"type");A(this,"rarity");A(this,"cost");A(this,"damage");A(this,"description");A(this,"shieldChance");A(this,"shieldAmount");A(this,"returnChance");A(this,"shieldPierce");this.id=t,this.name=e,this.type=i,this.rarity=n,this.cost=r,this.damage=a,this.description=o,this.shieldChance=Math.max(0,Math.min(1,h)),this.shieldAmount=Math.max(0,l),this.returnChance=Math.max(0,Math.min(1,c)),this.shieldPierce=Math.max(0,u)}getDamage(){return this.damage}shouldGrantShield(){return Math.random()<this.shieldChance}shouldReturnToHand(){return Math.random()<this.returnChance}}const C={ROCK:"rock",PAPER:"paper",SCISSORS:"scissors",RUBBER_BAND:"rubber_band",CANDLE:"candle",COLA:"cola",PLANT:"plant",SPECTACLES:"spectacles",JELLY_CUP:"jelly_cup"},D={COMMON:"common",UNCOMMON:"uncommon",RARE:"rare"},P={SUPER_EFFECTIVE:2,EFFECTIVE:1.5,NEUTRAL:1,NOT_EFFECTIVE:.75,NOT_VERY_EFFECTIVE:.5},t0={[C.ROCK]:{[C.ROCK]:P.NEUTRAL,[C.PAPER]:P.NOT_VERY_EFFECTIVE,[C.SCISSORS]:P.SUPER_EFFECTIVE,[C.RUBBER_BAND]:P.EFFECTIVE,[C.CANDLE]:P.NOT_EFFECTIVE,[C.COLA]:P.NOT_VERY_EFFECTIVE,[C.PLANT]:P.SUPER_EFFECTIVE,[C.SPECTACLES]:P.EFFECTIVE,[C.JELLY_CUP]:P.NEUTRAL},[C.PAPER]:{[C.ROCK]:P.SUPER_EFFECTIVE,[C.PAPER]:P.NEUTRAL,[C.SCISSORS]:P.NOT_VERY_EFFECTIVE,[C.RUBBER_BAND]:P.NOT_EFFECTIVE,[C.CANDLE]:P.EFFECTIVE,[C.COLA]:P.NEUTRAL,[C.PLANT]:P.EFFECTIVE,[C.SPECTACLES]:P.NOT_VERY_EFFECTIVE,[C.JELLY_CUP]:P.NEUTRAL},[C.SCISSORS]:{[C.ROCK]:P.NOT_VERY_EFFECTIVE,[C.PAPER]:P.SUPER_EFFECTIVE,[C.SCISSORS]:P.NEUTRAL,[C.RUBBER_BAND]:P.NEUTRAL,[C.CANDLE]:P.SUPER_EFFECTIVE,[C.COLA]:P.NOT_VERY_EFFECTIVE,[C.PLANT]:P.EFFECTIVE,[C.SPECTACLES]:P.EFFECTIVE,[C.JELLY_CUP]:P.NOT_EFFECTIVE},[C.RUBBER_BAND]:{[C.ROCK]:P.NOT_EFFECTIVE,[C.PAPER]:P.EFFECTIVE,[C.SCISSORS]:P.NEUTRAL,[C.RUBBER_BAND]:P.NEUTRAL,[C.CANDLE]:P.EFFECTIVE,[C.COLA]:P.NOT_EFFECTIVE,[C.PLANT]:P.NOT_EFFECTIVE,[C.SPECTACLES]:P.NOT_VERY_EFFECTIVE,[C.JELLY_CUP]:P.SUPER_EFFECTIVE},[C.CANDLE]:{[C.ROCK]:P.EFFECTIVE,[C.PAPER]:P.EFFECTIVE,[C.SCISSORS]:P.NOT_EFFECTIVE,[C.RUBBER_BAND]:P.NOT_VERY_EFFECTIVE,[C.CANDLE]:P.NEUTRAL,[C.COLA]:P.NOT_VERY_EFFECTIVE,[C.PLANT]:P.SUPER_EFFECTIVE,[C.SPECTACLES]:P.SUPER_EFFECTIVE,[C.JELLY_CUP]:P.EFFECTIVE},[C.COLA]:{[C.ROCK]:P.SUPER_EFFECTIVE,[C.PAPER]:P.NEUTRAL,[C.SCISSORS]:P.EFFECTIVE,[C.RUBBER_BAND]:P.EFFECTIVE,[C.CANDLE]:P.SUPER_EFFECTIVE,[C.COLA]:P.NEUTRAL,[C.PLANT]:P.NOT_VERY_EFFECTIVE,[C.SPECTACLES]:P.NOT_VERY_EFFECTIVE,[C.JELLY_CUP]:P.NEUTRAL},[C.PLANT]:{[C.ROCK]:P.NOT_EFFECTIVE,[C.PAPER]:P.NOT_VERY_EFFECTIVE,[C.SCISSORS]:P.EFFECTIVE,[C.RUBBER_BAND]:P.SUPER_EFFECTIVE,[C.CANDLE]:P.NOT_VERY_EFFECTIVE,[C.COLA]:P.SUPER_EFFECTIVE,[C.PLANT]:P.NEUTRAL,[C.SPECTACLES]:P.NOT_VERY_EFFECTIVE,[C.JELLY_CUP]:P.EFFECTIVE},[C.SPECTACLES]:{[C.ROCK]:P.EFFECTIVE,[C.PAPER]:P.SUPER_EFFECTIVE,[C.SCISSORS]:P.NOT_VERY_EFFECTIVE,[C.RUBBER_BAND]:P.NOT_EFFECTIVE,[C.CANDLE]:P.NOT_VERY_EFFECTIVE,[C.COLA]:P.EFFECTIVE,[C.PLANT]:P.NOT_EFFECTIVE,[C.SPECTACLES]:P.NEUTRAL,[C.JELLY_CUP]:P.SUPER_EFFECTIVE},[C.JELLY_CUP]:{[C.ROCK]:P.NOT_VERY_EFFECTIVE,[C.PAPER]:P.NOT_EFFECTIVE,[C.SCISSORS]:P.SUPER_EFFECTIVE,[C.RUBBER_BAND]:P.NEUTRAL,[C.CANDLE]:P.NOT_EFFECTIVE,[C.COLA]:P.EFFECTIVE,[C.PLANT]:P.EFFECTIVE,[C.SPECTACLES]:P.NOT_EFFECTIVE,[C.JELLY_CUP]:P.NEUTRAL}};function uh(s,t){return t0[s][t]}const e0=[new G(1,"Pebble Toss",C.ROCK,D.COMMON,1,2,"A small rock that grants a small shield when it wins.",.4,3,0,0),new G(2,"Stone Throw",C.ROCK,D.COMMON,2,3,"A medium-sized rock with decent shield potential.",.5,4,0,0),new G(3,"Rock Slide",C.ROCK,D.COMMON,2,4,"Multiple rocks that provide good protection.",.6,5,0,0),new G(4,"Boulder Push",C.ROCK,D.COMMON,3,5,"A heavy boulder that creates strong defenses.",.7,6,0,0),new G(5,"Granite Strike",C.ROCK,D.COMMON,3,6,"Hard granite that offers excellent protection.",.8,7,0,0),new G(6,"Mountain Crush",C.ROCK,D.COMMON,4,7,"A massive rock formation with incredible shielding.",.9,8,0,0),new G(7,"Crystal Barrier",C.ROCK,D.UNCOMMON,3,5,"Crystalline rock that grants shields and has a chance to return.",.8,8,.2,0),new G(8,"Obsidian Wall",C.ROCK,D.UNCOMMON,4,6,"Dark obsidian that provides massive protection.",.9,10,0,1),new G(9,"Diamond Defense",C.ROCK,D.UNCOMMON,4,7,"Precious diamond that offers the best protection.",1,12,0,0),new G(10,"Titan's Shield",C.ROCK,D.RARE,5,8,"Legendary rock that grants massive shields and can return.",1,15,.3,2)],s0=[new G(11,"Paper Cut",C.PAPER,D.COMMON,1,3,"A simple paper cut that might return to your hand.",0,0,.3,0),new G(12,"Note Throw",C.PAPER,D.COMMON,2,4,"A folded note with decent return potential.",0,0,.4,0),new G(13,"Scroll Strike",C.PAPER,D.COMMON,2,5,"An ancient scroll that often returns to its owner.",0,0,.5,0),new G(14,"Book Slam",C.PAPER,D.COMMON,3,6,"A heavy book that frequently returns to your collection.",0,0,.6,0),new G(15,"Document Storm",C.PAPER,D.COMMON,3,7,"A flurry of documents with high return probability.",0,0,.7,0),new G(16,"Library Tome",C.PAPER,D.COMMON,4,8,"A massive tome that almost always returns to the library.",0,0,.8,0),new G(17,"Origami Blade",C.PAPER,D.UNCOMMON,3,6,"Folded paper that cuts deep and returns reliably.",0,0,.8,1),new G(18,"Parchment Whip",C.PAPER,D.UNCOMMON,4,7,"Ancient parchment that strikes and returns with precision.",0,0,.9,0),new G(19,"Scroll of Return",C.PAPER,D.UNCOMMON,4,8,"A magical scroll that almost always returns to its caster.",0,0,.95,0),new G(20,"Infinite Paper",C.PAPER,D.RARE,5,9,"Legendary paper that always returns and grants small shields.",.3,3,1,2)],i0=[new G(21,"Paper Clip",C.SCISSORS,D.COMMON,1,4,"A simple paper clip that can pierce weak shields.",0,0,0,1),new G(22,"Safety Scissors",C.SCISSORS,D.COMMON,2,5,"Child-safe scissors with moderate piercing power.",0,0,0,2),new G(23,"Kitchen Shears",C.SCISSORS,D.COMMON,2,6,"Heavy-duty shears that cut through most defenses.",0,0,0,3),new G(24,"Garden Clippers",C.SCISSORS,D.COMMON,3,7,"Sharp clippers that slice through thick barriers.",0,0,0,4),new G(25,"Industrial Cutters",C.SCISSORS,D.COMMON,3,8,"Heavy machinery that destroys any shield in its path.",0,0,0,5),new G(26,"Steel Shears",C.SCISSORS,D.COMMON,4,9,"Reinforced steel scissors that ignore most defenses.",0,0,0,6),new G(27,"Laser Cutter",C.SCISSORS,D.UNCOMMON,4,8,"Precise laser that cuts through shields with ease.",0,0,0,8),new G(28,"Plasma Blade",C.SCISSORS,D.UNCOMMON,4,9,"Energy blade that vaporizes shields and deals massive damage.",0,0,0,10),new G(29,"Quantum Scissors",C.SCISSORS,D.UNCOMMON,5,10,"Advanced scissors that exist in multiple dimensions.",0,0,0,12),new G(30,"Reality Cutter",C.SCISSORS,D.RARE,6,12,"Legendary scissors that cut through reality itself.",0,0,0,15)],Ht=[...e0,...s0,...i0];class tt{static async load(){this.rockImg=await ct.get("rock.png"),this.paperImg=await ct.get("paper.png"),this.scissorsImg=await ct.get("scissors.png"),this.cardImgs.push(void 0);for(let t=1;t<=30;t++)this.cardImgs.push(await ct.get(`${t}.png`));this.bgImg=await ct.get("bg.png"),this.playImg=await ct.get("play.png"),this.viewImg=await ct.get("view.png"),this.playerImg=await ct.get("player.png"),this.enemyImg=await ct.get("enemy.png")}}A(tt,"bgImg"),A(tt,"playImg"),A(tt,"viewImg"),A(tt,"rockImg"),A(tt,"paperImg"),A(tt,"scissorsImg"),A(tt,"playerImg"),A(tt,"enemyImg"),A(tt,"cardImgs",[]);class Oe extends it{constructor(t,e,i,n,r,a=!1){super();const o=-20,h=0,l=n?o:0;let c;switch(t.rarity){case D.COMMON:c=8947848;break;case D.UNCOMMON:c=1034567;break;case D.RARE:c=14822444;break;default:c=8947848}const u=new Xe;u.beginFill(16777215),u.lineStyle(4,c),u.drawRoundedRect(0,0,e,i,4),u.endFill(),u.alpha=1,this.addChild(u);let d;if(t.type==="rock"?d=tt.rockImg:t.type==="paper"?d=tt.paperImg:t.type==="scissors"&&(d=tt.scissorsImg),d){const y=pt.from(d);y.width=e,y.height=i,u.addChild(y)}if(tt.cardImgs[t.id]){const y=tt.cardImgs[t.id],_=pt.from(y);_.width=60,_.height=60,_.position.set(42,82),u.addChild(_)}const f=new ft(t.name.toUpperCase(),{fontSize:16,fontWeight:"bold",fill:0,align:"center",wordWrap:!0,wordWrapWidth:e-30});f.anchor.set(.5,0),f.height==18?f.position.set(e/2,23):f.position.set(e/2,13),this.addChild(f);const p=new ft(`${t.damage}`,{fontSize:20,fontWeight:"bold",fill:6949386,align:"center"});p.anchor.set(.5,0),p.position.set(22,167),this.addChild(p);const g=new ft(`${t.cost}`,{fontSize:20,fontWeight:"bold",fill:658026,align:"center"});g.anchor.set(.5,0),g.position.set(e-22,167),this.addChild(g);const m=[];if(t.shieldChance>0&&m.push(`${Math.round(t.shieldChance*100)}% S`),t.returnChance>0&&m.push(`${Math.round(t.returnChance*100)}% R`),t.shieldPierce>0&&m.push(`${t.shieldPierce} P`),m.length>0){const y=new ft(m.join("; "),{fontSize:m.length>1?10:14,fill:4473924,align:"center"});y.anchor.set(.5,0),y.position.set(e/2,157),this.addChild(y)}this.position.set(h,l),this.interactive=!a,this.cursor=a?"default":"pointer",a||this.on("pointerdown",r)}}const n0={fontFamily:"Arial Rounded MT Bold",align:"center"};class r0 extends ft{constructor(t){const e={...n0,...t==null?void 0:t.style};super({...t,style:e}),this.anchor.set(.5)}}const a0={text:"",width:301,height:112,fontSize:28};class o0 extends Xg{constructor(t={}){const e={...a0,...t};super({defaultView:"button.png",nineSliceSprite:[38,50,38,50],anchor:.5,text:new r0({text:e.text,style:{fill:4868682,align:"center",fontSize:e.fontSize}}),textOffset:{x:0,y:-13},defaultTextAnchor:.5,scale:.9,animations:{hover:{props:{scale:{x:1.03,y:1.03},y:0},duration:100},pressed:{props:{scale:{x:.97,y:.97},y:10},duration:100}}}),this.width=e.width,this.height=e.height,this.onDown.connect(this.handleDown.bind(this)),this.onHover.connect(this.handleHover.bind(this))}handleHover(){Mt().audio.sfx.play("main/sounds/sfx-hover.wav")}handleDown(){Mt().audio.sfx.play("main/sounds/sfx-press.wav")}}class Ys{constructor(t){A(this,"cards",[]);t?(this.cards=[...t],this.shuffle()):(this.cards=[...Ht],this.shuffle())}shuffle(){for(let t=this.cards.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[this.cards[t],this.cards[e]]=[this.cards[e],this.cards[t]]}}drawCard(){return this.cards.length===0?null:this.cards.pop()||null}drawCards(t){const e=[];for(let i=0;i<t&&this.cards.length>0;i++){const n=this.drawCard();n&&e.push(n)}return e}addCardToBottom(t){this.cards.unshift(t)}addCardToTop(t){this.cards.push(t)}addCards(t){this.cards.push(...t)}getCardCount(){return this.cards.length}isEmpty(){return this.cards.length===0}reset(){this.cards=[...Ht],this.shuffle()}peekCards(){return[...this.cards]}clone(){return new Ys([...this.cards])}}class dh{constructor(t,e,i,n){A(this,"name");A(this,"maxHealth");A(this,"currentHealth");A(this,"maxEnergy");A(this,"currentEnergy");A(this,"shield",0);A(this,"deck");this.name=t,this.maxHealth=e,this.currentHealth=e,this.maxEnergy=i,this.currentEnergy=i,this.shield=0,this.deck=n||new Ys}takeDamage(t){this.currentHealth=Math.max(0,this.currentHealth-t)}addShield(t){this.shield=Math.max(0,this.shield+t)}removeShield(t){this.shield=Math.max(0,this.shield-t)}heal(t){this.currentHealth=Math.min(this.maxHealth,this.currentHealth+t)}spendEnergy(t){return this.currentEnergy>=t?(this.currentEnergy-=t,!0):!1}restoreEnergy(t){this.currentEnergy=Math.min(this.maxEnergy,this.currentEnergy+t)}isAlive(){return this.currentHealth>0}reset(){this.currentHealth=this.maxHealth,this.currentEnergy=this.maxEnergy,this.shield=0}}function h0(s){const t=[...s];for(let e=t.length-1;e>0;e--){const i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}return t}function En(s,t){return h0(s).slice(0,t)}const Ri=class Ri{constructor(t){A(this,"_deck");A(this,"_coins",0);A(this,"_maxHP",25);A(this,"_maxEnergy",5);A(this,"_computerCharacters",[]);this._deck=t,this.populateComputerCharacters()}static setCurrentRun(t){Ri.CURRENT=t}upgrade(){this._maxHP+=5,this._maxEnergy+=1}populateComputerCharacters(){const t=[C.ROCK,C.PAPER,C.SCISSORS],e=10;for(let i=0;i<e;i++){const n=10+Math.floor(i/(e-1)*90),r=t[i%3],a=`Enemy ${i+1} ${r}`,o=this.createEnemyDeck(r,i),h=new dh(a,n,10,o);this._computerCharacters.push(h)}}createEnemyDeck(t,e){const i=10+e,n=Math.floor(i*.6),r=Math.floor(i*.3),a=i-n-r,h=[C.ROCK,C.PAPER,C.SCISSORS].find(p=>p!==t);let l=[];const c=Ht.filter(p=>p.type===t),u=this.filterCardsByRarity(c,e);if(l.push(...En(u,n)),h){const p=Ht.filter(m=>m.type===h),g=this.filterCardsByRarity(p,e);l.push(...En(g,r))}const d=Ht.filter(p=>p.type!==t&&p.type!==h),f=this.filterCardsByRarity(d,e);return l.push(...En(f,a)),new Ys(l)}filterCardsByRarity(t,e){const n=e/9;return n<.3?t.filter(r=>r.rarity===D.COMMON):n<.7?t.filter(r=>r.rarity===D.COMMON||r.rarity===D.UNCOMMON):t}get deck(){return this._deck}set deck(t){this._deck=t}get coins(){return this._coins}set coins(t){this._coins=t}get maxHP(){return this._maxHP}set maxHP(t){this._maxHP=t}get maxEnergy(){return this._maxEnergy}set maxEnergy(t){this._maxEnergy=t}get computerCharacters(){return this._computerCharacters}set computerCharacters(t){this._computerCharacters=t}getNextComputerCharacter(){return this._computerCharacters.shift()}createPlayerCharacter(){return new dh("Player",this._maxHP,this._maxEnergy,this._deck)}};A(Ri,"CURRENT");let Ce=Ri;class l0{constructor(t,e){A(this,"player");A(this,"computer");A(this,"playerDeck");A(this,"computerDeck");A(this,"playerHand",[]);A(this,"computerHand",[]);A(this,"selectedPlayerCard",null);A(this,"selectedComputerCard",null);A(this,"turnNumber",1);A(this,"isBattleOver",!1);A(this,"winner",null);this.player=t,this.computer=e,this.playerDeck=t.deck.clone(),this.computerDeck=e.deck.clone(),this.dealInitialHands()}dealInitialHands(){this.playerHand=this.playerDeck.drawCards(5),this.computerHand=this.computerDeck.drawCards(5)}drawPlayerCard(){const t=this.playerDeck.drawCard();return t&&this.playerHand.push(t),t}drawComputerCard(){const t=this.computerDeck.drawCard();return t&&this.computerHand.push(t),t}selectPlayerCard(t){if(t>=0&&t<this.playerHand.length){const e=this.playerHand[t];if(this.player.spendEnergy(e.cost))return this.selectedPlayerCard=e,this.playerHand.splice(t,1),!0}return!1}selectComputerCard(){for(let t=0;t<this.computerHand.length;t++){const e=this.computerHand[t];if(this.computer.spendEnergy(e.cost)){this.selectedComputerCard=e,this.computerHand.splice(t,1);break}}}executeTurn(){if(!this.selectedPlayerCard||!this.selectedComputerCard)throw new Error("No cards selected for turn execution");const t=this.selectedPlayerCard,e=this.selectedComputerCard,i=t.getDamage(),n=e.getDamage(),r=uh(t.type,e.type),a=uh(e.type,t.type),o=i*r,h=n*a;let l=null,c=0,u=!1,d=!1,f=!1,p=!1;if(o>h){l=this.player,c=Math.floor(o-h);const g=this.handleWin(this.player,this.computer,t,c);u=g.shieldCreated,f=g.cardReturned}else if(h>o){l=this.computer,c=Math.floor(h-o);const g=this.handleWin(this.computer,this.player,e,c);d=g.shieldCreated,p=g.cardReturned}return this.checkBattleEnd(),this.selectedPlayerCard=null,this.selectedComputerCard=null,this.turnNumber++,this.player.restoreEnergy(3),this.computer.restoreEnergy(3),this.drawPlayerCard(),this.drawComputerCard(),{playerCard:t,computerCard:e,playerDamage:i,computerDamage:n,playerEffectiveness:r,computerEffectiveness:a,playerFinalDamage:o,computerFinalDamage:h,winner:l===this.player?"player":l===this.computer?"computer":"tie",damageDealt:c,isBattleOver:this.isBattleOver,winnerCharacter:this.winner,playerShieldCreated:u,computerShieldCreated:d,playerCardReturned:f,computerCardReturned:p}}handleWin(t,e,i,n){const r=Math.max(0,e.shield-i.shieldPierce),a=Math.max(0,n-r);e.removeShield(Math.min(e.shield,n)),e.takeDamage(a);let o=!1;i.shouldGrantShield()&&(t.addShield(i.shieldAmount),o=!0);let h=!1;return i.shouldReturnToHand()&&(t===this.player?this.playerHand.push(i):this.computerHand.push(i),h=!0),{shieldCreated:o,cardReturned:h}}checkBattleEnd(){this.player.isAlive()?this.computer.isAlive()||(this.isBattleOver=!0,this.winner=this.player):(this.isBattleOver=!0,this.winner=this.computer)}getBattleState(){var t;return{playerHealth:this.player.currentHealth,playerEnergy:this.player.currentEnergy,playerShield:this.player.shield,computerHealth:this.computer.currentHealth,computerEnergy:this.computer.currentEnergy,computerShield:this.computer.shield,turnNumber:this.turnNumber,isBattleOver:this.isBattleOver,winner:((t=this.winner)==null?void 0:t.name)||null}}reset(){this.player.reset(),this.computer.reset(),this.playerDeck.reset(),this.computerDeck.reset(),this.playerHand=[],this.computerHand=[],this.selectedPlayerCard=null,this.selectedComputerCard=null,this.turnNumber=1,this.isBattleOver=!1,this.winner=null,this.dealInitialHands()}}var c0=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,u0=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}`,d0=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec4 uLine;
uniform vec2 uNoise;
uniform vec3 uVignette;
uniform float uSeed;
uniform float uTime;
uniform vec2 uDimensions;

uniform vec4 uInputSize;

const float SQRT_2 = 1.414213;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

float vignette(vec3 co, vec2 coord)
{
    float outter = SQRT_2 - uVignette[0] * SQRT_2;
    vec2 dir = vec2(0.5) - coord;
    dir.y *= uDimensions.y / uDimensions.x;
    float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + uVignette[2] * SQRT_2), 0.0, 1.0);
    return darker + (1.0 - darker) * (1.0 - uVignette[1]);
}

float noise(vec2 coord)
{
    vec2 pixelCoord = coord * uInputSize.xy;
    pixelCoord.x = floor(pixelCoord.x / uNoise[1]);
    pixelCoord.y = floor(pixelCoord.y / uNoise[1]);
    return (rand(pixelCoord * uNoise[1] * uSeed) - 0.5) * uNoise[0];
}

vec3 interlaceLines(vec3 co, vec2 coord)
{
    vec3 color = co;

    float curvature = uLine[0];
    float lineWidth = uLine[1];
    float lineContrast = uLine[2];
    float verticalLine = uLine[3];

    vec2 dir = vec2(coord * uInputSize.xy / uDimensions - 0.5);

    float _c = curvature > 0. ? curvature : 1.;
    float k = curvature > 0. ? (length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;
    vec2 uv = dir * k;
    float v = verticalLine > 0.5 ? uv.x * uDimensions.x : uv.y * uDimensions.y;
    v *= min(1.0, 2.0 / lineWidth ) / _c;
    float j = 1. + cos(v * 1.2 - uTime) * 0.5 * lineContrast;
    color *= j;

    float segment = verticalLine > 0.5 ? mod((dir.x + .5) * uDimensions.x, 4.) : mod((dir.y + .5) * uDimensions.y, 4.);
    color *= 0.99 + ceil(segment) * 0.015;

    return color;
}

void main(void)
{
    finalColor = texture(uTexture, vTextureCoord);
    vec2 coord = vTextureCoord * uInputSize.xy / uDimensions;

    if (uNoise[0] > 0.0 && uNoise[1] > 0.0)
    {
        float n = noise(vTextureCoord);
        finalColor += vec4(n, n, n, finalColor.a);
    }

    if (uVignette[0] > 0.)
    {
        float v = vignette(finalColor.rgb, coord);
        finalColor *= vec4(v, v, v, finalColor.a);
    }

    if (uLine[1] > 0.0)
    {
        finalColor = vec4(interlaceLines(finalColor.rgb, vTextureCoord), finalColor.a);  
    }
}
`,f0=`struct CRTUniforms {
    uLine: vec4<f32>,
    uNoise: vec2<f32>,
    uVignette: vec3<f32>,
    uSeed: f32,
    uTime: f32,
    uDimensions: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> crtUniforms : CRTUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
    
  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let coord: vec2<f32> = uv * gfu.uInputSize.xy / crtUniforms.uDimensions;

  let uNoise = crtUniforms.uNoise;

  if (uNoise[0] > 0.0 && uNoise[1] > 0.0)
  {
    color += vec4<f32>(vec3<f32>(noise(uv)), color.a);
  }

  if (crtUniforms.uVignette[0] > 0.)
  {
    color *= vec4<f32>(vec3<f32>(vignette(color.rgb, coord)), color.a);
  }

  if (crtUniforms.uLine[1] > 0.0)
  {
    color = vec4<f32>(vec3<f32>(interlaceLines(color.rgb, uv)), color.a);  
  }

  return color;
}

const SQRT_2: f32 = 1.414213;

fn modulo(x: f32, y: f32) -> f32
{
  return x - y * floor(x/y);
}

fn rand(co: vec2<f32>) -> f32
{
  return fract(sin(dot(co, vec2<f32>(12.9898, 78.233))) * 43758.5453);
}

fn vignette(co: vec3<f32>, coord: vec2<f32>) -> f32
{
  let uVignette = crtUniforms.uVignette;
  let uDimensions = crtUniforms.uDimensions;
  
  let outter: f32 = SQRT_2 - uVignette[0] * SQRT_2;
  var dir: vec2<f32> = vec2<f32>(0.5) - coord;
  dir.y *= uDimensions.y / uDimensions.x;
  let darker: f32 = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + uVignette[2] * SQRT_2), 0.0, 1.0);
  return darker + (1.0 - darker) * (1.0 - uVignette[1]);
}

fn noise(coord: vec2<f32>) -> f32
{
  let uNoise = crtUniforms.uNoise;
  let uSeed = crtUniforms.uSeed;

  var pixelCoord: vec2<f32> = coord * gfu.uInputSize.xy;
  pixelCoord.x = floor(pixelCoord.x / uNoise[1]);
  pixelCoord.y = floor(pixelCoord.y / uNoise[1]);
  return (rand(pixelCoord * uNoise[1] * uSeed) - 0.5) * uNoise[0];
}

fn interlaceLines(co: vec3<f32>, coord: vec2<f32>) -> vec3<f32>
{
  var color = co;

  let uDimensions = crtUniforms.uDimensions;

  let curvature: f32 = crtUniforms.uLine[0];
  let lineWidth: f32 = crtUniforms.uLine[1];
  let lineContrast: f32 = crtUniforms.uLine[2];
  let verticalLine: f32 = crtUniforms.uLine[3];

  let dir: vec2<f32> = vec2<f32>(coord * gfu.uInputSize.xy / uDimensions - 0.5);

  let _c: f32 = select(1., curvature, curvature > 0.);
  let k: f32 = select(1., (length(dir * dir) * 0.25 * _c * _c + 0.935 * _c), curvature > 0.);
  let uv: vec2<f32> = dir * k;
  let v: f32 = select(uv.y * uDimensions.y, uv.x * uDimensions.x, verticalLine > 0.5) * min(1.0, 2.0 / lineWidth ) / _c;
  let j: f32 = 1. + cos(v * 1.2 - crtUniforms.uTime) * 0.5 * lineContrast;
  color *= j;

  let segment: f32 = select(modulo((dir.y + .5) * uDimensions.y, 4.), modulo((dir.x + .5) * uDimensions.x, 4.), verticalLine > 0.5);
  color *= 0.99 + ceil(segment) * 0.015;

  return color;
}`,p0=Object.defineProperty,m0=(s,t,e)=>t in s?p0(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,yi=(s,t,e)=>(m0(s,typeof t!="symbol"?t+"":t,e),e);const hu=class lu extends qd{constructor(t){t={...lu.DEFAULT_OPTIONS,...t};const e=qe.from({vertex:{source:u0,entryPoint:"mainVertex"},fragment:{source:f0,entryPoint:"mainFragment"}}),i=Oi.from({vertex:c0,fragment:d0,name:"crt-filter"});super({gpuProgram:e,glProgram:i,resources:{crtUniforms:{uLine:{value:new Float32Array(4),type:"vec4<f32>"},uNoise:{value:new Float32Array(2),type:"vec2<f32>"},uVignette:{value:new Float32Array(3),type:"vec3<f32>"},uSeed:{value:t.seed,type:"f32"},uTime:{value:t.time,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}}}}),yi(this,"uniforms"),yi(this,"seed"),yi(this,"time"),this.uniforms=this.resources.crtUniforms.uniforms,Object.assign(this,t)}apply(t,e,i,n){this.uniforms.uDimensions[0]=e.frame.width,this.uniforms.uDimensions[1]=e.frame.height,this.uniforms.uSeed=this.seed,this.uniforms.uTime=this.time,t.applyFilter(this,e,i,n)}get curvature(){return this.uniforms.uLine[0]}set curvature(t){this.uniforms.uLine[0]=t}get lineWidth(){return this.uniforms.uLine[1]}set lineWidth(t){this.uniforms.uLine[1]=t}get lineContrast(){return this.uniforms.uLine[2]}set lineContrast(t){this.uniforms.uLine[2]=t}get verticalLine(){return this.uniforms.uLine[3]>.5}set verticalLine(t){this.uniforms.uLine[3]=t?1:0}get noise(){return this.uniforms.uNoise[0]}set noise(t){this.uniforms.uNoise[0]=t}get noiseSize(){return this.uniforms.uNoise[1]}set noiseSize(t){this.uniforms.uNoise[1]=t}get vignetting(){return this.uniforms.uVignette[0]}set vignetting(t){this.uniforms.uVignette[0]=t}get vignettingAlpha(){return this.uniforms.uVignette[1]}set vignettingAlpha(t){this.uniforms.uVignette[1]=t}get vignettingBlur(){return this.uniforms.uVignette[2]}set vignettingBlur(t){this.uniforms.uVignette[2]=t}};yi(hu,"DEFAULT_OPTIONS",{curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0,seed:0});let cu=hu;const Fi=class Fi extends it{constructor(){super();A(this,"mainContainer");A(this,"bg");A(this,"battle");A(this,"paused",!1);A(this,"initialized",!1);A(this,"playerHealthText");A(this,"playerEnergyText");A(this,"playerShieldText");A(this,"computerHealthText");A(this,"computerEnergyText");A(this,"computerShieldText");A(this,"playerSprite");A(this,"enemySprite");A(this,"turnText");A(this,"statusText");A(this,"turnResultText");A(this,"cardButtons",[]);A(this,"selectedCardIndex",-1);A(this,"endTurnButton");A(this,"viewDeckButton");A(this,"deckOverlay");A(this,"deckCards",[]);A(this,"isDeckOverlayVisible",!1);A(this,"currentHeight");A(this,"currentWidth");A(this,"playedCardsContainer",new it);A(this,"lastPlayerCard",null);A(this,"lastComputerCard",null);A(this,"filter");this.filter=new cu({noise:.1,time:10,lineContrast:.1,vignetting:.3}),this.filters=[this.filter],tt.load().then(()=>{this.bg=new pt(tt.bgImg),this.bg.width=window.innerWidth,this.bg.height=window.innerHeight,this.addChild(this.bg),this.mainContainer=new it,this.addChild(this.mainContainer),this.mainContainer.addChild(this.playedCardsContainer);const e=Ce.CURRENT;if(!e)throw new Error("No current run found");const i=e.createPlayerCharacter(),n=e.getNextComputerCharacter();if(!n)throw new Error("No computer character available");this.battle=new l0(i,n),this.createUI(),this.updateUI(),this.updateCardButtons()})}createUI(){this.playerHealthText=new ft("Player HP: 100",{fontSize:24,fill:65280}),this.mainContainer.addChild(this.playerHealthText),this.playerEnergyText=new ft("Player Energy: 10",{fontSize:20,fill:35071}),this.mainContainer.addChild(this.playerEnergyText),this.playerShieldText=new ft("Player Shield: 0",{fontSize:20,fill:8947848}),this.mainContainer.addChild(this.playerShieldText),this.computerHealthText=new ft("Computer HP: 100",{fontSize:24,fill:16711680}),this.mainContainer.addChild(this.computerHealthText),this.computerEnergyText=new ft("Computer Energy: 10",{fontSize:20,fill:35071}),this.mainContainer.addChild(this.computerEnergyText),this.computerShieldText=new ft("Computer Shield: 0",{fontSize:20,fill:8947848}),this.mainContainer.addChild(this.computerShieldText),this.turnText=new ft("Turn: 1",{fontSize:28,fill:16777215}),this.mainContainer.addChild(this.turnText),this.statusText=new ft("Select a card to play!",{fontSize:24,fill:16776960}),this.mainContainer.addChild(this.statusText),this.turnResultText=new ft("",{fontSize:18,fill:16777215,align:"center",wordWrap:!0,wordWrapWidth:700}),this.turnResultText.alpha=0,this.mainContainer.addChild(this.turnResultText),this.endTurnButton=new Qn(pt.from(tt.playImg)),this.endTurnButton.view.width=200,this.endTurnButton.view.height=91,this.endTurnButton.onPress.connect(()=>this.executeTurn()),this.endTurnButton.view.alpha=.5,this.endTurnButton.view.interactive=!1,this.mainContainer.addChild(this.endTurnButton.view),this.playerSprite=pt.from(tt.playerImg),this.playerSprite.width=200,this.playerSprite.height=300,this.mainContainer.addChild(this.playerSprite),this.enemySprite=pt.from(tt.enemyImg),this.enemySprite.width=200,this.enemySprite.height=300,this.mainContainer.addChild(this.enemySprite),this.viewDeckButton=new Qn(pt.from(tt.viewImg)),this.viewDeckButton.onPress.connect(()=>this.toggleDeckOverlay()),this.viewDeckButton.view.width=150,this.viewDeckButton.view.height=95,this.mainContainer.addChild(this.viewDeckButton.view),this.deckOverlay=new it,this.deckOverlay.alpha=0,this.deckOverlay.interactive=!1,this.mainContainer.addChild(this.deckOverlay),this.initialized=!0}updateUI(){const e=this.battle.getBattleState();this.playerHealthText.text=`Player HP: ${e.playerHealth}`,this.playerEnergyText.text=`Player Energy: ${e.playerEnergy}`,this.playerShieldText.text=`Player Shield: ${e.playerShield}`,this.computerHealthText.text=`Computer HP: ${e.computerHealth}`,this.computerEnergyText.text=`Computer Energy: ${e.computerEnergy}`,this.computerShieldText.text=`Computer Shield: ${e.computerShield}`,this.turnText.text=`Turn: ${e.turnNumber}`,e.isBattleOver?(this.statusText.text=`Battle Over! ${e.winner} wins!`,this.statusText.style.fill=16755200,Ce.CURRENT.upgrade(),setTimeout(()=>{Mt().navigation.showScreen(Fi)},5e3)):this.selectedCardIndex!==-1?(this.statusText.text="Card selected! Click End Turn to continue.",this.statusText.style.fill=65280):(this.statusText.text="Select a card to play!",this.statusText.style.fill=16776960),this.selectedCardIndex!==-1&&!e.isBattleOver?(this.endTurnButton.view.alpha=1,this.endTurnButton.view.interactive=!0):(this.endTurnButton.view.alpha=.5,this.endTurnButton.view.interactive=!1),this.updateLayout()}updateCardButtons(){this.cardButtons.forEach(l=>{this.mainContainer.removeChild(l)}),this.cardButtons=[];const e=140,i=200,n=this.battle.playerHand.length,r=20,o=-(n*e+(n-1)*r)/2,h=this.currentHeight?this.currentHeight-100-i:50;this.battle.playerHand.forEach((l,c)=>{const u=this.selectedCardIndex===c,d=this.battle.player.currentEnergy<l.cost,f=new Oe(l,e,i,u,()=>this.onCardClick(c),d),p=o+c*(e+r);f.position.set(p,h+(u?-20:0)),d&&(f.alpha=.5),this.mainContainer.addChild(f),this.cardButtons.push(f)}),this.updateLayout()}onCardClick(e){this.selectedCardIndex===e?this.selectedCardIndex=-1:this.selectedCardIndex=e,this.updateUI()}executeTurn(){if(this.selectedCardIndex===-1){this.statusText.text="Please select a card first!",this.statusText.style.fill=16711680;return}if(this.battle.selectPlayerCard(this.selectedCardIndex)){this.battle.selectComputerCard();const e=this.battle.executeTurn();this.selectedCardIndex=-1,this.updateUI(),this.showTurnResults(e),e.isBattleOver&&(this.endTurnButton.onPress.disconnectAll(),this.endTurnButton.onPress.connect(()=>this.resetBattle()))}else this.statusText.text="Not enough energy for that card!",this.statusText.style.fill=16711680;this.updateCardButtons()}showTurnResults(e){this.lastPlayerCard=e.playerCard,this.lastComputerCard=e.computerCard,this.renderPlayedCards();let i=`Player played: ${e.playerCard.name} (${e.playerDamage} DMG)`;e.playerEffectiveness!==1&&(i+=` [${e.playerEffectiveness>1?"Super Effective":"Not Very Effective"}]`),i+=`
Computer played: ${e.computerCard.name} (${e.computerDamage} DMG)`,e.computerEffectiveness!==1&&(i+=` [${e.computerEffectiveness>1?"Super Effective":"Not Very Effective"}]`),i+=`

`,e.winner==="player"?i+=`Player wins! Dealt ${e.damageDealt} damage`:e.winner==="computer"?i+=`Computer wins! Dealt ${e.damageDealt} damage`:i+="It's a tie! No damage dealt";const n=[];e.playerShieldCreated&&n.push(`Player gained ${e.playerCard.shieldAmount} shield`),e.computerShieldCreated&&n.push(`Computer gained ${e.computerCard.shieldAmount} shield`),e.playerCardReturned&&n.push("Player's card returned to hand"),e.computerCardReturned&&n.push("Computer's card returned to hand"),n.length>0&&(i+=`

${n.join(`
`)}`),this.turnResultText.text=i,this.turnResultText.alpha=1}renderPlayedCards(){if(this.playedCardsContainer.removeChildren(),!this.lastPlayerCard||!this.lastComputerCard)return;const e=140,i=200,n=60,r=-340/2,a=250,o=new Oe(this.lastPlayerCard,e,i,!1,()=>{},!0),h=new Oe(this.lastComputerCard,e,i,!1,()=>{},!0);o.position.set(r,a),h.position.set(r+e+n,a),this.playedCardsContainer.addChild(o,h)}resetBattle(){this.battle.reset(),this.selectedCardIndex=-1,this.turnResultText.alpha=0,this.endTurnButton.onPress.disconnectAll(),this.endTurnButton.onPress.connect(()=>this.executeTurn()),this.updateUI()}prepare(){}update(e){this.paused||(this.filter.seed=Math.random(),this.filter.time+=.1)}async pause(){this.mainContainer.interactiveChildren=!1,this.paused=!0}async resume(){this.mainContainer.interactiveChildren=!0,this.paused=!1}reset(){this.battle.reset(),this.selectedCardIndex=-1,this.turnResultText.alpha=0,this.updateUI()}resize(e,i){this.currentWidth=e,this.currentHeight=i,this.updateLayout()}updateLayout(){if(!this.currentWidth||!this.currentHeight||!this.initialized)return;const e=this.currentWidth,i=this.currentHeight;var n=this.bg.width/this.bg.height,r=e/i;r>n?(this.bg.height=this.bg.height/(this.bg.width/e),this.bg.width=e,this.bg.position.x=0,this.bg.position.y=(i-this.bg.height)/2):(this.bg.width=this.bg.width/(this.bg.height/i),this.bg.height=i,this.bg.position.y=0,this.bg.position.x=(e-this.bg.width)/2);const a=e*.5;this.mainContainer.x=a,this.mainContainer.y=0;const o=-e*.5+50,h=e*.5-50,l=Math.max(50,i*.1),c=i-50;this.playerHealthText.position.set(o+350,l),this.playerEnergyText.position.set(o+350,l+30),this.playerShieldText.position.set(o+350,l+60),this.computerHealthText.position.set(h-this.computerHealthText.width-350,l),this.computerEnergyText.position.set(h-this.computerEnergyText.width-350,l+30),this.computerShieldText.position.set(h-this.computerShieldText.width-350,l+60),this.turnText.position.set(0-this.turnText.width/2,l),this.statusText.position.set(0-this.statusText.width/2,l+40),this.turnResultText.position.set(0-this.turnResultText.width/2,l+400),this.turnResultText.style.wordWrapWidth=500,this.viewDeckButton.view.position.set(o+25,l+15),this.endTurnButton.view.position.set(-100,c-60),this.playerSprite.position.set(o+150,c-250),this.enemySprite.position.set(h-350,c-230);const u=140,d=200,f=20,p=this.battle.playerHand.length,m=-(p*u+(p-1)*f)/2,y=i-130-d;this.cardButtons.forEach((_,x)=>{const b=m+x*(u+f),S=this.selectedCardIndex===x;_.position.set(b,y+(S?-20:0))})}async show(){Mt().audio.bgm.play("main/sounds/bgm-main.mp3",{volume:.3})}async hide(){}toggleDeckOverlay(){this.isDeckOverlayVisible?this.hideDeckOverlay():this.showDeckOverlay()}showDeckOverlay(){this.isDeckOverlayVisible=!0,this.deckOverlay.alpha=1,this.deckOverlay.interactive=!0,this.updateDeckOverlay()}hideDeckOverlay(){this.isDeckOverlayVisible=!1,this.deckOverlay.alpha=0,this.deckOverlay.interactive=!1,this.deckOverlay.removeChildren(),this.deckCards=[]}updateDeckOverlay(){this.deckOverlay.removeChildren(),this.deckCards=[];const e=Ce.CURRENT.deck.peekCards(),i=this.battle.playerHand,n=this.battle.playerDeck.peekCards(),r=e.filter(c=>!i.some(u=>u.id===c.id)&&!n.some(u=>u.id===c.id)),a=140,o=200,h=6,l=20;e.forEach((c,u)=>{const d=Math.floor(u/h),f=u%h,p=new Oe(c,a,o,!1,()=>{},!0);p.position.set(f*(a+l),50+d*(o+l)),i.some(g=>g.id===c.id)?p.alpha=.5:r.some(g=>g.id===c.id)?p.alpha=.25:p.alpha=1,this.deckOverlay.addChild(p),this.deckCards.push(p)})}};A(Fi,"assetBundles",["main"]);let mr=Fi;function uu(s){const t=[...s];for(let e=t.length-1;e>0;e--){const i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}return t}function xs(s,t){return uu(s).slice(0,t)}class du extends it{constructor(){super();A(this,"mainContainer");A(this,"bg");A(this,"statusText");A(this,"cardButtons",[]);A(this,"confirmButton");A(this,"currentWidth");A(this,"currentHeight");A(this,"pickPool",[]);A(this,"picks",[]);A(this,"pickChoices",[]);A(this,"selectedCardIndex",-1);A(this,"initialized",!1);A(this,"selectedCardDisplay");A(this,"filter");this.filter=new cu({noise:.1,time:10,lineContrast:.1,vignetting:.3}),this.filters=[this.filter],tt.load().then(()=>{this.bg=new pt(tt.bgImg),this.bg.width=window.innerWidth,this.bg.height=window.innerHeight,this.addChild(this.bg),this.mainContainer=new it,this.addChild(this.mainContainer),this.createUI(),this.startPickPhase()})}createUI(){this.statusText=new ft("Pick a card!",{fontSize:32,fill:16776960}),this.mainContainer.addChild(this.statusText),this.confirmButton=new o0({text:"Confirm"}),this.confirmButton.position.set(0,300),this.confirmButton.alpha=.5,this.confirmButton.interactive=!1,this.confirmButton.onPress.connect(()=>this.confirmPick()),this.mainContainer.addChild(this.confirmButton),this.initialized=!0}startPickPhase(){const e=Ht.filter(a=>a.rarity===D.RARE),i=Ht.filter(a=>a.rarity===D.UNCOMMON),n=xs(e,1),r=xs(i,8);this.pickPool=uu([...n,...r]),this.picks=[],this.nextPick()}nextPick(){this.selectedCardIndex=-1,this.pickChoices=xs(this.pickPool,3),this.updateCardButtons(),this.statusText.text=`Pick a card (${this.picks.length+1}/3)`,this.statusText.style.fill=16776960,this.confirmButton.alpha=.5,this.confirmButton.interactive=!1}update(e){this.filter.seed=Math.random(),this.filter.time+=.1}updateCardButtons(){this.cardButtons.forEach(o=>this.mainContainer.removeChild(o)),this.cardButtons=[];const e=140,i=200,n=40,r=-500/2,a=50;this.pickChoices.forEach((o,h)=>{const l=this.selectedCardIndex===h,c=new Oe(o,e,i,l,()=>this.onCardClick(h),!1);c.position.set(r+h*(e+n),a),this.mainContainer.addChild(c),this.cardButtons.push(c)}),this.updateLayout()}onCardClick(e){this.selectedCardIndex=e,this.confirmButton.alpha=1,this.confirmButton.interactive=!0,this.updateLayout()}updateSelectedCardDisplay(){if(this.selectedCardDisplay&&(this.mainContainer.removeChild(this.selectedCardDisplay),this.selectedCardDisplay=void 0),this.picks.length>0){const e=new it,i=140,n=200,r=20;this.picks.forEach((a,o)=>{const h=new Oe(a,i,n,!1,()=>{},!0);h.position.set(o*(i+r),0),e.addChild(h)}),this.selectedCardDisplay=e,this.mainContainer.addChild(this.selectedCardDisplay)}}confirmPick(){if(this.selectedCardIndex===-1)return;const e=this.pickChoices[this.selectedCardIndex];this.picks.push(e),this.pickPool=this.pickPool.filter(i=>i.id!==e.id),this.updateSelectedCardDisplay(),this.picks.length<3?this.nextPick():this.finishDeckBuild()}finishDeckBuild(){let e=[];for(const n of this.picks){const r=new Set(e.map(o=>o.id)),a=Ht.filter(o=>o.type===n.type&&o.rarity===D.COMMON&&!this.picks.some(h=>h.id===o.id)&&!r.has(o.id));e.push(n),e.push(...xs(a,2))}for(;e.length<10;){const n=new Set(e.map(a=>a.id)),r=xs(Ht.filter(a=>!n.has(a.id)),1);e.push(...r)}console.log(e);const i=new Ys(e);Ce.CURRENT=new Ce(i),this.statusText.text="Deck built! Ready to play.",this.statusText.style.fill=65280,this.cardButtons.forEach(n=>this.mainContainer.removeChild(n)),this.cardButtons=[],this.confirmButton.alpha=.5,this.confirmButton.interactive=!1,Mt().navigation.showScreen(mr)}resize(e,i){this.currentWidth=e,this.currentHeight=i,this.updateLayout()}updateLayout(){if(!this.currentWidth||!this.currentHeight||!this.initialized)return;const e=this.currentWidth,i=this.currentHeight;var n=this.bg.width/this.bg.height,r=e/i;r>n?(this.bg.height=this.bg.height/(this.bg.width/e),this.bg.width=e,this.bg.position.x=0,this.bg.position.y=(i-this.bg.height)/2):(this.bg.width=this.bg.width/(this.bg.height/i),this.bg.height=i,this.bg.position.y=0,this.bg.position.x=(e-this.bg.width)/2),this.mainContainer.x=e*.5,this.mainContainer.y=0,this.statusText.position.set(0-this.statusText.width/2,250),this.confirmButton.position.set(0,i-200),this.cardButtons.forEach((a,o)=>{a.position.y=i/2-100+(this.selectedCardIndex===o?-20:0)}),this.selectedCardDisplay&&this.selectedCardDisplay.position.set(-e/2+100,i-250)}}A(du,"assetBundles",["main"]);class g0{getString(t){return localStorage.getItem(t)??void 0}setString(t,e){localStorage.setItem(t,e)}getNumber(t){const e=this.getString(t)??void 0,i=Number(e);return isNaN(i)?null:i}setNumber(t,e){this.setString(t,String(e))}getBool(t){const e=localStorage.getItem(t);return e?!!e.toLowerCase():void 0}setBool(t,e){localStorage.setItem(t,String(e))}getObject(t){const e=this.getString(t);if(e)try{return JSON.parse(e)}catch(i){console.warn(i);return}}setObject(t,e){this.setString(t,JSON.stringify(e))}}const Re=new g0,fh="volume-master",ph="volume-bgm",mh="volume-sfx";class y0{init(){Mt().audio.setMasterVolume(this.getMasterVolume()),Mt().audio.bgm.setVolume(this.getBgmVolume()),Mt().audio.sfx.setVolume(this.getSfxVolume())}getMasterVolume(){return Re.getNumber(fh)??.5}setMasterVolume(t){Mt().audio.setMasterVolume(t),Re.setNumber(fh,t)}getBgmVolume(){return Re.getNumber(ph)??1}setBgmVolume(t){Mt().audio.bgm.setVolume(t),Re.setNumber(ph,t)}getSfxVolume(){return Re.getNumber(mh)??1}setSfxVolume(t){Mt().audio.sfx.setVolume(t),Re.setNumber(mh,t)}}const _0=new y0;X.add(Cr);X.add(yl);const x0=[{name:"default",assets:[]},{name:"game",assets:[{alias:["game/cards/1.png","1.png"],src:["game/cards/1@0.5x.webp","game/cards/1@0.5x.png","game/cards/1.webp","game/cards/1.png"],data:{tags:{m:!0}}},{alias:["game/cards/10.png","10.png"],src:["game/cards/10@0.5x.webp","game/cards/10@0.5x.png","game/cards/10.webp","game/cards/10.png"],data:{tags:{m:!0}}},{alias:["game/cards/11.png","11.png"],src:["game/cards/11@0.5x.webp","game/cards/11@0.5x.png","game/cards/11.webp","game/cards/11.png"],data:{tags:{m:!0}}},{alias:["game/cards/12.png","12.png"],src:["game/cards/12@0.5x.webp","game/cards/12@0.5x.png","game/cards/12.webp","game/cards/12.png"],data:{tags:{m:!0}}},{alias:["game/cards/13.png","13.png"],src:["game/cards/13@0.5x.webp","game/cards/13@0.5x.png","game/cards/13.webp","game/cards/13.png"],data:{tags:{m:!0}}},{alias:["game/cards/14.png","14.png"],src:["game/cards/14@0.5x.webp","game/cards/14@0.5x.png","game/cards/14.webp","game/cards/14.png"],data:{tags:{m:!0}}},{alias:["game/cards/15.png","15.png"],src:["game/cards/15@0.5x.webp","game/cards/15@0.5x.png","game/cards/15.webp","game/cards/15.png"],data:{tags:{m:!0}}},{alias:["game/cards/16.png","16.png"],src:["game/cards/16@0.5x.webp","game/cards/16@0.5x.png","game/cards/16.webp","game/cards/16.png"],data:{tags:{m:!0}}},{alias:["game/cards/17.png","17.png"],src:["game/cards/17@0.5x.webp","game/cards/17@0.5x.png","game/cards/17.webp","game/cards/17.png"],data:{tags:{m:!0}}},{alias:["game/cards/18.png","18.png"],src:["game/cards/18@0.5x.webp","game/cards/18@0.5x.png","game/cards/18.webp","game/cards/18.png"],data:{tags:{m:!0}}},{alias:["game/cards/19.png","19.png"],src:["game/cards/19@0.5x.webp","game/cards/19@0.5x.png","game/cards/19.webp","game/cards/19.png"],data:{tags:{m:!0}}},{alias:["game/cards/2.png","2.png"],src:["game/cards/2@0.5x.webp","game/cards/2@0.5x.png","game/cards/2.webp","game/cards/2.png"],data:{tags:{m:!0}}},{alias:["game/cards/20.png","20.png"],src:["game/cards/20@0.5x.webp","game/cards/20@0.5x.png","game/cards/20.webp","game/cards/20.png"],data:{tags:{m:!0}}},{alias:["game/cards/21.png","21.png"],src:["game/cards/21@0.5x.webp","game/cards/21@0.5x.png","game/cards/21.webp","game/cards/21.png"],data:{tags:{m:!0}}},{alias:["game/cards/22.png","22.png"],src:["game/cards/22@0.5x.webp","game/cards/22@0.5x.png","game/cards/22.webp","game/cards/22.png"],data:{tags:{m:!0}}},{alias:["game/cards/23.png","23.png"],src:["game/cards/23@0.5x.webp","game/cards/23@0.5x.png","game/cards/23.webp","game/cards/23.png"],data:{tags:{m:!0}}},{alias:["game/cards/24.png","24.png"],src:["game/cards/24@0.5x.webp","game/cards/24@0.5x.png","game/cards/24.webp","game/cards/24.png"],data:{tags:{m:!0}}},{alias:["game/cards/25.png","25.png"],src:["game/cards/25@0.5x.webp","game/cards/25@0.5x.png","game/cards/25.webp","game/cards/25.png"],data:{tags:{m:!0}}},{alias:["game/cards/26.png","26.png"],src:["game/cards/26@0.5x.webp","game/cards/26@0.5x.png","game/cards/26.webp","game/cards/26.png"],data:{tags:{m:!0}}},{alias:["game/cards/27.png","27.png"],src:["game/cards/27@0.5x.webp","game/cards/27@0.5x.png","game/cards/27.webp","game/cards/27.png"],data:{tags:{m:!0}}},{alias:["game/cards/28.png","28.png"],src:["game/cards/28@0.5x.webp","game/cards/28@0.5x.png","game/cards/28.webp","game/cards/28.png"],data:{tags:{m:!0}}},{alias:["game/cards/29.png","29.png"],src:["game/cards/29@0.5x.webp","game/cards/29@0.5x.png","game/cards/29.webp","game/cards/29.png"],data:{tags:{m:!0}}},{alias:["game/cards/3.png","3.png"],src:["game/cards/3@0.5x.webp","game/cards/3@0.5x.png","game/cards/3.webp","game/cards/3.png"],data:{tags:{m:!0}}},{alias:["game/cards/30.png","30.png"],src:["game/cards/30@0.5x.webp","game/cards/30@0.5x.png","game/cards/30.webp","game/cards/30.png"],data:{tags:{m:!0}}},{alias:["game/cards/4.png","4.png"],src:["game/cards/4@0.5x.webp","game/cards/4@0.5x.png","game/cards/4.webp","game/cards/4.png"],data:{tags:{m:!0}}},{alias:["game/cards/5.png","5.png"],src:["game/cards/5@0.5x.webp","game/cards/5@0.5x.png","game/cards/5.webp","game/cards/5.png"],data:{tags:{m:!0}}},{alias:["game/cards/6.png","6.png"],src:["game/cards/6@0.5x.webp","game/cards/6@0.5x.png","game/cards/6.webp","game/cards/6.png"],data:{tags:{m:!0}}},{alias:["game/cards/7.png","7.png"],src:["game/cards/7@0.5x.webp","game/cards/7@0.5x.png","game/cards/7.webp","game/cards/7.png"],data:{tags:{m:!0}}},{alias:["game/cards/8.png","8.png"],src:["game/cards/8@0.5x.webp","game/cards/8@0.5x.png","game/cards/8.webp","game/cards/8.png"],data:{tags:{m:!0}}},{alias:["game/cards/9.png","9.png"],src:["game/cards/9@0.5x.webp","game/cards/9@0.5x.png","game/cards/9.webp","game/cards/9.png"],data:{tags:{m:!0}}},{alias:["game/cards/enemy.png","enemy.png"],src:["game/cards/enemy@0.5x.webp","game/cards/enemy@0.5x.png","game/cards/enemy.webp","game/cards/enemy.png"],data:{tags:{m:!0}}},{alias:["game/cards/export.png","export.png"],src:["game/cards/export@0.5x.webp","game/cards/export@0.5x.png","game/cards/export.webp","game/cards/export.png"],data:{tags:{m:!0}}},{alias:["game/cards/paper.png","paper.png"],src:["game/cards/paper@0.5x.webp","game/cards/paper@0.5x.png","game/cards/paper.webp","game/cards/paper.png"],data:{tags:{m:!0}}},{alias:["game/cards/play.png","play.png"],src:["game/cards/play@0.5x.webp","game/cards/play@0.5x.png","game/cards/play.webp","game/cards/play.png"],data:{tags:{m:!0}}},{alias:["game/cards/player.png","player.png"],src:["game/cards/player@0.5x.webp","game/cards/player@0.5x.png","game/cards/player.webp","game/cards/player.png"],data:{tags:{m:!0}}},{alias:["game/cards/rock.png","rock.png"],src:["game/cards/rock@0.5x.webp","game/cards/rock@0.5x.png","game/cards/rock.webp","game/cards/rock.png"],data:{tags:{m:!0}}},{alias:["game/cards/scissors.png","scissors.png"],src:["game/cards/scissors@0.5x.webp","game/cards/scissors@0.5x.png","game/cards/scissors.webp","game/cards/scissors.png"],data:{tags:{m:!0}}},{alias:["game/cards/view.png","view.png"],src:["game/cards/view@0.5x.webp","game/cards/view@0.5x.png","game/cards/view.webp","game/cards/view.png"],data:{tags:{m:!0}}}]},{name:"main",assets:[{alias:["main/logo-white.svg","logo-white.svg"],src:["main/logo-white.svg"],data:{tags:{m:!0}}},{alias:["main/sounds/bgm-main.mp3","bgm-main.mp3"],src:["main/sounds/bgm-main.ogg","main/sounds/bgm-main.mp3"],data:{tags:{m:!0}}},{alias:["main/sounds/sfx-hover.wav","sfx-hover.wav"],src:["main/sounds/sfx-hover.ogg","main/sounds/sfx-hover.mp3"],data:{tags:{m:!0}}},{alias:["main/sounds/sfx-press.wav","sfx-press.wav"],src:["main/sounds/sfx-press.ogg","main/sounds/sfx-press.mp3"],data:{tags:{m:!0}}},{alias:["main/ui","ui"],src:["main/ui@0.5x.webp.json","main/ui@0.5x.png.json","main/ui.webp.json","main/ui.png.json"],data:{tags:{m:!0,tps:!0}}}]},{name:"preload",assets:[{alias:["preload/bg.png","bg.png"],src:["preload/bg@0.5x.webp","preload/bg@0.5x.png","preload/bg.webp","preload/bg.png"],data:{tags:{m:!0}}},{alias:["preload/logo.svg","logo.svg"],src:["preload/logo.svg"],data:{tags:{m:!0}}}]}],gh={bundles:x0};let fu;function b0(s){return fu=s,s}function zs(){return fu}class gr{static setParamValue(t,e){if(t.setValueAtTime){const i=zs().context;t.setValueAtTime(e,i.audioContext.currentTime)}else t.value=e;return e}}class w0 extends gt{constructor(){super(...arguments),this.speed=1,this.muted=!1,this.volume=1,this.paused=!1}refresh(){this.emit("refresh")}refreshPaused(){this.emit("refreshPaused")}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(t){console.warn("HTML Audio does not support filters")}get audioContext(){return console.warn("HTML Audio does not support audioContext"),null}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this.paused}destroy(){this.removeAllListeners()}}let v0=0;const yr=class extends gt{constructor(s){super(),this.id=v0++,this.init(s)}set(s,t){if(this[s]===void 0)throw new Error(`Property with name ${s} does not exist.`);switch(s){case"speed":this.speed=t;break;case"volume":this.volume=t;break;case"paused":this.paused=t;break;case"loop":this.loop=t;break;case"muted":this.muted=t;break}return this}get progress(){const{currentTime:s}=this._source;return s/this._duration}get paused(){return this._paused}set paused(s){this._paused=s,this.refreshPaused()}_onPlay(){this._playing=!0}_onPause(){this._playing=!1}init(s){this._playing=!1,this._duration=s.source.duration;const t=this._source=s.source.cloneNode(!1);t.src=s.parent.url,t.onplay=this._onPlay.bind(this),t.onpause=this._onPause.bind(this),s.context.on("refresh",this.refresh,this),s.context.on("refreshPaused",this.refreshPaused,this),this._media=s}_internalStop(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())}stop(){this._internalStop(),this._source&&this.emit("stop")}get speed(){return this._speed}set speed(s){this._speed=s,this.refresh()}get volume(){return this._volume}set volume(s){this._volume=s,this.refresh()}get loop(){return this._loop}set loop(s){this._loop=s,this.refresh()}get muted(){return this._muted}set muted(s){this._muted=s,this.refresh()}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(s){console.warn("HTML Audio does not support filters")}refresh(){const s=this._media.context,t=this._media.parent;this._source.loop=this._loop||t.loop;const e=s.volume*(s.muted?0:1),i=t.volume*(t.muted?0:1),n=this._volume*(this._muted?0:1);this._source.volume=n*e*i,this._source.playbackRate=this._speed*s.speed*t.speed}refreshPaused(){const s=this._media.context,t=this._media.parent,e=this._paused||t.paused||s.paused;e!==this._pausedReal&&(this._pausedReal=e,e?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",e))}play(s){const{start:t,end:e,speed:i,loop:n,volume:r,muted:a}=s;e&&console.assert(e>t,"End time is before start time"),this._speed=i,this._volume=r,this._loop=!!n,this._muted=a,this.refresh(),this.loop&&e!==null&&(console.warn('Looping not support when specifying an "end" time'),this.loop=!1),this._start=t,this._end=e||this._duration,this._start=Math.max(0,this._start-yr.PADDING),this._end=Math.min(this._end+yr.PADDING,this._duration),this._source.onloadedmetadata=()=>{this._source&&(this._source.currentTime=t,this._source.onloadedmetadata=null,this.emit("progress",t/this._duration,this._duration),vt.shared.add(this._onUpdate,this))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")}_onUpdate(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()}_onComplete(){vt.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)}destroy(){vt.shared.remove(this._onUpdate,this),this.removeAllListeners();const s=this._source;s&&(s.onended=null,s.onplay=null,s.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)}toString(){return`[HTMLAudioInstance id=${this.id}]`}};let pu=yr;pu.PADDING=.1;class C0 extends gt{init(t){this.parent=t,this._source=t.options.source||new Audio,t.url&&(this._source.src=t.url)}create(){return new pu(this)}get isPlayable(){return!!this._source&&this._source.readyState===4}get duration(){return this._source.duration}get context(){return this.parent.context}get filters(){return null}set filters(t){console.warn("HTML Audio does not support filters")}destroy(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)}get source(){return this._source}load(t){const e=this._source,i=this.parent;if(e.readyState===4){i.isLoaded=!0;const h=i.autoPlayStart();t&&setTimeout(()=>{t(null,i,h)},0);return}if(!i.url){t(new Error("sound.url or sound.source must be set"));return}e.src=i.url;const n=()=>{o(),i.isLoaded=!0;const h=i.autoPlayStart();t&&t(null,i,h)},r=()=>{o(),t&&t(new Error("Sound loading has been aborted"))},a=()=>{o();const h=`Failed to load audio element (code: ${e.error.code})`;t?t(new Error(h)):console.error(h)},o=()=>{e.removeEventListener("canplaythrough",n),e.removeEventListener("load",n),e.removeEventListener("abort",r),e.removeEventListener("error",a)};e.addEventListener("canplaythrough",n,!1),e.addEventListener("load",n,!1),e.addEventListener("abort",r,!1),e.addEventListener("error",a,!1),e.load()}}class S0{constructor(t,e){this.parent=t,Object.assign(this,e),this.duration=this.end-this.start,console.assert(this.duration>0,"End time must be after start time")}play(t){return this.parent.play({complete:t,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})}destroy(){this.parent=null}}const Ei=["ogg","oga","opus","m4a","mp3","mpeg","wav","aiff","wma","mid","caf"],A0=["audio/mpeg","audio/ogg"],ki={};function T0(s){const t={m4a:"audio/mp4",oga:"audio/ogg",opus:'audio/ogg; codecs="opus"',caf:'audio/x-caf; codecs="opus"'},e=document.createElement("audio"),i={},n=/^no$/;Ei.forEach(r=>{const a=e.canPlayType(`audio/${r}`).replace(n,""),o=t[r]?e.canPlayType(t[r]).replace(n,""):"";i[r]=!!a||!!o}),Object.assign(ki,i)}T0();let P0=0;class M0 extends gt{constructor(t){super(),this.id=P0++,this._media=null,this._paused=!1,this._muted=!1,this._elapsed=0,this.init(t)}set(t,e){if(this[t]===void 0)throw new Error(`Property with name ${t} does not exist.`);switch(t){case"speed":this.speed=e;break;case"volume":this.volume=e;break;case"muted":this.muted=e;break;case"loop":this.loop=e;break;case"paused":this.paused=e;break}return this}stop(){this._source&&(this._internalStop(),this.emit("stop"))}get speed(){return this._speed}set speed(t){this._speed=t,this.refresh(),this._update(!0)}get volume(){return this._volume}set volume(t){this._volume=t,this.refresh()}get muted(){return this._muted}set muted(t){this._muted=t,this.refresh()}get loop(){return this._loop}set loop(t){this._loop=t,this.refresh()}get filters(){return this._filters}set filters(t){var e;this._filters&&((e=this._filters)==null||e.filter(i=>i).forEach(i=>i.disconnect()),this._filters=null,this._source.connect(this._gain)),this._filters=t!=null&&t.length?t.slice(0):null,this.refresh()}refresh(){if(!this._source)return;const t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;const i=t.volume*(t.muted?0:1),n=e.volume*(e.muted?0:1),r=this._volume*(this._muted?0:1);gr.setParamValue(this._gain.gain,r*n*i),gr.setParamValue(this._source.playbackRate,this._speed*e.speed*t.speed),this.applyFilters()}applyFilters(){var t;if((t=this._filters)!=null&&t.length){this._source.disconnect();let e=this._source;this._filters.forEach(i=>{e.connect(i.destination),e=i}),e.connect(this._gain)}}refreshPaused(){const t=this._media.context,e=this._media.parent,i=this._paused||e.paused||t.paused;i!==this._pausedReal&&(this._pausedReal=i,i?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",i))}play(t){const{start:e,end:i,speed:n,loop:r,volume:a,muted:o,filters:h}=t;i&&console.assert(i>e,"End time is before start time"),this._paused=!1;const{source:l,gain:c}=this._media.nodes.cloneBufferSource();this._source=l,this._gain=c,this._speed=n,this._volume=a,this._loop=!!r,this._muted=o,this._filters=h,this.refresh();const u=this._source.buffer.duration;this._duration=u,this._end=i,this._lastUpdate=this._now(),this._elapsed=e,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=i,this._source.loopStart=e,this._source.start(0,e)):i?this._source.start(0,e,i-e):this._source.start(0,e),this.emit("start"),this._update(!0),this.enableTicker(!0)}enableTicker(t){vt.shared.remove(this._updateListener,this),t&&vt.shared.add(this._updateListener,this)}get progress(){return this._progress}get paused(){return this._paused}set paused(t){this._paused=t,this.refreshPaused()}destroy(){var t;this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),(t=this._filters)==null||t.forEach(e=>e.disconnect()),this._filters=null,this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1}toString(){return`[WebAudioInstance id=${this.id}]`}_now(){return this._media.context.audioContext.currentTime}_updateListener(){this._update()}_update(t=!1){if(this._source){const e=this._now(),i=e-this._lastUpdate;if(i>0||t){const n=this._source.playbackRate.value;this._elapsed+=i*n,this._lastUpdate=e;const r=this._duration;let a;if(this._source.loopStart){const o=this._source.loopEnd-this._source.loopStart;a=(this._source.loopStart+this._elapsed%o)/r}else a=this._elapsed%r/r;this._progress=a,this.emit("progress",this._progress,r)}}}init(t){this._media=t,t.context.events.on("refresh",this.refresh,this),t.context.events.on("refreshPaused",this.refreshPaused,this)}_internalStop(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.stop(0),this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null}}_onComplete(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}}this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)}}class mu{constructor(t,e){this._output=e,this._input=t}get destination(){return this._input}get filters(){return this._filters}set filters(t){if(this._filters&&(this._filters.forEach(e=>{e&&e.disconnect()}),this._filters=null,this._input.connect(this._output)),t&&t.length){this._filters=t.slice(0),this._input.disconnect();let e=null;t.forEach(i=>{e===null?this._input.connect(i.destination):e.connect(i.destination),e=i}),e.connect(this._output)}}destroy(){this.filters=null,this._input=null,this._output=null}}const gu=class extends mu{constructor(s){const t=s.audioContext,e=t.createBufferSource(),i=t.createGain(),n=t.createAnalyser();e.connect(n),n.connect(i),i.connect(s.destination),super(n,i),this.context=s,this.bufferSource=e,this.gain=i,this.analyser=n}get script(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(gu.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script}destroy(){super.destroy(),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null}cloneBufferSource(){const s=this.bufferSource,t=this.context.audioContext.createBufferSource();t.buffer=s.buffer,gr.setParamValue(t.playbackRate,s.playbackRate.value),t.loop=s.loop;const e=this.context.audioContext.createGain();return t.connect(e),e.connect(this.destination),{source:t,gain:e}}get bufferSize(){return this.script.bufferSize}};let yu=gu;yu.BUFFER_SIZE=0;class E0{init(t){this.parent=t,this._nodes=new yu(this.context),this._source=this._nodes.bufferSource,this.source=t.options.source}destroy(){this.parent=null,this._nodes.destroy(),this._nodes=null;try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null,this.source=null}create(){return new M0(this)}get context(){return this.parent.context}get isPlayable(){return!!this._source&&!!this._source.buffer}get filters(){return this._nodes.filters}set filters(t){this._nodes.filters=t}get duration(){return console.assert(this.isPlayable,"Sound not yet playable, no duration"),this._source.buffer.duration}get buffer(){return this._source.buffer}set buffer(t){this._source.buffer=t}get nodes(){return this._nodes}load(t){this.source?this._decode(this.source,t):this.parent.url?this._loadUrl(t):t?t(new Error("sound.url or sound.source must be set")):console.error("sound.url or sound.source must be set")}async _loadUrl(t){const e=this.parent.url,i=await Z.get().fetch(e);this._decode(await i.arrayBuffer(),t)}_decode(t,e){const i=(n,r)=>{if(n)e&&e(n);else{this.parent.isLoaded=!0,this.buffer=r;const a=this.parent.autoPlayStart();e&&e(null,this.parent,a)}};t instanceof AudioBuffer?i(null,t):this.parent.context.decode(t,i)}}const Ve=class{static from(s){let t={};typeof s=="string"?t.url=s:s instanceof ArrayBuffer||s instanceof AudioBuffer||s instanceof HTMLAudioElement?t.source=s:Array.isArray(s)?t.url=s:t=s,t={autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1,...t},Object.freeze(t);const e=zs().useLegacy?new C0:new E0;return new Ve(e,t)}constructor(s,t){this.media=s,this.options=t,this._instances=[],this._sprites={},this.media.init(this);const e=t.complete;this._autoPlayOptions=e?{complete:e}:null,this.isLoaded=!1,this._preloadQueue=null,this.isPlaying=!1,this.autoPlay=t.autoPlay,this.singleInstance=t.singleInstance,this.preload=t.preload||this.autoPlay,this.url=Array.isArray(t.url)?this.preferUrl(t.url):t.url,this.speed=t.speed,this.volume=t.volume,this.loop=t.loop,t.sprites&&this.addSprites(t.sprites),this.preload&&this._preload(t.loaded)}preferUrl(s){const[t]=s.map(e=>({url:e,ext:ut.extname(e).slice(1)})).filter(({ext:e})=>ki[e]).sort((e,i)=>Ei.indexOf(e.ext)-Ei.indexOf(i.ext));if(!t)throw new Error("No supported file type found");return t.url}get context(){return zs().context}pause(){return this.isPlaying=!1,this.paused=!0,this}resume(){return this.isPlaying=this._instances.length>0,this.paused=!1,this}get paused(){return this._paused}set paused(s){this._paused=s,this.refreshPaused()}get speed(){return this._speed}set speed(s){this._speed=s,this.refresh()}get filters(){return this.media.filters}set filters(s){this.media.filters=s}addSprites(s,t){if(typeof s=="object"){const i={};for(const n in s)i[n]=this.addSprites(n,s[n]);return i}console.assert(!this._sprites[s],`Alias ${s} is already taken`);const e=new S0(this,t);return this._sprites[s]=e,e}destroy(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null}removeSprites(s){if(s){const t=this._sprites[s];t!==void 0&&(t.destroy(),delete this._sprites[s])}else for(const t in this._sprites)this.removeSprites(t);return this}get isPlayable(){return this.isLoaded&&this.media&&this.media.isPlayable}stop(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(let s=this._instances.length-1;s>=0;s--)this._instances[s].stop();return this}play(s,t){let e;if(typeof s=="string"?e={sprite:s,loop:this.loop,complete:t}:typeof s=="function"?(e={},e.complete=s):e=s,e={complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1,...e||{}},e.sprite){const n=e.sprite;console.assert(!!this._sprites[n],`Alias ${n} is not available`);const r=this._sprites[n];e.start=r.start+(e.start||0),e.end=r.end,e.speed=r.speed||1,e.loop=r.loop||e.loop,delete e.sprite}if(e.offset&&(e.start=e.offset),!this.isLoaded)return this._preloadQueue?new Promise(n=>{this._preloadQueue.push(()=>{n(this.play(e))})}):(this._preloadQueue=[],this.autoPlay=!0,this._autoPlayOptions=e,new Promise((n,r)=>{this._preload((a,o,h)=>{this._preloadQueue.forEach(l=>l()),this._preloadQueue=null,a?r(a):(e.loaded&&e.loaded(a,o,h),n(h))})}));(this.singleInstance||e.singleInstance)&&this._removeInstances();const i=this._createInstance();return this._instances.push(i),this.isPlaying=!0,i.once("end",()=>{e.complete&&e.complete(this),this._onComplete(i)}),i.once("stop",()=>{this._onComplete(i)}),i.play(e),i}refresh(){const s=this._instances.length;for(let t=0;t<s;t++)this._instances[t].refresh()}refreshPaused(){const s=this._instances.length;for(let t=0;t<s;t++)this._instances[t].refreshPaused()}get volume(){return this._volume}set volume(s){this._volume=s,this.refresh()}get muted(){return this._muted}set muted(s){this._muted=s,this.refresh()}get loop(){return this._loop}set loop(s){this._loop=s,this.refresh()}_preload(s){this.media.load(s)}get instances(){return this._instances}get sprites(){return this._sprites}get duration(){return this.media.duration}autoPlayStart(){let s;return this.autoPlay&&(s=this.play(this._autoPlayOptions)),s}_removeInstances(){for(let s=this._instances.length-1;s>=0;s--)this._poolInstance(this._instances[s]);this._instances.length=0}_onComplete(s){if(this._instances){const t=this._instances.indexOf(s);t>-1&&this._instances.splice(t,1),this.isPlaying=this._instances.length>0}this._poolInstance(s)}_createInstance(){if(Ve._pool.length>0){const s=Ve._pool.pop();return s.init(this.media),s}return this.media.create()}_poolInstance(s){s.destroy(),Ve._pool.indexOf(s)<0&&Ve._pool.push(s)}};let Ii=Ve;Ii._pool=[];class Ws extends mu{constructor(){const t=window,e=new Ws.AudioContext,i=e.createDynamicsCompressor(),n=e.createAnalyser();n.connect(i),i.connect(e.destination),super(n,i),this.autoPause=!0,this._ctx=e,this._offlineCtx=new Ws.OfflineAudioContext(1,2,t.OfflineAudioContext?Math.max(8e3,Math.min(96e3,e.sampleRate)):44100),this.compressor=i,this.analyser=n,this.events=new gt,this.volume=1,this.speed=1,this.muted=!1,this.paused=!1,this._locked=e.state==="suspended"&&("ontouchstart"in globalThis||"onclick"in globalThis),this._locked&&(this._unlock(),this._unlock=this._unlock.bind(this),document.addEventListener("mousedown",this._unlock,!0),document.addEventListener("touchstart",this._unlock,!0),document.addEventListener("touchend",this._unlock,!0)),this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),globalThis.addEventListener("focus",this.onFocus),globalThis.addEventListener("blur",this.onBlur)}onFocus(){if(!this.autoPause)return;const t=this._ctx.state;(t==="suspended"||t==="interrupted"||!this._locked)&&(this.paused=this._pausedOnBlur,this.refreshPaused())}onBlur(){this.autoPause&&(this._locked||(this._pausedOnBlur=this._paused,this.paused=!0,this.refreshPaused()))}_unlock(){this._locked&&(this.playEmptySound(),this._ctx.state==="running"&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._locked=!1))}playEmptySound(){const t=this._ctx.createBufferSource();t.buffer=this._ctx.createBuffer(1,1,22050),t.connect(this._ctx.destination),t.start(0,0,0),t.context.state==="suspended"&&t.context.resume()}static get AudioContext(){const t=window;return t.AudioContext||t.webkitAudioContext||null}static get OfflineAudioContext(){const t=window;return t.OfflineAudioContext||t.webkitOfflineAudioContext||null}destroy(){super.destroy();const t=this._ctx;typeof t.close<"u"&&t.close(),globalThis.removeEventListener("focus",this.onFocus),globalThis.removeEventListener("blur",this.onBlur),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null}get audioContext(){return this._ctx}get offlineContext(){return this._offlineCtx}set paused(t){t&&this._ctx.state==="running"?this._ctx.suspend():!t&&this._ctx.state==="suspended"&&this._ctx.resume(),this._paused=t}get paused(){return this._paused}refresh(){this.events.emit("refresh")}refreshPaused(){this.events.emit("refreshPaused")}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this._paused}decode(t,e){const i=r=>{e(new Error((r==null?void 0:r.message)||"Unable to decode file"))},n=this._offlineCtx.decodeAudioData(t,r=>{e(null,r)},i);n&&n.catch(i)}}class k0{constructor(){this.init()}init(){return this.supported&&(this._webAudioContext=new Ws),this._htmlAudioContext=new w0,this._sounds={},this.useLegacy=!this.supported,this}get context(){return this._context}get filtersAll(){return this.useLegacy?[]:this._context.filters}set filtersAll(t){this.useLegacy||(this._context.filters=t)}get supported(){return Ws.AudioContext!==null}add(t,e){if(typeof t=="object"){const r={};for(const a in t){const o=this._getOptions(t[a],e);r[a]=this.add(a,o)}return r}if(console.assert(!this._sounds[t],`Sound with alias ${t} already exists.`),e instanceof Ii)return this._sounds[t]=e,e;const i=this._getOptions(e),n=Ii.from(i);return this._sounds[t]=n,n}_getOptions(t,e){let i;return typeof t=="string"?i={url:t}:Array.isArray(t)?i={url:t}:t instanceof ArrayBuffer||t instanceof AudioBuffer||t instanceof HTMLAudioElement?i={source:t}:i=t,i={...i,...e||{}},i}get useLegacy(){return this._useLegacy}set useLegacy(t){this._useLegacy=t,this._context=!t&&this.supported?this._webAudioContext:this._htmlAudioContext}get disableAutoPause(){return!this._webAudioContext.autoPause}set disableAutoPause(t){this._webAudioContext.autoPause=!t}remove(t){return this.exists(t,!0),this._sounds[t].destroy(),delete this._sounds[t],this}get volumeAll(){return this._context.volume}set volumeAll(t){this._context.volume=t,this._context.refresh()}get speedAll(){return this._context.speed}set speedAll(t){this._context.speed=t,this._context.refresh()}togglePauseAll(){return this._context.togglePause()}pauseAll(){return this._context.paused=!0,this._context.refreshPaused(),this}resumeAll(){return this._context.paused=!1,this._context.refreshPaused(),this}toggleMuteAll(){return this._context.toggleMute()}muteAll(){return this._context.muted=!0,this._context.refresh(),this}unmuteAll(){return this._context.muted=!1,this._context.refresh(),this}removeAll(){for(const t in this._sounds)this._sounds[t].destroy(),delete this._sounds[t];return this}stopAll(){for(const t in this._sounds)this._sounds[t].stop();return this}exists(t,e=!1){const i=!!this._sounds[t];return e&&console.assert(i,`No sound matching alias '${t}'.`),i}isPlaying(){for(const t in this._sounds)if(this._sounds[t].isPlaying)return!0;return!1}find(t){return this.exists(t,!0),this._sounds[t]}play(t,e){return this.find(t).play(e)}stop(t){return this.find(t).stop()}pause(t){return this.find(t).pause()}resume(t){return this.find(t).resume()}volume(t,e){const i=this.find(t);return e!==void 0&&(i.volume=e),i.volume}speed(t,e){const i=this.find(t);return e!==void 0&&(i.speed=e),i.speed}duration(t){return this.find(t).duration}close(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this}}const yh=s=>{var i;const t=s.src;let e=(i=s==null?void 0:s.alias)==null?void 0:i[0];return(!e||s.src===e)&&(e=ut.basename(t,ut.extname(t))),e},I0={extension:I.Asset,detection:{test:async()=>!0,add:async s=>[...s,...Ei.filter(t=>ki[t])],remove:async s=>s.filter(t=>s.includes(t))},loader:{name:"sound",extension:{type:[I.LoadParser],priority:qt.High},test(s){const t=ut.extname(s).slice(1);return!!ki[t]||A0.some(e=>s.startsWith(`data:${e}`))},async load(s,t){const e=await new Promise((i,n)=>Ii.from({...t.data,url:s,preload:!0,loaded(r,a){var o,h;r?n(r):i(a),(h=(o=t.data)==null?void 0:o.loaded)==null||h.call(o,r,a)}}));return zs().add(yh(t),e),e},async unload(s,t){zs().remove(yh(t))}}};X.add(I0);const Le=b0(new k0);class R0{constructor(){A(this,"currentAlias");A(this,"current");A(this,"volume",1)}async play(t,e){if(this.currentAlias!==t){if(this.current){const i=this.current;pr(i,{volume:0},{duration:1,ease:"linear"}).then(()=>{i.stop()})}this.current=Le.find(t),this.currentAlias=t,this.current.play({loop:!0,...e}),this.current.volume=0,pr(this.current,{volume:this.volume},{duration:1,ease:"linear"})}}getVolume(){return this.volume}setVolume(t){this.volume=t,this.current&&(this.current.volume=this.volume)}}class F0{constructor(){A(this,"volume",1)}play(t,e){const i=this.volume*((e==null?void 0:e.volume)??1);Le.play(t,{...e,volume:i})}getVolume(){return this.volume}setVolume(t){this.volume=t}}class _u{static init(){const t=this;t.audio={bgm:new R0,sfx:new F0,getMasterVolume:()=>Le.volumeAll,setMasterVolume:e=>{Le.volumeAll=e,e?Le.unmuteAll():Le.muteAll()}}}static destroy(){const t=this;t.audio=null}}A(_u,"extension",I.Application);class V0{constructor(){A(this,"app");A(this,"container",new it);A(this,"width",0);A(this,"height",0);A(this,"background");A(this,"currentScreen");A(this,"currentPopup")}init(t){this.app=t}setBackground(t){this.background=new t,this.addAndShowScreen(this.background)}async addAndShowScreen(t){this.container.parent||this.app.stage.addChild(this.container),this.container.addChild(t),t.prepare&&t.prepare(),t.resize&&t.resize(this.width,this.height),t.update&&this.app.ticker.add(t.update,t),t.show&&(t.interactiveChildren=!1,await t.show(),t.interactiveChildren=!0)}async hideAndRemoveScreen(t){t.interactiveChildren=!1,t.hide&&await t.hide(),t.update&&this.app.ticker.remove(t.update,t),t.parent&&t.parent.removeChild(t),t.reset&&t.reset()}async showScreen(t){var e;this.currentScreen&&(this.currentScreen.interactiveChildren=!1),t.assetBundles&&await ct.loadBundle(t.assetBundles,i=>{var n;(n=this.currentScreen)!=null&&n.onLoad&&this.currentScreen.onLoad(i*100)}),(e=this.currentScreen)!=null&&e.onLoad&&this.currentScreen.onLoad(100),this.currentScreen&&await this.hideAndRemoveScreen(this.currentScreen),this.currentScreen=Dt.get(t),await this.addAndShowScreen(this.currentScreen)}resize(t,e){var i,n,r,a,o,h;this.width=t,this.height=e,(n=(i=this.currentScreen)==null?void 0:i.resize)==null||n.call(i,t,e),(a=(r=this.currentPopup)==null?void 0:r.resize)==null||a.call(r,t,e),(h=(o=this.background)==null?void 0:o.resize)==null||h.call(o,t,e)}async presentPopup(t){var e,i;this.currentScreen&&(this.currentScreen.interactiveChildren=!1,await((i=(e=this.currentScreen).pause)==null?void 0:i.call(e))),this.currentPopup&&await this.hideAndRemoveScreen(this.currentPopup),this.currentPopup=new t,await this.addAndShowScreen(this.currentPopup)}async dismissPopup(){var e,i;if(!this.currentPopup)return;const t=this.currentPopup;this.currentPopup=void 0,await this.hideAndRemoveScreen(t),this.currentScreen&&(this.currentScreen.interactiveChildren=!0,(i=(e=this.currentScreen).resume)==null||i.call(e))}blur(){var t,e,i,n,r,a;(e=(t=this.currentScreen)==null?void 0:t.blur)==null||e.call(t),(n=(i=this.currentPopup)==null?void 0:i.blur)==null||n.call(i),(a=(r=this.background)==null?void 0:r.blur)==null||a.call(r)}focus(){var t,e,i,n,r,a;(e=(t=this.currentScreen)==null?void 0:t.focus)==null||e.call(t),(n=(i=this.currentPopup)==null?void 0:i.focus)==null||n.call(i),(a=(r=this.background)==null?void 0:r.focus)==null||a.call(r)}}class _r{static init(){const t=this;t.navigation=new V0,t.navigation.init(t),this._onResize=()=>t.navigation.resize(t.renderer.width,t.renderer.height),t.renderer.on("resize",this._onResize),t.resize()}static destroy(){const t=this;t.navigation=null}}A(_r,"extension",I.Application),A(_r,"_onResize");function B0(s,t,e,i,n){const r=e/i;let a=s,o=t;n&&(e<i?(o=window.innerHeight,a=Math.min(window.innerWidth,e,o*r)):(a=window.innerWidth,o=Math.min(window.innerHeight,i,a/r)));const h=a<e?e/a:1,l=o<i?i/o:1,c=h>l?h:l,u=Math.floor(a*c),d=Math.floor(o*c);return{width:u,height:d}}class Ts{static init(t){const e=this;Object.defineProperty(e,"resizeTo",{set(i){globalThis.removeEventListener("resize",e.queueResize),this._resizeTo=i,i&&(globalThis.addEventListener("resize",e.queueResize),e.resize())},get(){return this._resizeTo}}),e.queueResize=()=>{this._resizeTo&&(this._cancelResize(),this._resizeId=requestAnimationFrame(()=>e.resize()))},e.resize=()=>{if(!this._resizeTo)return;this._cancelResize();let i,n;if(this._resizeTo===globalThis.window)i=globalThis.innerWidth,n=globalThis.innerHeight;else{const{clientWidth:o,clientHeight:h}=this._resizeTo;i=o,n=h}const{width:r,height:a}=B0(i,n,e.resizeOptions.minWidth,e.resizeOptions.minHeight,e.resizeOptions.letterbox);e.renderer.canvas.style.width=`${i}px`,e.renderer.canvas.style.height=`${n}px`,window.scrollTo(0,0),e.renderer.resize(r,a)},this._cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this._resizeId=null,this._resizeTo=null,e.resizeOptions={minWidth:768,minHeight:1024,letterbox:!0,...t.resizeOptions},e.resizeTo=t.resizeTo||null}static destroy(){const t=this;globalThis.removeEventListener("resize",t.queueResize),this._cancelResize(),this._cancelResize=null,t.queueResize=null,t.resizeTo=null,t.resize=null}}A(Ts,"extension",I.Application),A(Ts,"_resizeId"),A(Ts,"_resizeTo"),A(Ts,"_cancelResize");function O0(){let s=Math.max(window.devicePixelRatio,2);return s%1!==0&&(s=2),s}X.remove(Cr);X.add(Ts);X.add(_u);X.add(_r);class L0 extends gl{async init(t){t.resizeTo??(t.resizeTo=window),t.resolution??(t.resolution=O0()),await super.init(t),document.getElementById("pixi-container").appendChild(this.canvas),await ct.init({manifest:gh,basePath:"assets"}),await ct.loadBundle("preload");const e=gh.bundles.map(i=>i.name);await ct.loadBundle(e)}destroy(t=!1,e=!1){super.destroy(t,e)}}const _i=new L0;Cu(_i);(async()=>(await _i.init({background:"#1E1E1E",resizeOptions:{minWidth:768,minHeight:1024,letterbox:!1}}),_0.init(),await _i.navigation.showScreen(ou),await _i.navigation.showScreen(du)))();export{nt as $,dl as A,at as B,it as C,Z as D,I as E,qd as F,qe as G,kh as H,kt as I,pd as J,ga as K,pt as L,U as M,Ud as N,Qd as O,mt as P,st as Q,Nn as R,Kd as S,vt as T,bi as U,j as V,yf as W,_a as X,Zi as Y,xa as Z,yd as _,gt as a,Fh as a0,fl as a1,N as a2,W as a3,vf as a4,Sl as a5,Df as a6,lp as a7,up as a8,gp as a9,_p as aa,xp as ab,Ye as ac,kl as ad,ja as ae,Ha as af,Ge as ag,ke as ah,xg as ai,_o as aj,Lt as ak,vm as al,et as am,Xe as an,Du as ao,Mo as ap,Fl as aq,Bf as b,ae as c,mi as d,X as e,$a as f,Rf as g,vr as h,De as i,ll as j,Gh as k,It as l,sl as m,Si as n,hp as o,cp as p,pp as q,Zu as r,yp as s,Li as t,L as u,Lu as v,Y as w,Oi as x,wp as y,Dt as z};
