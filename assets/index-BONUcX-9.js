const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-ihqzFj20.js","assets/webworkerAll-CEujfYjk.js","assets/colorToUniform-BXaCBwVl.js","assets/WebGPURenderer-oCSBFX_2.js","assets/SharedSystems-fhrEOg9i.js","assets/WebGLRenderer-gWY7hehK.js"])))=>i.map(i=>d[i]);
var $c=Object.defineProperty;var Yc=(s,t,e)=>t in s?$c(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var A=(s,t,e)=>Yc(s,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();let th=null;function oe(){return th}function jc(s){th=s}const Xc="modulepreload",Kc=function(s){return"/"+s},Dr={},ai=function(t,e,i){let n=Promise.resolve();if(e&&e.length>0){let a=function(l){return Promise.all(l.map(c=>Promise.resolve(c).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),h=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=a(e.map(l=>{if(l=Kc(l),l in Dr)return;Dr[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":Xc,c||(d.as="script"),d.crossOrigin="",d.href=l,h&&d.setAttribute("nonce",h),document.head.appendChild(d),c)return new Promise((f,m)=>{d.addEventListener("load",f),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function r(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return n.then(a=>{for(const o of a||[])o.status==="rejected"&&r(o.reason);return t().catch(r)})};var R=(s=>(s.Application="application",s.WebGLPipes="webgl-pipes",s.WebGLPipesAdaptor="webgl-pipes-adaptor",s.WebGLSystem="webgl-system",s.WebGPUPipes="webgpu-pipes",s.WebGPUPipesAdaptor="webgpu-pipes-adaptor",s.WebGPUSystem="webgpu-system",s.CanvasSystem="canvas-system",s.CanvasPipesAdaptor="canvas-pipes-adaptor",s.CanvasPipes="canvas-pipes",s.Asset="asset",s.LoadParser="load-parser",s.ResolveParser="resolve-parser",s.CacheParser="cache-parser",s.DetectionParser="detection-parser",s.MaskEffect="mask-effect",s.BlendMode="blend-mode",s.TextureSource="texture-source",s.Environment="environment",s.ShapeBuilder="shape-builder",s.Batcher="batcher",s))(R||{});const pn=s=>{if(typeof s=="function"||typeof s=="object"&&s.extension){if(!s.extension)throw new Error("Extension class must have an extension object");s={...typeof s.extension!="object"?{type:s.extension}:s.extension,ref:s}}if(typeof s=="object")s={...s};else throw new Error("Invalid extension type");return typeof s.type=="string"&&(s.type=[s.type]),s},Vs=(s,t)=>pn(s).priority??t,Y={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...s){return s.map(pn).forEach(t=>{t.type.forEach(e=>{var i,n;return(n=(i=this._removeHandlers)[e])==null?void 0:n.call(i,t)})}),this},add(...s){return s.map(pn).forEach(t=>{t.type.forEach(e=>{var r,a;const i=this._addHandlers,n=this._queue;i[e]?(a=i[e])==null||a.call(i,t):(n[e]=n[e]||[],(r=n[e])==null||r.push(t))})}),this},handle(s,t,e){var a;const i=this._addHandlers,n=this._removeHandlers;if(i[s]||n[s])throw new Error(`Extension type ${s} already has a handler`);i[s]=t,n[s]=e;const r=this._queue;return r[s]&&((a=r[s])==null||a.forEach(o=>t(o)),delete r[s]),this},handleByMap(s,t){return this.handle(s,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByNamedList(s,t,e=-1){return this.handle(s,i=>{t.findIndex(r=>r.name===i.name)>=0||(t.push({name:i.name,value:i.ref}),t.sort((r,a)=>Vs(a.value,e)-Vs(r.value,e)))},i=>{const n=t.findIndex(r=>r.name===i.name);n!==-1&&t.splice(n,1)})},handleByList(s,t,e=-1){return this.handle(s,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((n,r)=>Vs(r,e)-Vs(n,e)))},i=>{const n=t.indexOf(i.ref);n!==-1&&t.splice(n,1)})},mixin(s,...t){for(const e of t)Object.defineProperties(s.prototype,Object.getOwnPropertyDescriptors(e))}},qc={extension:{type:R.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await ai(()=>import("./browserAll-ihqzFj20.js"),__vite__mapDeps([0,1,2]))}},Zc={extension:{type:R.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await ai(()=>import("./webworkerAll-CEujfYjk.js"),__vite__mapDeps([1,2]))}};class at{constructor(t,e,i){this._x=e||0,this._y=i||0,this._observer=t}clone(t){return new at(t??this._observer,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}function eh(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Ai={exports:{}},Nr;function Qc(){return Nr||(Nr=1,function(s){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function n(h,l,c){this.fn=h,this.context=l,this.once=c||!1}function r(h,l,c,u,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new n(c,u||h,d),m=e?e+l:l;return h._events[m]?h._events[m].fn?h._events[m]=[h._events[m],f]:h._events[m].push(f):(h._events[m]=f,h._eventsCount++),h}function a(h,l){--h._eventsCount===0?h._events=new i:delete h._events[l]}function o(){this._events=new i,this._eventsCount=0}o.prototype.eventNames=function(){var l=[],c,u;if(this._eventsCount===0)return l;for(u in c=this._events)t.call(c,u)&&l.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},o.prototype.listeners=function(l){var c=e?e+l:l,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,f=u.length,m=new Array(f);d<f;d++)m[d]=u[d].fn;return m},o.prototype.listenerCount=function(l){var c=e?e+l:l,u=this._events[c];return u?u.fn?1:u.length:0},o.prototype.emit=function(l,c,u,d,f,m){var g=e?e+l:l;if(!this._events[g])return!1;var p=this._events[g],y=arguments.length,x,_;if(p.fn){switch(p.once&&this.removeListener(l,p.fn,void 0,!0),y){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,c),!0;case 3:return p.fn.call(p.context,c,u),!0;case 4:return p.fn.call(p.context,c,u,d),!0;case 5:return p.fn.call(p.context,c,u,d,f),!0;case 6:return p.fn.call(p.context,c,u,d,f,m),!0}for(_=1,x=new Array(y-1);_<y;_++)x[_-1]=arguments[_];p.fn.apply(p.context,x)}else{var b=p.length,C;for(_=0;_<b;_++)switch(p[_].once&&this.removeListener(l,p[_].fn,void 0,!0),y){case 1:p[_].fn.call(p[_].context);break;case 2:p[_].fn.call(p[_].context,c);break;case 3:p[_].fn.call(p[_].context,c,u);break;case 4:p[_].fn.call(p[_].context,c,u,d);break;default:if(!x)for(C=1,x=new Array(y-1);C<y;C++)x[C-1]=arguments[C];p[_].fn.apply(p[_].context,x)}}return!0},o.prototype.on=function(l,c,u){return r(this,l,c,u,!1)},o.prototype.once=function(l,c,u){return r(this,l,c,u,!0)},o.prototype.removeListener=function(l,c,u,d){var f=e?e+l:l;if(!this._events[f])return this;if(!c)return a(this,f),this;var m=this._events[f];if(m.fn)m.fn===c&&(!d||m.once)&&(!u||m.context===u)&&a(this,f);else{for(var g=0,p=[],y=m.length;g<y;g++)(m[g].fn!==c||d&&!m[g].once||u&&m[g].context!==u)&&p.push(m[g]);p.length?this._events[f]=p.length===1?p[0]:p:a(this,f)}return this},o.prototype.removeAllListeners=function(l){var c;return l?(c=e?e+l:l,this._events[c]&&a(this,c)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=e,o.EventEmitter=o,s.exports=o}(Ai)),Ai.exports}var Jc=Qc();const ct=eh(Jc),tu=Math.PI*2,eu=180/Math.PI,mn=Math.PI/180;class lt{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new lt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return Ti.x=0,Ti.y=0,Ti}}const Ti=new lt;class N{constructor(t=1,e=0,i=0,n=1,r=0,a=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=a}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,n,r,a){return this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=a,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new lt;const i=t.x,n=t.y;return e.x=this.a*i+this.c*n+this.tx,e.y=this.b*i+this.d*n+this.ty,e}applyInverse(t,e){e=e||new lt;const i=this.a,n=this.b,r=this.c,a=this.d,o=this.tx,h=this.ty,l=1/(i*a+r*-n),c=t.x,u=t.y;return e.x=a*l*c+-r*l*u+(h*r-o*a)*l,e.y=i*l*u+-n*l*c+(-h*i+o*n)*l,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),n=this.a,r=this.c,a=this.tx;return this.a=n*e-this.b*i,this.b=n*i+this.b*e,this.c=r*e-this.d*i,this.d=r*i+this.d*e,this.tx=a*e-this.ty*i,this.ty=a*i+this.ty*e,this}append(t){const e=this.a,i=this.b,n=this.c,r=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*i+t.b*r,this.c=t.c*e+t.d*n,this.d=t.c*i+t.d*r,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*r+this.ty,this}appendFrom(t,e){const i=t.a,n=t.b,r=t.c,a=t.d,o=t.tx,h=t.ty,l=e.a,c=e.b,u=e.c,d=e.d;return this.a=i*l+n*u,this.b=i*c+n*d,this.c=r*l+a*u,this.d=r*c+a*d,this.tx=o*l+h*u+e.tx,this.ty=o*c+h*d+e.ty,this}setTransform(t,e,i,n,r,a,o,h,l){return this.a=Math.cos(o+l)*r,this.b=Math.sin(o+l)*r,this.c=-Math.sin(o-h)*a,this.d=Math.cos(o-h)*a,this.tx=t-(i*this.a+n*this.c),this.ty=e-(i*this.b+n*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const i=this.a,n=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,i=this.b,n=this.c,r=this.d,a=t.pivot,o=-Math.atan2(-n,r),h=Math.atan2(i,e),l=Math.abs(o+h);return l<1e-5||Math.abs(tu-l)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=h),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(n*n+r*r),t.position.x=this.tx+(a.x*e+a.y*n),t.position.y=this.ty+(a.x*i+a.y*r),t}invert(){const t=this.a,e=this.b,i=this.c,n=this.d,r=this.tx,a=t*n-e*i;return this.a=n/a,this.b=-e/a,this.c=-i/a,this.d=t/a,this.tx=(i*this.ty-n*r)/a,this.ty=-(t*this.ty-e*r)/a,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new N;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return iu.identity()}static get shared(){return su.identity()}}const su=new N,iu=new N,he=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],le=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],ce=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ue=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],gn=[],sh=[],Ds=Math.sign;function nu(){for(let s=0;s<16;s++){const t=[];gn.push(t);for(let e=0;e<16;e++){const i=Ds(he[s]*he[e]+ce[s]*le[e]),n=Ds(le[s]*he[e]+ue[s]*le[e]),r=Ds(he[s]*ce[e]+ce[s]*ue[e]),a=Ds(le[s]*ce[e]+ue[s]*ue[e]);for(let o=0;o<16;o++)if(he[o]===i&&le[o]===n&&ce[o]===r&&ue[o]===a){t.push(o);break}}}for(let s=0;s<16;s++){const t=new N;t.set(he[s],le[s],ce[s],ue[s],0,0),sh.push(t)}}nu();const j={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:s=>he[s],uY:s=>le[s],vX:s=>ce[s],vY:s=>ue[s],inv:s=>s&8?s&15:-s&7,add:(s,t)=>gn[s][t],sub:(s,t)=>gn[s][j.inv(t)],rotate180:s=>s^4,isVertical:s=>(s&3)===2,byDirection:(s,t)=>Math.abs(s)*2<=Math.abs(t)?t>=0?j.S:j.N:Math.abs(t)*2<=Math.abs(s)?s>0?j.E:j.W:t>0?s>0?j.SE:j.SW:s>0?j.NE:j.NW,matrixAppendRotationInv:(s,t,e=0,i=0)=>{const n=sh[j.inv(t)];n.tx=e,n.ty=i,s.append(n)}},Ns=[new lt,new lt,new lt,new lt];class K{constructor(t=0,e=0,i=0,n=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(n)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new K(0,0,0,0)}clone(){return new K(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}strokeContains(t,e,i,n=.5){const{width:r,height:a}=this;if(r<=0||a<=0)return!1;const o=this.x,h=this.y,l=i*(1-n),c=i-l,u=o-l,d=o+r+l,f=h-l,m=h+a+l,g=o+c,p=o+r-c,y=h+c,x=h+a-c;return t>=u&&t<=d&&e>=f&&e<=m&&!(t>g&&t<p&&e>y&&e<x)}intersects(t,e){if(!e){const T=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=T)return!1;const M=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>M}const i=this.left,n=this.right,r=this.top,a=this.bottom;if(n<=i||a<=r)return!1;const o=Ns[0].set(t.left,t.top),h=Ns[1].set(t.left,t.bottom),l=Ns[2].set(t.right,t.top),c=Ns[3].set(t.right,t.bottom);if(l.x<=o.x||h.y<=o.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(o,o),e.apply(h,h),e.apply(l,l),e.apply(c,c),Math.max(o.x,h.x,l.x,c.x)<=i||Math.min(o.x,h.x,l.x,c.x)>=n||Math.max(o.y,h.y,l.y,c.y)<=r||Math.min(o.y,h.y,l.y,c.y)>=a))return!1;const d=u*(h.y-o.y),f=u*(o.x-h.x),m=d*i+f*r,g=d*n+f*r,p=d*i+f*a,y=d*n+f*a;if(Math.max(m,g,p,y)<=d*o.x+f*o.y||Math.min(m,g,p,y)>=d*c.x+f*c.y)return!1;const x=u*(o.y-l.y),_=u*(l.x-o.x),b=x*i+_*r,C=x*n+_*r,w=x*i+_*a,v=x*n+_*a;return!(Math.max(b,C,w,v)<=x*o.x+_*o.y||Math.min(b,C,w,v)>=x*c.x+_*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),n=Math.max(this.y,t.y),r=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=n,this.height=Math.max(r-n,0),this}ceil(t=1,e=.001){const i=Math.ceil((this.x+this.width-e)*t)/t,n=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=n-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),r=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=n,this.height=r-n,this}getBounds(t){return t||(t=new K),t.copyFrom(this),t}containsRect(t){if(this.width<=0||this.height<=0)return!1;const e=t.x,i=t.y,n=t.x+t.width,r=t.y+t.height;return e>=this.x&&e<this.x+this.width&&i>=this.y&&i<this.y+this.height&&n>=this.x&&n<this.x+this.width&&r>=this.y&&r<this.y+this.height}set(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const Pi={default:-1};function tt(s="default"){return Pi[s]===void 0&&(Pi[s]=-1),++Pi[s]}const zr={},W="8.0.0",ru="8.3.4";function V(s,t,e=3){if(zr[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`):(i=i.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${s}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`),console.warn(i))),zr[t]=!0}const ih=()=>{};function Ie(s){return s+=s===0?1:0,--s,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s+1}function Ur(s){return!(s&s-1)&&!!s}function nh(s){const t={};for(const e in s)s[e]!==void 0&&(t[e]=s[e]);return t}const Gr=Object.create(null);function au(s){const t=Gr[s];return t===void 0&&(Gr[s]=tt("resource")),t}const rh=class ah extends ct{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,t={...ah.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){V(W,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=au(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};rh.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let Fe=rh;const oh=class hh extends ct{constructor(t={}){super(),this.options=t,this.uid=tt("textureSource"),this._resourceType="textureSource",this._resourceId=tt("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...hh.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new Fe(nh(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){var e,i;this.style!==t&&((e=this._style)==null||e.off("change",this._onStyleChange,this),this._style=t,(i=this._style)==null||i.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=tt("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,i){i||(i=this._resolution),t||(t=this.width),e||(e=this.height);const n=Math.round(t*i),r=Math.round(e*i);return this.width=n/i,this.height=r/i,this._resolution=i,this.pixelWidth===n&&this.pixelHeight===r?!1:(this._refreshPOT(),this.pixelWidth=n,this.pixelHeight=r,this.emit("resize",this),this._resourceId=tt("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=Ur(this.pixelWidth)&&Ur(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};oh.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let Pt=oh;class er extends Pt{constructor(t){const e=t.resource||new Float32Array(t.width*t.height*4);let i=t.format;i||(e instanceof Float32Array?i="rgba32float":e instanceof Int32Array||e instanceof Uint32Array?i="rgba32uint":e instanceof Int16Array||e instanceof Uint16Array?i="rgba16uint":(e instanceof Int8Array,i="bgra8unorm")),super({...t,resource:e,format:i}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}er.extension=R.TextureSource;const Wr=new N;class ou{constructor(t,e){this.mapCoord=new N,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof e>"u"?this.clampMargin=t.width<10?0:.5:this.clampMargin=e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){var e;this.texture!==t&&((e=this._texture)==null||e.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const i=this.mapCoord;for(let n=0;n<t.length;n+=2){const r=t[n],a=t[n+1];e[n]=r*i.a+a*i.c+i.tx,e[n+1]=r*i.b+a*i.d+i.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const i=t.orig,n=t.trim;n&&(Wr.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Wr));const r=t.source,a=this.uClampFrame,o=this.clampMargin/r._resolution,h=this.clampOffset/r._resolution;return a[0]=(t.frame.x+o+h)/r.width,a[1]=(t.frame.y+o+h)/r.height,a[2]=(t.frame.x+t.frame.width-o+h)/r.width,a[3]=(t.frame.y+t.frame.height-o+h)/r.height,this.uClampOffset[0]=this.clampOffset/r.pixelWidth,this.uClampOffset[1]=this.clampOffset/r.pixelHeight,this.isSimple=t.frame.width===r.width&&t.frame.height===r.height&&t.rotate===0,!0}}class D extends ct{constructor({source:t,label:e,frame:i,orig:n,trim:r,defaultAnchor:a,defaultBorders:o,rotate:h,dynamic:l}={}){if(super(),this.uid=tt("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new K,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=e,this.source=(t==null?void 0:t.source)??new Pt,this.noFrame=!i,i)this.frame.copyFrom(i);else{const{width:c,height:u}=this._source;this.frame.width=c,this.frame.height=u}this.orig=n||this.frame,this.trim=r,this.rotate=h??0,this.defaultAnchor=a,this.defaultBorders=o,this.destroyed=!1,this.dynamic=l||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new ou(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:e}=this,{width:i,height:n}=this._source,r=e.x/i,a=e.y/n,o=e.width/i,h=e.height/n;let l=this.rotate;if(l){const c=o/2,u=h/2,d=r+c,f=a+u;l=j.add(l,j.NW),t.x0=d+c*j.uX(l),t.y0=f+u*j.uY(l),l=j.add(l,2),t.x1=d+c*j.uX(l),t.y1=f+u*j.uY(l),l=j.add(l,2),t.x2=d+c*j.uX(l),t.y2=f+u*j.uY(l),l=j.add(l,2),t.x3=d+c*j.uX(l),t.y3=f+u*j.uY(l)}else t.x0=r,t.y0=a,t.x1=r+o,t.y1=a,t.x2=r+o,t.y2=a+h,t.x3=r,t.y3=a+h}destroy(t=!1){this._source&&t&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return V(W,"Texture.baseTexture is now Texture.source"),this._source}}D.EMPTY=new D({label:"EMPTY",source:new Pt({label:"EMPTY"})});D.EMPTY.destroy=ih;D.WHITE=new D({source:new er({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});D.WHITE.destroy=ih;function hu(s,t,e){const{width:i,height:n}=e.orig,r=e.trim;if(r){const a=r.width,o=r.height;s.minX=r.x-t._x*i,s.maxX=s.minX+a,s.minY=r.y-t._y*n,s.maxY=s.minY+o}else s.minX=-t._x*i,s.maxX=s.minX+i,s.minY=-t._y*n,s.maxY=s.minY+n}const Hr=new N;class Tt{constructor(t=1/0,e=1/0,i=-1/0,n=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Hr,this.minX=t,this.minY=e,this.maxX=i,this.maxY=n}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new K);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Hr,this}set(t,e,i,n){this.minX=t,this.minY=e,this.maxX=i,this.maxY=n}addFrame(t,e,i,n,r){r||(r=this.matrix);const a=r.a,o=r.b,h=r.c,l=r.d,c=r.tx,u=r.ty;let d=this.minX,f=this.minY,m=this.maxX,g=this.maxY,p=a*t+h*e+c,y=o*t+l*e+u;p<d&&(d=p),y<f&&(f=y),p>m&&(m=p),y>g&&(g=y),p=a*i+h*e+c,y=o*i+l*e+u,p<d&&(d=p),y<f&&(f=y),p>m&&(m=p),y>g&&(g=y),p=a*t+h*n+c,y=o*t+l*n+u,p<d&&(d=p),y<f&&(f=y),p>m&&(m=p),y>g&&(g=y),p=a*i+h*n+c,y=o*i+l*n+u,p<d&&(d=p),y<f&&(f=y),p>m&&(m=p),y>g&&(g=y),this.minX=d,this.minY=f,this.maxX=m,this.maxY=g}addRect(t,e){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,e)}addBounds(t,e){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,e)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,i=this.minY,n=this.maxX,r=this.maxY,{a,b:o,c:h,d:l,tx:c,ty:u}=t;let d=a*e+h*i+c,f=o*e+l*i+u;this.minX=d,this.minY=f,this.maxX=d,this.maxY=f,d=a*n+h*i+c,f=o*n+l*i+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=a*e+h*r+c,f=o*e+l*r+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=a*n+h*r+c,f=o*n+l*r+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,e,i,n){return this.minX<t&&(this.minX=t),this.maxX>e&&(this.maxX=e),this.minY<i&&(this.minY=i),this.maxY>n&&(this.maxY=n),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Tt(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}set x(t){const e=this.maxX-this.minX;this.minX=t,this.maxX=t+e}get y(){return this.minY}set y(t){const e=this.maxY-this.minY;this.minY=t,this.maxY=t+e}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,i,n){let r=this.minX,a=this.minY,o=this.maxX,h=this.maxY;n||(n=this.matrix);const l=n.a,c=n.b,u=n.c,d=n.d,f=n.tx,m=n.ty;for(let g=e;g<i;g+=2){const p=t[g],y=t[g+1],x=l*p+u*y+f,_=c*p+d*y+m;r=x<r?x:r,a=_<a?_:a,o=x>o?x:o,h=_>h?_:h}this.minX=r,this.minY=a,this.maxX=o,this.maxY=h}containsPoint(t,e){return this.minX<=t&&this.minY<=e&&this.maxX>=t&&this.maxY>=e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(t){return this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,this}}var lu={grad:.9,turn:360,rad:360/(2*Math.PI)},Vt=function(s){return typeof s=="string"?s.length>0:typeof s=="number"},it=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*s)/e+0},xt=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),s>e?e:s>t?s:t},lh=function(s){return(s=isFinite(s)?s%360:0)>0?s:s+360},$r=function(s){return{r:xt(s.r,0,255),g:xt(s.g,0,255),b:xt(s.b,0,255),a:xt(s.a)}},Mi=function(s){return{r:it(s.r),g:it(s.g),b:it(s.b),a:it(s.a,3)}},cu=/^#([0-9a-f]{3,8})$/i,zs=function(s){var t=s.toString(16);return t.length<2?"0"+t:t},ch=function(s){var t=s.r,e=s.g,i=s.b,n=s.a,r=Math.max(t,e,i),a=r-Math.min(t,e,i),o=a?r===t?(e-i)/a:r===e?2+(i-t)/a:4+(t-e)/a:0;return{h:60*(o<0?o+6:o),s:r?a/r*100:0,v:r/255*100,a:n}},uh=function(s){var t=s.h,e=s.s,i=s.v,n=s.a;t=t/360*6,e/=100,i/=100;var r=Math.floor(t),a=i*(1-e),o=i*(1-(t-r)*e),h=i*(1-(1-t+r)*e),l=r%6;return{r:255*[i,o,a,a,h,i][l],g:255*[h,i,i,o,a,a][l],b:255*[a,a,h,i,i,o][l],a:n}},Yr=function(s){return{h:lh(s.h),s:xt(s.s,0,100),l:xt(s.l,0,100),a:xt(s.a)}},jr=function(s){return{h:it(s.h),s:it(s.s),l:it(s.l),a:it(s.a,3)}},Xr=function(s){return uh((e=(t=s).s,{h:t.h,s:(e*=((i=t.l)<50?i:100-i)/100)>0?2*e/(i+e)*100:0,v:i+e,a:t.a}));var t,e,i},ms=function(s){return{h:(t=ch(s)).h,s:(n=(200-(e=t.s))*(i=t.v)/100)>0&&n<200?e*i/100/(n<=100?n:200-n)*100:0,l:n/2,a:t.a};var t,e,i,n},uu=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,du=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,fu=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,pu=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,yn={string:[[function(s){var t=cu.exec(s);return t?(s=t[1]).length<=4?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?it(parseInt(s[3]+s[3],16)/255,2):1}:s.length===6||s.length===8?{r:parseInt(s.substr(0,2),16),g:parseInt(s.substr(2,2),16),b:parseInt(s.substr(4,2),16),a:s.length===8?it(parseInt(s.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(s){var t=fu.exec(s)||pu.exec(s);return t?t[2]!==t[4]||t[4]!==t[6]?null:$r({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(s){var t=uu.exec(s)||du.exec(s);if(!t)return null;var e,i,n=Yr({h:(e=t[1],i=t[2],i===void 0&&(i="deg"),Number(e)*(lu[i]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return Xr(n)},"hsl"]],object:[[function(s){var t=s.r,e=s.g,i=s.b,n=s.a,r=n===void 0?1:n;return Vt(t)&&Vt(e)&&Vt(i)?$r({r:Number(t),g:Number(e),b:Number(i),a:Number(r)}):null},"rgb"],[function(s){var t=s.h,e=s.s,i=s.l,n=s.a,r=n===void 0?1:n;if(!Vt(t)||!Vt(e)||!Vt(i))return null;var a=Yr({h:Number(t),s:Number(e),l:Number(i),a:Number(r)});return Xr(a)},"hsl"],[function(s){var t=s.h,e=s.s,i=s.v,n=s.a,r=n===void 0?1:n;if(!Vt(t)||!Vt(e)||!Vt(i))return null;var a=function(o){return{h:lh(o.h),s:xt(o.s,0,100),v:xt(o.v,0,100),a:xt(o.a)}}({h:Number(t),s:Number(e),v:Number(i),a:Number(r)});return uh(a)},"hsv"]]},Kr=function(s,t){for(var e=0;e<t.length;e++){var i=t[e][0](s);if(i)return[i,t[e][1]]}return[null,void 0]},mu=function(s){return typeof s=="string"?Kr(s.trim(),yn.string):typeof s=="object"&&s!==null?Kr(s,yn.object):[null,void 0]},Ei=function(s,t){var e=ms(s);return{h:e.h,s:xt(e.s+100*t,0,100),l:e.l,a:e.a}},ki=function(s){return(299*s.r+587*s.g+114*s.b)/1e3/255},qr=function(s,t){var e=ms(s);return{h:e.h,s:e.s,l:xt(e.l+100*t,0,100),a:e.a}},xn=function(){function s(t){this.parsed=mu(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return s.prototype.isValid=function(){return this.parsed!==null},s.prototype.brightness=function(){return it(ki(this.rgba),2)},s.prototype.isDark=function(){return ki(this.rgba)<.5},s.prototype.isLight=function(){return ki(this.rgba)>=.5},s.prototype.toHex=function(){return t=Mi(this.rgba),e=t.r,i=t.g,n=t.b,a=(r=t.a)<1?zs(it(255*r)):"","#"+zs(e)+zs(i)+zs(n)+a;var t,e,i,n,r,a},s.prototype.toRgb=function(){return Mi(this.rgba)},s.prototype.toRgbString=function(){return t=Mi(this.rgba),e=t.r,i=t.g,n=t.b,(r=t.a)<1?"rgba("+e+", "+i+", "+n+", "+r+")":"rgb("+e+", "+i+", "+n+")";var t,e,i,n,r},s.prototype.toHsl=function(){return jr(ms(this.rgba))},s.prototype.toHslString=function(){return t=jr(ms(this.rgba)),e=t.h,i=t.s,n=t.l,(r=t.a)<1?"hsla("+e+", "+i+"%, "+n+"%, "+r+")":"hsl("+e+", "+i+"%, "+n+"%)";var t,e,i,n,r},s.prototype.toHsv=function(){return t=ch(this.rgba),{h:it(t.h),s:it(t.s),v:it(t.v),a:it(t.a,3)};var t},s.prototype.invert=function(){return Rt({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},s.prototype.saturate=function(t){return t===void 0&&(t=.1),Rt(Ei(this.rgba,t))},s.prototype.desaturate=function(t){return t===void 0&&(t=.1),Rt(Ei(this.rgba,-t))},s.prototype.grayscale=function(){return Rt(Ei(this.rgba,-1))},s.prototype.lighten=function(t){return t===void 0&&(t=.1),Rt(qr(this.rgba,t))},s.prototype.darken=function(t){return t===void 0&&(t=.1),Rt(qr(this.rgba,-t))},s.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},s.prototype.alpha=function(t){return typeof t=="number"?Rt({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):it(this.rgba.a,3);var e},s.prototype.hue=function(t){var e=ms(this.rgba);return typeof t=="number"?Rt({h:t,s:e.s,l:e.l,a:e.a}):it(e.h)},s.prototype.isEqual=function(t){return this.toHex()===Rt(t).toHex()},s}(),Rt=function(s){return s instanceof xn?s:new xn(s)},Zr=[],gu=function(s){s.forEach(function(t){Zr.indexOf(t)<0&&(t(xn,yn),Zr.push(t))})};function yu(s,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var n in e)i[e[n]]=n;var r={};s.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var o,h,l=i[this.toHex()];if(l)return l;if(a!=null&&a.closest){var c=this.toRgb(),u=1/0,d="black";if(!r.length)for(var f in e)r[f]=new s(e[f]).toRgb();for(var m in e){var g=(o=c,h=r[m],Math.pow(o.r-h.r,2)+Math.pow(o.g-h.g,2)+Math.pow(o.b-h.b,2));g<u&&(u=g,d=m)}return d}},t.string.push([function(a){var o=a.toLowerCase(),h=o==="transparent"?"#0000":e[o];return h?new s(h).toRgb():null},"name"])}gu([yu]);const Be=class ls{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof ls)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._value=this._cloneSource(t),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,e){const i=typeof t;if(i!==typeof e)return!1;if(i==="number"||i==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((r,a)=>r===e[a]);if(t!==null&&e!==null){const r=Object.keys(t),a=Object.keys(e);return r.length!==a.length?!1:r.every(o=>t[o]===e[o])}return t===e}toRgba(){const[t,e,i,n]=this._components;return{r:t,g:e,b:i,a:n}}toRgb(){const[t,e,i]=this._components;return{r:t,g:e,b:i}}toRgbaString(){const[t,e,i]=this.toUint8RgbArray();return`rgba(${t},${e},${i},${this.alpha})`}toUint8RgbArray(t){const[e,i,n]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb),t[0]=Math.round(e*255),t[1]=Math.round(i*255),t[2]=Math.round(n*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t||(t=this._arrayRgba);const[e,i,n,r]=this._components;return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb);const[e,i,n]=this._components;return t[0]=e,t[1]=i,t[2]=n,t}toNumber(){return this._int}toBgrNumber(){const[t,e,i]=this.toUint8RgbArray();return(i<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,i,n,r]=ls._temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=i,this._components[2]*=n,this._components[3]*=r,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let i=this._int>>16&255,n=this._int>>8&255,r=this._int&255;return e&&(i=i*t+.5|0,n=n*t+.5|0,r=r*t+.5|0),(t*255<<24)+(i<<16)+(n<<8)+r}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let e,i,n,r;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const a=t;e=(a>>16&255)/255,i=(a>>8&255)/255,n=(a&255)/255,r=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,i,n,r=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,i,n,r=255]=t,e/=255,i/=255,n/=255,r/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const o=ls.HEX_PATTERN.exec(t);o&&(t=`#${o[2]}`)}const a=Rt(t);a.isValid()&&({r:e,g:i,b:n,a:r}=a.rgba,e/=255,i/=255,n/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=i,this._components[2]=n,this._components[3]=r,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,e,i]=this._components;this._int=(t*255<<16)+(e*255<<8)+(i*255|0)}_clamp(t,e=0,i=1){return typeof t=="number"?Math.min(Math.max(t,e),i):(t.forEach((n,r)=>{t[r]=Math.min(Math.max(n,e),i)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof ls||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}};Be.shared=new Be;Be._temp=new Be;Be.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let et=Be;const xu={cullArea:null,cullable:!1,cullableChildren:!0};let Ri=0;const Qr=500;function $(...s){Ri!==Qr&&(Ri++,Ri===Qr?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...s))}class sr{constructor(t,e){this._pool=[],this._count=0,this._index=0,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){var i;let e;return this._index>0?e=this._pool[--this._index]:e=new this._classType,(i=e.init)==null||i.call(e,t),e}return(t){var e;(e=t.reset)==null||e.call(t),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class _u{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new sr(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const i=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[i]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}}const Bt=new _u,bu={get isCachedAsTexture(){var s;return!!((s=this.renderGroup)!=null&&s.isCachedAsTexture)},cacheAsTexture(s){typeof s=="boolean"&&s===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(s===!0?{}:s))},updateCacheTexture(){var s;(s=this.renderGroup)==null||s.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(s){V("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(s)}};function wu(s,t,e){const i=s.length;let n;if(t>=i||e===0)return;e=t+e>i?i-t:e;const r=i-e;for(n=t;n<r;++n)s[n]=s[n+e];s.length=r}const vu={allowChildren:!0,removeChildren(s=0,t){var r;const e=t??this.children.length,i=e-s,n=[];if(i>0&&i<=e){for(let o=e-1;o>=s;o--){const h=this.children[o];h&&(n.push(h),h.parent=null)}wu(this.children,s,e);const a=this.renderGroup||this.parentRenderGroup;a&&a.removeChildren(n);for(let o=0;o<n.length;++o){const h=n[o];(r=h.parentRenderLayer)==null||r.detach(h),this.emit("childRemoved",h,this,o),n[o].emit("removed",this)}return n.length>0&&this._didViewChangeTick++,n}else if(i===0&&this.children.length===0)return n;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(s){const t=this.getChildAt(s);return this.removeChild(t)},getChildAt(s){if(s<0||s>=this.children.length)throw new Error(`getChildAt: Index (${s}) does not exist.`);return this.children[s]},setChildIndex(s,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(s),this.addChildAt(s,t)},getChildIndex(s){const t=this.children.indexOf(s);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(s,t){this.allowChildren||V(W,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:e}=this;if(t<0||t>e.length)throw new Error(`${s}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(s.parent){const n=s.parent.children.indexOf(s);if(s.parent===this&&n===t)return s;n!==-1&&s.parent.children.splice(n,1)}t===e.length?e.push(s):e.splice(t,0,s),s.parent=this,s.didChange=!0,s._updateFlags=15;const i=this.renderGroup||this.parentRenderGroup;return i&&i.addChild(s),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",s,this,t),s.emit("added",this),s},swapChildren(s,t){if(s===t)return;const e=this.getChildIndex(s),i=this.getChildIndex(t);this.children[e]=t,this.children[i]=s;const n=this.renderGroup||this.parentRenderGroup;n&&(n.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var s;(s=this.parent)==null||s.removeChild(this)},reparentChild(...s){return s.length===1?this.reparentChildAt(s[0],this.children.length):(s.forEach(t=>this.reparentChildAt(t,this.children.length)),s[0])},reparentChildAt(s,t){if(s.parent===this)return this.setChildIndex(s,t),s;const e=s.worldTransform.clone();s.removeFromParent(),this.addChildAt(s,t);const i=this.worldTransform.clone();return i.invert(),e.prepend(i),s.setFromMatrix(e),s},replaceChild(s,t){s.updateLocalTransform(),this.addChildAt(t,this.getChildIndex(s)),t.setFromMatrix(s.localTransform),t.updateLocalTransform(),this.removeChild(s)}},Cu={collectRenderables(s,t,e){this.parentRenderLayer&&this.parentRenderLayer!==e||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(s,t,e):this.renderGroup?t.renderPipes.renderGroup.addRenderGroup(this.renderGroup,s):this.collectRenderablesWithEffects(s,t,e))},collectRenderablesSimple(s,t,e){const i=this.children,n=i.length;for(let r=0;r<n;r++)i[r].collectRenderables(s,t,e)},collectRenderablesWithEffects(s,t,e){const{renderPipes:i}=t;for(let n=0;n<this.effects.length;n++){const r=this.effects[n];i[r.pipe].push(r,this,s)}this.collectRenderablesSimple(s,t,e);for(let n=this.effects.length-1;n>=0;n--){const r=this.effects[n];i[r.pipe].pop(r,this,s)}}};class Jr{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}class Su{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this._tests.length;e++){const i=this._tests[e];if(i.test(t))return Bt.get(i.maskClass,t)}return t}returnMaskEffect(t){Bt.return(t)}}const _n=new Su;Y.handleByList(R.MaskEffect,_n._effectClasses);const Au={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const s=this.renderGroup||this.parentRenderGroup;s&&(s.structureDidChange=!0)},addEffect(s){this.effects.indexOf(s)===-1&&(this.effects.push(s),this.effects.sort((e,i)=>e.priority-i.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(s){const t=this.effects.indexOf(s);t!==-1&&(this.effects.splice(t,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(s){const t=this._maskEffect;(t==null?void 0:t.mask)!==s&&(t&&(this.removeEffect(t),_n.returnMaskEffect(t),this._maskEffect=null),s!=null&&(this._maskEffect=_n.getMaskEffect(s),this.addEffect(this._maskEffect)))},get mask(){var s;return(s=this._maskEffect)==null?void 0:s.mask},setMask(s){this._maskOptions={...this._maskOptions,...s},s.mask&&(this.mask=s.mask),this._markStructureAsChanged()},set filters(s){var r;!Array.isArray(s)&&s&&(s=[s]);const t=this._filterEffect||(this._filterEffect=new Jr);s=s;const e=(s==null?void 0:s.length)>0,i=((r=t.filters)==null?void 0:r.length)>0,n=e!==i;s=Array.isArray(s)?s.slice(0):s,t.filters=Object.freeze(s),n&&(e?this.addEffect(t):(this.removeEffect(t),t.filters=s??null))},get filters(){var s;return(s=this._filterEffect)==null?void 0:s.filters},set filterArea(s){this._filterEffect||(this._filterEffect=new Jr),this._filterEffect.filterArea=s},get filterArea(){var s;return(s=this._filterEffect)==null?void 0:s.filterArea}},Tu={label:null,get name(){return V(W,"Container.name property has been removed, use Container.label instead"),this.label},set name(s){V(W,"Container.name property has been removed, use Container.label instead"),this.label=s},getChildByName(s,t=!1){return this.getChildByLabel(s,t)},getChildByLabel(s,t=!1){const e=this.children;for(let i=0;i<e.length;i++){const n=e[i];if(n.label===s||s instanceof RegExp&&s.test(n.label))return n}if(t)for(let i=0;i<e.length;i++){const r=e[i].getChildByLabel(s,!0);if(r)return r}return null},getChildrenByLabel(s,t=!1,e=[]){const i=this.children;for(let n=0;n<i.length;n++){const r=i[n];(r.label===s||s instanceof RegExp&&s.test(r.label))&&e.push(r)}if(t)for(let n=0;n<i.length;n++)i[n].getChildrenByLabel(s,!0,e);return e}},ut=new sr(N),zt=new sr(Tt),Pu=new N,Mu={getFastGlobalBounds(s,t){t||(t=new Tt),t.clear(),this._getGlobalBoundsRecursive(!!s,t,this.parentRenderLayer),t.isValid||t.set(0,0,0,0);const e=this.renderGroup||this.parentRenderGroup;return t.applyMatrix(e.worldTransform),t},_getGlobalBoundsRecursive(s,t,e){let i=t;if(s&&this.parentRenderLayer&&this.parentRenderLayer!==e||this.localDisplayStatus!==7||!this.measurable)return;const n=!!this.effects.length;if((this.renderGroup||n)&&(i=zt.get().clear()),this.boundsArea)t.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const a=this.bounds;i.addFrame(a.minX,a.minY,a.maxX,a.maxY,this.groupTransform)}const r=this.children;for(let a=0;a<r.length;a++)r[a]._getGlobalBoundsRecursive(s,i,e)}if(n){let r=!1;const a=this.renderGroup||this.parentRenderGroup;for(let o=0;o<this.effects.length;o++)this.effects[o].addBounds&&(r||(r=!0,i.applyMatrix(a.worldTransform)),this.effects[o].addBounds(i,!0));r&&(i.applyMatrix(a.worldTransform.copyTo(Pu).invert()),t.addBounds(i,this.relativeGroupTransform)),t.addBounds(i),zt.return(i)}else this.renderGroup&&(t.addBounds(i,this.relativeGroupTransform),zt.return(i))}};function dh(s,t,e){e.clear();let i,n;return s.parent?t?i=s.parent.worldTransform:(n=ut.get().identity(),i=ir(s,n)):i=N.IDENTITY,fh(s,e,i,t),n&&ut.return(n),e.isValid||e.set(0,0,0,0),e}function fh(s,t,e,i){var o,h;if(!s.visible||!s.measurable)return;let n;i?n=s.worldTransform:(s.updateLocalTransform(),n=ut.get(),n.appendFrom(s.localTransform,e));const r=t,a=!!s.effects.length;if(a&&(t=zt.get().clear()),s.boundsArea)t.addRect(s.boundsArea,n);else{s.bounds&&(t.matrix=n,t.addBounds(s.bounds));for(let l=0;l<s.children.length;l++)fh(s.children[l],t,n,i)}if(a){for(let l=0;l<s.effects.length;l++)(h=(o=s.effects[l]).addBounds)==null||h.call(o,t);r.addBounds(t,N.IDENTITY),zt.return(t)}i||ut.return(n)}function ir(s,t){const e=s.parent;return e&&(ir(e,t),e.updateLocalTransform(),t.append(e.localTransform)),t}function ph(s,t){if(s===16777215||!t)return t;if(t===16777215||!s)return s;const e=s>>16&255,i=s>>8&255,n=s&255,r=t>>16&255,a=t>>8&255,o=t&255,h=e*r/255|0,l=i*a/255|0,c=n*o/255|0;return(h<<16)+(l<<8)+c}const ta=16777215;function ea(s,t){return s===ta?t:t===ta?s:ph(s,t)}function ti(s){return((s&255)<<16)+(s&65280)+(s>>16&255)}const Eu={getGlobalAlpha(s){if(s)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let t=this.alpha,e=this.parent;for(;e;)t*=e.alpha,e=e.parent;return t},getGlobalTransform(s,t){if(t)return s.copyFrom(this.worldTransform);this.updateLocalTransform();const e=ir(this,ut.get().identity());return s.appendFrom(this.localTransform,e),ut.return(e),s},getGlobalTint(s){if(s)return this.renderGroup?ti(this.renderGroup.worldColor):this.parentRenderGroup?ti(ea(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let t=this.localColor,e=this.parent;for(;e;)t=ea(t,e.localColor),e=e.parent;return ti(t)}};function mh(s,t,e){return t.clear(),e||(e=N.IDENTITY),gh(s,t,e,s,!0),t.isValid||t.set(0,0,0,0),t}function gh(s,t,e,i,n){var h,l;let r;if(n)r=ut.get(),r=e.copyTo(r);else{if(!s.visible||!s.measurable)return;s.updateLocalTransform();const c=s.localTransform;r=ut.get(),r.appendFrom(c,e)}const a=t,o=!!s.effects.length;if(o&&(t=zt.get().clear()),s.boundsArea)t.addRect(s.boundsArea,r);else{s.renderPipeId&&(t.matrix=r,t.addBounds(s.bounds));const c=s.children;for(let u=0;u<c.length;u++)gh(c[u],t,r,i,!1)}if(o){for(let c=0;c<s.effects.length;c++)(l=(h=s.effects[c]).addLocalBounds)==null||l.call(h,t,i);a.addBounds(t,N.IDENTITY),zt.return(t)}ut.return(r)}function yh(s,t){const e=s.children;for(let i=0;i<e.length;i++){const n=e[i],r=n.uid,a=(n._didViewChangeTick&65535)<<16|n._didContainerChangeTick&65535,o=t.index;(t.data[o]!==r||t.data[o+1]!==a)&&(t.data[t.index]=r,t.data[t.index+1]=a,t.didChange=!0),t.index=o+2,n.children.length&&yh(n,t)}return t.didChange}const ku=new N,Ru={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(s,t){const e=Math.sign(this.scale.x)||1;t!==0?this.scale.x=s/t*e:this.scale.x=e},_setHeight(s,t){const e=Math.sign(this.scale.y)||1;t!==0?this.scale.y=s/t*e:this.scale.y=e},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new Tt});const s=this._localBoundsCacheData;return s.index=1,s.didChange=!1,s.data[0]!==this._didViewChangeTick&&(s.didChange=!0,s.data[0]=this._didViewChangeTick),yh(this,s),s.didChange&&mh(this,s.localBounds,ku),s.localBounds},getBounds(s,t){return dh(this,s,t||new Tt)}},Iu={_onRender:null,set onRender(s){const t=this.renderGroup||this.parentRenderGroup;if(!s){this._onRender&&(t==null||t.removeOnRender(this)),this._onRender=null;return}this._onRender||t==null||t.addOnRender(this),this._onRender=s},get onRender(){return this._onRender}},Fu={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(s){this._zIndex!==s&&(this._zIndex=s,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(Bu))}};function Bu(s,t){return s._zIndex-t._zIndex}const Lu={getGlobalPosition(s=new lt,t=!1){return this.parent?this.parent.toGlobal(this._position,s,t):(s.x=this._position.x,s.y=this._position.y),s},toGlobal(s,t,e=!1){const i=this.getGlobalTransform(ut.get(),e);return t=i.apply(s,t),ut.return(i),t},toLocal(s,t,e,i){t&&(s=t.toGlobal(s,e,i));const n=this.getGlobalTransform(ut.get(),i);return e=n.applyInverse(s,e),ut.return(n),e}};class xh{constructor(){this.uid=tt("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let Ou=0;class Vu{constructor(t){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this.textureStyle=new Fe(this.textureOptions)}createTexture(t,e,i){const n=new Pt({...this.textureOptions,width:t,height:e,resolution:1,antialias:i,autoGarbageCollect:!1});return new D({source:n,label:`texturePool_${Ou++}`})}getOptimalTexture(t,e,i=1,n){let r=Math.ceil(t*i-1e-6),a=Math.ceil(e*i-1e-6);r=Ie(r),a=Ie(a);const o=(r<<17)+(a<<1)+(n?1:0);this._texturePool[o]||(this._texturePool[o]=[]);let h=this._texturePool[o].pop();return h||(h=this.createTexture(r,a,n)),h.source._resolution=i,h.source.width=r/i,h.source.height=a/i,h.source.pixelWidth=r,h.source.pixelHeight=a,h.frame.x=0,h.frame.y=0,h.frame.width=t,h.frame.height=e,h.updateUvs(),this._poolKeyHash[h.uid]=o,h}getSameSizeTexture(t,e=!1){const i=t.source;return this.getOptimalTexture(t.width,t.height,i._resolution,e)}returnTexture(t,e=!1){const i=this._poolKeyHash[t.uid];e&&(t.source.style=this.textureStyle),this._texturePool[i].push(t)}clear(t){if(t=t!==!1,t)for(const e in this._texturePool){const i=this._texturePool[e];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0)}this._texturePool={}}}const Du=new Vu;class Nu{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new N,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new xh,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(t){this.root=t,t._onRender&&this.addOnRender(t),t.didChange=!0;const e=t.children;for(let i=0;i<e.length;i++){const n=e[i];n._updateFlags=15,this.addChild(n)}}enableCacheAsTexture(t={}){this.textureOptions=t,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(Du.returnTexture(this.texture),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const e=this.childrenToUpdate[t];e.list.fill(null),e.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){const e=this.renderGroupChildren.indexOf(t);e>-1&&this.renderGroupChildren.splice(e,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup){this.addRenderGroupChild(t.renderGroup);return}t._onRender&&this.addOnRender(t);const e=t.children;for(let i=0;i<e.length;i++)this.addChild(e[i])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup){this._removeRenderGroupChild(t.renderGroup);return}const e=t.children;for(let i=0;i<e.length;i++)this.removeChild(e[i])}removeChildren(t){for(let e=0;e<t.length;e++)this.removeChild(t[e])}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeRenderGroupDepth];e||(e=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(t){for(let e=0;e<this._onRenderContainers.length;e++)this._onRenderContainers[e]._onRender(t)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(t=[]){const e=this.root.children;for(let i=0;i<e.length;i++)this._getChildren(e[i],t);return t}_getChildren(t,e=[]){if(e.push(t),t.renderGroup)return e;const i=t.children;for(let n=0;n<i.length;n++)this._getChildren(i[n],e);return e}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new N),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new N),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const t=this._parentCacheAsTextureRenderGroup;return t?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new N),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(t.inverseWorldTransform).translate(-t._textureBounds.x,-t._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function zu(s,t,e={}){for(const i in t)!e[i]&&t[i]!==void 0&&(s[i]=t[i])}const Ii=new at(null),Us=new at(null),Fi=new at(null,1,1),Gs=new at(null),sa=1,Uu=2,Bi=4;class ft extends ct{constructor(t={}){var e,i;super(),this.uid=tt("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new N,this.relativeGroupTransform=new N,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new at(this,0,0),this._scale=Fi,this._pivot=Us,this._origin=Gs,this._skew=Ii,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],zu(this,t,{children:!0,parent:!0,effects:!0}),(e=t.children)==null||e.forEach(n=>this.addChild(n)),(i=t.parent)==null||i.addChild(this)}static mixin(t){V("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),Y.mixin(ft,t)}set _didChangeId(t){this._didViewChangeTick=t>>12&4095,this._didContainerChangeTick=t&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...t){if(this.allowChildren||V(W,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let n=0;n<t.length;n++)this.addChild(t[n]);return t[0]}const e=t[0],i=this.renderGroup||this.parentRenderGroup;return e.parent===this?(this.children.splice(this.children.indexOf(e),1),this.children.push(e),i&&(i.structureDidChange=!0),e):(e.parent&&e.parent.removeChild(e),this.children.push(e),this.sortableChildren&&(this.sortDirty=!0),e.parent=this,e.didChange=!0,e._updateFlags=15,i&&i.addChild(e),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this),this._didViewChangeTick++,e._zIndex!==0&&e.depthOfChildModified(),e)}removeChild(...t){if(t.length>1){for(let n=0;n<t.length;n++)this.removeChild(t[n]);return t[0]}const e=t[0],i=this.children.indexOf(e);return i>-1&&(this._didViewChangeTick++,this.children.splice(i,1),this.renderGroup?this.renderGroup.removeChild(e):this.parentRenderGroup&&this.parentRenderGroup.removeChild(e),e.parentRenderLayer&&e.parentRenderLayer.detach(e),e.parent=null,this.emit("childRemoved",e,this,i),e.emit("removed",this)),e}_onUpdate(t){t&&t===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),this.renderGroup=Bt.get(Nu,this),this.groupTransform=N.IDENTITY,t==null||t.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),Bt.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,t==null||t.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new N),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*eu}set angle(t){this.rotation=t*mn}get pivot(){return this._pivot===Us&&(this._pivot=new at(this,0,0)),this._pivot}set pivot(t){this._pivot===Us&&(this._pivot=new at(this,0,0),this._origin!==Gs&&$("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof t=="number"?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===Ii&&(this._skew=new at(this,0,0)),this._skew}set skew(t){this._skew===Ii&&(this._skew=new at(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===Fi&&(this._scale=new at(this,1,1)),this._scale}set scale(t){this._scale===Fi&&(this._scale=new at(this,0,0)),typeof t=="string"&&(t=parseFloat(t)),typeof t=="number"?this._scale.set(t):this._scale.copyFrom(t)}get origin(){return this._origin===Gs&&(this._origin=new at(this,0,0)),this._origin}set origin(t){this._origin===Gs&&(this._origin=new at(this,0,0),this._pivot!==Us&&$("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof t=="number"?this._origin.set(t):this._origin.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const e=this.getLocalBounds().width;this._setWidth(t,e)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const e=this.getLocalBounds().height;this._setHeight(t,e)}getSize(t){t||(t={});const e=this.getLocalBounds();return t.width=Math.abs(this.scale.x*e.width),t.height=Math.abs(this.scale.y*e.height),t}setSize(t,e){const i=this.getLocalBounds();typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,i.width),e!==void 0&&this._setHeight(e,i.height)}_updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}updateTransform(t){return this.position.set(typeof t.x=="number"?t.x:this.position.x,typeof t.y=="number"?t.y:this.position.y),this.scale.set(typeof t.scaleX=="number"?t.scaleX||1:this.scale.x,typeof t.scaleY=="number"?t.scaleY||1:this.scale.y),this.rotation=typeof t.rotation=="number"?t.rotation:this.rotation,this.skew.set(typeof t.skewX=="number"?t.skewX:this.skew.x,typeof t.skewY=="number"?t.skewY:this.skew.y),this.pivot.set(typeof t.pivotX=="number"?t.pivotX:this.pivot.x,typeof t.pivotY=="number"?t.pivotY:this.pivot.y),this.origin.set(typeof t.originX=="number"?t.originX:this.origin.x,typeof t.originY=="number"?t.originY:this.origin.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this._didContainerChangeTick;if(this._didLocalTransformChangeId===t)return;this._didLocalTransformChangeId=t;const e=this.localTransform,i=this._scale,n=this._pivot,r=this._origin,a=this._position,o=i._x,h=i._y,l=n._x,c=n._y,u=-r._x,d=-r._y;e.a=this._cx*o,e.b=this._sx*o,e.c=this._cy*h,e.d=this._sy*h,e.tx=a._x-(l*e.a+c*e.c)+(u*e.a+d*e.c)-u*o,e.ty=a._y-(l*e.b+c*e.d)+(u*e.b+d*e.d)-d*h}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=sa,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const i=et.shared.setValue(t??16777215).toBgrNumber();i!==this.localColor&&(this.localColor=i,this._updateFlags|=sa,this._onUpdate())}get tint(){return ti(this.localColor)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Uu,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(t){const e=t?2:0;(this.localDisplayStatus&2)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Bi,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(t){const e=t?0:4;(this.localDisplayStatus&4)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Bi,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(t){const e=t?1:0;(this.localDisplayStatus&1)!==e&&(this._updateFlags|=Bi,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(t=!1){var n;if(this.destroyed)return;this.destroyed=!0;let e;if(this.children.length&&(e=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._origin=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof t=="boolean"?t:t==null?void 0:t.children)&&e)for(let r=0;r<e.length;++r)e[r].destroy(t);(n=this.renderGroup)==null||n.destroy(),this.renderGroup=null}}Y.mixin(ft,vu,Mu,Lu,Iu,Ru,Au,Tu,Fu,xu,bu,Eu,Cu);class nr extends ft{constructor(t){super(t),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this._bounds=new Tt(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const e=this.bounds,{x:i,y:n}=t;return i>=e.minX&&i<=e.maxX&&n>=e.minY&&n<=e.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}destroy(t){var e,i;super.destroy(t),this._bounds=null;for(const n in this._gpuData)(i=(e=this._gpuData[n]).destroy)==null||i.call(e);this._gpuData=null}collectRenderablesSimple(t,e,i){const{renderPipes:n}=e;n.blendMode.setBlendMode(this,this.groupBlendMode,t),n[this.renderPipeId].addRenderable(this,t),this.didViewUpdate=!1;const a=this.children,o=a.length;for(let h=0;h<o;h++)a[h].collectRenderables(t,e,i)}}class _t extends nr{constructor(t=D.EMPTY){t instanceof D&&(t={texture:t});const{texture:e=D.EMPTY,anchor:i,roundPixels:n,width:r,height:a,...o}=t;super({label:"Sprite",...o}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new at({_onUpdate:()=>{this.onViewUpdate()}}),i?this.anchor=i:e.defaultAnchor&&(this.anchor=e.defaultAnchor),this.texture=e,this.allowChildren=!1,this.roundPixels=n??!1,r!==void 0&&(this.width=r),a!==void 0&&(this.height=a)}static from(t,e=!1){return t instanceof D?new _t(t):new _t(D.from(t,e))}set texture(t){t||(t=D.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return hu(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return V("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const t=this._anchor,e=this._texture,i=this._bounds,{width:n,height:r}=e.orig;i.minX=-t._x*n,i.maxX=i.minX+n,i.minY=-t._y*r,i.maxY=i.minY+r}destroy(t=!1){if(super.destroy(t),typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(i)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null,this._gpuData=null}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width),this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height),this._height=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this._texture.orig.width),e!==void 0&&this._setHeight(e,this._texture.orig.height)}}const Gu=new Tt;function _h(s,t,e){const i=Gu;s.measurable=!0,dh(s,e,i),t.addBoundsMask(i),s.measurable=!1}function bh(s,t,e){const i=zt.get();s.measurable=!0;const n=ut.get().identity(),r=wh(s,e,n);mh(s,i,r),s.measurable=!1,t.addBoundsMask(i),ut.return(n),zt.return(i)}function wh(s,t,e){return s?(s!==t&&(wh(s.parent,t,e),s.updateLocalTransform(),e.append(s.localTransform)),e):($("Mask bounds, renderable is not inside the root container"),e)}class vh{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof _t),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(t,e){this.inverse||_h(this.mask,t,e)}addLocalBounds(t,e){bh(this.mask,t,e)}containsPoint(t,e){const i=this.mask;return e(i,t)}destroy(){this.reset()}static test(t){return t instanceof _t}}vh.extension=R.MaskEffect;class Ch{constructor(t){this.priority=0,this.pipe="colorMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return typeof t=="number"}}Ch.extension=R.MaskEffect;class Sh{constructor(t){this.priority=0,this.pipe="stencilMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(t,e){_h(this.mask,t,e)}addLocalBounds(t,e){bh(this.mask,t,e)}containsPoint(t,e){const i=this.mask;return e(i,t)}destroy(){this.reset()}static test(t){return t instanceof ft}}Sh.extension=R.MaskEffect;const Wu={createCanvas:(s,t)=>{const e=document.createElement("canvas");return e.width=s,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(s,t)=>fetch(s,t),parseXML:s=>new DOMParser().parseFromString(s,"text/xml")};let ia=Wu;const q={get(){return ia},set(s){ia=s}};class Ah extends Pt{constructor(t){t.resource||(t.resource=q.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity,this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,e=this.height,i=this._resolution){const n=super.resize(t,e,i);return n&&this.resizeCanvas(),n}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}Ah.extension=R.TextureSource;class ye extends Pt{constructor(t){super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}ye.extension=R.TextureSource;var oi=(s=>(s[s.INTERACTION=50]="INTERACTION",s[s.HIGH=25]="HIGH",s[s.NORMAL=0]="NORMAL",s[s.LOW=-25]="LOW",s[s.UTILITY=-50]="UTILITY",s))(oi||{});class Li{constructor(t,e=null,i=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=e,this.priority=i,this._once=n}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const Th=class mt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Li(null,null,1/0),this.deltaMS=1/mt.targetFPMS,this.elapsedMS=1/mt.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,i=oi.NORMAL){return this._addListener(new Li(t,e,i))}addOnce(t,e,i=oi.NORMAL){return this._addListener(new Li(t,e,i,!0))}_addListener(t){let e=this._head.next,i=this._head;if(!e)t.connect(i);else{for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}return this._startIfPossible(),this}remove(t,e){let i=this._head.next;for(;i;)i.match(t,e)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*mt.targetFPMS;const i=this._head;let n=i.next;for(;n;)n=n.emit(this);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,mt.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!mt._shared){const t=mt._shared=new mt;t.autoStart=!0,t._protected=!0}return mt._shared}static get system(){if(!mt._system){const t=mt._system=new mt;t.autoStart=!0,t._protected=!0}return mt._system}};Th.targetFPMS=.06;let At=Th,Oi;async function Ph(){return Oi??(Oi=(async()=>{var a;const t=document.createElement("canvas").getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise(o=>{const h=document.createElement("video");h.onloadeddata=()=>o(h),h.onerror=()=>o(null),h.autoplay=!1,h.crossOrigin="anonymous",h.preload="auto",h.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",h.load()});if(!e)return"premultiply-alpha-on-upload";const i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i);const n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const r=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,r),t.deleteFramebuffer(n),t.deleteTexture(i),(a=t.getExtension("WEBGL_lose_context"))==null||a.loseContext(),r[0]<=r[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Oi}const _i=class Mh extends Pt{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...Mh.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=At.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await Ph(),this._load=new Promise((i,n)=>{this.isValid?i(this):(this._resolve=i,this._reject=n,e.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(At.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(At.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(At.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};_i.extension=R.TextureSource;_i.defaultOptions={...Pt.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};_i.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let ei=_i;const St=(s,t,e=!1)=>(Array.isArray(s)||(s=[s]),t?s.map(i=>typeof i=="string"||e?t(i):i):s);class Hu{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||$(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const i=St(t);let n;for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];if(l.test(e)){n=l.getCacheableAssets(i,e);break}}const r=new Map(Object.entries(n||{}));n||i.forEach(h=>{r.set(h,e)});const a=[...r.keys()],o={cacheKeys:a,keys:i};i.forEach(h=>{this._cacheMap.set(h,o)}),a.forEach(h=>{const l=n?n[h]:e;this._cache.has(h)&&this._cache.get(h)!==l&&$("[Cache] already has key:",h),this._cache.set(h,r.get(h))})}remove(t){if(!this._cacheMap.has(t)){$(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(n=>{this._cache.delete(n)}),e.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const J=new Hu,bn=[];Y.handleByList(R.TextureSource,bn);function Eh(s={}){const t=s&&s.resource,e=t?s.resource:s,i=t?s:{resource:s};for(let n=0;n<bn.length;n++){const r=bn[n];if(r.test(e))return new r(i)}throw new Error(`Could not find a source type for resource: ${i.resource}`)}function $u(s={},t=!1){const e=s&&s.resource,i=e?s.resource:s,n=e?s:{resource:s};if(!t&&J.has(i))return J.get(i);const r=new D({source:Eh(n)});return r.on("destroy",()=>{J.has(i)&&J.remove(i)}),t||J.set(i,r),r}function Yu(s,t=!1){return typeof s=="string"?J.get(s):s instanceof Pt?new D({source:s}):$u(s,t)}D.from=Yu;Pt.from=Eh;Y.add(vh,Ch,Sh,ei,ye,Ah,er);var $t=(s=>(s[s.Low=0]="Low",s[s.Normal=1]="Normal",s[s.High=2]="High",s))($t||{});function Ct(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function Ke(s){return s.split("?")[0].split("#")[0]}function ju(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Xu(s,t,e){return s.replace(new RegExp(ju(t),"g"),e)}function Ku(s,t){let e="",i=0,n=-1,r=0,a=-1;for(let o=0;o<=s.length;++o){if(o<s.length)a=s.charCodeAt(o);else{if(a===47)break;a=47}if(a===47){if(!(n===o-1||r===1))if(n!==o-1&&r===2){if(e.length<2||i!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const h=e.lastIndexOf("/");if(h!==e.length-1){h===-1?(e="",i=0):(e=e.slice(0,h),i=e.length-1-e.lastIndexOf("/")),n=o,r=0;continue}}else if(e.length===2||e.length===1){e="",i=0,n=o,r=0;continue}}}else e.length>0?e+=`/${s.slice(n+1,o)}`:e=s.slice(n+1,o),i=o-n-1;n=o,r=0}else a===46&&r!==-1?++r:r=-1}return e}const ot={toPosix(s){return Xu(s,"\\","/")},isUrl(s){return/^https?:/.test(this.toPosix(s))},isDataUrl(s){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(s)},isBlobUrl(s){return s.startsWith("blob:")},hasProtocol(s){return/^[^/:]+:/.test(this.toPosix(s))},getProtocol(s){Ct(s),s=this.toPosix(s);const t=/^file:\/\/\//.exec(s);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(s);return e?e[0]:""},toAbsolute(s,t,e){if(Ct(s),this.isDataUrl(s)||this.isBlobUrl(s))return s;const i=Ke(this.toPosix(t??q.get().getBaseUrl())),n=Ke(this.toPosix(e??this.rootname(i)));return s=this.toPosix(s),s.startsWith("/")?ot.join(n,s.slice(1)):this.isAbsolute(s)?s:this.join(i,s)},normalize(s){if(Ct(s),s.length===0)return".";if(this.isDataUrl(s)||this.isBlobUrl(s))return s;s=this.toPosix(s);let t="";const e=s.startsWith("/");this.hasProtocol(s)&&(t=this.rootname(s),s=s.slice(t.length));const i=s.endsWith("/");return s=Ku(s),s.length>0&&i&&(s+="/"),e?`/${s}`:t+s},isAbsolute(s){return Ct(s),s=this.toPosix(s),this.hasProtocol(s)?!0:s.startsWith("/")},join(...s){if(s.length===0)return".";let t;for(let e=0;e<s.length;++e){const i=s[e];if(Ct(i),i.length>0)if(t===void 0)t=i;else{const n=s[e-1]??"";this.joinExtensions.includes(this.extname(n).toLowerCase())?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(s){if(Ct(s),s.length===0)return".";s=this.toPosix(s);let t=s.charCodeAt(0);const e=t===47;let i=-1,n=!0;const r=this.getProtocol(s),a=s;s=s.slice(r.length);for(let o=s.length-1;o>=1;--o)if(t=s.charCodeAt(o),t===47){if(!n){i=o;break}}else n=!1;return i===-1?e?"/":this.isUrl(a)?r+s:r:e&&i===1?"//":r+s.slice(0,i)},rootname(s){Ct(s),s=this.toPosix(s);let t="";if(s.startsWith("/")?t="/":t=this.getProtocol(s),this.isUrl(s)){const e=s.indexOf("/",t.length);e!==-1?t=s.slice(0,e):t=s,t.endsWith("/")||(t+="/")}return t},basename(s,t){Ct(s),t&&Ct(t),s=Ke(this.toPosix(s));let e=0,i=-1,n=!0,r;if(t!==void 0&&t.length>0&&t.length<=s.length){if(t.length===s.length&&t===s)return"";let a=t.length-1,o=-1;for(r=s.length-1;r>=0;--r){const h=s.charCodeAt(r);if(h===47){if(!n){e=r+1;break}}else o===-1&&(n=!1,o=r+1),a>=0&&(h===t.charCodeAt(a)?--a===-1&&(i=r):(a=-1,i=o))}return e===i?i=o:i===-1&&(i=s.length),s.slice(e,i)}for(r=s.length-1;r>=0;--r)if(s.charCodeAt(r)===47){if(!n){e=r+1;break}}else i===-1&&(n=!1,i=r+1);return i===-1?"":s.slice(e,i)},extname(s){Ct(s),s=Ke(this.toPosix(s));let t=-1,e=0,i=-1,n=!0,r=0;for(let a=s.length-1;a>=0;--a){const o=s.charCodeAt(a);if(o===47){if(!n){e=a+1;break}continue}i===-1&&(n=!1,i=a+1),o===46?t===-1?t=a:r!==1&&(r=1):t!==-1&&(r=-1)}return t===-1||i===-1||r===0||r===1&&t===i-1&&t===e+1?"":s.slice(t,i)},parse(s){Ct(s);const t={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return t;s=Ke(this.toPosix(s));let e=s.charCodeAt(0);const i=this.isAbsolute(s);let n;t.root=this.rootname(s),i||this.hasProtocol(s)?n=1:n=0;let r=-1,a=0,o=-1,h=!0,l=s.length-1,c=0;for(;l>=n;--l){if(e=s.charCodeAt(l),e===47){if(!h){a=l+1;break}continue}o===-1&&(h=!1,o=l+1),e===46?r===-1?r=l:c!==1&&(c=1):r!==-1&&(c=-1)}return r===-1||o===-1||c===0||c===1&&r===o-1&&r===a+1?o!==-1&&(a===0&&i?t.base=t.name=s.slice(1,o):t.base=t.name=s.slice(a,o)):(a===0&&i?(t.name=s.slice(1,r),t.base=s.slice(1,o)):(t.name=s.slice(a,r),t.base=s.slice(a,o)),t.ext=s.slice(r,o)),t.dir=this.dirname(s),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function kh(s,t,e,i,n){const r=t[e];for(let a=0;a<r.length;a++){const o=r[a];e<t.length-1?kh(s.replace(i[e],o),t,e+1,i,n):n.push(s.replace(i[e],o))}}function qu(s){const t=/\{(.*?)\}/g,e=s.match(t),i=[];if(e){const n=[];e.forEach(r=>{const a=r.substring(1,r.length-1).split(",");n.push(a)}),kh(s,n,0,e,i)}else i.push(s);return i}const hi=s=>!Array.isArray(s);class Ne{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`).join("&")}}getAlias(t){const{alias:e,src:i}=t;return St(e||i,r=>typeof r=="string"?r:Array.isArray(r)?r.map(a=>(a==null?void 0:a.src)??a):r!=null&&r.src?r.src:r,!0)}addManifest(t){this._manifest&&$("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const i=[];let n=e;Array.isArray(e)||(n=Object.entries(e).map(([r,a])=>typeof a=="string"||Array.isArray(a)?{alias:r,src:a}:{alias:r,...a})),n.forEach(r=>{const a=r.src,o=r.alias;let h;if(typeof o=="string"){const l=this._createBundleAssetId(t,o);i.push(l),h=[o,l]}else{const l=o.map(c=>this._createBundleAssetId(t,c));i.push(...l),h=[...o,...l]}this.add({...r,alias:h,src:a})}),this._bundles[t]=i}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);let i;i=r=>{this.hasKey(r)&&$(`[Resolver] already has key: ${r} overwriting`)},St(e).forEach(r=>{const{src:a}=r;let{data:o,format:h,loadParser:l}=r;const c=St(a).map(f=>typeof f=="string"?qu(f):Array.isArray(f)?f:[f]),u=this.getAlias(r);Array.isArray(u)?u.forEach(i):i(u);const d=[];c.forEach(f=>{f.forEach(m=>{let g={};if(typeof m!="object"){g.src=m;for(let p=0;p<this._parsers.length;p++){const y=this._parsers[p];if(y.test(m)){g=y.parse(m);break}}}else o=m.data??o,h=m.format??h,l=m.loadParser??l,g={...g,...m};if(!u)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this._buildResolvedAsset(g,{aliases:u,data:o,format:h,loadParser:l}),d.push(g)})}),u.forEach(f=>{this._assetMap[f]=d})})}resolveBundle(t){const e=hi(t);t=St(t);const i={};return t.forEach(n=>{const r=this._bundles[n];if(r){const a=this.resolve(r),o={};for(const h in a){const l=a[h];o[this._extractAssetIdFromBundle(n,h)]=l}i[n]=o}}),e?i[t[0]]:i}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const i={};for(const n in e)i[n]=e[n].src;return i}return e.src}resolve(t){const e=hi(t);t=St(t);const i={};return t.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let r=this._assetMap[n];const a=this._getPreferredOrder(r);a==null||a.priority.forEach(o=>{a.params[o].forEach(h=>{const l=r.filter(c=>c[o]?c[o]===h:!1);l.length&&(r=l)})}),this._resolverHash[n]=r[0]}else this._resolverHash[n]=this._buildResolvedAsset({alias:[n],src:n},{});i[n]=this._resolverHash[n]}),e?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const i=t[e],n=this._preferredOrder.find(r=>r.params.format.includes(i.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:i,data:n,loadParser:r,format:a}=e;return(this._basePath||this._rootPath)&&(t.src=ot.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=i??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...n||{},...t.data},t.loadParser=r??t.loadParser,t.format=a??t.format??Zu(t.src),t}}Ne.RETINA_PREFIX=/@([0-9\.]+)x/;function Zu(s){return s.split(".").pop().split("?").shift().split("#").shift()}const wn=(s,t)=>{const e=t.split("?")[1];return e&&(s+=`?${e}`),s},Rh=class cs{constructor(t,e){this.linkedSheets=[];let i=t;(t==null?void 0:t.source)instanceof Pt&&(i={texture:t,data:e});const{texture:n,data:r,cachePrefix:a=""}=i;this.cachePrefix=a,this._texture=n instanceof D?n:null,this.textureSource=n.source,this.textures={},this.animations={},this.data=r;const o=parseFloat(r.meta.scale);o?(this.resolution=o,n.source.resolution=this.resolution):this.resolution=n.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=cs.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const i=cs.BATCH_SIZE;for(;e-t<i&&e<this._frameKeys.length;){const n=this._frameKeys[e],r=this._frames[n],a=r.frame;if(a){let o=null,h=null;const l=r.trimmed!==!1&&r.sourceSize?r.sourceSize:r.frame,c=new K(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);r.rotated?o=new K(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):o=new K(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),r.trimmed!==!1&&r.spriteSourceSize&&(h=new K(Math.floor(r.spriteSourceSize.x)/this.resolution,Math.floor(r.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[n]=new D({source:this.textureSource,frame:o,orig:c,trim:h,rotate:r.rotated?2:0,defaultAnchor:r.anchor,defaultBorders:r.borders,label:n.toString()})}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let i=0;i<t[e].length;i++){const n=t[e][i];this.animations[e].push(this.textures[n])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*cs.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*cs.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};Rh.BATCH_SIZE=1e3;let na=Rh;const Qu=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function Ih(s,t,e){const i={};if(s.forEach(n=>{i[n]=t}),Object.keys(t.textures).forEach(n=>{i[`${t.cachePrefix}${n}`]=t.textures[n]}),!e){const n=ot.dirname(s[0]);t.linkedSheets.forEach((r,a)=>{const o=Ih([`${n}/${t.data.meta.related_multi_packs[a]}`],r,!0);Object.assign(i,o)})}return i}const Ju={extension:R.Asset,cache:{test:s=>s instanceof na,getCacheableAssets:(s,t)=>Ih(s,t,!1)},resolver:{extension:{type:R.ResolveParser,name:"resolveSpritesheet"},test:s=>{const e=s.split("?")[0].split("."),i=e.pop(),n=e.pop();return i==="json"&&Qu.includes(n)},parse:s=>{var e;const t=s.split(".");return{resolution:parseFloat(((e=Ne.RETINA_PREFIX.exec(s))==null?void 0:e[1])??"1"),format:t[t.length-2],src:s}}},loader:{name:"spritesheetLoader",extension:{type:R.LoadParser,priority:$t.Normal,name:"spritesheetLoader"},async testParse(s,t){return ot.extname(t.src).toLowerCase()===".json"&&!!s.frames},async parse(s,t,e){var u,d;const{texture:i,imageFilename:n,textureOptions:r,cachePrefix:a}=(t==null?void 0:t.data)??{};let o=ot.dirname(t.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let h;if(i instanceof D)h=i;else{const f=wn(o+(n??s.meta.image),t.src);h=(await e.load([{src:f,data:r}]))[f]}const l=new na({texture:h.source,data:s,cachePrefix:a});await l.parse();const c=(u=s==null?void 0:s.meta)==null?void 0:u.related_multi_packs;if(Array.isArray(c)){const f=[];for(const g of c){if(typeof g!="string")continue;let p=o+g;(d=t.data)!=null&&d.ignoreMultiPack||(p=wn(p,t.src),f.push(e.load({src:p,data:{textureOptions:r,ignoreMultiPack:!0}})))}const m=await Promise.all(f);l.linkedSheets=m,m.forEach(g=>{g.linkedSheets=[l].concat(l.linkedSheets.filter(p=>p!==g))})}return l},async unload(s,t,e){await e.unload(s.textureSource._sourceOrigin),s.destroy(!1)}}};Y.add(Ju);var Vi=/iPhone/i,ra=/iPod/i,aa=/iPad/i,oa=/\biOS-universal(?:.+)Mac\b/i,Di=/\bAndroid(?:.+)Mobile\b/i,ha=/Android/i,be=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Ws=/Silk/i,Dt=/Windows Phone/i,la=/\bWindows(?:.+)ARM\b/i,ca=/BlackBerry/i,ua=/BB10/i,da=/Opera Mini/i,fa=/\b(CriOS|Chrome)(?:.+)Mobile/i,pa=/Mobile(?:.+)Firefox\b/i,ma=function(s){return typeof s<"u"&&s.platform==="MacIntel"&&typeof s.maxTouchPoints=="number"&&s.maxTouchPoints>1&&typeof MSStream>"u"};function td(s){return function(t){return t.test(s)}}function ga(s){var t={userAgent:"",platform:"",maxTouchPoints:0};!s&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof s=="string"?t.userAgent=s:s&&s.userAgent&&(t={userAgent:s.userAgent,platform:s.platform,maxTouchPoints:s.maxTouchPoints||0});var e=t.userAgent,i=e.split("[FBAN");typeof i[1]<"u"&&(e=i[0]),i=e.split("Twitter"),typeof i[1]<"u"&&(e=i[0]);var n=td(e),r={apple:{phone:n(Vi)&&!n(Dt),ipod:n(ra),tablet:!n(Vi)&&(n(aa)||ma(t))&&!n(Dt),universal:n(oa),device:(n(Vi)||n(ra)||n(aa)||n(oa)||ma(t))&&!n(Dt)},amazon:{phone:n(be),tablet:!n(be)&&n(Ws),device:n(be)||n(Ws)},android:{phone:!n(Dt)&&n(be)||!n(Dt)&&n(Di),tablet:!n(Dt)&&!n(be)&&!n(Di)&&(n(Ws)||n(ha)),device:!n(Dt)&&(n(be)||n(Ws)||n(Di)||n(ha))||n(/\bokhttp\b/i)},windows:{phone:n(Dt),tablet:n(la),device:n(Dt)||n(la)},other:{blackberry:n(ca),blackberry10:n(ua),opera:n(da),firefox:n(pa),chrome:n(fa),device:n(ca)||n(ua)||n(da)||n(pa)||n(fa)},any:!1,phone:!1,tablet:!1};return r.any=r.apple.device||r.android.device||r.windows.device||r.other.device,r.phone=r.apple.phone||r.android.phone||r.windows.phone,r.tablet=r.apple.tablet||r.android.tablet||r.windows.tablet,r}const ed=ga.default??ga,Ni=ed(globalThis.navigator),zi=Object.create(null),ya=Object.create(null);function rr(s,t){let e=ya[s];return e===void 0&&(zi[t]===void 0&&(zi[t]=1),ya[s]=e=zi[t]++),e}let we;function Fh(){return(!we||we!=null&&we.isContextLost())&&(we=q.get().createCanvas().getContext("webgl",{})),we}let Hs;function sd(){if(!Hs){Hs="mediump";const s=Fh();s&&s.getShaderPrecisionFormat&&(Hs=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision?"highp":"mediump")}return Hs}function id(s,t,e){return t?s:e?(s=s.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${s}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${s}
        `}function nd(s,t,e){const i=e?t.maxSupportedFragmentPrecision:t.maxSupportedVertexPrecision;if(s.substring(0,9)!=="precision"){let n=e?t.requestedFragmentPrecision:t.requestedVertexPrecision;return n==="highp"&&i!=="highp"&&(n="mediump"),`precision ${n} float;
${s}`}else if(i!=="highp"&&s.substring(0,15)==="precision highp")return s.replace("precision highp","precision mediump");return s}function rd(s,t){return t?`#version 300 es
${s}`:s}const ad={},od={};function hd(s,{name:t="pixi-program"},e=!0){t=t.replace(/\s+/g,"-"),t+=e?"-fragment":"-vertex";const i=e?ad:od;return i[t]?(i[t]++,t+=`-${i[t]}`):i[t]=1,s.indexOf("#define SHADER_NAME")!==-1?s:`${`#define SHADER_NAME ${t}`}
${s}`}function ld(s,t){return t?s.replace("#version 300 es",""):s}const Ui={stripVersion:ld,ensurePrecision:nd,addProgramDefines:id,setProgramName:hd,insertVersion:rd},Gi=Object.create(null),Bh=class vn{constructor(t){t={...vn.defaultOptions,...t};const e=t.fragment.indexOf("#version 300 es")!==-1,i={stripVersion:e,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:sd()},setProgramName:{name:t.name},addProgramDefines:e,insertVersion:e};let n=t.fragment,r=t.vertex;Object.keys(Ui).forEach(a=>{const o=i[a];n=Ui[a](n,o,!0),r=Ui[a](r,o,!1)}),this.fragment=n,this.vertex=r,this.transformFeedbackVaryings=t.transformFeedbackVaryings,this._key=rr(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(t){const e=`${t.vertex}:${t.fragment}`;return Gi[e]||(Gi[e]=new vn(t)),Gi[e]}};Bh.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let bi=Bh;const xa={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function cd(s){return xa[s]??xa.float32}const ud={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function dd({source:s,entryPoint:t}){const e={},i=s.indexOf(`fn ${t}`);if(i!==-1){const n=s.indexOf("->",i);if(n!==-1){const r=s.substring(i,n),a=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let o;for(;(o=a.exec(r))!==null;){const h=ud[o[3]]??"float32";e[o[2]]={location:parseInt(o[1],10),format:h,stride:cd(h).stride,offset:0,instance:!1,start:0}}}}return e}function Wi(s){var u,d;const t=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,e=/@group\((\d+)\)/,i=/@binding\((\d+)\)/,n=/var(<[^>]+>)? (\w+)/,r=/:\s*(\w+)/,a=/struct\s+(\w+)\s*{([^}]+)}/g,o=/(\w+)\s*:\s*([\w\<\>]+)/g,h=/struct\s+(\w+)/,l=(u=s.match(t))==null?void 0:u.map(f=>({group:parseInt(f.match(e)[1],10),binding:parseInt(f.match(i)[1],10),name:f.match(n)[2],isUniform:f.match(n)[1]==="<uniform>",type:f.match(r)[1]}));if(!l)return{groups:[],structs:[]};const c=((d=s.match(a))==null?void 0:d.map(f=>{const m=f.match(h)[1],g=f.match(o).reduce((p,y)=>{const[x,_]=y.split(":");return p[x.trim()]=_.trim(),p},{});return g?{name:m,members:g}:null}).filter(({name:f})=>l.some(m=>m.type===f)))??[];return{groups:l,structs:c}}var us=(s=>(s[s.VERTEX=1]="VERTEX",s[s.FRAGMENT=2]="FRAGMENT",s[s.COMPUTE=4]="COMPUTE",s))(us||{});function fd({groups:s}){const t=[];for(let e=0;e<s.length;e++){const i=s[e];t[i.group]||(t[i.group]=[]),i.isUniform?t[i.group].push({binding:i.binding,visibility:us.VERTEX|us.FRAGMENT,buffer:{type:"uniform"}}):i.type==="sampler"?t[i.group].push({binding:i.binding,visibility:us.FRAGMENT,sampler:{type:"filtering"}}):i.type==="texture_2d"&&t[i.group].push({binding:i.binding,visibility:us.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return t}function pd({groups:s}){const t=[];for(let e=0;e<s.length;e++){const i=s[e];t[i.group]||(t[i.group]={}),t[i.group][i.name]=i.binding}return t}function md(s,t){const e=new Set,i=new Set,n=[...s.structs,...t.structs].filter(a=>e.has(a.name)?!1:(e.add(a.name),!0)),r=[...s.groups,...t.groups].filter(a=>{const o=`${a.name}-${a.binding}`;return i.has(o)?!1:(i.add(o),!0)});return{structs:n,groups:r}}const Hi=Object.create(null);class ze{constructor(t){var o,h;this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:e,vertex:i,layout:n,gpuLayout:r,name:a}=t;if(this.name=a,this.fragment=e,this.vertex=i,e.source===i.source){const l=Wi(e.source);this.structsAndGroups=l}else{const l=Wi(i.source),c=Wi(e.source);this.structsAndGroups=md(l,c)}this.layout=n??pd(this.structsAndGroups),this.gpuLayout=r??fd(this.structsAndGroups),this.autoAssignGlobalUniforms=((o=this.layout[0])==null?void 0:o.globalUniforms)!==void 0,this.autoAssignLocalUniforms=((h=this.layout[1])==null?void 0:h.localUniforms)!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:t,fragment:e}=this,i=t.source+e.source+t.entryPoint+e.entryPoint;this._layoutKey=rr(i,"program")}get attributeData(){return this._attributeData??(this._attributeData=dd(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(t){const e=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return Hi[e]||(Hi[e]=new ze(t)),Hi[e]}}const Lh=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],gd=Lh.reduce((s,t)=>(s[t]=!0,s),{});function yd(s,t){switch(s){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*t);case"vec3<f32>":return new Float32Array(3*t);case"vec4<f32>":return new Float32Array(4*t);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Oh=class Vh{constructor(t,e){this._touched=0,this.uid=tt("uniform"),this._resourceType="uniformGroup",this._resourceId=tt("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,e={...Vh.defaultOptions,...e},this.uniformStructures=t;const i={};for(const n in t){const r=t[n];if(r.name=n,r.size=r.size??1,!gd[r.type])throw new Error(`Uniform type ${r.type} is not supported. Supported uniform types are: ${Lh.join(", ")}`);r.value??(r.value=yd(r.type,r.size)),i[n]=r.value}this.uniforms=i,this._dirtyId=1,this.ubo=e.ubo,this.isStatic=e.isStatic,this._signature=rr(Object.keys(i).map(n=>`${n}-${t[n].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};Oh.defaultOptions={ubo:!1,isStatic:!1};let Dh=Oh;class si{constructor(t){this.resources=Object.create(null),this._dirty=!0;let e=0;for(const i in t){const n=t[i];this.setResource(n,e++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let e=0;for(const i in this.resources)t[e++]=this.resources[i]._resourceId;this._key=t.join("|")}setResource(t,e){var n,r;const i=this.resources[e];t!==i&&(i&&((n=t.off)==null||n.call(t,"change",this.onResourceChange,this)),(r=t.on)==null||r.call(t,"change",this.onResourceChange,this),this.resources[e]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t){const e=this.resources;for(const i in e)e[i]._touched=t}destroy(){var e;const t=this.resources;for(const i in t){const n=t[i];(e=n.off)==null||e.call(n,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){const e=this.resources;for(const i in e)e[i]===t&&(e[i]=null)}else this._updateKey()}}var Cn=(s=>(s[s.WEBGL=1]="WEBGL",s[s.WEBGPU=2]="WEBGPU",s[s.BOTH=3]="BOTH",s))(Cn||{});class wi extends ct{constructor(t){super(),this.uid=tt("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:e,glProgram:i,groups:n,resources:r,compatibleRenderers:a,groupMap:o}=t;this.gpuProgram=e,this.glProgram=i,a===void 0&&(a=0,e&&(a|=Cn.WEBGPU),i&&(a|=Cn.WEBGL)),this.compatibleRenderers=a;const h={};if(!r&&!n&&(r={}),r&&n)throw new Error("[Shader] Cannot have both resources and groups");if(!e&&n&&!o)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!e&&n&&o)for(const l in o)for(const c in o[l]){const u=o[l][c];h[u]={group:l,binding:c,name:u}}else if(e&&n&&!o){const l=e.structsAndGroups.groups;o={},l.forEach(c=>{o[c.group]=o[c.group]||{},o[c.group][c.binding]=c.name,h[c.name]=c})}else if(r){n={},o={},e&&e.structsAndGroups.groups.forEach(u=>{o[u.group]=o[u.group]||{},o[u.group][u.binding]=u.name,h[u.name]=u});let l=0;for(const c in r)h[c]||(n[99]||(n[99]=new si,this._ownedBindGroups.push(n[99])),h[c]={group:99,binding:l,name:c},o[99]=o[99]||{},o[99][l]=c,l++);for(const c in r){const u=c;let d=r[c];!d.source&&!d._resourceType&&(d=new Dh(d));const f=h[u];f&&(n[f.group]||(n[f.group]=new si,this._ownedBindGroups.push(n[f.group])),n[f.group].setResource(d,f.binding))}}this.groups=n,this._uniformBindMap=o,this.resources=this._buildResourceAccessor(n,h)}addResource(t,e,i){var n,r;(n=this._uniformBindMap)[e]||(n[e]={}),(r=this._uniformBindMap[e])[i]||(r[i]=t),this.groups[e]||(this.groups[e]=new si,this._ownedBindGroups.push(this.groups[e]))}_buildResourceAccessor(t,e){const i={};for(const n in e){const r=e[n];Object.defineProperty(i,r.name,{get(){return t[r.group].getResource(r.binding)},set(a){t[r.group].setResource(a,r.binding)}})}return i}destroy(t=!1){var e,i;this.emit("destroy",this),t&&((e=this.gpuProgram)==null||e.destroy(),(i=this.glProgram)==null||i.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(n=>{n.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(t){const{gpu:e,gl:i,...n}=t;let r,a;return e&&(r=ze.from(e)),i&&(a=bi.from(i)),new wi({gpuProgram:r,glProgram:a,...n})}}const xd={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},$i=0,Yi=1,ji=2,Xi=3,Ki=4,qi=5,Sn=class Nh{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<$i)}set blend(t){!!(this.data&1<<$i)!==t&&(this.data^=1<<$i)}get offsets(){return!!(this.data&1<<Yi)}set offsets(t){!!(this.data&1<<Yi)!==t&&(this.data^=1<<Yi)}set cullMode(t){if(t==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=t==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<ji)}set culling(t){!!(this.data&1<<ji)!==t&&(this.data^=1<<ji)}get depthTest(){return!!(this.data&1<<Xi)}set depthTest(t){!!(this.data&1<<Xi)!==t&&(this.data^=1<<Xi)}get depthMask(){return!!(this.data&1<<qi)}set depthMask(t){!!(this.data&1<<qi)!==t&&(this.data^=1<<qi)}get clockwiseFrontFace(){return!!(this.data&1<<Ki)}set clockwiseFrontFace(t){!!(this.data&1<<Ki)!==t&&(this.data^=1<<Ki)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!=="none",this._blendMode=t,this._blendModeId=xd[t]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new Nh;return t.depthTest=!1,t.blend=!0,t}};Sn.default2d=Sn.for2d();let _d=Sn;const zh=class An extends wi{constructor(t){t={...An.defaultOptions,...t},super(t),this.enabled=!0,this._state=_d.for2d(),this.blendMode=t.blendMode,this.padding=t.padding,typeof t.antialias=="boolean"?this.antialias=t.antialias?"on":"off":this.antialias=t.antialias,this.resolution=t.resolution,this.blendRequired=t.blendRequired,this.clipToViewport=t.clipToViewport,this.addResource("uTexture",0,1)}apply(t,e,i,n){t.applyFilter(this,e,i,n)}get blendMode(){return this._state.blendMode}set blendMode(t){this._state.blendMode=t}static from(t){const{gpu:e,gl:i,...n}=t;let r,a;return e&&(r=ze.from(e)),i&&(a=bi.from(i)),new An({gpuProgram:r,glProgram:a,...n})}};zh.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1,clipToViewport:!0};let bd=zh;const Tn=[];Y.handleByNamedList(R.Environment,Tn);async function wd(s){if(!s)for(let t=0;t<Tn.length;t++){const e=Tn[t];if(e.value.test()){await e.value.load();return}}}let qe;function vd(){if(typeof qe=="boolean")return qe;try{qe=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{qe=!1}return qe}function _a(s,t,e=2){const i=t&&t.length,n=i?t[0]*e:s.length;let r=Uh(s,0,n,e,!0);const a=[];if(!r||r.next===r.prev)return a;let o,h,l;if(i&&(r=Pd(s,t,r,e)),s.length>80*e){o=1/0,h=1/0;let c=-1/0,u=-1/0;for(let d=e;d<n;d+=e){const f=s[d],m=s[d+1];f<o&&(o=f),m<h&&(h=m),f>c&&(c=f),m>u&&(u=m)}l=Math.max(c-o,u-h),l=l!==0?32767/l:0}return bs(r,a,e,o,h,l,0),a}function Uh(s,t,e,i,n){let r;if(n===Dd(s,t,e,i)>0)for(let a=t;a<e;a+=i)r=ba(a/i|0,s[a],s[a+1],r);else for(let a=e-i;a>=t;a-=i)r=ba(a/i|0,s[a],s[a+1],r);return r&&Le(r,r.next)&&(vs(r),r=r.next),r}function xe(s,t){if(!s)return s;t||(t=s);let e=s,i;do if(i=!1,!e.steiner&&(Le(e,e.next)||X(e.prev,e,e.next)===0)){if(vs(e),e=t=e.prev,e===e.next)break;i=!0}else e=e.next;while(i||e!==t);return t}function bs(s,t,e,i,n,r,a){if(!s)return;!a&&r&&Id(s,i,n,r);let o=s;for(;s.prev!==s.next;){const h=s.prev,l=s.next;if(r?Sd(s,i,n,r):Cd(s)){t.push(h.i,s.i,l.i),vs(s),s=l.next,o=l.next;continue}if(s=l,s===o){a?a===1?(s=Ad(xe(s),t),bs(s,t,e,i,n,r,2)):a===2&&Td(s,t,e,i,n,r):bs(xe(s),t,e,i,n,r,1);break}}}function Cd(s){const t=s.prev,e=s,i=s.next;if(X(t,e,i)>=0)return!1;const n=t.x,r=e.x,a=i.x,o=t.y,h=e.y,l=i.y,c=Math.min(n,r,a),u=Math.min(o,h,l),d=Math.max(n,r,a),f=Math.max(o,h,l);let m=i.next;for(;m!==t;){if(m.x>=c&&m.x<=d&&m.y>=u&&m.y<=f&&ds(n,o,r,h,a,l,m.x,m.y)&&X(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function Sd(s,t,e,i){const n=s.prev,r=s,a=s.next;if(X(n,r,a)>=0)return!1;const o=n.x,h=r.x,l=a.x,c=n.y,u=r.y,d=a.y,f=Math.min(o,h,l),m=Math.min(c,u,d),g=Math.max(o,h,l),p=Math.max(c,u,d),y=Pn(f,m,t,e,i),x=Pn(g,p,t,e,i);let _=s.prevZ,b=s.nextZ;for(;_&&_.z>=y&&b&&b.z<=x;){if(_.x>=f&&_.x<=g&&_.y>=m&&_.y<=p&&_!==n&&_!==a&&ds(o,c,h,u,l,d,_.x,_.y)&&X(_.prev,_,_.next)>=0||(_=_.prevZ,b.x>=f&&b.x<=g&&b.y>=m&&b.y<=p&&b!==n&&b!==a&&ds(o,c,h,u,l,d,b.x,b.y)&&X(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;_&&_.z>=y;){if(_.x>=f&&_.x<=g&&_.y>=m&&_.y<=p&&_!==n&&_!==a&&ds(o,c,h,u,l,d,_.x,_.y)&&X(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;b&&b.z<=x;){if(b.x>=f&&b.x<=g&&b.y>=m&&b.y<=p&&b!==n&&b!==a&&ds(o,c,h,u,l,d,b.x,b.y)&&X(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function Ad(s,t){let e=s;do{const i=e.prev,n=e.next.next;!Le(i,n)&&Wh(i,e,e.next,n)&&ws(i,n)&&ws(n,i)&&(t.push(i.i,e.i,n.i),vs(e),vs(e.next),e=s=n),e=e.next}while(e!==s);return xe(e)}function Td(s,t,e,i,n,r){let a=s;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&Ld(a,o)){let h=Hh(a,o);a=xe(a,a.next),h=xe(h,h.next),bs(a,t,e,i,n,r,0),bs(h,t,e,i,n,r,0);return}o=o.next}a=a.next}while(a!==s)}function Pd(s,t,e,i){const n=[];for(let r=0,a=t.length;r<a;r++){const o=t[r]*i,h=r<a-1?t[r+1]*i:s.length,l=Uh(s,o,h,i,!1);l===l.next&&(l.steiner=!0),n.push(Bd(l))}n.sort(Md);for(let r=0;r<n.length;r++)e=Ed(n[r],e);return e}function Md(s,t){let e=s.x-t.x;if(e===0&&(e=s.y-t.y,e===0)){const i=(s.next.y-s.y)/(s.next.x-s.x),n=(t.next.y-t.y)/(t.next.x-t.x);e=i-n}return e}function Ed(s,t){const e=kd(s,t);if(!e)return t;const i=Hh(e,s);return xe(i,i.next),xe(e,e.next)}function kd(s,t){let e=t;const i=s.x,n=s.y;let r=-1/0,a;if(Le(s,e))return e;do{if(Le(s,e.next))return e.next;if(n<=e.y&&n>=e.next.y&&e.next.y!==e.y){const u=e.x+(n-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(u<=i&&u>r&&(r=u,a=e.x<e.next.x?e:e.next,u===i))return a}e=e.next}while(e!==t);if(!a)return null;const o=a,h=a.x,l=a.y;let c=1/0;e=a;do{if(i>=e.x&&e.x>=h&&i!==e.x&&Gh(n<l?i:r,n,h,l,n<l?r:i,n,e.x,e.y)){const u=Math.abs(n-e.y)/(i-e.x);ws(e,s)&&(u<c||u===c&&(e.x>a.x||e.x===a.x&&Rd(a,e)))&&(a=e,c=u)}e=e.next}while(e!==o);return a}function Rd(s,t){return X(s.prev,s,t.prev)<0&&X(t.next,s,s.next)<0}function Id(s,t,e,i){let n=s;do n.z===0&&(n.z=Pn(n.x,n.y,t,e,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==s);n.prevZ.nextZ=null,n.prevZ=null,Fd(n)}function Fd(s){let t,e=1;do{let i=s,n;s=null;let r=null;for(t=0;i;){t++;let a=i,o=0;for(let l=0;l<e&&(o++,a=a.nextZ,!!a);l++);let h=e;for(;o>0||h>0&&a;)o!==0&&(h===0||!a||i.z<=a.z)?(n=i,i=i.nextZ,o--):(n=a,a=a.nextZ,h--),r?r.nextZ=n:s=n,n.prevZ=r,r=n;i=a}r.nextZ=null,e*=2}while(t>1);return s}function Pn(s,t,e,i,n){return s=(s-e)*n|0,t=(t-i)*n|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,s|t<<1}function Bd(s){let t=s,e=s;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==s);return e}function Gh(s,t,e,i,n,r,a,o){return(n-a)*(t-o)>=(s-a)*(r-o)&&(s-a)*(i-o)>=(e-a)*(t-o)&&(e-a)*(r-o)>=(n-a)*(i-o)}function ds(s,t,e,i,n,r,a,o){return!(s===a&&t===o)&&Gh(s,t,e,i,n,r,a,o)}function Ld(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!Od(s,t)&&(ws(s,t)&&ws(t,s)&&Vd(s,t)&&(X(s.prev,s,t.prev)||X(s,t.prev,t))||Le(s,t)&&X(s.prev,s,s.next)>0&&X(t.prev,t,t.next)>0)}function X(s,t,e){return(t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y)}function Le(s,t){return s.x===t.x&&s.y===t.y}function Wh(s,t,e,i){const n=Ys(X(s,t,e)),r=Ys(X(s,t,i)),a=Ys(X(e,i,s)),o=Ys(X(e,i,t));return!!(n!==r&&a!==o||n===0&&$s(s,e,t)||r===0&&$s(s,i,t)||a===0&&$s(e,s,i)||o===0&&$s(e,t,i))}function $s(s,t,e){return t.x<=Math.max(s.x,e.x)&&t.x>=Math.min(s.x,e.x)&&t.y<=Math.max(s.y,e.y)&&t.y>=Math.min(s.y,e.y)}function Ys(s){return s>0?1:s<0?-1:0}function Od(s,t){let e=s;do{if(e.i!==s.i&&e.next.i!==s.i&&e.i!==t.i&&e.next.i!==t.i&&Wh(e,e.next,s,t))return!0;e=e.next}while(e!==s);return!1}function ws(s,t){return X(s.prev,s,s.next)<0?X(s,t,s.next)>=0&&X(s,s.prev,t)>=0:X(s,t,s.prev)<0||X(s,s.next,t)<0}function Vd(s,t){let e=s,i=!1;const n=(s.x+t.x)/2,r=(s.y+t.y)/2;do e.y>r!=e.next.y>r&&e.next.y!==e.y&&n<(e.next.x-e.x)*(r-e.y)/(e.next.y-e.y)+e.x&&(i=!i),e=e.next;while(e!==s);return i}function Hh(s,t){const e=Mn(s.i,s.x,s.y),i=Mn(t.i,t.x,t.y),n=s.next,r=t.prev;return s.next=t,t.prev=s,e.next=n,n.prev=e,i.next=e,e.prev=i,r.next=i,i.prev=r,i}function ba(s,t,e,i){const n=Mn(s,t,e);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function vs(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Mn(s,t,e){return{i:s,x:t,y:e,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Dd(s,t,e,i){let n=0;for(let r=t,a=e-i;r<e;r+=i)n+=(s[a]-s[r])*(s[r+1]+s[a+1]),a=r;return n}const Nd=_a.default||_a;var $h=(s=>(s[s.NONE=0]="NONE",s[s.COLOR=16384]="COLOR",s[s.STENCIL=1024]="STENCIL",s[s.DEPTH=256]="DEPTH",s[s.COLOR_DEPTH=16640]="COLOR_DEPTH",s[s.COLOR_STENCIL=17408]="COLOR_STENCIL",s[s.DEPTH_STENCIL=1280]="DEPTH_STENCIL",s[s.ALL=17664]="ALL",s))($h||{});class zd{constructor(t){this.items=[],this._name=t}emit(t,e,i,n,r,a,o,h){const{name:l,items:c}=this;for(let u=0,d=c.length;u<d;u++)c[u][l](t,e,i,n,r,a,o,h);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&this.items.splice(e,1),this}contains(t){return this.items.indexOf(t)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const Ud=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],Yh=class jh extends ct{constructor(t){super(),this.uid=tt("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const e=[...Ud,...this.config.runners??[]];this._addRunners(...e),this._unsafeEvalCheck()}async init(t={}){const e=t.skipExtensionImports===!0?!0:t.manageImports===!1;await wd(e),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const i in this._systemsHash)t={...this._systemsHash[i].constructor.defaultOptions,...t};t={...jh.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let i=0;i<this.runners.init.items.length;i++)await this.runners.init.items[i].init(t);this._initOptions=t}render(t,e){let i=t;if(i instanceof ft&&(i={container:i},e&&(V(W,"passing a second argument is deprecated, please use render options instead"),i.target=e.renderTexture)),i.target||(i.target=this.view.renderTarget),i.target===this.view.renderTarget&&(this._lastObjectRendered=i.container,i.clearColor??(i.clearColor=this.background.colorRgba),i.clear??(i.clear=this.background.clearBeforeRender)),i.clearColor){const n=Array.isArray(i.clearColor)&&i.clearColor.length===4;i.clearColor=n?i.clearColor:et.shared.setValue(i.clearColor).toArray()}i.transform||(i.container.updateLocalTransform(),i.transform=i.container.localTransform),i.container.enableRenderGroup(),this.runners.prerender.emit(i),this.runners.renderStart.emit(i),this.runners.render.emit(i),this.runners.renderEnd.emit(i),this.runners.postrender.emit(i)}resize(t,e,i){const n=this.view.resolution;this.view.resize(t,e,i),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),i!==void 0&&i!==n&&this.runners.resolutionChange.emit(i)}clear(t={}){const e=this;t.target||(t.target=e.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=$h.ALL);const{clear:i,clearColor:n,target:r}=t;et.shared.setValue(n??this.background.colorRgba),e.renderTarget.clear(r,i,et.shared.toArray())}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach(e=>{this.runners[e]=new zd(e)})}_addSystems(t){let e;for(e in t){const i=t[e];this._addSystem(i.value,i.name)}}_addSystem(t,e){const i=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=i,this._systemsHash[e]=i;for(const n in this.runners)this.runners[n].add(i);return this}_addPipes(t,e){const i=e.reduce((n,r)=>(n[r.name]=r.value,n),{});t.forEach(n=>{const r=n.value,a=n.name,o=i[a];this.renderPipes[a]=new r(this,o?new o:null)})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!vd())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};Yh.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let Xh=Yh,js;function Gd(s){return js!==void 0||(js=(()=>{var e;const t={stencil:!0,failIfMajorPerformanceCaveat:s??Xh.defaultOptions.failIfMajorPerformanceCaveat};try{if(!q.get().getWebGLRenderingContext())return!1;let n=q.get().createCanvas().getContext("webgl",t);const r=!!((e=n==null?void 0:n.getContextAttributes())!=null&&e.stencil);if(n){const a=n.getExtension("WEBGL_lose_context");a&&a.loseContext()}return n=null,r}catch{return!1}})()),js}let Xs;async function Wd(s={}){return Xs!==void 0||(Xs=await(async()=>{const t=q.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(s)).requestDevice(),!0}catch{return!1}})()),Xs}const wa=["webgl","webgpu","canvas"];async function Hd(s){let t=[];s.preference?(t.push(s.preference),wa.forEach(r=>{r!==s.preference&&t.push(r)})):t=wa.slice();let e,i={};for(let r=0;r<t.length;r++){const a=t[r];if(a==="webgpu"&&await Wd()){const{WebGPURenderer:o}=await ai(async()=>{const{WebGPURenderer:h}=await import("./WebGPURenderer-oCSBFX_2.js");return{WebGPURenderer:h}},__vite__mapDeps([3,2,4]));e=o,i={...s,...s.webgpu};break}else if(a==="webgl"&&Gd(s.failIfMajorPerformanceCaveat??Xh.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:o}=await ai(async()=>{const{WebGLRenderer:h}=await import("./WebGLRenderer-gWY7hehK.js");return{WebGLRenderer:h}},__vite__mapDeps([5,2,4]));e=o,i={...s,...s.webgl};break}else if(a==="canvas")throw i={...s},new Error("CanvasRenderer is not yet implemented")}if(delete i.webgpu,delete i.webgl,!e)throw new Error("No available renderer for the current environment");const n=new e;return await n.init(i),n}const Kh="8.11.0";class qh{static init(){var t;(t=globalThis.__PIXI_APP_INIT__)==null||t.call(globalThis,this,Kh)}static destroy(){}}qh.extension=R.Application;class $d{constructor(t){this._renderer=t}init(){var t;(t=globalThis.__PIXI_RENDERER_INIT__)==null||t.call(globalThis,this._renderer,Kh)}destroy(){this._renderer=null}}$d.extension={type:[R.WebGLSystem,R.WebGPUSystem],name:"initHook",priority:-10};const Zh=class En{constructor(...t){this.stage=new ft,t[0]!==void 0&&V(W,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.renderer=await Hd(t),En._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return V(W,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,e=!1){const i=En._plugins.slice(0);i.reverse(),i.forEach(n=>{n.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};Zh._plugins=[];let Qh=Zh;Y.handleByList(R.Application,Qh._plugins);Y.add(qh);class ar{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this._cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this._cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this._cancelResize();let e,i;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,i=globalThis.innerHeight;else{const{clientWidth:n,clientHeight:r}=this._resizeTo;e=n,i=r}this.renderer.resize(e,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this._cancelResize(),this._cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}ar.extension=R.Application;class Jh{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,oi.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?At.shared:new At,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}Jh.extension=R.Application;class tl extends ct{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return V(W,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return V(W,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return V(W,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return V(W,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return V(W,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(t=!1){var e;this.emit("destroy",this),this.removeAllListeners();for(const i in this.chars)(e=this.chars[i].texture)==null||e.destroy();this.chars=null,t&&(this.pages.forEach(i=>i.texture.destroy(!0)),this.pages=null)}}const Yd=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function li(s){const t=typeof s.fontSize=="number"?`${s.fontSize}px`:s.fontSize;let e=s.fontFamily;Array.isArray(s.fontFamily)||(e=s.fontFamily.split(","));for(let i=e.length-1;i>=0;i--){let n=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!Yd.includes(n)&&(n=`"${n}"`),e[i]=n}return`${s.fontStyle} ${s.fontVariant} ${s.fontWeight} ${t} ${e.join(",")}`}const Zi={willReadFrequently:!0},Ot=class I{static get experimentalLetterSpacingSupported(){let t=I._experimentalLetterSpacingSupported;if(t===void 0){const e=q.get().getCanvasRenderingContext2D().prototype;t=I._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,i,n,r,a,o,h,l){this.text=t,this.style=e,this.width=i,this.height=n,this.lines=r,this.lineWidths=a,this.lineHeight=o,this.maxLineWidth=h,this.fontProperties=l}static measureText(t=" ",e,i=I._canvas,n=e.wordWrap){var y;const r=li(e),a=I.measureFont(r);a.fontSize===0&&(a.fontSize=e.fontSize,a.ascent=e.fontSize);const o=I.__context;o.font=r;const l=(n?I._wordWrap(t,e,i):t).split(/(?:\r\n|\r|\n)/),c=new Array(l.length);let u=0;for(let x=0;x<l.length;x++){const _=I._measureText(l[x],e.letterSpacing,o);c[x]=_,u=Math.max(u,_)}const d=((y=e._stroke)==null?void 0:y.width)||0;let f=u+d;e.dropShadow&&(f+=e.dropShadow.distance);const m=e.lineHeight||a.fontSize;let g=Math.max(m,a.fontSize+d)+(l.length-1)*(m+e.leading);return e.dropShadow&&(g+=e.dropShadow.distance),new I(t,e,f,g,l,c,m+e.leading,u,a)}static _measureText(t,e,i){let n=!1;I.experimentalLetterSpacingSupported&&(I.experimentalLetterSpacing?(i.letterSpacing=`${e}px`,i.textLetterSpacing=`${e}px`,n=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));const r=i.measureText(t);let a=r.width;const o=-r.actualBoundingBoxLeft;let l=r.actualBoundingBoxRight-o;if(a>0)if(n)a-=e,l-=e;else{const c=(I.graphemeSegmenter(t).length-1)*e;a+=c,l+=c}return Math.max(a,l)}static _wordWrap(t,e,i=I._canvas){const n=i.getContext("2d",Zi);let r=0,a="",o="";const h=Object.create(null),{letterSpacing:l,whiteSpace:c}=e,u=I._collapseSpaces(c),d=I._collapseNewlines(c);let f=!u;const m=e.wordWrapWidth+l,g=I._tokenize(t);for(let p=0;p<g.length;p++){let y=g[p];if(I._isNewline(y)){if(!d){o+=I._addLine(a),f=!u,a="",r=0;continue}y=" "}if(u){const _=I.isBreakingSpace(y),b=I.isBreakingSpace(a[a.length-1]);if(_&&b)continue}const x=I._getFromCache(y,l,h,n);if(x>m)if(a!==""&&(o+=I._addLine(a),a="",r=0),I.canBreakWords(y,e.breakWords)){const _=I.wordWrapSplit(y);for(let b=0;b<_.length;b++){let C=_[b],w=C,v=1;for(;_[b+v];){const k=_[b+v];if(!I.canBreakChars(w,k,y,b,e.breakWords))C+=k;else break;w=k,v++}b+=v-1;const T=I._getFromCache(C,l,h,n);T+r>m&&(o+=I._addLine(a),f=!1,a="",r=0),a+=C,r+=T}}else{a.length>0&&(o+=I._addLine(a),a="",r=0);const _=p===g.length-1;o+=I._addLine(y,!_),f=!1,a="",r=0}else x+r>m&&(f=!1,o+=I._addLine(a),a="",r=0),(a.length>0||!I.isBreakingSpace(y)||f)&&(a+=y,r+=x)}return o+=I._addLine(a,!1),o}static _addLine(t,e=!0){return t=I._trimRight(t),t=e?`${t}
`:t,t}static _getFromCache(t,e,i,n){let r=i[t];return typeof r!="number"&&(r=I._measureText(t,e,n)+e,i[t]=r),r}static _collapseSpaces(t){return t==="normal"||t==="pre-line"}static _collapseNewlines(t){return t==="normal"}static _trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const i=t[e];if(!I.isBreakingSpace(i))break;t=t.slice(0,-1)}return t}static _isNewline(t){return typeof t!="string"?!1:I._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:I._breakingSpaces.includes(t.charCodeAt(0))}static _tokenize(t){const e=[];let i="";if(typeof t!="string")return e;for(let n=0;n<t.length;n++){const r=t[n],a=t[n+1];if(I.isBreakingSpace(r,a)||I._isNewline(r)){i!==""&&(e.push(i),i=""),r==="\r"&&a===`
`?(e.push(`\r
`),n++):e.push(r);continue}i+=r}return i!==""&&e.push(i),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,i,n,r){return!0}static wordWrapSplit(t){return I.graphemeSegmenter(t)}static measureFont(t){if(I._fonts[t])return I._fonts[t];const e=I._context;e.font=t;const i=e.measureText(I.METRICS_STRING+I.BASELINE_SYMBOL),n={ascent:i.actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent,fontSize:i.actualBoundingBoxAscent+i.actualBoundingBoxDescent};return I._fonts[t]=n,n}static clearMetrics(t=""){t?delete I._fonts[t]:I._fonts={}}static get _canvas(){if(!I.__canvas){let t;try{const e=new OffscreenCanvas(0,0),i=e.getContext("2d",Zi);if(i!=null&&i.measureText)return I.__canvas=e,e;t=q.get().createCanvas()}catch{t=q.get().createCanvas()}t.width=t.height=10,I.__canvas=t}return I.__canvas}static get _context(){return I.__context||(I.__context=I._canvas.getContext("2d",Zi)),I.__context}};Ot.METRICS_STRING="|ÉqÅ";Ot.BASELINE_SYMBOL="M";Ot.BASELINE_MULTIPLIER=1.4;Ot.HEIGHT_MULTIPLIER=2;Ot.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const s=new Intl.Segmenter;return t=>{const e=s.segment(t),i=[];let n=0;for(const r of e)i[n++]=r.segment;return i}}return s=>[...s]})();Ot.experimentalLetterSpacing=!1;Ot._fonts={};Ot._newlines=[10,13];Ot._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let Ft=Ot;const va=[{offset:0,color:"white"},{offset:1,color:"black"}],or=class kn{constructor(...t){this.uid=tt("fillGradient"),this.type="linear",this.colorStops=[];let e=jd(t);e={...e.type==="radial"?kn.defaultRadialOptions:kn.defaultLinearOptions,...nh(e)},this._textureSize=e.textureSize,this._wrapMode=e.wrapMode,e.type==="radial"?(this.center=e.center,this.outerCenter=e.outerCenter??this.center,this.innerRadius=e.innerRadius,this.outerRadius=e.outerRadius,this.scale=e.scale,this.rotation=e.rotation):(this.start=e.start,this.end=e.end),this.textureSpace=e.textureSpace,this.type=e.type,e.colorStops.forEach(n=>{this.addColorStop(n.offset,n.color)})}addColorStop(t,e){return this.colorStops.push({offset:t,color:et.shared.setValue(e).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:t,y:e}=this.start,{x:i,y:n}=this.end,r=i-t,a=n-e;const o=r<0||a<0;if(this._wrapMode==="clamp-to-edge"){if(r<0){const p=t;t=i,i=p,r*=-1}if(a<0){const p=e;e=n,n=p,a*=-1}}const h=this.colorStops.length?this.colorStops:va,l=this._textureSize,{canvas:c,context:u}=Sa(l,1),d=o?u.createLinearGradient(this._textureSize,0,0,0):u.createLinearGradient(0,0,this._textureSize,0);Ca(d,h),u.fillStyle=d,u.fillRect(0,0,l,1),this.texture=new D({source:new ye({resource:c,addressMode:this._wrapMode})});const f=Math.sqrt(r*r+a*a),m=Math.atan2(a,r),g=new N;g.scale(f/l,1),g.rotate(m),g.translate(t,e),this.textureSpace==="local"&&g.scale(l,l),this.transform=g}buildGradient(){this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:va,e=this._textureSize,{canvas:i,context:n}=Sa(e,e),{x:r,y:a}=this.center,{x:o,y:h}=this.outerCenter,l=this.innerRadius,c=this.outerRadius,u=o-c,d=h-c,f=e/(c*2),m=(r-u)*f,g=(a-d)*f,p=n.createRadialGradient(m,g,l*f,(o-u)*f,(h-d)*f,c*f);Ca(p,t),n.fillStyle=t[t.length-1].color,n.fillRect(0,0,e,e),n.fillStyle=p,n.translate(m,g),n.rotate(this.rotation),n.scale(1,this.scale),n.translate(-m,-g),n.fillRect(0,0,e,e),this.texture=new D({source:new ye({resource:i,addressMode:this._wrapMode})});const y=new N;y.scale(1/f,1/f),y.translate(u,d),this.textureSpace==="local"&&y.scale(e,e),this.transform=y}get styleKey(){return this.uid}destroy(){var t;(t=this.texture)==null||t.destroy(!0),this.texture=null}};or.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};or.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let Gt=or;function Ca(s,t){for(let e=0;e<t.length;e++){const i=t[e];s.addColorStop(i.offset,i.color)}}function Sa(s,t){const e=q.get().createCanvas(s,t),i=e.getContext("2d");return{canvas:e,context:i}}function jd(s){let t=s[0]??{};return(typeof t=="number"||s[1])&&(V("8.5.2","use options object instead"),t={type:"linear",start:{x:s[0],y:s[1]},end:{x:s[2],y:s[3]},textureSpace:s[4],textureSize:s[5]??Gt.defaultLinearOptions.textureSize}),t}const Aa={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class vi{constructor(t,e){this.uid=tt("fillPattern"),this.transform=new N,this._styleKey=null,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=Aa[e].addressModeU,t.source.style.addressModeV=Aa[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var Qi,Ta;function Xd(){if(Ta)return Qi;Ta=1,Qi=e;var s={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},t=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function e(r){var a=[];return r.replace(t,function(o,h,l){var c=h.toLowerCase();for(l=n(l),c=="m"&&l.length>2&&(a.push([h].concat(l.splice(0,2))),c="l",h=h=="m"?"l":"L");;){if(l.length==s[c])return l.unshift(h),a.push(l);if(l.length<s[c])throw new Error("malformed path data");a.push([h].concat(l.splice(0,s[c])))}}),a}var i=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function n(r){var a=r.match(i);return a?a.map(Number):[]}return Qi}var Kd=Xd();const qd=eh(Kd);function Zd(s,t){const e=qd(s),i=[];let n=null,r=0,a=0;for(let o=0;o<e.length;o++){const h=e[o],l=h[0],c=h;switch(l){case"M":r=c[1],a=c[2],t.moveTo(r,a);break;case"m":r+=c[1],a+=c[2],t.moveTo(r,a);break;case"H":r=c[1],t.lineTo(r,a);break;case"h":r+=c[1],t.lineTo(r,a);break;case"V":a=c[1],t.lineTo(r,a);break;case"v":a+=c[1],t.lineTo(r,a);break;case"L":r=c[1],a=c[2],t.lineTo(r,a);break;case"l":r+=c[1],a+=c[2],t.lineTo(r,a);break;case"C":r=c[5],a=c[6],t.bezierCurveTo(c[1],c[2],c[3],c[4],r,a);break;case"c":t.bezierCurveTo(r+c[1],a+c[2],r+c[3],a+c[4],r+c[5],a+c[6]),r+=c[5],a+=c[6];break;case"S":r=c[3],a=c[4],t.bezierCurveToShort(c[1],c[2],r,a);break;case"s":t.bezierCurveToShort(r+c[1],a+c[2],r+c[3],a+c[4]),r+=c[3],a+=c[4];break;case"Q":r=c[3],a=c[4],t.quadraticCurveTo(c[1],c[2],r,a);break;case"q":t.quadraticCurveTo(r+c[1],a+c[2],r+c[3],a+c[4]),r+=c[3],a+=c[4];break;case"T":r=c[1],a=c[2],t.quadraticCurveToShort(r,a);break;case"t":r+=c[1],a+=c[2],t.quadraticCurveToShort(r,a);break;case"A":r=c[6],a=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],r,a);break;case"a":r+=c[6],a+=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],r,a);break;case"Z":case"z":t.closePath(),i.length>0&&(n=i.pop(),n?(r=n.startX,a=n.startY):(r=0,a=0)),n=null;break;default:$(`Unknown SVG path command: ${l}`)}l!=="Z"&&l!=="z"&&n===null&&(n={startX:r,startY:a},i.push(n))}return t}class hr{constructor(t=0,e=0,i=0){this.type="circle",this.x=t,this.y=e,this.radius=i}clone(){return new hr(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const i=this.radius*this.radius;let n=this.x-t,r=this.y-e;return n*=n,r*=r,n+r<=i}strokeContains(t,e,i,n=.5){if(this.radius===0)return!1;const r=this.x-t,a=this.y-e,o=this.radius,h=(1-n)*i,l=Math.sqrt(r*r+a*a);return l<=o+h&&l>o-(i-h)}getBounds(t){return t||(t=new K),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class lr{constructor(t=0,e=0,i=0,n=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=i,this.halfHeight=n}clone(){return new lr(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let i=(t-this.x)/this.halfWidth,n=(e-this.y)/this.halfHeight;return i*=i,n*=n,i+n<=1}strokeContains(t,e,i,n=.5){const{halfWidth:r,halfHeight:a}=this;if(r<=0||a<=0)return!1;const o=i*(1-n),h=i-o,l=r-h,c=a-h,u=r+o,d=a+o,f=t-this.x,m=e-this.y,g=f*f/(l*l)+m*m/(c*c),p=f*f/(u*u)+m*m/(d*d);return g>1&&p<=1}getBounds(t){return t||(t=new K),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function Qd(s,t,e,i,n,r){const a=s-e,o=t-i,h=n-e,l=r-i,c=a*h+o*l,u=h*h+l*l;let d=-1;u!==0&&(d=c/u);let f,m;d<0?(f=e,m=i):d>1?(f=n,m=r):(f=e+d*h,m=i+d*l);const g=s-f,p=t-m;return g*g+p*p}let Jd,tf;class gs{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const i=[];for(let n=0,r=e.length;n<r;n++)i.push(e[n].x,e[n].y);e=i}this.points=e,this.closePath=!0}isClockwise(){let t=0;const e=this.points,i=e.length;for(let n=0;n<i;n+=2){const r=e[n],a=e[n+1],o=e[(n+2)%i],h=e[(n+3)%i];t+=(o-r)*(h+a)}return t<0}containsPolygon(t){const e=this.getBounds(Jd),i=t.getBounds(tf);if(!e.containsRect(i))return!1;const n=t.points;for(let r=0;r<n.length;r+=2){const a=n[r],o=n[r+1];if(!this.contains(a,o))return!1}return!0}clone(){const t=this.points.slice(),e=new gs(t);return e.closePath=this.closePath,e}contains(t,e){let i=!1;const n=this.points.length/2;for(let r=0,a=n-1;r<n;a=r++){const o=this.points[r*2],h=this.points[r*2+1],l=this.points[a*2],c=this.points[a*2+1];h>e!=c>e&&t<(l-o)*((e-h)/(c-h))+o&&(i=!i)}return i}strokeContains(t,e,i,n=.5){const r=i*i,a=r*(1-n),o=r-a,{points:h}=this,l=h.length-(this.closePath?0:2);for(let c=0;c<l;c+=2){const u=h[c],d=h[c+1],f=h[(c+2)%h.length],m=h[(c+3)%h.length],g=Qd(t,e,u,d,f,m),p=Math.sign((f-u)*(e-d)-(m-d)*(t-u));if(g<=(p<0?o:a))return!0}return!1}getBounds(t){t||(t=new K);const e=this.points;let i=1/0,n=-1/0,r=1/0,a=-1/0;for(let o=0,h=e.length;o<h;o+=2){const l=e[o],c=e[o+1];i=l<i?l:i,n=l>n?l:n,r=c<r?c:r,a=c>a?c:a}return t.x=i,t.width=n-i,t.y=r,t.height=a-r,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return V("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return V("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const Ks=(s,t,e,i,n,r,a)=>{const o=s-e,h=t-i,l=Math.sqrt(o*o+h*h);return l>=n-r&&l<=n+a};class cr{constructor(t=0,e=0,i=0,n=0,r=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=i,this.height=n,this.radius=r}getBounds(t){return t||(t=new K),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new cr(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+i&&e<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let n=t-(this.x+i),r=e-(this.y+i);const a=i*i;if(n*n+r*r<=a||(n=t-(this.x+this.width-i),n*n+r*r<=a)||(r=e-(this.y+this.height-i),n*n+r*r<=a)||(n=t-(this.x+i),n*n+r*r<=a))return!0}return!1}strokeContains(t,e,i,n=.5){const{x:r,y:a,width:o,height:h,radius:l}=this,c=i*(1-n),u=i-c,d=r+l,f=a+l,m=o-l*2,g=h-l*2,p=r+o,y=a+h;return(t>=r-c&&t<=r+u||t>=p-u&&t<=p+c)&&e>=f&&e<=f+g||(e>=a-c&&e<=a+u||e>=y-u&&e<=y+c)&&t>=d&&t<=d+m?!0:t<d&&e<f&&Ks(t,e,d,f,l,u,c)||t>p-l&&e<f&&Ks(t,e,p-l,f,l,u,c)||t>p-l&&e>y-l&&Ks(t,e,p-l,y-l,l,u,c)||t<d&&e>y-l&&Ks(t,e,d,y-l,l,u,c)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const el={};function ef(s,t,e){let i=2166136261;for(let n=0;n<t;n++)i^=s[n].uid,i=Math.imul(i,16777619),i>>>=0;return el[i]||sf(s,t,i,e)}function sf(s,t,e,i){const n={};let r=0;for(let o=0;o<i;o++){const h=o<t?s[o]:D.EMPTY.source;n[r++]=h.source,n[r++]=h.style}const a=new si(n);return el[e]=a,a}class Pa{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}function Ma(s,t){const e=s.byteLength/8|0,i=new Float64Array(s,0,e);new Float64Array(t,0,e).set(i);const r=s.byteLength-e*8;if(r>0){const a=new Uint8Array(s,e*8,r);new Uint8Array(t,e*8,r).set(a)}}const nf={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var rf=(s=>(s[s.DISABLED=0]="DISABLED",s[s.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",s[s.MASK_ACTIVE=2]="MASK_ACTIVE",s[s.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",s[s.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",s[s.NONE=5]="NONE",s))(rf||{});function Ea(s,t){return t.alphaMode==="no-premultiply-alpha"&&nf[s]||s}const af=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function of(s){let t="";for(let e=0;e<s;++e)e>0&&(t+=`
else `),e<s-1&&(t+=`if(test == ${e}.0){}`);return t}function hf(s,t){if(s===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);try{for(;;){const i=af.replace(/%forloop%/gi,of(s));if(t.shaderSource(e,i),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))s=s/2|0;else break}}finally{t.deleteShader(e)}return s}let ve=null;function lf(){var t;if(ve)return ve;const s=Fh();return ve=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),ve=hf(ve,s),(t=s.getExtension("WEBGL_lose_context"))==null||t.loseContext(),ve}class cf{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}}class uf{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new cf,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const sl=[];let Rn=0;function ka(){return Rn>0?sl[--Rn]:new uf}function Ra(s){sl[Rn++]=s}let Ze=0;const il=class nl{constructor(t){this.uid=tt("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],t={...nl.defaultOptions,...t},t.maxTextures||(V("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),t.maxTextures=lf());const{maxTextures:e,attributesInitialSize:i,indicesInitialSize:n}=t;this.attributeBuffer=new Pa(i*4),this.indexBuffer=new Uint16Array(n),this.maxTextures=e}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)Ra(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,e){const i=t._batch.textures.ids[e._source.uid];return!i&&i!==0?!1:(t._textureId=i,t.texture=e,!0)}updateElement(t){this.dirty=!0;const e=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId)}break(t){const e=this._elements;if(!e[this.elementStart])return;let i=ka(),n=i.textures;n.clear();const r=e[this.elementStart];let a=Ea(r.blendMode,r.texture._source),o=r.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const h=this.attributeBuffer.float32View,l=this.attributeBuffer.uint32View,c=this.indexBuffer;let u=this._batchIndexSize,d=this._batchIndexStart,f="startBatch";const m=this.maxTextures;for(let g=this.elementStart;g<this.elementSize;++g){const p=e[g];e[g]=null;const x=p.texture._source,_=Ea(p.blendMode,x),b=a!==_||o!==p.topology;if(x._batchTick===Ze&&!b){p._textureId=x._textureBindLocation,u+=p.indexSize,p.packAsQuad?(this.packQuadAttributes(p,h,l,p._attributeStart,p._textureId),this.packQuadIndex(c,p._indexStart,p._attributeStart/this.vertexSize)):(this.packAttributes(p,h,l,p._attributeStart,p._textureId),this.packIndex(p,c,p._indexStart,p._attributeStart/this.vertexSize)),p._batch=i;continue}x._batchTick=Ze,(n.count>=m||b)&&(this._finishBatch(i,d,u-d,n,a,o,t,f),f="renderBatch",d=u,a=_,o=p.topology,i=ka(),n=i.textures,n.clear(),++Ze),p._textureId=x._textureBindLocation=n.count,n.ids[x.uid]=n.count,n.textures[n.count++]=x,p._batch=i,u+=p.indexSize,p.packAsQuad?(this.packQuadAttributes(p,h,l,p._attributeStart,p._textureId),this.packQuadIndex(c,p._indexStart,p._attributeStart/this.vertexSize)):(this.packAttributes(p,h,l,p._attributeStart,p._textureId),this.packIndex(p,c,p._indexStart,p._attributeStart/this.vertexSize))}n.count>0&&(this._finishBatch(i,d,u-d,n,a,o,t,f),d=u,++Ze),this.elementStart=this.elementSize,this._batchIndexStart=d,this._batchIndexSize=u}_finishBatch(t,e,i,n,r,a,o,h){t.gpuBindGroup=null,t.bindGroup=null,t.action=h,t.batcher=this,t.textures=n,t.blendMode=r,t.topology=a,t.start=e,t.size=i,++Ze,this.batches[this.batchIndex++]=t,o.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){t*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(t*4)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const e=Math.max(t,this.attributeBuffer.size*2),i=new Pa(e);Ma(this.attributeBuffer.rawBinaryData,i.rawBinaryData),this.attributeBuffer=i}_resizeIndexBuffer(t){const e=this.indexBuffer;let i=Math.max(t,e.length*1.5);i+=i%2;const n=i>65535?new Uint32Array(i):new Uint16Array(i);if(n.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let r=0;r<e.length;r++)n[r]=e[r];else Ma(e.buffer,n.buffer);this.indexBuffer=n}packQuadIndex(t,e,i){t[e]=i+0,t[e+1]=i+1,t[e+2]=i+2,t[e+3]=i+0,t[e+4]=i+2,t[e+5]=i+3}packIndex(t,e,i,n){const r=t.indices,a=t.indexSize,o=t.indexOffset,h=t.attributeOffset;for(let l=0;l<a;l++)e[i++]=n+r[l+o]-h}destroy(){for(let t=0;t<this.batches.length;t++)Ra(this.batches[t]);this.batches=null;for(let t=0;t<this._elements.length;t++)this._elements[t]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};il.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let df=il;var pt=(s=>(s[s.MAP_READ=1]="MAP_READ",s[s.MAP_WRITE=2]="MAP_WRITE",s[s.COPY_SRC=4]="COPY_SRC",s[s.COPY_DST=8]="COPY_DST",s[s.INDEX=16]="INDEX",s[s.VERTEX=32]="VERTEX",s[s.UNIFORM=64]="UNIFORM",s[s.STORAGE=128]="STORAGE",s[s.INDIRECT=256]="INDIRECT",s[s.QUERY_RESOLVE=512]="QUERY_RESOLVE",s[s.STATIC=1024]="STATIC",s))(pt||{});class Cs extends ct{constructor(t){let{data:e,size:i}=t;const{usage:n,label:r,shrinkToFit:a}=t;super(),this.uid=tt("buffer"),this._resourceType="buffer",this._resourceId=tt("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,e instanceof Array&&(e=new Float32Array(e)),this._data=e,i??(i=e==null?void 0:e.byteLength);const o=!!e;this.descriptor={size:i,usage:n,mappedAtCreation:o,label:r},this.shrinkToFit=a??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&pt.STATIC)}set static(t){t?this.descriptor.usage|=pt.STATIC:this.descriptor.usage&=~pt.STATIC}setDataWithSize(t,e,i){if(this._updateID++,this._updateSize=e*t.BYTES_PER_ELEMENT,this._data===t){i&&this.emit("update",this);return}const n=this._data;if(this._data=t,this._dataInt32=null,!n||n.length!==t.length){!this.shrinkToFit&&n&&t.byteLength<n.byteLength?i&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=tt("resource"),this.emit("change",this));return}i&&this.emit("update",this)}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function rl(s,t){if(!(s instanceof Cs)){let e=t?pt.INDEX:pt.VERTEX;s instanceof Array&&(t?(s=new Uint32Array(s),e=pt.INDEX|pt.COPY_DST):(s=new Float32Array(s),e=pt.VERTEX|pt.COPY_DST)),s=new Cs({data:s,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:e})}return s}function ff(s,t,e){const i=s.getAttribute(t);if(!i)return e.minX=0,e.minY=0,e.maxX=0,e.maxY=0,e;const n=i.buffer.data;let r=1/0,a=1/0,o=-1/0,h=-1/0;const l=n.BYTES_PER_ELEMENT,c=(i.offset||0)/l,u=(i.stride||2*4)/l;for(let d=c;d<n.length;d+=u){const f=n[d],m=n[d+1];f>o&&(o=f),m>h&&(h=m),f<r&&(r=f),m<a&&(a=m)}return e.minX=r,e.minY=a,e.maxX=o,e.maxY=h,e}function pf(s){return(s instanceof Cs||Array.isArray(s)||s.BYTES_PER_ELEMENT)&&(s={buffer:s}),s.buffer=rl(s.buffer,!1),s}class mf extends ct{constructor(t={}){super(),this.uid=tt("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new Tt,this._boundsDirty=!0;const{attributes:e,indexBuffer:i,topology:n}=t;if(this.buffers=[],this.attributes={},e)for(const r in e)this.addAttribute(r,e[r]);this.instanceCount=t.instanceCount??1,i&&this.addIndex(i),this.topology=n||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return e.buffer.data.length/(e.stride/4||e.size)}return 0}addAttribute(t,e){const i=pf(e);this.buffers.indexOf(i.buffer)===-1&&(this.buffers.push(i.buffer),i.buffer.on("update",this.onBufferUpdate,this),i.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=i}addIndex(t){this.indexBuffer=rl(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,ff(this,"aPosition",this._bounds)):this._bounds}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(e=>e.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const gf=new Float32Array(1),yf=new Uint32Array(1);class xf extends mf{constructor(){const e=new Cs({data:gf,label:"attribute-batch-buffer",usage:pt.VERTEX|pt.COPY_DST,shrinkToFit:!1}),i=new Cs({data:yf,label:"index-batch-buffer",usage:pt.INDEX|pt.COPY_DST,shrinkToFit:!1}),n=6*4;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:n,offset:0},aUV:{buffer:e,format:"float32x2",stride:n,offset:2*4},aColor:{buffer:e,format:"unorm8x4",stride:n,offset:4*4},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:n,offset:5*4}},indexBuffer:i})}}function Ia(s,t,e){if(s)for(const i in s){const n=i.toLocaleLowerCase(),r=t[n];if(r){let a=s[i];i==="header"&&(a=a.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),e&&r.push(`//----${e}----//`),r.push(a)}else $(`${i} placement hook does not exist in shader`)}}const _f=/\{\{(.*?)\}\}/g;function Fa(s){var i;const t={};return(((i=s.match(_f))==null?void 0:i.map(n=>n.replace(/[{()}]/g,"")))??[]).forEach(n=>{t[n]=[]}),t}function Ba(s,t){let e;const i=/@in\s+([^;]+);/g;for(;(e=i.exec(s))!==null;)t.push(e[1])}function La(s,t,e=!1){const i=[];Ba(t,i),s.forEach(o=>{o.header&&Ba(o.header,i)});const n=i;e&&n.sort();const r=n.map((o,h)=>`       @location(${h}) ${o},`).join(`
`);let a=t.replace(/@in\s+[^;]+;\s*/g,"");return a=a.replace("{{in}}",`
${r}
`),a}function Oa(s,t){let e;const i=/@out\s+([^;]+);/g;for(;(e=i.exec(s))!==null;)t.push(e[1])}function bf(s){const e=/\b(\w+)\s*:/g.exec(s);return e?e[1]:""}function wf(s){const t=/@.*?\s+/g;return s.replace(t,"")}function vf(s,t){const e=[];Oa(t,e),s.forEach(h=>{h.header&&Oa(h.header,e)});let i=0;const n=e.sort().map(h=>h.indexOf("builtin")>-1?h:`@location(${i++}) ${h}`).join(`,
`),r=e.sort().map(h=>`       var ${wf(h)};`).join(`
`),a=`return VSOutput(
            ${e.sort().map(h=>` ${bf(h)}`).join(`,
`)});`;let o=t.replace(/@out\s+[^;]+;\s*/g,"");return o=o.replace("{{struct}}",`
${n}
`),o=o.replace("{{start}}",`
${r}
`),o=o.replace("{{return}}",`
${a}
`),o}function Va(s,t){let e=s;for(const i in t){const n=t[i];n.join(`
`).length?e=e.replace(`{{${i}}}`,`//-----${i} START-----//
${n.join(`
`)}
//----${i} FINISH----//`):e=e.replace(`{{${i}}}`,"")}return e}const Jt=Object.create(null),Ji=new Map;let Cf=0;function Sf({template:s,bits:t}){const e=al(s,t);if(Jt[e])return Jt[e];const{vertex:i,fragment:n}=Tf(s,t);return Jt[e]=ol(i,n,t),Jt[e]}function Af({template:s,bits:t}){const e=al(s,t);return Jt[e]||(Jt[e]=ol(s.vertex,s.fragment,t)),Jt[e]}function Tf(s,t){const e=t.map(a=>a.vertex).filter(a=>!!a),i=t.map(a=>a.fragment).filter(a=>!!a);let n=La(e,s.vertex,!0);n=vf(e,n);const r=La(i,s.fragment,!0);return{vertex:n,fragment:r}}function al(s,t){return t.map(e=>(Ji.has(e)||Ji.set(e,Cf++),Ji.get(e))).sort((e,i)=>e-i).join("-")+s.vertex+s.fragment}function ol(s,t,e){const i=Fa(s),n=Fa(t);return e.forEach(r=>{Ia(r.vertex,i,r.name),Ia(r.fragment,n,r.name)}),{vertex:Va(s,i),fragment:Va(t,n)}}const Pf=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,Mf=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,Ef=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,kf=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,Rf={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},If={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function Ff({bits:s,name:t}){const e=Sf({template:{fragment:Mf,vertex:Pf},bits:[Rf,...s]});return ze.from({name:t,vertex:{source:e.vertex,entryPoint:"main"},fragment:{source:e.fragment,entryPoint:"main"}})}function Bf({bits:s,name:t}){return new bi({name:t,...Af({template:{vertex:Ef,fragment:kf},bits:[If,...s]})})}const Lf={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},Of={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},tn={};function Vf(s){const t=[];if(s===1)t.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),t.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let e=0;for(let i=0;i<s;i++)t.push(`@group(1) @binding(${e++}) var textureSource${i+1}: texture_2d<f32>;`),t.push(`@group(1) @binding(${e++}) var textureSampler${i+1}: sampler;`)}return t.join(`
`)}function Df(s){const t=[];if(s===1)t.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{t.push("switch vTextureId {");for(let e=0;e<s;e++)e===s-1?t.push("  default:{"):t.push(`  case ${e}:{`),t.push(`      outColor = textureSampleGrad(textureSource${e+1}, textureSampler${e+1}, vUV, uvDx, uvDy);`),t.push("      break;}");t.push("}")}return t.join(`
`)}function Nf(s){return tn[s]||(tn[s]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${Vf(s)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${Df(s)}
            `}}),tn[s]}const en={};function zf(s){const t=[];for(let e=0;e<s;e++)e>0&&t.push("else"),e<s-1&&t.push(`if(vTextureId < ${e}.5)`),t.push("{"),t.push(`	outColor = texture(uTextures[${e}], vUV);`),t.push("}");return t.join(`
`)}function Uf(s){return en[s]||(en[s]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${s}];

            `,main:`

                ${zf(s)}
            `}}),en[s]}const Gf={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Wf={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Da={};function Hf(s){let t=Da[s];if(t)return t;const e=new Int32Array(s);for(let i=0;i<s;i++)e[i]=i;return t=Da[s]=new Dh({uTextures:{value:e,type:"i32",size:s}},{isStatic:!0}),t}class $f extends wi{constructor(t){const e=Bf({name:"batch",bits:[Of,Uf(t),Wf]}),i=Ff({name:"batch",bits:[Lf,Nf(t),Gf]});super({glProgram:e,gpuProgram:i,resources:{batchSamplers:Hf(t)}})}}let sn=null;const hl=class ll extends df{constructor(t){super(t),this.geometry=new xf,this.name=ll.extension.name,this.vertexSize=6,sn??(sn=new $f(t.maxTextures)),this.shader=sn}packAttributes(t,e,i,n,r){const a=r<<16|t.roundPixels&65535,o=t.transform,h=o.a,l=o.b,c=o.c,u=o.d,d=o.tx,f=o.ty,{positions:m,uvs:g}=t,p=t.color,y=t.attributeOffset,x=y+t.attributeSize;for(let _=y;_<x;_++){const b=_*2,C=m[b],w=m[b+1];e[n++]=h*C+c*w+d,e[n++]=u*w+l*C+f,e[n++]=g[b],e[n++]=g[b+1],i[n++]=p,i[n++]=a}}packQuadAttributes(t,e,i,n,r){const a=t.texture,o=t.transform,h=o.a,l=o.b,c=o.c,u=o.d,d=o.tx,f=o.ty,m=t.bounds,g=m.maxX,p=m.minX,y=m.maxY,x=m.minY,_=a.uvs,b=t.color,C=r<<16|t.roundPixels&65535;e[n+0]=h*p+c*x+d,e[n+1]=u*x+l*p+f,e[n+2]=_.x0,e[n+3]=_.y0,i[n+4]=b,i[n+5]=C,e[n+6]=h*g+c*x+d,e[n+7]=u*x+l*g+f,e[n+8]=_.x1,e[n+9]=_.y1,i[n+10]=b,i[n+11]=C,e[n+12]=h*g+c*y+d,e[n+13]=u*y+l*g+f,e[n+14]=_.x2,e[n+15]=_.y2,i[n+16]=b,i[n+17]=C,e[n+18]=h*p+c*y+d,e[n+19]=u*y+l*p+f,e[n+20]=_.x3,e[n+21]=_.y3,i[n+22]=b,i[n+23]=C}};hl.extension={type:[R.Batcher],name:"default"};let Yf=hl;function jf(s,t,e,i,n,r,a,o=null){let h=0;e*=t,n*=r;const l=o.a,c=o.b,u=o.c,d=o.d,f=o.tx,m=o.ty;for(;h<a;){const g=s[e],p=s[e+1];i[n]=l*g+u*p+f,i[n+1]=c*g+d*p+m,n+=r,e+=t,h++}}function Xf(s,t,e,i){let n=0;for(t*=e;n<i;)s[t]=0,s[t+1]=0,t+=e,n++}function cl(s,t,e,i,n){const r=t.a,a=t.b,o=t.c,h=t.d,l=t.tx,c=t.ty;e||(e=0),i||(i=2),n||(n=s.length/i-e);let u=e*i;for(let d=0;d<n;d++){const f=s[u],m=s[u+1];s[u]=r*f+o*m+l,s[u+1]=a*f+h*m+c,u+=i}}const Kf=new N;class ul{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,e=t>>16|t&65280|(t&255)<<16,i=this.renderable;return i?ph(e,i.groupColor)+(this.alpha*i.groupAlpha*255<<24):e+(this.alpha*255<<24)}get transform(){var t;return((t=this.renderable)==null?void 0:t.groupTransform)||Kf}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}const Ss={extension:{type:R.ShapeBuilder,name:"circle"},build(s,t){let e,i,n,r,a,o;if(s.type==="circle"){const b=s;if(a=o=b.radius,a<=0)return!1;e=b.x,i=b.y,n=r=0}else if(s.type==="ellipse"){const b=s;if(a=b.halfWidth,o=b.halfHeight,a<=0||o<=0)return!1;e=b.x,i=b.y,n=r=0}else{const b=s,C=b.width/2,w=b.height/2;e=b.x+C,i=b.y+w,a=o=Math.max(0,Math.min(b.radius,Math.min(C,w))),n=C-a,r=w-o}if(n<0||r<0)return!1;const h=Math.ceil(2.3*Math.sqrt(a+o)),l=h*8+(n?4:0)+(r?4:0);if(l===0)return!1;if(h===0)return t[0]=t[6]=e+n,t[1]=t[3]=i+r,t[2]=t[4]=e-n,t[5]=t[7]=i-r,!0;let c=0,u=h*4+(n?2:0)+2,d=u,f=l,m=n+a,g=r,p=e+m,y=e-m,x=i+g;if(t[c++]=p,t[c++]=x,t[--u]=x,t[--u]=y,r){const b=i-g;t[d++]=y,t[d++]=b,t[--f]=b,t[--f]=p}for(let b=1;b<h;b++){const C=Math.PI/2*(b/h),w=n+Math.cos(C)*a,v=r+Math.sin(C)*o,T=e+w,k=e-w,M=i+v,E=i-v;t[c++]=T,t[c++]=M,t[--u]=M,t[--u]=k,t[d++]=k,t[d++]=E,t[--f]=E,t[--f]=T}m=n,g=r+o,p=e+m,y=e-m,x=i+g;const _=i-g;return t[c++]=p,t[c++]=x,t[--f]=_,t[--f]=p,n&&(t[c++]=y,t[c++]=x,t[--f]=_,t[--f]=y),!0},triangulate(s,t,e,i,n,r){if(s.length===0)return;let a=0,o=0;for(let c=0;c<s.length;c+=2)a+=s[c],o+=s[c+1];a/=s.length/2,o/=s.length/2;let h=i;t[h*e]=a,t[h*e+1]=o;const l=h++;for(let c=0;c<s.length;c+=2)t[h*e]=s[c],t[h*e+1]=s[c+1],c>0&&(n[r++]=h,n[r++]=l,n[r++]=h-1),h++;n[r++]=l+1,n[r++]=l,n[r++]=h-1}},qf={...Ss,extension:{...Ss.extension,name:"ellipse"}},Zf={...Ss,extension:{...Ss.extension,name:"roundedRectangle"}},dl=1e-4,Na=1e-4;function Qf(s){const t=s.length;if(t<6)return 1;let e=0;for(let i=0,n=s[t-2],r=s[t-1];i<t;i+=2){const a=s[i],o=s[i+1];e+=(a-n)*(o+r),n=a,r=o}return e<0?-1:1}function za(s,t,e,i,n,r,a,o){const h=s-e*n,l=t-i*n,c=s+e*r,u=t+i*r;let d,f;a?(d=i,f=-e):(d=-i,f=e);const m=h+d,g=l+f,p=c+d,y=u+f;return o.push(m,g),o.push(p,y),2}function re(s,t,e,i,n,r,a,o){const h=e-s,l=i-t;let c=Math.atan2(h,l),u=Math.atan2(n-s,r-t);o&&c<u?c+=Math.PI*2:!o&&c>u&&(u+=Math.PI*2);let d=c;const f=u-c,m=Math.abs(f),g=Math.sqrt(h*h+l*l),p=(15*m*Math.sqrt(g)/Math.PI>>0)+1,y=f/p;if(d+=y,o){a.push(s,t),a.push(e,i);for(let x=1,_=d;x<p;x++,_+=y)a.push(s,t),a.push(s+Math.sin(_)*g,t+Math.cos(_)*g);a.push(s,t),a.push(n,r)}else{a.push(e,i),a.push(s,t);for(let x=1,_=d;x<p;x++,_+=y)a.push(s+Math.sin(_)*g,t+Math.cos(_)*g),a.push(s,t);a.push(n,r),a.push(s,t)}return p*2}function Jf(s,t,e,i,n,r){const a=dl;if(s.length===0)return;const o=t;let h=o.alignment;if(t.alignment!==.5){let H=Qf(s);h=(h-.5)*H+.5}const l=new lt(s[0],s[1]),c=new lt(s[s.length-2],s[s.length-1]),u=i,d=Math.abs(l.x-c.x)<a&&Math.abs(l.y-c.y)<a;if(u){s=s.slice(),d&&(s.pop(),s.pop(),c.set(s[s.length-2],s[s.length-1]));const H=(l.x+c.x)*.5,vt=(c.y+l.y)*.5;s.unshift(H,vt),s.push(H,vt)}const f=n,m=s.length/2;let g=s.length;const p=f.length/2,y=o.width/2,x=y*y,_=o.miterLimit*o.miterLimit;let b=s[0],C=s[1],w=s[2],v=s[3],T=0,k=0,M=-(C-v),E=b-w,U=0,L=0,rt=Math.sqrt(M*M+E*E);M/=rt,E/=rt,M*=y,E*=y;const Yt=h,B=(1-Yt)*2,F=Yt*2;u||(o.cap==="round"?g+=re(b-M*(B-F)*.5,C-E*(B-F)*.5,b-M*B,C-E*B,b+M*F,C+E*F,f,!0)+2:o.cap==="square"&&(g+=za(b,C,M,E,B,F,!0,f))),f.push(b-M*B,C-E*B),f.push(b+M*F,C+E*F);for(let H=1;H<m-1;++H){b=s[(H-1)*2],C=s[(H-1)*2+1],w=s[H*2],v=s[H*2+1],T=s[(H+1)*2],k=s[(H+1)*2+1],M=-(C-v),E=b-w,rt=Math.sqrt(M*M+E*E),M/=rt,E/=rt,M*=y,E*=y,U=-(v-k),L=w-T,rt=Math.sqrt(U*U+L*L),U/=rt,L/=rt,U*=y,L*=y;const vt=w-b,jt=C-v,Xt=w-T,Kt=k-v,Xe=vt*Xt+jt*Kt,Mt=jt*Xt-Kt*vt,Et=Mt<0;if(Math.abs(Mt)<.001*Math.abs(Xe)){f.push(w-M*B,v-E*B),f.push(w+M*F,v+E*F),Xe>=0&&(o.join==="round"?g+=re(w,v,w-M*B,v-E*B,w-U*B,v-L*B,f,!1)+4:g+=2,f.push(w-U*F,v-L*F),f.push(w+U*B,v+L*B));continue}const te=(-M+b)*(-E+v)-(-M+w)*(-E+C),qt=(-U+T)*(-L+v)-(-U+w)*(-L+k),kt=(vt*qt-Xt*te)/Mt,Os=(Kt*te-jt*qt)/Mt,Si=(kt-w)*(kt-w)+(Os-v)*(Os-v),ee=w+(kt-w)*B,se=v+(Os-v)*B,ie=w-(kt-w)*F,ne=v-(Os-v)*F,Wc=Math.min(vt*vt+jt*jt,Xt*Xt+Kt*Kt),Vr=Et?B:F,Hc=Wc+Vr*Vr*x;Si<=Hc?o.join==="bevel"||Si/x>_?(Et?(f.push(ee,se),f.push(w+M*F,v+E*F),f.push(ee,se),f.push(w+U*F,v+L*F)):(f.push(w-M*B,v-E*B),f.push(ie,ne),f.push(w-U*B,v-L*B),f.push(ie,ne)),g+=2):o.join==="round"?Et?(f.push(ee,se),f.push(w+M*F,v+E*F),g+=re(w,v,w+M*F,v+E*F,w+U*F,v+L*F,f,!0)+4,f.push(ee,se),f.push(w+U*F,v+L*F)):(f.push(w-M*B,v-E*B),f.push(ie,ne),g+=re(w,v,w-M*B,v-E*B,w-U*B,v-L*B,f,!1)+4,f.push(w-U*B,v-L*B),f.push(ie,ne)):(f.push(ee,se),f.push(ie,ne)):(f.push(w-M*B,v-E*B),f.push(w+M*F,v+E*F),o.join==="round"?Et?g+=re(w,v,w+M*F,v+E*F,w+U*F,v+L*F,f,!0)+2:g+=re(w,v,w-M*B,v-E*B,w-U*B,v-L*B,f,!1)+2:o.join==="miter"&&Si/x<=_&&(Et?(f.push(ie,ne),f.push(ie,ne)):(f.push(ee,se),f.push(ee,se)),g+=2),f.push(w-U*B,v-L*B),f.push(w+U*F,v+L*F),g+=2)}b=s[(m-2)*2],C=s[(m-2)*2+1],w=s[(m-1)*2],v=s[(m-1)*2+1],M=-(C-v),E=b-w,rt=Math.sqrt(M*M+E*E),M/=rt,E/=rt,M*=y,E*=y,f.push(w-M*B,v-E*B),f.push(w+M*F,v+E*F),u||(o.cap==="round"?g+=re(w-M*(B-F)*.5,v-E*(B-F)*.5,w-M*B,v-E*B,w+M*F,v+E*F,f,!1)+2:o.cap==="square"&&(g+=za(w,v,M,E,B,F,!1,f)));const wt=Na*Na;for(let H=p;H<g+p-2;++H)b=f[H*2],C=f[H*2+1],w=f[(H+1)*2],v=f[(H+1)*2+1],T=f[(H+2)*2],k=f[(H+2)*2+1],!(Math.abs(b*(v-k)+w*(k-C)+T*(C-v))<wt)&&r.push(H,H+1,H+2)}function tp(s,t,e,i){const n=dl;if(s.length===0)return;const r=s[0],a=s[1],o=s[s.length-2],h=s[s.length-1],l=t||Math.abs(r-o)<n&&Math.abs(a-h)<n,c=e,u=s.length/2,d=c.length/2;for(let f=0;f<u;f++)c.push(s[f*2]),c.push(s[f*2+1]);for(let f=0;f<u-1;f++)i.push(d+f,d+f+1);l&&i.push(d+u-1,d)}function fl(s,t,e,i,n,r,a){const o=Nd(s,t,2);if(!o)return;for(let l=0;l<o.length;l+=3)r[a++]=o[l]+n,r[a++]=o[l+1]+n,r[a++]=o[l+2]+n;let h=n*i;for(let l=0;l<s.length;l+=2)e[h]=s[l],e[h+1]=s[l+1],h+=i}const ep=[],sp={extension:{type:R.ShapeBuilder,name:"polygon"},build(s,t){for(let e=0;e<s.points.length;e++)t[e]=s.points[e];return!0},triangulate(s,t,e,i,n,r){fl(s,ep,t,e,i,n,r)}},ip={extension:{type:R.ShapeBuilder,name:"rectangle"},build(s,t){const e=s,i=e.x,n=e.y,r=e.width,a=e.height;return r>0&&a>0?(t[0]=i,t[1]=n,t[2]=i+r,t[3]=n,t[4]=i+r,t[5]=n+a,t[6]=i,t[7]=n+a,!0):!1},triangulate(s,t,e,i,n,r){let a=0;i*=e,t[i+a]=s[0],t[i+a+1]=s[1],a+=e,t[i+a]=s[2],t[i+a+1]=s[3],a+=e,t[i+a]=s[6],t[i+a+1]=s[7],a+=e,t[i+a]=s[4],t[i+a+1]=s[5],a+=e;const o=i/e;n[r++]=o,n[r++]=o+1,n[r++]=o+2,n[r++]=o+1,n[r++]=o+3,n[r++]=o+2}},np={extension:{type:R.ShapeBuilder,name:"triangle"},build(s,t){return t[0]=s.x,t[1]=s.y,t[2]=s.x2,t[3]=s.y2,t[4]=s.x3,t[5]=s.y3,!0},triangulate(s,t,e,i,n,r){let a=0;i*=e,t[i+a]=s[0],t[i+a+1]=s[1],a+=e,t[i+a]=s[2],t[i+a+1]=s[3],a+=e,t[i+a]=s[4],t[i+a+1]=s[5];const o=i/e;n[r++]=o,n[r++]=o+1,n[r++]=o+2}},rp=new N,ap=new K;function op(s,t,e,i){const n=t.matrix?s.copyFrom(t.matrix).invert():s.identity();if(t.textureSpace==="local"){const a=e.getBounds(ap);t.width&&a.pad(t.width);const{x:o,y:h}=a,l=1/a.width,c=1/a.height,u=-o*l,d=-h*c,f=n.a,m=n.b,g=n.c,p=n.d;n.a*=l,n.b*=l,n.c*=c,n.d*=c,n.tx=u*f+d*g+n.tx,n.ty=u*m+d*p+n.ty}else n.translate(t.texture.frame.x,t.texture.frame.y),n.scale(1/t.texture.source.width,1/t.texture.source.height);const r=t.texture.source.style;return!(t.fill instanceof Gt)&&r.addressMode==="clamp-to-edge"&&(r.addressMode="repeat",r.update()),i&&n.append(rp.copyFrom(i).invert()),n}const Ci={};Y.handleByMap(R.ShapeBuilder,Ci);Y.add(ip,sp,np,Ss,qf,Zf);const hp=new K,lp=new N;function cp(s,t){const{geometryData:e,batches:i}=t;i.length=0,e.indices.length=0,e.vertices.length=0,e.uvs.length=0;for(let n=0;n<s.instructions.length;n++){const r=s.instructions[n];if(r.action==="texture")up(r.data,i,e);else if(r.action==="fill"||r.action==="stroke"){const a=r.action==="stroke",o=r.data.path.shapePath,h=r.data.style,l=r.data.hole;a&&l&&Ua(l.shapePath,h,!0,i,e),l&&(o.shapePrimitives[o.shapePrimitives.length-1].holes=l.shapePath.shapePrimitives),Ua(o,h,a,i,e)}}}function up(s,t,e){const i=[],n=Ci.rectangle,r=hp;r.x=s.dx,r.y=s.dy,r.width=s.dw,r.height=s.dh;const a=s.transform;if(!n.build(r,i))return;const{vertices:o,uvs:h,indices:l}=e,c=l.length,u=o.length/2;a&&cl(i,a),n.triangulate(i,o,2,u,l,c);const d=s.image,f=d.uvs;h.push(f.x0,f.y0,f.x1,f.y1,f.x3,f.y3,f.x2,f.y2);const m=Bt.get(ul);m.indexOffset=c,m.indexSize=l.length-c,m.attributeOffset=u,m.attributeSize=o.length/2-u,m.baseColor=s.style,m.alpha=s.alpha,m.texture=d,m.geometryData=e,t.push(m)}function Ua(s,t,e,i,n){const{vertices:r,uvs:a,indices:o}=n;s.shapePrimitives.forEach(({shape:h,transform:l,holes:c})=>{const u=[],d=Ci[h.type];if(!d.build(h,u))return;const f=o.length,m=r.length/2;let g="triangle-list";if(l&&cl(u,l),e){const _=h.closePath??!0,b=t;b.pixelLine?(tp(u,_,r,o),g="line-list"):Jf(u,b,!1,_,r,o)}else if(c){const _=[],b=u.slice();dp(c).forEach(w=>{_.push(b.length/2),b.push(...w)}),fl(b,_,r,2,m,o,f)}else d.triangulate(u,r,2,m,o,f);const p=a.length/2,y=t.texture;if(y!==D.WHITE){const _=op(lp,t,h,l);jf(r,2,m,a,p,2,r.length/2-m,_)}else Xf(a,p,2,r.length/2-m);const x=Bt.get(ul);x.indexOffset=f,x.indexSize=o.length-f,x.attributeOffset=m,x.attributeSize=r.length/2-m,x.baseColor=t.color,x.alpha=t.alpha,x.texture=y,x.geometryData=n,x.topology=g,i.push(x)})}function dp(s){const t=[];for(let e=0;e<s.length;e++){const i=s[e].shape,n=[];Ci[i.type].build(i,n)&&t.push(n)}return t}class fp{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class pp{constructor(){this.instructions=new xh}init(t){this.batcher=new Yf({maxTextures:t}),this.instructions.reset()}get geometry(){return V(ru,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const ur=class In{constructor(t){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._renderer=t,t.renderableGC.addManagedHash(this,"_gpuContextHash"),t.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(t){In.defaultOptions.bezierSmoothness=(t==null?void 0:t.bezierSmoothness)??In.defaultOptions.bezierSmoothness}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){e?this._cleanGraphicsContextData(t):e=this._initContext(t),cp(t,e);const i=t.batchMode;t.customShader||i==="no-batch"?e.isBatchable=!1:i==="auto"?e.isBatchable=e.geometryData.vertices.length<400:e.isBatchable=!0,t.dirty=!1}return e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_initContextRenderData(t){const e=Bt.get(pp,{maxTextures:this._renderer.limits.maxBatchableTextures}),{batches:i,geometryData:n}=this._gpuContextHash[t.uid],r=n.vertices.length,a=n.indices.length;for(let c=0;c<i.length;c++)i[c].applyTransform=!1;const o=e.batcher;o.ensureAttributeBuffer(r),o.ensureIndexBuffer(a),o.begin();for(let c=0;c<i.length;c++){const u=i[c];o.add(u)}o.finish(e.instructions);const h=o.geometry;h.indexBuffer.setDataWithSize(o.indexBuffer,o.indexSize,!0),h.buffers[0].setDataWithSize(o.attributeBuffer.float32View,o.attributeSize,!0);const l=o.batches;for(let c=0;c<l.length;c++){const u=l[c];u.bindGroup=ef(u.textures.textures,u.textures.count,this._renderer.limits.maxBatchableTextures)}return this._graphicsDataContextHash[t.uid]=e,e}_initContext(t){const e=new fp;return e.context=t,this._gpuContextHash[t.uid]=e,t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(Bt.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach(i=>{Bt.return(i)})}destroy(){for(const t in this._gpuContextHash)this._gpuContextHash[t]&&this.onGraphicsContextDestroy(this._gpuContextHash[t].context)}};ur.extension={type:[R.WebGLSystem,R.WebGPUSystem,R.CanvasSystem],name:"graphicsContext"};ur.defaultOptions={bezierSmoothness:.5};let pl=ur;const mp=8,qs=11920929e-14,gp=1;function ml(s,t,e,i,n,r,a,o,h,l){const u=Math.min(.99,Math.max(0,l??pl.defaultOptions.bezierSmoothness));let d=(gp-u)/1;return d*=d,yp(t,e,i,n,r,a,o,h,s,d),s}function yp(s,t,e,i,n,r,a,o,h,l){Fn(s,t,e,i,n,r,a,o,h,l,0),h.push(a,o)}function Fn(s,t,e,i,n,r,a,o,h,l,c){if(c>mp)return;const u=(s+e)/2,d=(t+i)/2,f=(e+n)/2,m=(i+r)/2,g=(n+a)/2,p=(r+o)/2,y=(u+f)/2,x=(d+m)/2,_=(f+g)/2,b=(m+p)/2,C=(y+_)/2,w=(x+b)/2;if(c>0){let v=a-s,T=o-t;const k=Math.abs((e-a)*T-(i-o)*v),M=Math.abs((n-a)*T-(r-o)*v);if(k>qs&&M>qs){if((k+M)*(k+M)<=l*(v*v+T*T)){h.push(C,w);return}}else if(k>qs){if(k*k<=l*(v*v+T*T)){h.push(C,w);return}}else if(M>qs){if(M*M<=l*(v*v+T*T)){h.push(C,w);return}}else if(v=C-(s+a)/2,T=w-(t+o)/2,v*v+T*T<=l){h.push(C,w);return}}Fn(s,t,u,d,y,x,C,w,h,l,c+1),Fn(C,w,_,b,g,p,a,o,h,l,c+1)}const xp=8,_p=11920929e-14,bp=1;function wp(s,t,e,i,n,r,a,o){const l=Math.min(.99,Math.max(0,o??pl.defaultOptions.bezierSmoothness));let c=(bp-l)/1;return c*=c,vp(t,e,i,n,r,a,s,c),s}function vp(s,t,e,i,n,r,a,o){Bn(a,s,t,e,i,n,r,o,0),a.push(n,r)}function Bn(s,t,e,i,n,r,a,o,h){if(h>xp)return;const l=(t+i)/2,c=(e+n)/2,u=(i+r)/2,d=(n+a)/2,f=(l+u)/2,m=(c+d)/2;let g=r-t,p=a-e;const y=Math.abs((i-r)*p-(n-a)*g);if(y>_p){if(y*y<=o*(g*g+p*p)){s.push(f,m);return}}else if(g=f-(t+r)/2,p=m-(e+a)/2,g*g+p*p<=o){s.push(f,m);return}Bn(s,t,e,l,c,f,m,o,h+1),Bn(s,f,m,u,d,r,a,o,h+1)}function gl(s,t,e,i,n,r,a,o){let h=Math.abs(n-r);(!a&&n>r||a&&r>n)&&(h=2*Math.PI-h),o||(o=Math.max(6,Math.floor(6*Math.pow(i,1/3)*(h/Math.PI)))),o=Math.max(o,3);let l=h/o,c=n;l*=a?-1:1;for(let u=0;u<o+1;u++){const d=Math.cos(c),f=Math.sin(c),m=t+d*i,g=e+f*i;s.push(m,g),c+=l}}function Cp(s,t,e,i,n,r){const a=s[s.length-2],h=s[s.length-1]-e,l=a-t,c=n-e,u=i-t,d=Math.abs(h*u-l*c);if(d<1e-8||r===0){(s[s.length-2]!==t||s[s.length-1]!==e)&&s.push(t,e);return}const f=h*h+l*l,m=c*c+u*u,g=h*c+l*u,p=r*Math.sqrt(f)/d,y=r*Math.sqrt(m)/d,x=p*g/f,_=y*g/m,b=p*u+y*l,C=p*c+y*h,w=l*(y+x),v=h*(y+x),T=u*(p+_),k=c*(p+_),M=Math.atan2(v-C,w-b),E=Math.atan2(k-C,T-b);gl(s,b+t,C+e,r,M,E,l*c>u*h)}const ys=Math.PI*2,nn={centerX:0,centerY:0,ang1:0,ang2:0},rn=({x:s,y:t},e,i,n,r,a,o,h)=>{s*=e,t*=i;const l=n*s-r*t,c=r*s+n*t;return h.x=l+a,h.y=c+o,h};function Sp(s,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),i=t===1.5707963267948966?.551915024494:e,n=Math.cos(s),r=Math.sin(s),a=Math.cos(s+t),o=Math.sin(s+t);return[{x:n-r*i,y:r+n*i},{x:a+o*i,y:o-a*i},{x:a,y:o}]}const Ga=(s,t,e,i)=>{const n=s*i-t*e<0?-1:1;let r=s*e+t*i;return r>1&&(r=1),r<-1&&(r=-1),n*Math.acos(r)},Ap=(s,t,e,i,n,r,a,o,h,l,c,u,d)=>{const f=Math.pow(n,2),m=Math.pow(r,2),g=Math.pow(c,2),p=Math.pow(u,2);let y=f*m-f*p-m*g;y<0&&(y=0),y/=f*p+m*g,y=Math.sqrt(y)*(a===o?-1:1);const x=y*n/r*u,_=y*-r/n*c,b=l*x-h*_+(s+e)/2,C=h*x+l*_+(t+i)/2,w=(c-x)/n,v=(u-_)/r,T=(-c-x)/n,k=(-u-_)/r,M=Ga(1,0,w,v);let E=Ga(w,v,T,k);o===0&&E>0&&(E-=ys),o===1&&E<0&&(E+=ys),d.centerX=b,d.centerY=C,d.ang1=M,d.ang2=E};function Tp(s,t,e,i,n,r,a,o=0,h=0,l=0){if(r===0||a===0)return;const c=Math.sin(o*ys/360),u=Math.cos(o*ys/360),d=u*(t-i)/2+c*(e-n)/2,f=-c*(t-i)/2+u*(e-n)/2;if(d===0&&f===0)return;r=Math.abs(r),a=Math.abs(a);const m=Math.pow(d,2)/Math.pow(r,2)+Math.pow(f,2)/Math.pow(a,2);m>1&&(r*=Math.sqrt(m),a*=Math.sqrt(m)),Ap(t,e,i,n,r,a,h,l,c,u,d,f,nn);let{ang1:g,ang2:p}=nn;const{centerX:y,centerY:x}=nn;let _=Math.abs(p)/(ys/4);Math.abs(1-_)<1e-7&&(_=1);const b=Math.max(Math.ceil(_),1);p/=b;let C=s[s.length-2],w=s[s.length-1];const v={x:0,y:0};for(let T=0;T<b;T++){const k=Sp(g,p),{x:M,y:E}=rn(k[0],r,a,u,c,y,x,v),{x:U,y:L}=rn(k[1],r,a,u,c,y,x,v),{x:rt,y:Yt}=rn(k[2],r,a,u,c,y,x,v);ml(s,C,w,M,E,U,L,rt,Yt),C=rt,w=Yt,g+=p}}function Pp(s,t,e){const i=(a,o)=>{const h=o.x-a.x,l=o.y-a.y,c=Math.sqrt(h*h+l*l),u=h/c,d=l/c;return{len:c,nx:u,ny:d}},n=(a,o)=>{a===0?s.moveTo(o.x,o.y):s.lineTo(o.x,o.y)};let r=t[t.length-1];for(let a=0;a<t.length;a++){const o=t[a%t.length],h=o.radius??e;if(h<=0){n(a,o),r=o;continue}const l=t[(a+1)%t.length],c=i(o,r),u=i(o,l);if(c.len<1e-4||u.len<1e-4){n(a,o),r=o;continue}let d=Math.asin(c.nx*u.ny-c.ny*u.nx),f=1,m=!1;c.nx*u.nx-c.ny*-u.ny<0?d<0?d=Math.PI+d:(d=Math.PI-d,f=-1,m=!0):d>0&&(f=-1,m=!0);const g=d/2;let p,y=Math.abs(Math.cos(g)*h/Math.sin(g));y>Math.min(c.len/2,u.len/2)?(y=Math.min(c.len/2,u.len/2),p=Math.abs(y*Math.sin(g)/Math.cos(g))):p=h;const x=o.x+u.nx*y+-u.ny*p*f,_=o.y+u.ny*y+u.nx*p*f,b=Math.atan2(c.ny,c.nx)+Math.PI/2*f,C=Math.atan2(u.ny,u.nx)-Math.PI/2*f;a===0&&s.moveTo(x+Math.cos(b)*p,_+Math.sin(b)*p),s.arc(x,_,p,b,C,m),r=o}}function Mp(s,t,e,i){const n=(o,h)=>Math.sqrt((o.x-h.x)**2+(o.y-h.y)**2),r=(o,h,l)=>({x:o.x+(h.x-o.x)*l,y:o.y+(h.y-o.y)*l}),a=t.length;for(let o=0;o<a;o++){const h=t[(o+1)%a],l=h.radius??e;if(l<=0){o===0?s.moveTo(h.x,h.y):s.lineTo(h.x,h.y);continue}const c=t[o],u=t[(o+2)%a],d=n(c,h);let f;if(d<1e-4)f=h;else{const p=Math.min(d/2,l);f=r(h,c,p/d)}const m=n(u,h);let g;if(m<1e-4)g=h;else{const p=Math.min(m/2,l);g=r(h,u,p/m)}o===0?s.moveTo(f.x,f.y):s.lineTo(f.x,f.y),s.quadraticCurveTo(h.x,h.y,g.x,g.y,i)}}const Ep=new K;class kp{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Tt,this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const i=this._currentPoly.points,n=i[i.length-2],r=i[i.length-1];return(n!==t||r!==e)&&i.push(t,e),this}arc(t,e,i,n,r,a){this._ensurePoly(!1);const o=this._currentPoly.points;return gl(o,t,e,i,n,r,a),this}arcTo(t,e,i,n,r){this._ensurePoly();const a=this._currentPoly.points;return Cp(a,t,e,i,n,r),this}arcToSvg(t,e,i,n,r,a,o){const h=this._currentPoly.points;return Tp(h,this._currentPoly.lastX,this._currentPoly.lastY,a,o,t,e,i,n,r),this}bezierCurveTo(t,e,i,n,r,a,o){this._ensurePoly();const h=this._currentPoly;return ml(this._currentPoly.points,h.lastX,h.lastY,t,e,i,n,r,a,o),this}quadraticCurveTo(t,e,i,n,r){this._ensurePoly();const a=this._currentPoly;return wp(this._currentPoly.points,a.lastX,a.lastY,t,e,i,n,r),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));const i=this.shapePrimitives,n=i.length;for(let r=0;r<t.instructions.length;r++){const a=t.instructions[r];this[a.action](...a.data)}if(t.checkForHoles&&i.length-n>1){let r=null;for(let a=n;a<i.length;a++){const o=i[a];if(o.shape.type==="polygon"){const h=o.shape,l=r==null?void 0:r.shape;l&&l.containsPolygon(h)?(r.holes||(r.holes=[]),r.holes.push(o),i.copyWithin(a,a+1),i.length--,a--):r=o}}}return this}finish(t=!1){this.endPoly(t)}rect(t,e,i,n,r){return this.drawShape(new K(t,e,i,n),r),this}circle(t,e,i,n){return this.drawShape(new hr(t,e,i),n),this}poly(t,e,i){const n=new gs(t);return n.closePath=e,this.drawShape(n,i),this}regularPoly(t,e,i,n,r=0,a){n=Math.max(n|0,3);const o=-1*Math.PI/2+r,h=Math.PI*2/n,l=[];for(let c=0;c<n;c++){const u=o-c*h;l.push(t+i*Math.cos(u),e+i*Math.sin(u))}return this.poly(l,!0,a),this}roundPoly(t,e,i,n,r,a=0,o){if(n=Math.max(n|0,3),r<=0)return this.regularPoly(t,e,i,n,a);const h=i*Math.sin(Math.PI/n)-.001;r=Math.min(r,h);const l=-1*Math.PI/2+a,c=Math.PI*2/n,u=(n-2)*Math.PI/n/2;for(let d=0;d<n;d++){const f=d*c+l,m=t+i*Math.cos(f),g=e+i*Math.sin(f),p=f+Math.PI+u,y=f-Math.PI-u,x=m+r*Math.cos(p),_=g+r*Math.sin(p),b=m+r*Math.cos(y),C=g+r*Math.sin(y);d===0?this.moveTo(x,_):this.lineTo(x,_),this.quadraticCurveTo(m,g,b,C,o)}return this.closePath()}roundShape(t,e,i=!1,n){return t.length<3?this:(i?Mp(this,t,e,n):Pp(this,t,e),this.closePath())}filletRect(t,e,i,n,r){if(r===0)return this.rect(t,e,i,n);const a=Math.min(i,n)/2,o=Math.min(a,Math.max(-a,r)),h=t+i,l=e+n,c=o<0?-o:0,u=Math.abs(o);return this.moveTo(t,e+u).arcTo(t+c,e+c,t+u,e,u).lineTo(h-u,e).arcTo(h-c,e+c,h,e+u,u).lineTo(h,l-u).arcTo(h-c,l-c,t+i-u,l,u).lineTo(t+u,l).arcTo(t+c,l-c,t,l-u,u).closePath()}chamferRect(t,e,i,n,r,a){if(r<=0)return this.rect(t,e,i,n);const o=Math.min(r,Math.min(i,n)/2),h=t+i,l=e+n,c=[t+o,e,h-o,e,h,e+o,h,l-o,h-o,l,t+o,l,t,l-o,t,e+o];for(let u=c.length-1;u>=2;u-=2)c[u]===c[u-2]&&c[u-1]===c[u-3]&&c.splice(u-1,2);return this.poly(c,!0,a)}ellipse(t,e,i,n,r){return this.drawShape(new lr(t,e,i,n),r),this}roundRect(t,e,i,n,r,a){return this.drawShape(new cr(t,e,i,n,r),a),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let i=this._currentPoly;return i&&this.endPoly(),i=new gs,i.points.push(t,e),this._currentPoly=i,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new gs,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let i=e.shape.x,n=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const r=e.transform,a=i;i=r.a*i+r.c*n+r.tx,n=r.b*a+r.d*n+r.ty}this._currentPoly.points.push(i,n)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const i=t.instructions[e];this[i.action](...i.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let i=0;i<e.length;i++){const n=e[i],r=n.shape.getBounds(Ep);n.transform?t.addRect(r,n.transform):t.addRect(r)}return t}}class Oe{constructor(t,e=!1){this.instructions=[],this.uid=tt("graphicsPath"),this._dirty=!0,this.checkForHoles=e,typeof t=="string"?Zd(t,this):this.instructions=(t==null?void 0:t.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new kp(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,i,n,r){const a=this.instructions[this.instructions.length-1],o=this.getLastPoint(lt.shared);let h=0,l=0;if(!a||a.action!=="bezierCurveTo")h=o.x,l=o.y;else{h=a.data[2],l=a.data[3];const c=o.x,u=o.y;h=c+(c-h),l=u+(u-l)}return this.instructions.push({action:"bezierCurveTo",data:[h,l,t,e,i,n,r]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,i){const n=this.instructions[this.instructions.length-1],r=this.getLastPoint(lt.shared);let a=0,o=0;if(!n||n.action!=="quadraticCurveTo")a=r.x,o=r.y;else{a=n.data[0],o=n.data[1];const h=r.x,l=r.y;a=h+(h-a),o=l+(l-o)}return this.instructions.push({action:"quadraticCurveTo",data:[a,o,t,e,i]}),this._dirty=!0,this}rect(t,e,i,n,r){return this.instructions.push({action:"rect",data:[t,e,i,n,r]}),this._dirty=!0,this}circle(t,e,i,n){return this.instructions.push({action:"circle",data:[t,e,i,n]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,i,n,r,a,o){r||(r=n/2);const h=-1*Math.PI/2+a,l=i*2,c=Math.PI*2/l,u=[];for(let d=0;d<l;d++){const f=d%2?r:n,m=d*c+h;u.push(t+f*Math.cos(m),e+f*Math.sin(m))}return this.poly(u,!0,o),this}clone(t=!1){const e=new Oe;if(e.checkForHoles=this.checkForHoles,!t)e.instructions=this.instructions.slice();else for(let i=0;i<this.instructions.length;i++){const n=this.instructions[i];e.instructions.push({action:n.action,data:n.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,i=t.b,n=t.c,r=t.d,a=t.tx,o=t.ty;let h=0,l=0,c=0,u=0,d=0,f=0,m=0,g=0;for(let p=0;p<this.instructions.length;p++){const y=this.instructions[p],x=y.data;switch(y.action){case"moveTo":case"lineTo":h=x[0],l=x[1],x[0]=e*h+n*l+a,x[1]=i*h+r*l+o;break;case"bezierCurveTo":c=x[0],u=x[1],d=x[2],f=x[3],h=x[4],l=x[5],x[0]=e*c+n*u+a,x[1]=i*c+r*u+o,x[2]=e*d+n*f+a,x[3]=i*d+r*f+o,x[4]=e*h+n*l+a,x[5]=i*h+r*l+o;break;case"quadraticCurveTo":c=x[0],u=x[1],h=x[2],l=x[3],x[0]=e*c+n*u+a,x[1]=i*c+r*u+o,x[2]=e*h+n*l+a,x[3]=i*h+r*l+o;break;case"arcToSvg":h=x[5],l=x[6],m=x[0],g=x[1],x[0]=e*m+n*g,x[1]=i*m+r*g,x[5]=e*h+n*l+a,x[6]=i*h+r*l+o;break;case"circle":x[4]=Qe(x[3],t);break;case"rect":x[4]=Qe(x[4],t);break;case"ellipse":x[8]=Qe(x[8],t);break;case"roundRect":x[5]=Qe(x[5],t);break;case"addPath":x[0].transform(t);break;case"poly":x[2]=Qe(x[2],t);break;default:$("unknown transform action",y.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,i=this.instructions[e];if(!i)return t.x=0,t.y=0,t;for(;i.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;i=this.instructions[e]}switch(i.action){case"moveTo":case"lineTo":t.x=i.data[0],t.y=i.data[1];break;case"quadraticCurveTo":t.x=i.data[2],t.y=i.data[3];break;case"bezierCurveTo":t.x=i.data[4],t.y=i.data[5];break;case"arc":case"arcToSvg":t.x=i.data[5],t.y=i.data[6];break;case"addPath":i.data[0].getLastPoint(t);break}return t}}function Qe(s,t){return s?s.prepend(t):t.clone()}function Z(s,t,e){const i=s.getAttribute(t);return i?Number(i):e}function Rp(s,t){const e=s.querySelectorAll("defs");for(let i=0;i<e.length;i++){const n=e[i];for(let r=0;r<n.children.length;r++){const a=n.children[r];switch(a.nodeName.toLowerCase()){case"lineargradient":t.defs[a.id]=Ip(a);break;case"radialgradient":t.defs[a.id]=Fp();break}}}}function Ip(s){const t=Z(s,"x1",0),e=Z(s,"y1",0),i=Z(s,"x2",1),n=Z(s,"y2",0),r=s.getAttribute("gradientUnits")||"objectBoundingBox",a=new Gt(t,e,i,n,r==="objectBoundingBox"?"local":"global");for(let o=0;o<s.children.length;o++){const h=s.children[o],l=Z(h,"offset",0),c=et.shared.setValue(h.getAttribute("stop-color")).toNumber();a.addColorStop(l,c)}return a}function Fp(s){return $("[SVG Parser] Radial gradients are not yet supported"),new Gt(0,0,1,0)}function Wa(s){const t=s.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}const Ha={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function yl(s,t){const e=s.getAttribute("style"),i={},n={},r={strokeStyle:i,fillStyle:n,useFill:!1,useStroke:!1};for(const a in Ha){const o=s.getAttribute(a);o&&$a(t,r,a,o.trim())}if(e){const a=e.split(";");for(let o=0;o<a.length;o++){const h=a[o].trim(),[l,c]=h.split(":");Ha[l]&&$a(t,r,l,c.trim())}}return{strokeStyle:r.useStroke?i:null,fillStyle:r.useFill?n:null,useFill:r.useFill,useStroke:r.useStroke}}function $a(s,t,e,i){switch(e){case"stroke":if(i!=="none"){if(i.startsWith("url(")){const n=Wa(i);t.strokeStyle.fill=s.defs[n]}else t.strokeStyle.color=et.shared.setValue(i).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(i);break;case"fill":if(i!=="none"){if(i.startsWith("url(")){const n=Wa(i);t.fillStyle.fill=s.defs[n]}else t.fillStyle.color=et.shared.setValue(i).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(i);break;case"stroke-opacity":t.strokeStyle.alpha=Number(i);break;case"opacity":t.fillStyle.alpha=Number(i),t.strokeStyle.alpha=Number(i);break}}function Bp(s,t){if(typeof s=="string"){const a=document.createElement("div");a.innerHTML=s.trim(),s=a.querySelector("svg")}const e={context:t,defs:{},path:new Oe};Rp(s,e);const i=s.children,{fillStyle:n,strokeStyle:r}=yl(s,e);for(let a=0;a<i.length;a++){const o=i[a];o.nodeName.toLowerCase()!=="defs"&&xl(o,e,n,r)}return t}function xl(s,t,e,i){const n=s.children,{fillStyle:r,strokeStyle:a}=yl(s,t);r&&e?e={...e,...r}:r&&(e=r),a&&i?i={...i,...a}:a&&(i=a);const o=!e&&!i;o&&(e={color:0});let h,l,c,u,d,f,m,g,p,y,x,_,b,C,w,v,T;switch(s.nodeName.toLowerCase()){case"path":C=s.getAttribute("d"),s.getAttribute("fill-rule")==="evenodd"&&$("SVG Evenodd fill rule not supported, your svg may render incorrectly"),w=new Oe(C,!0),t.context.path(w),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"circle":m=Z(s,"cx",0),g=Z(s,"cy",0),p=Z(s,"r",0),t.context.ellipse(m,g,p,p),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"rect":h=Z(s,"x",0),l=Z(s,"y",0),v=Z(s,"width",0),T=Z(s,"height",0),y=Z(s,"rx",0),x=Z(s,"ry",0),y||x?t.context.roundRect(h,l,v,T,y||x):t.context.rect(h,l,v,T),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"ellipse":m=Z(s,"cx",0),g=Z(s,"cy",0),y=Z(s,"rx",0),x=Z(s,"ry",0),t.context.beginPath(),t.context.ellipse(m,g,y,x),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"line":c=Z(s,"x1",0),u=Z(s,"y1",0),d=Z(s,"x2",0),f=Z(s,"y2",0),t.context.beginPath(),t.context.moveTo(c,u),t.context.lineTo(d,f),i&&t.context.stroke(i);break;case"polygon":b=s.getAttribute("points"),_=b.match(/\d+/g).map(k=>parseInt(k,10)),t.context.poly(_,!0),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"polyline":b=s.getAttribute("points"),_=b.match(/\d+/g).map(k=>parseInt(k,10)),t.context.poly(_,!1),i&&t.context.stroke(i);break;case"g":case"svg":break;default:{$(`[SVG parser] <${s.nodeName}> elements unsupported`);break}}o&&(e=null);for(let k=0;k<n.length;k++)xl(n[k],t,e,i)}function Lp(s){return et.isColorLike(s)}function Ya(s){return s instanceof vi}function ja(s){return s instanceof Gt}function Op(s){return s instanceof D}function Vp(s,t,e){const i=et.shared.setValue(t??0);return s.color=i.toNumber(),s.alpha=i.alpha===1?e.alpha:i.alpha,s.texture=D.WHITE,{...e,...s}}function Dp(s,t,e){return s.texture=t,{...e,...s}}function Xa(s,t,e){return s.fill=t,s.color=16777215,s.texture=t.texture,s.matrix=t.transform,{...e,...s}}function Ka(s,t,e){return t.buildGradient(),s.fill=t,s.color=16777215,s.texture=t.texture,s.matrix=t.transform,s.textureSpace=t.textureSpace,{...e,...s}}function Np(s,t){const e={...t,...s},i=et.shared.setValue(e.color);return e.alpha*=i.alpha,e.color=i.toNumber(),e}function de(s,t){if(s==null)return null;const e={},i=s;return Lp(s)?Vp(e,s,t):Op(s)?Dp(e,s,t):Ya(s)?Xa(e,s,t):ja(s)?Ka(e,s,t):i.fill&&Ya(i.fill)?Xa(i,i.fill,t):i.fill&&ja(i.fill)?Ka(i,i.fill,t):Np(i,t)}function ci(s,t){const{width:e,alignment:i,miterLimit:n,cap:r,join:a,pixelLine:o,...h}=t,l=de(s,h);return l?{width:e,alignment:i,miterLimit:n,cap:r,join:a,pixelLine:o,...l}:null}const zp=new lt,qa=new N,dr=class It extends ct{constructor(){super(...arguments),this.uid=tt("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new Oe,this._transform=new N,this._fillStyle={...It.defaultFillStyle},this._strokeStyle={...It.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new Tt,this._boundsDirty=!0}clone(){const t=new It;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=de(t,It.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=ci(t,It.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=de(t,It.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=de(t,It.defaultStrokeStyle),this}texture(t,e,i,n,r,a){return this.instructions.push({action:"texture",data:{image:t,dx:i||0,dy:n||0,dw:r||t.frame.width,dh:a||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?et.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new Oe,this}fill(t,e){let i;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n&&n.action==="stroke"?i=n.data.path:i=this._activePath.clone(),i?(t!=null&&(e!==void 0&&typeof t=="number"&&(V(W,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=de(t,It.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:i}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(lt.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const i=this.instructions[this.instructions.length-1];return this._tick===0&&i&&i.action==="fill"?e=i.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=ci(t,It.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],i=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(i);else{e.data.hole=i;break}}return this._initNextPathLocation(),this}arc(t,e,i,n,r,a){this._tick++;const o=this._transform;return this._activePath.arc(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,i,n,r,a),this}arcTo(t,e,i,n,r){this._tick++;const a=this._transform;return this._activePath.arcTo(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,a.a*i+a.c*n+a.tx,a.b*i+a.d*n+a.ty,r),this}arcToSvg(t,e,i,n,r,a,o){this._tick++;const h=this._transform;return this._activePath.arcToSvg(t,e,i,n,r,h.a*a+h.c*o+h.tx,h.b*a+h.d*o+h.ty),this}bezierCurveTo(t,e,i,n,r,a,o){this._tick++;const h=this._transform;return this._activePath.bezierCurveTo(h.a*t+h.c*e+h.tx,h.b*t+h.d*e+h.ty,h.a*i+h.c*n+h.tx,h.b*i+h.d*n+h.ty,h.a*r+h.c*a+h.tx,h.b*r+h.d*a+h.ty,o),this}closePath(){var t;return this._tick++,(t=this._activePath)==null||t.closePath(),this}ellipse(t,e,i,n){return this._tick++,this._activePath.ellipse(t,e,i,n,this._transform.clone()),this}circle(t,e,i){return this._tick++,this._activePath.circle(t,e,i,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const i=this._transform;return this._activePath.lineTo(i.a*t+i.c*e+i.tx,i.b*t+i.d*e+i.ty),this}moveTo(t,e){this._tick++;const i=this._transform,n=this._activePath.instructions,r=i.a*t+i.c*e+i.tx,a=i.b*t+i.d*e+i.ty;return n.length===1&&n[0].action==="moveTo"?(n[0].data[0]=r,n[0].data[1]=a,this):(this._activePath.moveTo(r,a),this)}quadraticCurveTo(t,e,i,n,r){this._tick++;const a=this._transform;return this._activePath.quadraticCurveTo(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,a.a*i+a.c*n+a.tx,a.b*i+a.d*n+a.ty,r),this}rect(t,e,i,n){return this._tick++,this._activePath.rect(t,e,i,n,this._transform.clone()),this}roundRect(t,e,i,n,r){return this._tick++,this._activePath.roundRect(t,e,i,n,r,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,i,n,r=0,a){return this._tick++,this._activePath.regularPoly(t,e,i,n,r,a),this}roundPoly(t,e,i,n,r,a){return this._tick++,this._activePath.roundPoly(t,e,i,n,r,a),this}roundShape(t,e,i,n){return this._tick++,this._activePath.roundShape(t,e,i,n),this}filletRect(t,e,i,n,r){return this._tick++,this._activePath.filletRect(t,e,i,n,r),this}chamferRect(t,e,i,n,r,a){return this._tick++,this._activePath.chamferRect(t,e,i,n,r,a),this}star(t,e,i,n,r=0,a=0){return this._tick++,this._activePath.star(t,e,i,n,r,a,this._transform.clone()),this}svg(t){return this._tick++,Bp(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,i,n,r,a){return t instanceof N?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,i,n,r,a),this)}transform(t,e,i,n,r,a){return t instanceof N?(this._transform.append(t),this):(qa.set(t,e,i,n,r,a),this._transform.append(qa),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const i=this.instructions[e],n=i.action;if(n==="fill"){const r=i.data;t.addBounds(r.path.bounds)}else if(n==="texture"){const r=i.data;t.addFrame(r.dx,r.dy,r.dx+r.dw,r.dy+r.dh,r.transform)}if(n==="stroke"){const r=i.data,a=r.style.alignment,o=r.style.width*(1-a),h=r.path.bounds;t.addFrame(h.minX-o,h.minY-o,h.maxX+o,h.maxY+o)}}return t}containsPoint(t){var n;if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let i=!1;for(let r=0;r<e.length;r++){const a=e[r],o=a.data,h=o.path;if(!a.action||!h)continue;const l=o.style,c=h.shapePath.shapePrimitives;for(let u=0;u<c.length;u++){const d=c[u].shape;if(!l||!d)continue;const f=c[u].transform,m=f?f.applyInverse(t,zp):t;if(a.action==="fill")i=d.contains(m.x,m.y);else{const p=l;i=d.strokeContains(m.x,m.y,p.width,p.alignment)}const g=o.hole;if(g){const p=(n=g.shapePath)==null?void 0:n.shapePrimitives;if(p)for(let y=0;y<p.length;y++)p[y].shape.contains(m.x,m.y)&&(i=!1)}if(i)return!0}}return i}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(i),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(i)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};dr.defaultFillStyle={color:16777215,alpha:1,texture:D.WHITE,matrix:null,fill:null,textureSpace:"local"};dr.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:D.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let yt=dr;const Za=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function Up(s){const t=[];let e=0;for(let i=0;i<Za.length;i++){const n=`_${Za[i]}`;t[e++]=s[n]}return e=_l(s._fill,t,e),e=Wp(s._stroke,t,e),e=Hp(s.dropShadow,t,e),e=Gp(s.filters,t,e),t.join("-")}function Gp(s,t,e){if(!s)return e;for(const i of s)t[e++]=i.uid;return e}function _l(s,t,e){var i;return s&&(t[e++]=s.color,t[e++]=s.alpha,t[e++]=(i=s.fill)==null?void 0:i.styleKey),e}function Wp(s,t,e){return s&&(e=_l(s,t,e),t[e++]=s.width,t[e++]=s.alignment,t[e++]=s.cap,t[e++]=s.join,t[e++]=s.miterLimit),e}function Hp(s,t,e){return s&&(t[e++]=s.alpha,t[e++]=s.angle,t[e++]=s.blur,t[e++]=s.distance,t[e++]=et.shared.setValue(s.color).toNumber()),e}const fr=class Ae extends ct{constructor(t={}){super(),$p(t);const e={...Ae.defaultTextStyle,...t};for(const i in e){const n=i;this[n]=e[i]}this.update()}get align(){return this._align}set align(t){this._align=t,this.update()}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords=t,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(t){t!==null&&typeof t=="object"?this._dropShadow=this._createProxy({...Ae.defaultDropShadow,...t}):this._dropShadow=t?this._createProxy({...Ae.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t,this.update()}get fontSize(){return this._fontSize}set fontSize(t){typeof t=="string"?this._fontSize=parseInt(t,10):this._fontSize=t,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t,this.update()}get leading(){return this._leading}set leading(t){this._leading=t,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing=t,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t,this.update()}get padding(){return this._padding}set padding(t){this._padding=t,this.update()}get filters(){return this._filters}set filters(t){this._filters=t,this.update()}get trim(){return this._trim}set trim(t){this._trim=t,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace=t,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap=t,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth=t,this.update()}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._isFillStyle(t)&&(this._originalFill=this._createProxy({...yt.defaultFillStyle,...t},()=>{this._fill=de({...this._originalFill},yt.defaultFillStyle)})),this._fill=de(t===0?"black":t,yt.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._isFillStyle(t)&&(this._originalStroke=this._createProxy({...yt.defaultStrokeStyle,...t},()=>{this._stroke=ci({...this._originalStroke},yt.defaultStrokeStyle)})),this._stroke=ci(t,yt.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=Up(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const t=Ae.defaultTextStyle;for(const e in t)this[e]=t[e]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new Ae({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let t=0;if(this._filters)for(let e=0;e<this._filters.length;e++)t+=this._filters[e].padding;return Math.max(this._padding,t)}destroy(t=!1){var i,n,r,a;if(this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const o=typeof t=="boolean"?t:t==null?void 0:t.textureSource;(i=this._fill)!=null&&i.texture&&this._fill.texture.destroy(o),(n=this._originalFill)!=null&&n.texture&&this._originalFill.texture.destroy(o),(r=this._stroke)!=null&&r.texture&&this._stroke.texture.destroy(o),(a=this._originalStroke)!=null&&a.texture&&this._originalStroke.texture.destroy(o)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(t,e){return new Proxy(t,{set:(i,n,r)=>(i[n]=r,e==null||e(n,r),this.update(),!0)})}_isFillStyle(t){return(t??null)!==null&&!(et.isColorLike(t)||t instanceof Gt||t instanceof vi)}};fr.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};fr.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Ve=fr;function $p(s){const t=s;if(typeof t.dropShadow=="boolean"&&t.dropShadow){const e=Ve.defaultDropShadow;s.dropShadow={alpha:t.dropShadowAlpha??e.alpha,angle:t.dropShadowAngle??e.angle,blur:t.dropShadowBlur??e.blur,color:t.dropShadowColor??e.color,distance:t.dropShadowDistance??e.distance}}if(t.strokeThickness!==void 0){V(W,"strokeThickness is now a part of stroke");const e=t.stroke;let i={};if(et.isColorLike(e))i.color=e;else if(e instanceof Gt||e instanceof vi)i.fill=e;else if(Object.hasOwnProperty.call(e,"color")||Object.hasOwnProperty.call(e,"fill"))i=e;else throw new Error("Invalid stroke value.");s.stroke={...i,width:t.strokeThickness}}if(Array.isArray(t.fillGradientStops)){V(W,"gradient fill is now a fill pattern: `new FillGradient(...)`");let e;s.fontSize==null?s.fontSize=Ve.defaultTextStyle.fontSize:typeof s.fontSize=="string"?e=parseInt(s.fontSize,10):e=s.fontSize;const i=new Gt({start:{x:0,y:0},end:{x:0,y:(e||0)*1.7}}),n=t.fillGradientStops.map(r=>et.shared.setValue(r).toNumber());n.forEach((r,a)=>{const o=a/(n.length-1);i.addColorStop(o,r)}),s.fill={fill:i}}}class Yp{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,e){const i=q.get().createCanvas();i.width=t,i.height=e;const n=i.getContext("2d");return{canvas:i,context:n}}getOptimalCanvasAndContext(t,e,i=1){t=Math.ceil(t*i-1e-6),e=Math.ceil(e*i-1e-6),t=Ie(t),e=Ie(e);const n=(t<<17)+(e<<1);this._canvasPool[n]||(this._canvasPool[n]=[]);let r=this._canvasPool[n].pop();return r||(r=this._createCanvasAndContext(t,e)),r}returnCanvasAndContext(t){const e=t.canvas,{width:i,height:n}=e,r=(i<<17)+(n<<1);t.context.resetTransform(),t.context.clearRect(0,0,i,n),this._canvasPool[r].push(t)}clear(){this._canvasPool={}}}const ui=new Yp,Qa=1e5;function di(s,t,e,i=0){if(s.texture===D.WHITE&&!s.fill)return et.shared.setValue(s.color).setAlpha(s.alpha??1).toHexa();if(s.fill){if(s.fill instanceof vi){const n=s.fill,r=t.createPattern(n.texture.source.resource,"repeat"),a=n.transform.copyTo(N.shared);return a.scale(n.texture.frame.width,n.texture.frame.height),r.setTransform(a),r}else if(s.fill instanceof Gt){const n=s.fill,r=n.type==="linear",a=n.textureSpace==="local";let o=1,h=1;a&&e&&(o=e.width+i,h=e.height+i);let l,c=!1;if(r){const{start:u,end:d}=n;l=t.createLinearGradient(u.x*o,u.y*h,d.x*o,d.y*h),c=Math.abs(d.x-u.x)<Math.abs((d.y-u.y)*.1)}else{const{center:u,innerRadius:d,outerCenter:f,outerRadius:m}=n;l=t.createRadialGradient(u.x*o,u.y*h,d*o,f.x*o,f.y*h,m*o)}if(c&&a&&e){const u=e.lineHeight/h;for(let d=0;d<e.lines.length;d++){const f=(d*e.lineHeight+i/2)/h;n.colorStops.forEach(m=>{const g=f+m.offset*u;l.addColorStop(Math.floor(g*Qa)/Qa,et.shared.setValue(m.color).toHex())})}}else n.colorStops.forEach(u=>{l.addColorStop(u.offset,et.shared.setValue(u.color).toHex())});return l}}else{const n=t.createPattern(s.texture.source.resource,"repeat"),r=s.matrix.copyTo(N.shared);return r.scale(s.texture.frame.width,s.texture.frame.height),n.setTransform(r),n}return $("FillStyle not recognised",s),"red"}const bl=class wl extends tl{constructor(t){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentMaxCharHeight=0,this._currentPageIndex=-1,this._skipKerning=!1;const e={...wl.defaultOptions,...t};this._textureSize=e.textureSize,this._mipmap=e.mipmap;const i=e.style.clone();e.overrideFill&&(i._fill.color=16777215,i._fill.alpha=1,i._fill.texture=D.WHITE,i._fill.fill=null),this.applyFillAsTint=e.overrideFill;const n=i.fontSize;i.fontSize=this.baseMeasurementFontSize;const r=li(i);e.overrideSize?i._stroke&&(i._stroke.width*=this.baseRenderedFontSize/n):i.fontSize=this.baseRenderedFontSize=n,this._style=i,this._skipKerning=e.skipKerning??!1,this.resolution=e.resolution??1,this._padding=e.padding??4,e.textureStyle&&(this._textureStyle=e.textureStyle instanceof Fe?e.textureStyle:new Fe(e.textureStyle)),this.fontMetrics=Ft.measureFont(r),this.lineHeight=i.lineHeight||this.fontMetrics.fontSize||i.fontSize}ensureCharacters(t){var p,y;const e=Ft.graphemeSegmenter(t).filter(x=>!this._currentChars.includes(x)).filter((x,_,b)=>b.indexOf(x)===_);if(!e.length)return;this._currentChars=[...this._currentChars,...e];let i;this._currentPageIndex===-1?i=this._nextPage():i=this.pages[this._currentPageIndex];let{canvas:n,context:r}=i.canvasAndContext,a=i.texture.source;const o=this._style;let h=this._currentX,l=this._currentY,c=this._currentMaxCharHeight;const u=this.baseRenderedFontSize/this.baseMeasurementFontSize,d=this._padding*u;let f=!1;const m=n.width/this.resolution,g=n.height/this.resolution;for(let x=0;x<e.length;x++){const _=e[x],b=Ft.measureText(_,o,n,!1);b.lineHeight=b.height;const C=b.width*u,w=Math.ceil((o.fontStyle==="italic"?2:1)*C),v=b.height*u,T=w+d*2,k=v+d*2;if(f=!1,_!==`
`&&_!=="\r"&&_!=="	"&&_!==" "&&(f=!0,c=Math.ceil(Math.max(k,c))),h+T>m&&(l+=c,c=k,h=0,l+c>g)){a.update();const E=this._nextPage();n=E.canvasAndContext.canvas,r=E.canvasAndContext.context,a=E.texture.source,h=0,l=0,c=0}const M=C/u-(((p=o.dropShadow)==null?void 0:p.distance)??0)-(((y=o._stroke)==null?void 0:y.width)??0);if(this.chars[_]={id:_.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:M,kerning:{}},f){this._drawGlyph(r,b,h+d,l+d,u,o);const E=a.width*u,U=a.height*u,L=new K(h/E*a.width,l/U*a.height,T/E*a.width,k/U*a.height);this.chars[_].texture=new D({source:a,frame:L}),h+=Math.ceil(T)}}a.update(),this._currentX=h,this._currentY=l,this._currentMaxCharHeight=c,this._skipKerning&&this._applyKerning(e,r)}get pageTextures(){return V(W,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(t,e){const i=this._measureCache;for(let n=0;n<t.length;n++){const r=t[n];for(let a=0;a<this._currentChars.length;a++){const o=this._currentChars[a];let h=i[r];h||(h=i[r]=e.measureText(r).width);let l=i[o];l||(l=i[o]=e.measureText(o).width);let c=e.measureText(r+o).width,u=c-(h+l);u&&(this.chars[r].kerning[o]=u),c=e.measureText(r+o).width,u=c-(h+l),u&&(this.chars[o].kerning[r]=u)}}}_nextPage(){this._currentPageIndex++;const t=this.resolution,e=ui.getOptimalCanvasAndContext(this._textureSize,this._textureSize,t);this._setupContext(e.context,this._style,t);const i=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),n=new D({source:new ye({resource:e.canvas,resolution:i,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})});this._textureStyle&&(n.source.style=this._textureStyle);const r={canvasAndContext:e,texture:n};return this.pages[this._currentPageIndex]=r,r}_setupContext(t,e,i){e.fontSize=this.baseRenderedFontSize,t.scale(i,i),t.font=li(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;const n=e._stroke,r=(n==null?void 0:n.width)??0;if(n&&(t.lineWidth=r,t.lineJoin=n.join,t.miterLimit=n.miterLimit,t.strokeStyle=di(n,t)),e._fill&&(t.fillStyle=di(e._fill,t)),e.dropShadow){const a=e.dropShadow,o=et.shared.setValue(a.color).toArray(),h=a.blur*i,l=a.distance*i;t.shadowColor=`rgba(${o[0]*255},${o[1]*255},${o[2]*255},${a.alpha})`,t.shadowBlur=h,t.shadowOffsetX=Math.cos(a.angle)*l,t.shadowOffsetY=Math.sin(a.angle)*l}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}_drawGlyph(t,e,i,n,r,a){const o=e.text,h=e.fontProperties,l=a._stroke,c=((l==null?void 0:l.width)??0)*r,u=i+c/2,d=n-c/2,f=h.descent*r,m=e.lineHeight*r;let g=!1;a.stroke&&c&&(g=!0,t.strokeText(o,u,d+m-f));const{shadowBlur:p,shadowOffsetX:y,shadowOffsetY:x}=t;a._fill&&(g&&(t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),t.fillText(o,u,d+m-f)),g&&(t.shadowBlur=p,t.shadowOffsetX=y,t.shadowOffsetY=x)}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{canvasAndContext:e,texture:i}=this.pages[t];ui.returnCanvasAndContext(e),i.destroy(!0)}this.pages=null}};bl.defaultOptions={textureSize:512,style:new Ve,mipmap:!0};let Ja=bl;function jp(s,t,e,i){const n={width:0,height:0,offsetY:0,scale:t.fontSize/e.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};n.offsetY=e.baseLineOffset;let r=n.lines[0],a=null,o=!0;const h={width:0,start:0,index:0,positions:[],chars:[]},l=p=>{const y=r.width;for(let x=0;x<h.index;x++){const _=p.positions[x];r.chars.push(p.chars[x]),r.charPositions.push(_+y)}r.width+=p.width,o=!1,h.width=0,h.index=0,h.chars.length=0},c=()=>{let p=r.chars.length-1;if(i){let y=r.chars[p];for(;y===" ";)r.width-=e.chars[y].xAdvance,y=r.chars[--p]}n.width=Math.max(n.width,r.width),r={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},o=!0,n.lines.push(r),n.height+=e.lineHeight},u=e.baseMeasurementFontSize/t.fontSize,d=t.letterSpacing*u,f=t.wordWrapWidth*u,m=t.wordWrap&&t.breakWords,g=p=>p-d>f;for(let p=0;p<s.length+1;p++){let y;const x=p===s.length;x||(y=s[p]);const _=e.chars[y]||e.chars[" "];if(/(?:\s)/.test(y)||y==="\r"||y===`
`||x){if(!o&&t.wordWrap&&g(r.width+h.width)?(c(),l(h),x||r.charPositions.push(0)):(h.start=r.width,l(h),x||r.charPositions.push(0)),y==="\r"||y===`
`)r.width!==0&&c();else if(!x){const v=_.xAdvance+(_.kerning[a]||0)+d;r.width+=v,r.spaceWidth=v,r.spacesIndex.push(r.charPositions.length),r.chars.push(y)}}else{const w=_.kerning[a]||0,v=_.xAdvance+w+d;m&&g(r.width+h.width+v)&&(l(h),c()),h.positions[h.index++]=h.width+w,h.chars.push(y),h.width+=v}a=y}return c(),t.align==="center"?Xp(n):t.align==="right"?Kp(n):t.align==="justify"&&qp(n),n}function Xp(s){for(let t=0;t<s.lines.length;t++){const e=s.lines[t],i=s.width/2-e.width/2;for(let n=0;n<e.charPositions.length;n++)e.charPositions[n]+=i}}function Kp(s){for(let t=0;t<s.lines.length;t++){const e=s.lines[t],i=s.width-e.width;for(let n=0;n<e.charPositions.length;n++)e.charPositions[n]+=i}}function qp(s){const t=s.width;for(let e=0;e<s.lines.length;e++){const i=s.lines[e];let n=0,r=i.spacesIndex[n++],a=0;const o=i.spacesIndex.length,l=(t-i.width)/o;for(let c=0;c<i.charPositions.length;c++)c===r&&(r=i.spacesIndex[n++],a+=l),i.charPositions[c]+=a}}function Zp(s){if(s==="")return[];typeof s=="string"&&(s=[s]);const t=[];for(let e=0,i=s.length;e<i;e++){const n=s[e];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);if(n[0].length===0||n[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const r=n[0].charCodeAt(0),a=n[1].charCodeAt(0);if(a<r)throw new Error("[BitmapFont]: Invalid character range.");for(let o=r,h=a;o<=h;o++)t.push(String.fromCharCode(o))}else t.push(...Array.from(n))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}let Zs=0;class Qp{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null}}getFont(t,e){var a;let i=`${e.fontFamily}-bitmap`,n=!0;if(e._fill.fill&&!e._stroke)i+=e._fill.fill.styleKey,n=!1;else if(e._stroke||e.dropShadow){let o=e.styleKey;o=o.substring(0,o.lastIndexOf("-")),i=`${o}-bitmap`,n=!1}if(!J.has(i)){const o=new Ja({style:e,overrideFill:n,overrideSize:!0,...this.defaultOptions});Zs++,Zs>50&&$("BitmapText",`You have dynamically created ${Zs} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),o.once("destroy",()=>{Zs--,J.remove(i)}),J.set(i,o)}const r=J.get(i);return(a=r.ensureCharacters)==null||a.call(r,t),r}getLayout(t,e,i=!0){const n=this.getFont(t,e),r=Ft.graphemeSegmenter(t);return jp(r,e,n,i)}measureText(t,e,i=!0){return this.getLayout(t,e,i)}install(...t){var l,c,u,d;let e=t[0];typeof e=="string"&&(e={name:e,style:t[1],chars:(l=t[2])==null?void 0:l.chars,resolution:(c=t[2])==null?void 0:c.resolution,padding:(u=t[2])==null?void 0:u.padding,skipKerning:(d=t[2])==null?void 0:d.skipKerning},V(W,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const i=e==null?void 0:e.name;if(!i)throw new Error("[BitmapFontManager] Property `name` is required.");e={...this.defaultOptions,...e};const n=e.style,r=n instanceof Ve?n:new Ve(n),a=r._fill.fill!==null&&r._fill.fill!==void 0,o=new Ja({style:r,overrideFill:a,skipKerning:e.skipKerning,padding:e.padding,resolution:e.resolution,overrideSize:!1,textureStyle:e.textureStyle}),h=Zp(e.chars);return o.ensureCharacters(h.join("")),J.set(`${i}-bitmap`,o),o.once("destroy",()=>J.remove(`${i}-bitmap`)),o}uninstall(t){const e=`${t}-bitmap`,i=J.get(e);i&&i.destroy()}}const to=new Qp;class vl extends tl{constructor(t,e){super();const{textures:i,data:n}=t;Object.keys(n.pages).forEach(r=>{const a=n.pages[parseInt(r,10)],o=i[a.id];this.pages.push({texture:o})}),Object.keys(n.chars).forEach(r=>{const a=n.chars[r],{frame:o,source:h}=i[a.page],l=new K(a.x+o.x,a.y+o.y,a.width,a.height),c=new D({source:h,frame:l});this.chars[r]={id:r.codePointAt(0),xOffset:a.xOffset,yOffset:a.yOffset,xAdvance:a.xAdvance,kerning:a.kerning??{},texture:c}}),this.baseRenderedFontSize=n.fontSize,this.baseMeasurementFontSize=n.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:n.fontSize},this.baseLineOffset=n.baseLineOffset,this.lineHeight=n.lineHeight,this.fontFamily=n.fontFamily,this.distanceField=n.distanceField??{type:"none",range:0},this.url=e}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{texture:e}=this.pages[t];e.destroy(!0)}this.pages=null}static install(t){to.install(t)}static uninstall(t){to.uninstall(t)}}const an={test(s){return typeof s=="string"&&s.startsWith("info face=")},parse(s){const t=s.match(/^[a-z]+\s+.+$/gm),e={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const u in t){const d=t[u].match(/^[a-z]+/gm)[0],f=t[u].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),m={};for(const g in f){const p=f[g].split("="),y=p[0],x=p[1].replace(/"/gm,""),_=parseFloat(x),b=isNaN(_)?x:_;m[y]=b}e[d].push(m)}const i={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[n]=e.info,[r]=e.common,[a]=e.distanceField??[];a&&(i.distanceField={range:parseInt(a.distanceRange,10),type:a.fieldType}),i.fontSize=parseInt(n.size,10),i.fontFamily=n.face,i.lineHeight=parseInt(r.lineHeight,10);const o=e.page;for(let u=0;u<o.length;u++)i.pages.push({id:parseInt(o[u].id,10)||0,file:o[u].file});const h={};i.baseLineOffset=i.lineHeight-parseInt(r.base,10);const l=e.char;for(let u=0;u<l.length;u++){const d=l[u],f=parseInt(d.id,10);let m=d.letter??d.char??String.fromCharCode(f);m==="space"&&(m=" "),h[f]=m,i.chars[m]={id:f,page:parseInt(d.page,10)||0,x:parseInt(d.x,10),y:parseInt(d.y,10),width:parseInt(d.width,10),height:parseInt(d.height,10),xOffset:parseInt(d.xoffset,10),yOffset:parseInt(d.yoffset,10),xAdvance:parseInt(d.xadvance,10),kerning:{}}}const c=e.kerning||[];for(let u=0;u<c.length;u++){const d=parseInt(c[u].first,10),f=parseInt(c[u].second,10),m=parseInt(c[u].amount,10);i.chars[h[f]].kerning[h[d]]=m}return i}},eo={test(s){const t=s;return typeof t!="string"&&"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(s){const t={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},e=s.getElementsByTagName("info")[0],i=s.getElementsByTagName("common")[0],n=s.getElementsByTagName("distanceField")[0];n&&(t.distanceField={type:n.getAttribute("fieldType"),range:parseInt(n.getAttribute("distanceRange"),10)});const r=s.getElementsByTagName("page"),a=s.getElementsByTagName("char"),o=s.getElementsByTagName("kerning");t.fontSize=parseInt(e.getAttribute("size"),10),t.fontFamily=e.getAttribute("face"),t.lineHeight=parseInt(i.getAttribute("lineHeight"),10);for(let l=0;l<r.length;l++)t.pages.push({id:parseInt(r[l].getAttribute("id"),10)||0,file:r[l].getAttribute("file")});const h={};t.baseLineOffset=t.lineHeight-parseInt(i.getAttribute("base"),10);for(let l=0;l<a.length;l++){const c=a[l],u=parseInt(c.getAttribute("id"),10);let d=c.getAttribute("letter")??c.getAttribute("char")??String.fromCharCode(u);d==="space"&&(d=" "),h[u]=d,t.chars[d]={id:u,page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xOffset:parseInt(c.getAttribute("xoffset"),10),yOffset:parseInt(c.getAttribute("yoffset"),10),xAdvance:parseInt(c.getAttribute("xadvance"),10),kerning:{}}}for(let l=0;l<o.length;l++){const c=parseInt(o[l].getAttribute("first"),10),u=parseInt(o[l].getAttribute("second"),10),d=parseInt(o[l].getAttribute("amount"),10);t.chars[h[u]].kerning[h[c]]=d}return t}},so={test(s){return typeof s=="string"&&s.includes("<font>")?eo.test(q.get().parseXML(s)):!1},parse(s){return eo.parse(q.get().parseXML(s))}},Jp=[".xml",".fnt"],tm={extension:{type:R.CacheParser,name:"cacheBitmapFont"},test:s=>s instanceof vl,getCacheableAssets(s,t){const e={};return s.forEach(i=>{e[i]=t,e[`${i}-bitmap`]=t}),e[`${t.fontFamily}-bitmap`]=t,e}},em={extension:{type:R.LoadParser,priority:$t.Normal},name:"loadBitmapFont",test(s){return Jp.includes(ot.extname(s).toLowerCase())},async testParse(s){return an.test(s)||so.test(s)},async parse(s,t,e){const i=an.test(s)?an.parse(s):so.parse(s),{src:n}=t,{pages:r}=i,a=[],o=i.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let u=0;u<r.length;++u){const d=r[u].file;let f=ot.join(ot.dirname(n),d);f=wn(f,n),a.push({src:f,data:o})}const h=await e.load(a),l=a.map(u=>h[u.src]);return new vl({data:i,textures:l},n)},async load(s,t){return await(await q.get().fetch(s)).text()},async unload(s,t,e){await Promise.all(s.pages.map(i=>e.unload(i.texture.source._sourceOrigin))),s.destroy()}};class sm{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<e;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}const im={extension:{type:R.CacheParser,name:"cacheTextureArray"},test:s=>Array.isArray(s)&&s.every(t=>t instanceof D),getCacheableAssets:(s,t)=>{const e={};return s.forEach(i=>{t.forEach((n,r)=>{e[i+(r===0?"":r+1)]=n})}),e}};async function Cl(s){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=s});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(s)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const nm={extension:{type:R.DetectionParser,priority:1},test:async()=>Cl("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async s=>[...s,"avif"],remove:async s=>s.filter(t=>t!=="avif")},io=["png","jpg","jpeg"],rm={extension:{type:R.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async s=>[...s,...io],remove:async s=>s.filter(t=>!io.includes(t))},am="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function pr(s){return am?!1:document.createElement("video").canPlayType(s)!==""}const om={extension:{type:R.DetectionParser,priority:0},test:async()=>pr("video/mp4"),add:async s=>[...s,"mp4","m4v"],remove:async s=>s.filter(t=>t!=="mp4"&&t!=="m4v")},hm={extension:{type:R.DetectionParser,priority:0},test:async()=>pr("video/ogg"),add:async s=>[...s,"ogv"],remove:async s=>s.filter(t=>t!=="ogv")},lm={extension:{type:R.DetectionParser,priority:0},test:async()=>pr("video/webm"),add:async s=>[...s,"webm"],remove:async s=>s.filter(t=>t!=="webm")},cm={extension:{type:R.DetectionParser,priority:0},test:async()=>Cl("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async s=>[...s,"webp"],remove:async s=>s.filter(t=>t!=="webp")};class um{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,i)=>(this._parsersValidated=!1,t[e]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const i={promise:null,parser:null};return i.promise=(async()=>{var a,o;let n=null,r=null;if(e.loadParser&&(r=this._parserHash[e.loadParser],r||$(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!r){for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];if(l.load&&((a=l.test)!=null&&a.call(l,t,e,this))){r=l;break}}if(!r)return $(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await r.load(t,e,this),i.parser=r;for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];l.parse&&l.parse&&await((o=l.testParse)==null?void 0:o.call(l,n,e,this))&&(n=await l.parse(n,e,this)||n,i.parser=l)}return n})(),i}async load(t,e){this._parsersValidated||this._validateParsers();let i=0;const n={},r=hi(t),a=St(t,l=>({alias:[l],src:l,data:{}})),o=a.length,h=a.map(async l=>{const c=ot.toAbsolute(l.src);if(!n[l.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,l)),n[l.src]=await this.promiseCache[c].promise,e&&e(++i/o)}catch(u){throw delete this.promiseCache[c],delete n[l.src],new Error(`[Loader.load] Failed to load ${c}.
${u}`)}});return await Promise.all(h),r?n[a[0].src]:n}async unload(t){const i=St(t,n=>({alias:[n],src:n})).map(async n=>{var o,h;const r=ot.toAbsolute(n.src),a=this.promiseCache[r];if(a){const l=await a.promise;delete this.promiseCache[r],await((h=(o=a.parser)==null?void 0:o.unload)==null?void 0:h.call(o,l,n,this))}});await Promise.all(i)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(e.name?t[e.name]&&$(`[Assets] loadParser name conflict "${e.name}"`):$("[Assets] loadParser should have a name"),{...t,[e.name]:e}),{})}}function Ue(s,t){if(Array.isArray(t)){for(const e of t)if(s.startsWith(`data:${e}`))return!0;return!1}return s.startsWith(`data:${t}`)}function Ge(s,t){const e=s.split("?")[0],i=ot.extname(e).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}const dm=".json",fm="application/json",pm={extension:{type:R.LoadParser,priority:$t.Low},name:"loadJson",test(s){return Ue(s,fm)||Ge(s,dm)},async load(s){return await(await q.get().fetch(s)).json()}},mm=".txt",gm="text/plain",ym={name:"loadTxt",extension:{type:R.LoadParser,priority:$t.Low,name:"loadTxt"},test(s){return Ue(s,gm)||Ge(s,mm)},async load(s){return await(await q.get().fetch(s)).text()}},xm=["normal","bold","100","200","300","400","500","600","700","800","900"],_m=[".ttf",".otf",".woff",".woff2"],bm=["font/ttf","font/otf","font/woff","font/woff2"],wm=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function vm(s){const t=ot.extname(s),n=ot.basename(s,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1));let r=n.length>0;for(const o of n)if(!o.match(wm)){r=!1;break}let a=n.join(" ");return r||(a=`"${a.replace(/[\\"]/g,"\\$&")}"`),a}const Cm=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function Sm(s){return Cm.test(s)?s:encodeURI(s)}const Am={extension:{type:R.LoadParser,priority:$t.Low},name:"loadWebFont",test(s){return Ue(s,bm)||Ge(s,_m)},async load(s,t){var i,n,r;const e=q.get().getFontFaceSet();if(e){const a=[],o=((i=t.data)==null?void 0:i.family)??vm(s),h=((r=(n=t.data)==null?void 0:n.weights)==null?void 0:r.filter(c=>xm.includes(c)))??["normal"],l=t.data??{};for(let c=0;c<h.length;c++){const u=h[c],d=new FontFace(o,`url(${Sm(s)})`,{...l,weight:u});await d.load(),e.add(d),a.push(d)}return J.set(`${o}-and-url`,{url:s,fontFaces:a}),a.length===1?a[0]:a}return $("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(s){(Array.isArray(s)?s:[s]).forEach(t=>{J.remove(`${t.family}-and-url`),q.get().getFontFaceSet().delete(t)})}};function mr(s,t=1){var i;const e=(i=Ne.RETINA_PREFIX)==null?void 0:i.exec(s);return e?parseFloat(e[1]):t}function gr(s,t,e){s.label=e,s._sourceOrigin=e;const i=new D({source:s,label:e}),n=()=>{delete t.promiseCache[e],J.has(e)&&J.remove(e)};return i.source.once("destroy",()=>{t.promiseCache[e]&&($("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),n())}),i.once("destroy",()=>{s.destroyed||($("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),n())}),i}const Tm=".svg",Pm="image/svg+xml",Mm={extension:{type:R.LoadParser,priority:$t.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(s){return Ue(s,Pm)||Ge(s,Tm)},async load(s,t,e){var i;return((i=t.data)==null?void 0:i.parseAsGraphicsContext)??this.config.parseAsGraphicsContext?km(s):Em(s,t,e,this.config.crossOrigin)},unload(s){s.destroy(!0)}};async function Em(s,t,e,i){var p,y,x;const r=await(await q.get().fetch(s)).blob(),a=URL.createObjectURL(r),o=new Image;o.src=a,o.crossOrigin=i,await o.decode(),URL.revokeObjectURL(a);const h=document.createElement("canvas"),l=h.getContext("2d"),c=((p=t.data)==null?void 0:p.resolution)||mr(s),u=((y=t.data)==null?void 0:y.width)??o.width,d=((x=t.data)==null?void 0:x.height)??o.height;h.width=u*c,h.height=d*c,l.drawImage(o,0,0,u*c,d*c);const{parseAsGraphicsContext:f,...m}=t.data??{},g=new ye({resource:h,alphaMode:"premultiply-alpha-on-upload",resolution:c,...m});return gr(g,e,s)}async function km(s){const e=await(await q.get().fetch(s)).text(),i=new yt;return i.svg(e),i}const Rm=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let Ee=null,Ln=class{constructor(){Ee||(Ee=URL.createObjectURL(new Blob([Rm],{type:"application/javascript"}))),this.worker=new Worker(Ee)}};Ln.revokeObjectURL=function(){Ee&&(URL.revokeObjectURL(Ee),Ee=null)};const Im=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let ke=null;class Sl{constructor(){ke||(ke=URL.createObjectURL(new Blob([Im],{type:"application/javascript"}))),this.worker=new Worker(ke)}}Sl.revokeObjectURL=function(){ke&&(URL.revokeObjectURL(ke),ke=null)};let no=0,on;class Fm{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new Ln;e.addEventListener("message",i=>{e.terminate(),Ln.revokeObjectURL(),t(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t,e){var i;return this._run("loadImageBitmap",[t,(i=e==null?void 0:e.data)==null?void 0:i.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){on===void 0&&(on=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<on&&(this._createdWorkers++,t=new Sl().worker,t.addEventListener("message",e=>{this._complete(e.data),this._returnWorker(e.target),this._next()})),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){t.error!==void 0?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),this._resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const i=new Promise((n,r)=>{this._queue.push({id:t,arguments:e,resolve:n,reject:r})});return this._next(),i}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const e=this._queue.pop(),i=e.id;this._resolveHash[no]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:no++,id:i})}}const ro=new Fm,Bm=[".jpeg",".jpg",".png",".webp",".avif"],Lm=["image/jpeg","image/png","image/webp","image/avif"];async function Om(s,t){var n;const e=await q.get().fetch(s);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${s}: ${e.status} ${e.statusText}`);const i=await e.blob();return((n=t==null?void 0:t.data)==null?void 0:n.alphaMode)==="premultiplied-alpha"?createImageBitmap(i,{premultiplyAlpha:"none"}):createImageBitmap(i)}const Al={name:"loadTextures",extension:{type:R.LoadParser,priority:$t.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(s){return Ue(s,Lm)||Ge(s,Bm)},async load(s,t,e){var r;let i=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await ro.isImageBitmapSupported()?i=await ro.loadImageBitmap(s,t):i=await Om(s,t):i=await new Promise((a,o)=>{i=new Image,i.crossOrigin=this.config.crossOrigin,i.src=s,i.complete?a(i):(i.onload=()=>{a(i)},i.onerror=o)});const n=new ye({resource:i,alphaMode:"premultiply-alpha-on-upload",resolution:((r=t.data)==null?void 0:r.resolution)||mr(s),...t.data});return gr(n,e,s)},unload(s){s.destroy(!0)}},Tl=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],Vm=Tl.map(s=>`video/${s.substring(1)}`);function Dm(s,t,e){e===void 0&&!t.startsWith("data:")?s.crossOrigin=zm(t):e!==!1&&(s.crossOrigin=typeof e=="string"?e:"anonymous")}function Nm(s){return new Promise((t,e)=>{s.addEventListener("canplaythrough",i),s.addEventListener("error",n),s.load();function i(){r(),t()}function n(a){r(),e(a)}function r(){s.removeEventListener("canplaythrough",i),s.removeEventListener("error",n)}})}function zm(s,t=globalThis.location){if(s.startsWith("data:"))return"";t||(t=globalThis.location);const e=new URL(s,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}const Um={name:"loadVideo",extension:{type:R.LoadParser,name:"loadVideo"},test(s){const t=Ue(s,Vm),e=Ge(s,Tl);return t||e},async load(s,t,e){var h,l;const i={...ei.defaultOptions,resolution:((h=t.data)==null?void 0:h.resolution)||mr(s),alphaMode:((l=t.data)==null?void 0:l.alphaMode)||await Ph(),...t.data},n=document.createElement("video"),r={preload:i.autoLoad!==!1?"auto":void 0,"webkit-playsinline":i.playsinline!==!1?"":void 0,playsinline:i.playsinline!==!1?"":void 0,muted:i.muted===!0?"":void 0,loop:i.loop===!0?"":void 0,autoplay:i.autoPlay!==!1?"":void 0};Object.keys(r).forEach(c=>{const u=r[c];u!==void 0&&n.setAttribute(c,u)}),i.muted===!0&&(n.muted=!0),Dm(n,s,i.crossorigin);const a=document.createElement("source");let o;if(s.startsWith("data:"))o=s.slice(5,s.indexOf(";"));else if(!s.startsWith("blob:")){const c=s.split("?")[0].slice(s.lastIndexOf(".")+1).toLowerCase();o=ei.MIME_TYPES[c]||`video/${c}`}return a.src=s,o&&(a.type=o),new Promise(c=>{const u=async()=>{const d=new ei({...i,resource:n});n.removeEventListener("canplay",u),t.data.preload&&await Nm(n),c(gr(d,e,s))};i.preload&&!i.autoPlay&&n.load(),n.addEventListener("canplay",u),n.appendChild(a)})},unload(s){s.destroy(!0)}},Pl={extension:{type:R.ResolveParser,name:"resolveTexture"},test:Al.test,parse:s=>{var t;return{resolution:parseFloat(((t=Ne.RETINA_PREFIX.exec(s))==null?void 0:t[1])??"1"),format:s.split(".").pop(),src:s}}},Gm={extension:{type:R.ResolveParser,priority:-2,name:"resolveJson"},test:s=>Ne.RETINA_PREFIX.test(s)&&s.endsWith(".json"),parse:Pl.parse};class Wm{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Ne,this.loader=new um,this.cache=J,this._backgroundLoader=new sm(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var r,a;if(this._initialized){$("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let o=t.manifest;typeof o=="string"&&(o=await this.load(o)),this.resolver.addManifest(o)}const e=((r=t.texturePreference)==null?void 0:r.resolution)??1,i=typeof e=="number"?[e]:e,n=await this._detectFormats({preferredFormats:(a=t.texturePreference)==null?void 0:a.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:n,resolution:i}}),t.preferences&&this.setPreferences(t.preferences)}add(t){this.resolver.add(t)}async load(t,e){this._initialized||await this.init();const i=hi(t),n=St(t).map(o=>{if(typeof o!="string"){const h=this.resolver.getAlias(o);return h.some(l=>!this.resolver.hasKey(l))&&this.add(o),Array.isArray(h)?h[0]:h}return this.resolver.hasKey(o)||this.add({alias:o,src:o}),o}),r=this.resolver.resolve(n),a=await this._mapLoadToResolve(r,e);return i?a[n[0]]:a}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);const n=this.resolver.resolveBundle(t),r={},a=Object.keys(n);let o=0,h=0;const l=()=>{e==null||e(++o/h)},c=a.map(u=>{const d=n[u];return h+=Object.keys(d).length,this._mapLoadToResolve(d,l).then(f=>{r[u]=f})});return await Promise.all(c),i?r[t[0]]:r}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return J.get(t);const e={};for(let i=0;i<t.length;i++)e[i]=J.get(t[i]);return e}async _mapLoadToResolve(t,e){const i=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const n=await this.loader.load(i,e);this._backgroundLoader.active=!0;const r={};return i.forEach(a=>{const o=n[a.src],h=[a.src];a.alias&&h.push(...a.alias),h.forEach(l=>{r[l]=o}),J.set(h,o)}),r}async unload(t){this._initialized||await this.init();const e=St(t).map(n=>typeof n!="string"?n.src:n),i=this.resolver.resolve(e);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=St(t);const e=this.resolver.resolveBundle(t),i=Object.keys(e).map(n=>this._unloadFromResolved(e[n]));await Promise.all(i)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(i=>{J.remove(i.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const i of t.detections)t.skipDetections||await i.test()?e=await i.add(e):t.skipDetections||(e=await i.remove(e));return e=e.filter((i,n)=>e.indexOf(i)===n),e}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(i=>i in t).forEach(i=>{e.config[i]=t[i]})})}}const ht=new Wm;Y.handleByList(R.LoadParser,ht.loader.parsers).handleByList(R.ResolveParser,ht.resolver.parsers).handleByList(R.CacheParser,ht.cache.parsers).handleByList(R.DetectionParser,ht.detections);Y.add(im,rm,nm,cm,om,hm,lm,pm,ym,Am,Mm,Al,Um,em,tm,Pl,Gm);const ao={loader:R.LoadParser,resolver:R.ResolveParser,cache:R.CacheParser,detection:R.DetectionParser};Y.handle(R.Asset,s=>{const t=s.ref;Object.entries(ao).filter(([e])=>!!t[e]).forEach(([e,i])=>Y.add(Object.assign(t[e],{extension:t[e].extension??i})))},s=>{const t=s.ref;Object.keys(ao).filter(e=>!!t[e]).forEach(e=>Y.remove(t[e]))});class De extends nr{constructor(t){t instanceof yt&&(t={context:t});const{context:e,roundPixels:i,...n}=t||{};super({label:"Graphics",...n}),this.renderPipeId="graphics",e?this._context=e:this._context=this._ownedContext=new yt,this._context.on("update",this.onViewUpdate,this),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=i??!1}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(t===!0||(t==null?void 0:t.context)===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new De(this._context.clone()):(this._ownedContext=null,new De(this._context))}lineStyle(t,e,i){V(W,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const n={};return t&&(n.width=t),e&&(n.color=e),i&&(n.alpha=i),this.context.strokeStyle=n,this}beginFill(t,e){V(W,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const i={};return t!==void 0&&(i.color=t),e!==void 0&&(i.alpha=e),this.context.fillStyle=i,this}endFill(){V(W,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return(t.width!==yt.defaultStrokeStyle.width||t.color!==yt.defaultStrokeStyle.color||t.alpha!==yt.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return V(W,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return V(W,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return V(W,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return V(W,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return V(W,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return V(W,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}class Hm extends nr{constructor(t,e){const{text:i,resolution:n,style:r,anchor:a,width:o,height:h,roundPixels:l,...c}=t;super({...c}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=e,this.text=i??"",this.style=r,this.resolution=n??null,this.allowChildren=!1,this._anchor=new at({_onUpdate:()=>{this.onViewUpdate()}}),a&&(this.anchor=a),this.roundPixels=l??!1,o!==void 0&&(this.width=o),h!==void 0&&(this.height=h)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}set text(t){t=t.toString(),this._text!==t&&(this._text=t,this.onViewUpdate())}get text(){return this._text}set resolution(t){this._autoResolution=t===null,this._resolution=t,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(t){var e;t||(t={}),(e=this._style)==null||e.off("update",this.onViewUpdate,this),t instanceof this._styleClass?this._style=t:this._style=new this._styleClass(t),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(t){this._setWidth(t,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(t){this._setHeight(t,this.bounds.height)}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this.bounds.width,t.height=Math.abs(this.scale.y)*this.bounds.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this.bounds.width),e!==void 0&&this._setHeight(e,this.bounds.height)}containsPoint(t){const e=this.bounds.width,i=this.bounds.height,n=-e*this.anchor.x;let r=0;return t.x>=n&&t.x<=n+e&&(r=-i*this.anchor.y,t.y>=r&&t.y<=r+i)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}destroy(t=!1){super.destroy(t),this.owner=null,this._bounds=null,this._anchor=null,(typeof t=="boolean"?t:t!=null&&t.style)&&this._style.destroy(t),this._style=null,this._text=null}}function $m(s,t){let e=s[0]??{};return(typeof e=="string"||s[1])&&(V(W,`use new ${t}({ text: "hi!", style }) instead`),e={text:e,style:s[1]}),e}let ae=null,Nt=null;function Ym(s,t){ae||(ae=q.get().createCanvas(256,128),Nt=ae.getContext("2d",{willReadFrequently:!0}),Nt.globalCompositeOperation="copy",Nt.globalAlpha=1),(ae.width<s||ae.height<t)&&(ae.width=Ie(s),ae.height=Ie(t))}function oo(s,t,e){for(let i=0,n=4*e*t;i<t;++i,n+=4)if(s[n+3]!==0)return!1;return!0}function ho(s,t,e,i,n){const r=4*t;for(let a=i,o=i*r+4*e;a<=n;++a,o+=r)if(s[o+3]!==0)return!1;return!0}function jm(...s){let t=s[0];t.canvas||(t={canvas:s[0],resolution:s[1]});const{canvas:e}=t,i=Math.min(t.resolution??1,1),n=t.width??e.width,r=t.height??e.height;let a=t.output;if(Ym(n,r),!Nt)throw new TypeError("Failed to get canvas 2D context");Nt.drawImage(e,0,0,n,r,0,0,n*i,r*i);const h=Nt.getImageData(0,0,n,r).data;let l=0,c=0,u=n-1,d=r-1;for(;c<r&&oo(h,n,c);)++c;if(c===r)return K.EMPTY;for(;oo(h,n,d);)--d;for(;ho(h,n,l,c,d);)++l;for(;ho(h,n,u,c,d);)--u;return++u,++d,Nt.globalCompositeOperation="source-over",Nt.strokeRect(l,c,u-l,d-c),Nt.globalCompositeOperation="copy",a??(a=new K),a.set(l/i,c/i,(u-l)/i,(d-c)/i),a}const lo=new K;class Xm{getCanvasAndContext(t){const{text:e,style:i,resolution:n=1}=t,r=i._getFinalPadding(),a=Ft.measureText(e||" ",i),o=Math.ceil(Math.ceil(Math.max(1,a.width)+r*2)*n),h=Math.ceil(Math.ceil(Math.max(1,a.height)+r*2)*n),l=ui.getOptimalCanvasAndContext(o,h);this._renderTextToCanvas(e,i,r,n,l);const c=i.trim?jm({canvas:l.canvas,width:o,height:h,resolution:1,output:lo}):lo.set(0,0,o,h);return{canvasAndContext:l,frame:c}}returnCanvasAndContext(t){ui.returnCanvasAndContext(t)}_renderTextToCanvas(t,e,i,n,r){var _,b,C,w;const{canvas:a,context:o}=r,h=li(e),l=Ft.measureText(t||" ",e),c=l.lines,u=l.lineHeight,d=l.lineWidths,f=l.maxLineWidth,m=l.fontProperties,g=a.height;if(o.resetTransform(),o.scale(n,n),o.textBaseline=e.textBaseline,(_=e._stroke)!=null&&_.width){const v=e._stroke;o.lineWidth=v.width,o.miterLimit=v.miterLimit,o.lineJoin=v.join,o.lineCap=v.cap}o.font=h;let p,y;const x=e.dropShadow?2:1;for(let v=0;v<x;++v){const T=e.dropShadow&&v===0,k=T?Math.ceil(Math.max(1,g)+i*2):0,M=k*n;if(T){o.fillStyle="black",o.strokeStyle="black";const L=e.dropShadow,rt=L.color,Yt=L.alpha;o.shadowColor=et.shared.setValue(rt).setAlpha(Yt).toRgbaString();const B=L.blur*n,F=L.distance*n;o.shadowBlur=B,o.shadowOffsetX=Math.cos(L.angle)*F,o.shadowOffsetY=Math.sin(L.angle)*F+M}else{if(o.fillStyle=e._fill?di(e._fill,o,l):null,(b=e._stroke)!=null&&b.width){const L=e._stroke.width*e._stroke.alignment;o.strokeStyle=di(e._stroke,o,l,L)}o.shadowColor="black"}let E=(u-m.fontSize)/2;u-m.fontSize<0&&(E=0);const U=((C=e._stroke)==null?void 0:C.width)??0;for(let L=0;L<c.length;L++)p=U/2,y=U/2+L*u+m.ascent+E,e.align==="right"?p+=f-d[L]:e.align==="center"&&(p+=(f-d[L])/2),(w=e._stroke)!=null&&w.width&&this._drawLetterSpacing(c[L],e,r,p+i,y+i-k,!0),e._fill!==void 0&&this._drawLetterSpacing(c[L],e,r,p+i,y+i-k)}}_drawLetterSpacing(t,e,i,n,r,a=!1){const{context:o}=i,h=e.letterSpacing;let l=!1;if(Ft.experimentalLetterSpacingSupported&&(Ft.experimentalLetterSpacing?(o.letterSpacing=`${h}px`,o.textLetterSpacing=`${h}px`,l=!0):(o.letterSpacing="0px",o.textLetterSpacing="0px")),h===0||l){a?o.strokeText(t,n,r):o.fillText(t,n,r);return}let c=n;const u=Ft.graphemeSegmenter(t);let d=o.measureText(t).width,f=0;for(let m=0;m<u.length;++m){const g=u[m];a?o.strokeText(g,c,r):o.fillText(g,c,r);let p="";for(let y=m+1;y<u.length;++y)p+=u[y];f=o.measureText(p).width,c+=d-f+h,d=f}}}const co=new Xm;class gt extends Hm{constructor(...t){const e=$m(t,"Text");super(e,Ve),this.renderPipeId="text",e.textureStyle&&(this.textureStyle=e.textureStyle instanceof Fe?e.textureStyle:new Fe(e.textureStyle))}updateBounds(){const t=this._bounds,e=this._anchor;let i=0,n=0;if(this._style.trim){const{frame:r,canvasAndContext:a}=co.getCanvasAndContext({text:this.text,style:this._style,resolution:1});co.returnCanvasAndContext(a),i=r.width,n=r.height}else{const r=Ft.measureText(this._text,this._style);i=r.width,n=r.height}t.minX=-e._x*i,t.maxX=t.minX+i,t.minY=-e._y*n,t.maxY=t.minY+n}}Y.add(qc,Zc);var hn={},Je={},uo;function Is(){if(uo)return Je;uo=1,Object.defineProperty(Je,"__esModule",{value:!0}),Je.Collector=void 0;let s=class{constructor(e){this.emit=(...i)=>{e.emitCollecting(this,i)}}};return Je.Collector=s,Je}var ts={},fo;function Km(){if(fo)return ts;fo=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.CollectorArray=void 0;const s=Is();let t=class extends s.Collector{constructor(){super(...arguments),this.result=[]}handleResult(i){return this.result.push(i),!0}getResult(){return this.result}reset(){this.result.length=0}};return ts.CollectorArray=t,ts}var es={},po;function qm(){if(po)return es;po=1,Object.defineProperty(es,"__esModule",{value:!0}),es.CollectorLast=void 0;const s=Is();let t=class extends s.Collector{handleResult(i){return this.result=i,!0}getResult(){return this.result}reset(){delete this.result}};return es.CollectorLast=t,es}var ss={},mo;function Zm(){if(mo)return ss;mo=1,Object.defineProperty(ss,"__esModule",{value:!0}),ss.CollectorUntil0=void 0;const s=Is();let t=class extends s.Collector{constructor(){super(...arguments),this.result=!1}handleResult(i){return this.result=i,this.result}getResult(){return this.result}reset(){this.result=!1}};return ss.CollectorUntil0=t,ss}var is={},go;function Qm(){if(go)return is;go=1,Object.defineProperty(is,"__esModule",{value:!0}),is.CollectorWhile0=void 0;const s=Is();let t=class extends s.Collector{constructor(){super(...arguments),this.result=!1}handleResult(i){return this.result=i,!this.result}getResult(){return this.result}reset(){this.result=!1}};return is.CollectorWhile0=t,is}var ns={},rs={},yo;function Jm(){if(yo)return rs;yo=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.SignalConnectionImpl=void 0;class s{constructor(e,i){this.link=e,this.parentCleanup=i}disconnect(){return this.link!==null?(this.link.unlink(),this.link=null,this.parentCleanup(),this.parentCleanup=null,!0):!1}set enabled(e){this.link&&this.link.setEnabled(e)}get enabled(){return this.link!==null&&this.link.isEnabled()}}return rs.SignalConnectionImpl=s,rs}var as={},xo;function tg(){if(xo)return as;xo=1,Object.defineProperty(as,"__esModule",{value:!0}),as.SignalLink=void 0;let s=class Ml{constructor(e=null,i=null,n=0){this.enabled=!0,this.newLink=!1,this.callback=null,this.prev=e??this,this.next=i??this,this.order=n}isEnabled(){return this.enabled&&!this.newLink}setEnabled(e){this.enabled=e}unlink(){this.callback=null,this.next.prev=this.prev,this.prev.next=this.next}insert(e,i){let n=this.prev;for(;n!==this&&!(n.order<=i);)n=n.prev;const r=new Ml(n,n.next,i);return r.callback=e,n.next=r,r.next.prev=r,r}};return as.SignalLink=s,as}var _o;function eg(){if(_o)return ns;_o=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.Signal=void 0;const s=Jm(),t=tg();let e=class{constructor(){this.head=new t.SignalLink,this.hasNewLinks=!1,this.emitDepth=0,this.connectionsCount=0}getConnectionsCount(){return this.connectionsCount}hasConnections(){return this.connectionsCount>0}connect(n,r=0){this.connectionsCount++;const a=this.head.insert(n,r);return this.emitDepth>0&&(this.hasNewLinks=!0,a.newLink=!0),new s.SignalConnectionImpl(a,()=>this.decrementConnectionCount())}decrementConnectionCount(){this.connectionsCount--}disconnect(n){for(let r=this.head.next;r!==this.head;r=r.next)if(r.callback===n)return this.decrementConnectionCount(),r.unlink(),!0;return!1}disconnectAll(){for(;this.head.next!==this.head;)this.head.next.unlink();this.connectionsCount=0}emit(...n){this.emitDepth++;for(let r=this.head.next;r!==this.head;r=r.next)r.isEnabled()&&r.callback&&r.callback.apply(null,n);this.emitDepth--,this.unsetNewLink()}emitCollecting(n,r){this.emitDepth++;for(let a=this.head.next;a!==this.head;a=a.next)if(a.isEnabled()&&a.callback){const o=a.callback.apply(null,r);if(!n.handleResult(o))break}this.emitDepth--,this.unsetNewLink()}unsetNewLink(){if(this.hasNewLinks&&this.emitDepth===0){for(let n=this.head.next;n!==this.head;n=n.next)n.newLink=!1;this.hasNewLinks=!1}}};return ns.Signal=e,ns}var os={},bo;function sg(){if(bo)return os;bo=1,Object.defineProperty(os,"__esModule",{value:!0}),os.SignalConnections=void 0;let s=class{constructor(){this.list=[]}add(e){this.list.push(e)}disconnectAll(){for(const e of this.list)e.disconnect();this.list=[]}getCount(){return this.list.length}isEmpty(){return this.list.length===0}};return os.SignalConnections=s,os}var wo;function ig(){return wo||(wo=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.SignalConnections=s.Signal=s.CollectorWhile0=s.CollectorUntil0=s.CollectorLast=s.CollectorArray=s.Collector=void 0;var t=Is();Object.defineProperty(s,"Collector",{enumerable:!0,get:function(){return t.Collector}});var e=Km();Object.defineProperty(s,"CollectorArray",{enumerable:!0,get:function(){return e.CollectorArray}});var i=qm();Object.defineProperty(s,"CollectorLast",{enumerable:!0,get:function(){return i.CollectorLast}});var n=Zm();Object.defineProperty(s,"CollectorUntil0",{enumerable:!0,get:function(){return n.CollectorUntil0}});var r=Qm();Object.defineProperty(s,"CollectorWhile0",{enumerable:!0,get:function(){return r.CollectorWhile0}});var a=eg();Object.defineProperty(s,"Signal",{enumerable:!0,get:function(){return a.Signal}});var o=sg();Object.defineProperty(s,"SignalConnections",{enumerable:!0,get:function(){return o.SignalConnections}})}(hn)),hn}var Ce=ig(),ng=Object.defineProperty,rg=(s,t,e)=>t in s?ng(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,Zt=(s,t,e)=>rg(s,typeof t!="symbol"?t+"":t,e);class ag{constructor(){Zt(this,"_isMouseIn"),Zt(this,"_isDown"),Zt(this,"onDown"),Zt(this,"onUp"),Zt(this,"onUpOut"),Zt(this,"onOut"),Zt(this,"onPress"),Zt(this,"onHover"),this.onPress=new Ce.Signal,this.onDown=new Ce.Signal,this.onUp=new Ce.Signal,this.onHover=new Ce.Signal,this.onOut=new Ce.Signal,this.onUpOut=new Ce.Signal}connectEvents(t){Ni.any?(t.on("pointerdown",this.processDown,this),t.on("pointerup",this.processUp,this),t.on("pointerupoutside",this.processUpOut,this),t.on("pointerout",this.processOut,this),t.on("pointertap",this.processPress,this),t.on("pointerover",this.processOver,this)):(t.on("mousedown",this.processDown,this),t.on("mouseup",this.processUp,this),t.on("mouseupoutside",this.processUpOut,this),t.on("mouseout",this.processOut,this),t.on("click",this.processPress,this),t.on("mouseover",this.processOver,this))}disconnectEvents(t){Ni.any?(t.off("pointerdown",this.processDown,this),t.off("pointerup",this.processUp,this),t.off("pointerupoutside",this.processUpOut,this),t.off("pointerout",this.processOut,this),t.off("pointertap",this.processPress,this),t.off("pointerover",this.processOver,this)):(t.off("mousedown",this.processDown,this),t.off("mouseup",this.processUp,this),t.off("mouseupoutside",this.processUpOut,this),t.off("mouseout",this.processOut,this),t.off("click",this.processPress,this),t.off("mouseover",this.processOver,this))}processDown(t){this._isDown=!0,this.onDown.emit(this,t),this.down(t)}processUp(t){this._isDown&&(this.onUp.emit(this,t),this.up(t)),this._isDown=!1}processUpOut(t){this._isDown&&(this.onUp.emit(this,t),this.onUpOut.emit(this,t),this.up(t),this.upOut(t)),this._isDown=!1}processOut(t){this._isMouseIn&&(this._isMouseIn=!1,this.onOut.emit(this,t),this.out(t))}processPress(t){this._isDown=!1,this.onPress.emit(this,t),this.press(t)}processOver(t){Ni.any||(this._isMouseIn=!0,this.onHover.emit(this,t),this.hover(t))}down(t){}up(t){}upOut(t){}out(t){}press(t){}hover(t){}get isDown(){return this._isDown}}var og=Object.defineProperty,hg=(s,t,e)=>t in s?og(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,lg=(s,t,e)=>hg(s,t+"",e);class cg extends ag{constructor(t){super(),lg(this,"_view"),t&&(this.view=t,this.enabled=!0)}set view(t){!!this._view&&this.disconnectEvents(this._view),this._view=t,this.connectEvents(this._view)}get view(){return this._view}set enabled(t){if(!this.view){console.error("Button view is not set. Please set it before enabling the button.");return}this.view.eventMode=t?"static":"auto",this.view.cursor=t?"pointer":"default",!t&&this.isDown&&this.processUp()}get enabled(){return this.view.eventMode==="static"}}var ug=Object.defineProperty,dg=(s,t,e)=>t in s?ug(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,hs=(s,t,e)=>dg(s,typeof t!="symbol"?t+"":t,e);class fg extends ft{constructor(t){super(),hs(this,"_progress",0),hs(this,"options"),hs(this,"bgCircle",new De),hs(this,"fillCircle",new De),hs(this,"innerView",new ft),this.options=t,this.addChild(this.innerView),this.innerView.addChild(this.bgCircle,this.fillCircle),this.addBackground(),t.value&&(this.progress=t.value)}addBackground(){const{backgroundColor:t,lineWidth:e,radius:i,backgroundAlpha:n}=this.options;let r=1;n>0&&(r=n),t===void 0&&(r=1e-6),this.bgCircle.circle(0,0,i).stroke({width:e,color:t,alpha:r})}set progress(t){t>100&&(t=100),t<0&&(t=0),this._progress=t;const{lineWidth:e,radius:i,fillColor:n,fillAlpha:r,cap:a}=this.options;if(t===0&&r===0){this.fillCircle.clear();return}const o=0,h=360/100*t;this.fillCircle.clear().arc(0,0,i,(-90+o)*mn,(-90+o+h)*mn).stroke({width:e,color:n,cap:a,alpha:r})}get progress(){return this._progress}}function pg(s,t){s.indexOf(t)===-1&&s.push(t)}function El(s,t){const e=s.indexOf(t);e>-1&&s.splice(e,1)}const _e=(s,t,e)=>e>t?t:e<s?s:e;let yr=()=>{};const Wt={},kl=s=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(s);function Rl(s){return typeof s=="object"&&s!==null}const Il=s=>/^0[^.\s]+$/u.test(s);function xr(s){let t;return()=>(t===void 0&&(t=s()),t)}const We=s=>s,mg=(s,t)=>e=>t(s(e)),_r=(...s)=>s.reduce(mg),br=(s,t,e)=>{const i=t-s;return i===0?1:(e-s)/i};class Fl{constructor(){this.subscriptions=[]}add(t){return pg(this.subscriptions,t),()=>El(this.subscriptions,t)}notify(t,e,i){const n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](t,e,i);else for(let r=0;r<n;r++){const a=this.subscriptions[r];a&&a(t,e,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Lt=s=>s*1e3,Ut=s=>s/1e3;function Bl(s,t){return t?s*(1e3/t):0}const gg=(s,t,e)=>{const i=t-s;return((e-s)%i+i)%i+s},Ll=(s,t,e)=>(((1-3*e+3*t)*s+(3*e-6*t))*s+3*t)*s,yg=1e-7,xg=12;function _g(s,t,e,i,n){let r,a,o=0;do a=t+(e-t)/2,r=Ll(a,i,n)-s,r>0?e=a:t=a;while(Math.abs(r)>yg&&++o<xg);return a}function Fs(s,t,e,i){if(s===t&&e===i)return We;const n=r=>_g(r,0,1,s,e);return r=>r===0||r===1?r:Ll(n(r),t,i)}const Ol=s=>t=>t<=.5?s(2*t)/2:(2-s(2*(1-t)))/2,Vl=s=>t=>1-s(1-t),Dl=Fs(.33,1.53,.69,.99),wr=Vl(Dl),Nl=Ol(wr),zl=s=>(s*=2)<1?.5*wr(s):.5*(2-Math.pow(2,-10*(s-1))),vr=s=>1-Math.sin(Math.acos(s)),bg=Vl(vr),Ul=Ol(vr),wg=Fs(.42,0,1,1),vg=Fs(0,0,.58,1),Gl=Fs(.42,0,.58,1),Wl=s=>Array.isArray(s)&&typeof s[0]!="number";function Hl(s,t){return Wl(s)?s[gg(0,s.length,t)]:s}const $l=s=>Array.isArray(s)&&typeof s[0]=="number",Cg={linear:We,easeIn:wg,easeInOut:Gl,easeOut:vg,circIn:vr,circInOut:Ul,circOut:bg,backIn:wr,backInOut:Nl,backOut:Dl,anticipate:zl},Sg=s=>typeof s=="string",vo=s=>{if($l(s)){yr(s.length===4);const[t,e,i,n]=s;return Fs(t,e,i,n)}else if(Sg(s))return Cg[s];return s},Qs=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function Ag(s,t){let e=new Set,i=new Set,n=!1,r=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function h(c){a.has(c)&&(l.schedule(c),s()),c(o)}const l={schedule:(c,u=!1,d=!1)=>{const m=d&&n?e:i;return u&&a.add(c),m.has(c)||m.add(c),c},cancel:c=>{i.delete(c),a.delete(c)},process:c=>{if(o=c,n){r=!0;return}n=!0,[e,i]=[i,e],e.forEach(h),e.clear(),n=!1,r&&(r=!1,l.process(c))}};return l}const Tg=40;function Pg(s,t){let e=!1,i=!0;const n={delta:0,timestamp:0,isProcessing:!1},r=()=>e=!0,a=Qs.reduce((_,b)=>(_[b]=Ag(r),_),{}),{setup:o,read:h,resolveKeyframes:l,preUpdate:c,update:u,preRender:d,render:f,postRender:m}=a,g=()=>{const _=Wt.useManualTiming?n.timestamp:performance.now();e=!1,Wt.useManualTiming||(n.delta=i?1e3/60:Math.max(Math.min(_-n.timestamp,Tg),1)),n.timestamp=_,n.isProcessing=!0,o.process(n),h.process(n),l.process(n),c.process(n),u.process(n),d.process(n),f.process(n),m.process(n),n.isProcessing=!1,e&&t&&(i=!1,s(g))},p=()=>{e=!0,i=!0,n.isProcessing||s(g)};return{schedule:Qs.reduce((_,b)=>{const C=a[b];return _[b]=(w,v=!1,T=!1)=>(e||p(),C.schedule(w,v,T)),_},{}),cancel:_=>{for(let b=0;b<Qs.length;b++)a[Qs[b]].cancel(_)},state:n,steps:a}}const{schedule:Ht,cancel:On,state:fi}=Pg(typeof requestAnimationFrame<"u"?requestAnimationFrame:We,!0);let ii;function Mg(){ii=void 0}const bt={now:()=>(ii===void 0&&bt.set(fi.isProcessing||Wt.useManualTiming?fi.timestamp:performance.now()),ii),set:s=>{ii=s,queueMicrotask(Mg)}},Yl=s=>t=>typeof t=="string"&&t.startsWith(s),jl=Yl("--"),Eg=Yl("var(--"),Cr=s=>Eg(s)?kg.test(s.split("/*")[0].trim()):!1,kg=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,He={test:s=>typeof s=="number",parse:parseFloat,transform:s=>s},As={...He,transform:s=>_e(0,1,s)},Js={...He,default:1},xs=s=>Math.round(s*1e5)/1e5,Sr=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Rg(s){return s==null}const Ig=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Ar=(s,t)=>e=>!!(typeof e=="string"&&Ig.test(e)&&e.startsWith(s)||t&&!Rg(e)&&Object.prototype.hasOwnProperty.call(e,t)),Xl=(s,t,e)=>i=>{if(typeof i!="string")return i;const[n,r,a,o]=i.match(Sr);return{[s]:parseFloat(n),[t]:parseFloat(r),[e]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},Fg=s=>_e(0,255,s),ln={...He,transform:s=>Math.round(Fg(s))},fe={test:Ar("rgb","red"),parse:Xl("red","green","blue"),transform:({red:s,green:t,blue:e,alpha:i=1})=>"rgba("+ln.transform(s)+", "+ln.transform(t)+", "+ln.transform(e)+", "+xs(As.transform(i))+")"};function Bg(s){let t="",e="",i="",n="";return s.length>5?(t=s.substring(1,3),e=s.substring(3,5),i=s.substring(5,7),n=s.substring(7,9)):(t=s.substring(1,2),e=s.substring(2,3),i=s.substring(3,4),n=s.substring(4,5),t+=t,e+=e,i+=i,n+=n),{red:parseInt(t,16),green:parseInt(e,16),blue:parseInt(i,16),alpha:n?parseInt(n,16)/255:1}}const Vn={test:Ar("#"),parse:Bg,transform:fe.transform},Bs=s=>({test:t=>typeof t=="string"&&t.endsWith(s)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${s}`}),Qt=Bs("deg"),Re=Bs("%"),O=Bs("px"),Lg=Bs("vh"),Og=Bs("vw"),Co={...Re,parse:s=>Re.parse(s)/100,transform:s=>Re.transform(s*100)},Pe={test:Ar("hsl","hue"),parse:Xl("hue","saturation","lightness"),transform:({hue:s,saturation:t,lightness:e,alpha:i=1})=>"hsla("+Math.round(s)+", "+Re.transform(xs(t))+", "+Re.transform(xs(e))+", "+xs(As.transform(i))+")"},st={test:s=>fe.test(s)||Vn.test(s)||Pe.test(s),parse:s=>fe.test(s)?fe.parse(s):Pe.test(s)?Pe.parse(s):Vn.parse(s),transform:s=>typeof s=="string"?s:s.hasOwnProperty("red")?fe.transform(s):Pe.transform(s),getAnimatableNone:s=>{const t=st.parse(s);return t.alpha=0,st.transform(t)}},Vg=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Dg(s){var t,e;return isNaN(s)&&typeof s=="string"&&(((t=s.match(Sr))==null?void 0:t.length)||0)+(((e=s.match(Vg))==null?void 0:e.length)||0)>0}const Kl="number",ql="color",Ng="var",zg="var(",So="${}",Ug=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ts(s){const t=s.toString(),e=[],i={color:[],number:[],var:[]},n=[];let r=0;const o=t.replace(Ug,h=>(st.test(h)?(i.color.push(r),n.push(ql),e.push(st.parse(h))):h.startsWith(zg)?(i.var.push(r),n.push(Ng),e.push(h)):(i.number.push(r),n.push(Kl),e.push(parseFloat(h))),++r,So)).split(So);return{values:e,split:o,indexes:i,types:n}}function Zl(s){return Ts(s).values}function Ql(s){const{split:t,types:e}=Ts(s),i=t.length;return n=>{let r="";for(let a=0;a<i;a++)if(r+=t[a],n[a]!==void 0){const o=e[a];o===Kl?r+=xs(n[a]):o===ql?r+=st.transform(n[a]):r+=n[a]}return r}}const Gg=s=>typeof s=="number"?0:st.test(s)?st.getAnimatableNone(s):s;function Wg(s){const t=Zl(s);return Ql(s)(t.map(Gg))}const $e={test:Dg,parse:Zl,createTransformer:Ql,getAnimatableNone:Wg};function cn(s,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?s+(t-s)*6*e:e<1/2?t:e<2/3?s+(t-s)*(2/3-e)*6:s}function Hg({hue:s,saturation:t,lightness:e,alpha:i}){s/=360,t/=100,e/=100;let n=0,r=0,a=0;if(!t)n=r=a=e;else{const o=e<.5?e*(1+t):e+t-e*t,h=2*e-o;n=cn(h,o,s+1/3),r=cn(h,o,s),a=cn(h,o,s-1/3)}return{red:Math.round(n*255),green:Math.round(r*255),blue:Math.round(a*255),alpha:i}}function pi(s,t){return e=>e>0?t:s}const Ls=(s,t,e)=>s+(t-s)*e,un=(s,t,e)=>{const i=s*s,n=e*(t*t-i)+i;return n<0?0:Math.sqrt(n)},$g=[Vn,fe,Pe],Yg=s=>$g.find(t=>t.test(s));function Ao(s){const t=Yg(s);if(!t)return!1;let e=t.parse(s);return t===Pe&&(e=Hg(e)),e}const To=(s,t)=>{const e=Ao(s),i=Ao(t);if(!e||!i)return pi(s,t);const n={...e};return r=>(n.red=un(e.red,i.red,r),n.green=un(e.green,i.green,r),n.blue=un(e.blue,i.blue,r),n.alpha=Ls(e.alpha,i.alpha,r),fe.transform(n))},Dn=new Set(["none","hidden"]);function jg(s,t){return Dn.has(s)?e=>e<=0?s:t:e=>e>=1?t:s}function Xg(s,t){return e=>Ls(s,t,e)}function Tr(s){return typeof s=="number"?Xg:typeof s=="string"?Cr(s)?pi:st.test(s)?To:Zg:Array.isArray(s)?Jl:typeof s=="object"?st.test(s)?To:Kg:pi}function Jl(s,t){const e=[...s],i=e.length,n=s.map((r,a)=>Tr(r)(r,t[a]));return r=>{for(let a=0;a<i;a++)e[a]=n[a](r);return e}}function Kg(s,t){const e={...s,...t},i={};for(const n in e)s[n]!==void 0&&t[n]!==void 0&&(i[n]=Tr(s[n])(s[n],t[n]));return n=>{for(const r in i)e[r]=i[r](n);return e}}function qg(s,t){const e=[],i={color:0,var:0,number:0};for(let n=0;n<t.values.length;n++){const r=t.types[n],a=s.indexes[r][i[r]],o=s.values[a]??0;e[n]=o,i[r]++}return e}const Zg=(s,t)=>{const e=$e.createTransformer(t),i=Ts(s),n=Ts(t);return i.indexes.var.length===n.indexes.var.length&&i.indexes.color.length===n.indexes.color.length&&i.indexes.number.length>=n.indexes.number.length?Dn.has(s)&&!n.values.length||Dn.has(t)&&!i.values.length?jg(s,t):_r(Jl(qg(i,n),n.values),e):pi(s,t)};function tc(s,t,e){return typeof s=="number"&&typeof t=="number"&&typeof e=="number"?Ls(s,t,e):Tr(s)(s,t)}const Qg=s=>{const t=({timestamp:e})=>s(e);return{start:(e=!0)=>Ht.update(t,e),stop:()=>On(t),now:()=>fi.isProcessing?fi.timestamp:bt.now()}},ec=(s,t,e=10)=>{let i="";const n=Math.max(Math.round(t/e),2);for(let r=0;r<n;r++)i+=Math.round(s(r/(n-1))*1e4)/1e4+", ";return`linear(${i.substring(0,i.length-2)})`},mi=2e4;function Pr(s){let t=0;const e=50;let i=s.next(t);for(;!i.done&&t<mi;)t+=e,i=s.next(t);return t>=mi?1/0:t}function sc(s,t=100,e){const i=e({...s,keyframes:[0,t]}),n=Math.min(Pr(i),mi);return{type:"keyframes",ease:r=>i.next(n*r).value/t,duration:Ut(n)}}const Jg=5;function ic(s,t,e){const i=Math.max(t-Jg,0);return Bl(e-s(i),t-i)}const Q={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},dn=.001;function ty({duration:s=Q.duration,bounce:t=Q.bounce,velocity:e=Q.velocity,mass:i=Q.mass}){let n,r,a=1-t;a=_e(Q.minDamping,Q.maxDamping,a),s=_e(Q.minDuration,Q.maxDuration,Ut(s)),a<1?(n=l=>{const c=l*a,u=c*s,d=c-e,f=Nn(l,a),m=Math.exp(-u);return dn-d/f*m},r=l=>{const u=l*a*s,d=u*e+e,f=Math.pow(a,2)*Math.pow(l,2)*s,m=Math.exp(-u),g=Nn(Math.pow(l,2),a);return(-n(l)+dn>0?-1:1)*((d-f)*m)/g}):(n=l=>{const c=Math.exp(-l*s),u=(l-e)*s+1;return-dn+c*u},r=l=>{const c=Math.exp(-l*s),u=(e-l)*(s*s);return c*u});const o=5/s,h=sy(n,r,o);if(s=Lt(s),isNaN(h))return{stiffness:Q.stiffness,damping:Q.damping,duration:s};{const l=Math.pow(h,2)*i;return{stiffness:l,damping:a*2*Math.sqrt(i*l),duration:s}}}const ey=12;function sy(s,t,e){let i=e;for(let n=1;n<ey;n++)i=i-s(i)/t(i);return i}function Nn(s,t){return s*Math.sqrt(1-t*t)}const iy=["duration","bounce"],ny=["stiffness","damping","mass"];function Po(s,t){return t.some(e=>s[e]!==void 0)}function ry(s){let t={velocity:Q.velocity,stiffness:Q.stiffness,damping:Q.damping,mass:Q.mass,isResolvedFromDuration:!1,...s};if(!Po(s,ny)&&Po(s,iy))if(s.visualDuration){const e=s.visualDuration,i=2*Math.PI/(e*1.2),n=i*i,r=2*_e(.05,1,1-(s.bounce||0))*Math.sqrt(n);t={...t,mass:Q.mass,stiffness:n,damping:r}}else{const e=ty(s);t={...t,...e,mass:Q.mass},t.isResolvedFromDuration=!0}return t}function Ps(s=Q.visualDuration,t=Q.bounce){const e=typeof s!="object"?{visualDuration:s,keyframes:[0,1],bounce:t}:s;let{restSpeed:i,restDelta:n}=e;const r=e.keyframes[0],a=e.keyframes[e.keyframes.length-1],o={done:!1,value:r},{stiffness:h,damping:l,mass:c,duration:u,velocity:d,isResolvedFromDuration:f}=ry({...e,velocity:-Ut(e.velocity||0)}),m=d||0,g=l/(2*Math.sqrt(h*c)),p=a-r,y=Ut(Math.sqrt(h/c)),x=Math.abs(p)<5;i||(i=x?Q.restSpeed.granular:Q.restSpeed.default),n||(n=x?Q.restDelta.granular:Q.restDelta.default);let _;if(g<1){const C=Nn(y,g);_=w=>{const v=Math.exp(-g*y*w);return a-v*((m+g*y*p)/C*Math.sin(C*w)+p*Math.cos(C*w))}}else if(g===1)_=C=>a-Math.exp(-y*C)*(p+(m+y*p)*C);else{const C=y*Math.sqrt(g*g-1);_=w=>{const v=Math.exp(-g*y*w),T=Math.min(C*w,300);return a-v*((m+g*y*p)*Math.sinh(T)+C*p*Math.cosh(T))/C}}const b={calculatedDuration:f&&u||null,next:C=>{const w=_(C);if(f)o.done=C>=u;else{let v=C===0?m:0;g<1&&(v=C===0?Lt(m):ic(_,C,w));const T=Math.abs(v)<=i,k=Math.abs(a-w)<=n;o.done=T&&k}return o.value=o.done?a:w,o},toString:()=>{const C=Math.min(Pr(b),mi),w=ec(v=>b.next(C*v).value,C,30);return C+"ms "+w},toTransition:()=>{}};return b}Ps.applyToOptions=s=>{const t=sc(s,100,Ps);return s.ease=t.ease,s.duration=Lt(t.duration),s.type="keyframes",s};function zn({keyframes:s,velocity:t=0,power:e=.8,timeConstant:i=325,bounceDamping:n=10,bounceStiffness:r=500,modifyTarget:a,min:o,max:h,restDelta:l=.5,restSpeed:c}){const u=s[0],d={done:!1,value:u},f=T=>o!==void 0&&T<o||h!==void 0&&T>h,m=T=>o===void 0?h:h===void 0||Math.abs(o-T)<Math.abs(h-T)?o:h;let g=e*t;const p=u+g,y=a===void 0?p:a(p);y!==p&&(g=y-u);const x=T=>-g*Math.exp(-T/i),_=T=>y+x(T),b=T=>{const k=x(T),M=_(T);d.done=Math.abs(k)<=l,d.value=d.done?y:M};let C,w;const v=T=>{f(d.value)&&(C=T,w=Ps({keyframes:[d.value,m(d.value)],velocity:ic(_,T,d.value),damping:n,stiffness:r,restDelta:l,restSpeed:c}))};return v(0),{calculatedDuration:null,next:T=>{let k=!1;return!w&&C===void 0&&(k=!0,b(T),v(T)),C!==void 0&&T>=C?w.next(T-C):(!k&&b(T),d)}}}function ay(s,t,e){const i=[],n=e||Wt.mix||tc,r=s.length-1;for(let a=0;a<r;a++){let o=n(s[a],s[a+1]);if(t){const h=Array.isArray(t)?t[a]||We:t;o=_r(h,o)}i.push(o)}return i}function oy(s,t,{clamp:e=!0,ease:i,mixer:n}={}){const r=s.length;if(yr(r===t.length),r===1)return()=>t[0];if(r===2&&t[0]===t[1])return()=>t[1];const a=s[0]===s[1];s[0]>s[r-1]&&(s=[...s].reverse(),t=[...t].reverse());const o=ay(t,i,n),h=o.length,l=c=>{if(a&&c<s[0])return t[0];let u=0;if(h>1)for(;u<s.length-2&&!(c<s[u+1]);u++);const d=br(s[u],s[u+1],c);return o[u](d)};return e?c=>l(_e(s[0],s[r-1],c)):l}function nc(s,t){const e=s[s.length-1];for(let i=1;i<=t;i++){const n=br(0,t,i);s.push(Ls(e,1,n))}}function rc(s){const t=[0];return nc(t,s.length-1),t}function hy(s,t){return s.map(e=>e*t)}function ly(s,t){return s.map(()=>t||Gl).splice(0,s.length-1)}function _s({duration:s=300,keyframes:t,times:e,ease:i="easeInOut"}){const n=Wl(i)?i.map(vo):vo(i),r={done:!1,value:t[0]},a=hy(e&&e.length===t.length?e:rc(t),s),o=oy(a,t,{ease:Array.isArray(n)?n:ly(t,n)});return{calculatedDuration:s,next:h=>(r.value=o(h),r.done=h>=s,r)}}const cy=s=>s!==null;function Mr(s,{repeat:t,repeatType:e="loop"},i,n=1){const r=s.filter(cy),o=n<0||t&&e!=="loop"&&t%2===1?0:r.length-1;return!o||i===void 0?r[o]:i}const uy={decay:zn,inertia:zn,tween:_s,keyframes:_s,spring:Ps};function ac(s){typeof s.type=="string"&&(s.type=uy[s.type])}class Er{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,e){return this.finished.then(t,e)}}const dy=s=>s/100;class kr extends Er{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var i,n;const{motionValue:e}=this.options;e&&e.updatedAt!==bt.now()&&this.tick(bt.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(n=(i=this.options).onStop)==null||n.call(i))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;ac(t);const{type:e=_s,repeat:i=0,repeatDelay:n=0,repeatType:r,velocity:a=0}=t;let{keyframes:o}=t;const h=e||_s;h!==_s&&typeof o[0]!="number"&&(this.mixKeyframes=_r(dy,tc(o[0],o[1])),o=[0,100]);const l=h({...t,keyframes:o});r==="mirror"&&(this.mirroredGenerator=h({...t,keyframes:[...o].reverse(),velocity:-a})),l.calculatedDuration===null&&(l.calculatedDuration=Pr(l));const{calculatedDuration:c}=l;this.calculatedDuration=c,this.resolvedDuration=c+n,this.totalDuration=this.resolvedDuration*(i+1)-n,this.generator=l}updateTime(t){const e=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=e}tick(t,e=!1){const{generator:i,totalDuration:n,mixKeyframes:r,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:h}=this;if(this.startTime===null)return i.next(0);const{delay:l=0,keyframes:c,repeat:u,repeatType:d,repeatDelay:f,type:m,onUpdate:g,finalKeyframe:p}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-n/this.speed,this.startTime)),e?this.currentTime=t:this.updateTime(t);const y=this.currentTime-l*(this.playbackSpeed>=0?1:-1),x=this.playbackSpeed>=0?y<0:y>n;this.currentTime=Math.max(y,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=n);let _=this.currentTime,b=i;if(u){const T=Math.min(this.currentTime,n)/o;let k=Math.floor(T),M=T%1;!M&&T>=1&&(M=1),M===1&&k--,k=Math.min(k,u+1),!!(k%2)&&(d==="reverse"?(M=1-M,f&&(M-=f/o)):d==="mirror"&&(b=a)),_=_e(0,1,M)*o}const C=x?{done:!1,value:c[0]}:b.next(_);r&&(C.value=r(C.value));let{done:w}=C;!x&&h!==null&&(w=this.playbackSpeed>=0?this.currentTime>=n:this.currentTime<=0);const v=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&w);return v&&m!==zn&&(C.value=Mr(c,this.options,p,this.speed)),g&&g(C.value),v&&this.finish(),C}then(t,e){return this.finished.then(t,e)}get duration(){return Ut(this.calculatedDuration)}get time(){return Ut(this.currentTime)}set time(t){var e;t=Lt(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(e=this.driver)==null||e.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(bt.now());const e=this.playbackSpeed!==t;this.playbackSpeed=t,e&&(this.time=Ut(this.currentTime))}play(){var n,r;if(this.isStopped)return;const{driver:t=Qg,startTime:e}=this.options;this.driver||(this.driver=t(a=>this.tick(a))),(r=(n=this.options).onPlay)==null||r.call(n);const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=e??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(bt.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,e;this.notifyFinished(),this.teardown(),this.state="finished",(e=(t=this.options).onComplete)==null||e.call(t)}cancel(){var t,e;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(e=(t=this.options).onCancel)==null||e.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var e;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(e=this.driver)==null||e.stop(),t.observe(this)}}function fy(s){for(let t=1;t<s.length;t++)s[t]??(s[t]=s[t-1])}const pe=s=>s*180/Math.PI,Un=s=>{const t=pe(Math.atan2(s[1],s[0]));return Gn(t)},py={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:s=>(Math.abs(s[0])+Math.abs(s[3]))/2,rotate:Un,rotateZ:Un,skewX:s=>pe(Math.atan(s[1])),skewY:s=>pe(Math.atan(s[2])),skew:s=>(Math.abs(s[1])+Math.abs(s[2]))/2},Gn=s=>(s=s%360,s<0&&(s+=360),s),Mo=Un,Eo=s=>Math.sqrt(s[0]*s[0]+s[1]*s[1]),ko=s=>Math.sqrt(s[4]*s[4]+s[5]*s[5]),my={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Eo,scaleY:ko,scale:s=>(Eo(s)+ko(s))/2,rotateX:s=>Gn(pe(Math.atan2(s[6],s[5]))),rotateY:s=>Gn(pe(Math.atan2(-s[2],s[0]))),rotateZ:Mo,rotate:Mo,skewX:s=>pe(Math.atan(s[4])),skewY:s=>pe(Math.atan(s[1])),skew:s=>(Math.abs(s[1])+Math.abs(s[4]))/2};function Wn(s){return s.includes("scale")?1:0}function Hn(s,t){if(!s||s==="none")return Wn(t);const e=s.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,n;if(e)i=my,n=e;else{const o=s.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=py,n=o}if(!n)return Wn(t);const r=i[t],a=n[1].split(",").map(yy);return typeof r=="function"?r(a):a[r]}const gy=(s,t)=>{const{transform:e="none"}=getComputedStyle(s);return Hn(e,t)};function yy(s){return parseFloat(s.trim())}const Ye=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],je=new Set(Ye),Ro=s=>s===He||s===O,xy=new Set(["x","y","z"]),_y=Ye.filter(s=>!xy.has(s));function by(s){const t=[];return _y.forEach(e=>{const i=s.getValue(e);i!==void 0&&(t.push([e,i.get()]),i.set(e.startsWith("scale")?1:0))}),t}const me={width:({x:s},{paddingLeft:t="0",paddingRight:e="0"})=>s.max-s.min-parseFloat(t)-parseFloat(e),height:({y:s},{paddingTop:t="0",paddingBottom:e="0"})=>s.max-s.min-parseFloat(t)-parseFloat(e),top:(s,{top:t})=>parseFloat(t),left:(s,{left:t})=>parseFloat(t),bottom:({y:s},{top:t})=>parseFloat(t)+(s.max-s.min),right:({x:s},{left:t})=>parseFloat(t)+(s.max-s.min),x:(s,{transform:t})=>Hn(t,"x"),y:(s,{transform:t})=>Hn(t,"y")};me.translateX=me.x;me.translateY=me.y;const ge=new Set;let $n=!1,Yn=!1,jn=!1;function oc(){if(Yn){const s=Array.from(ge).filter(i=>i.needsMeasurement),t=new Set(s.map(i=>i.element)),e=new Map;t.forEach(i=>{const n=by(i);n.length&&(e.set(i,n),i.render())}),s.forEach(i=>i.measureInitialState()),t.forEach(i=>{i.render();const n=e.get(i);n&&n.forEach(([r,a])=>{var o;(o=i.getValue(r))==null||o.set(a)})}),s.forEach(i=>i.measureEndState()),s.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}Yn=!1,$n=!1,ge.forEach(s=>s.complete(jn)),ge.clear()}function hc(){ge.forEach(s=>{s.readKeyframes(),s.needsMeasurement&&(Yn=!0)})}function wy(){jn=!0,hc(),oc(),jn=!1}class Rr{constructor(t,e,i,n,r,a=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=e,this.name=i,this.motionValue=n,this.element=r,this.isAsync=a}scheduleResolve(){this.state="scheduled",this.isAsync?(ge.add(this),$n||($n=!0,Ht.read(hc),Ht.resolveKeyframes(oc))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:e,element:i,motionValue:n}=this;if(t[0]===null){const r=n==null?void 0:n.get(),a=t[t.length-1];if(r!==void 0)t[0]=r;else if(i&&e){const o=i.readValue(e,a);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=a),n&&r===void 0&&n.set(t[0])}fy(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),ge.delete(this)}cancel(){this.state==="scheduled"&&(ge.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const vy=s=>s.startsWith("--");function Cy(s,t,e){vy(t)?s.style.setProperty(t,e):s.style[t]=e}const Sy=xr(()=>window.ScrollTimeline!==void 0),Ay={};function Ty(s,t){const e=xr(s);return()=>Ay[t]??e()}const lc=Ty(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),fs=([s,t,e,i])=>`cubic-bezier(${s}, ${t}, ${e}, ${i})`,Io={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:fs([0,.65,.55,1]),circOut:fs([.55,0,1,.45]),backIn:fs([.31,.01,.66,-.59]),backOut:fs([.33,1.53,.69,.99])};function cc(s,t){if(s)return typeof s=="function"?lc()?ec(s,t):"ease-out":$l(s)?fs(s):Array.isArray(s)?s.map(e=>cc(e,t)||Io.easeOut):Io[s]}function Py(s,t,e,{delay:i=0,duration:n=300,repeat:r=0,repeatType:a="loop",ease:o="easeOut",times:h}={},l=void 0){const c={[t]:e};h&&(c.offset=h);const u=cc(o,n);Array.isArray(u)&&(c.easing=u);const d={delay:i,duration:n,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:r+1,direction:a==="reverse"?"alternate":"normal"};return l&&(d.pseudoElement=l),s.animate(c,d)}function Ir(s){return typeof s=="function"&&"applyToOptions"in s}function My({type:s,...t}){return Ir(s)&&lc()?s.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class Ey extends Er{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:e,name:i,keyframes:n,pseudoElement:r,allowFlatten:a=!1,finalKeyframe:o,onComplete:h}=t;this.isPseudoElement=!!r,this.allowFlatten=a,this.options=t,yr(typeof t.type!="string");const l=My(t);this.animation=Py(e,i,n,l,r),l.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!r){const c=Mr(n,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(c):Cy(e,i,c),this.animation.cancel()}h==null||h(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,e;(e=(t=this.animation).finish)==null||e.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,e;this.isPseudoElement||(e=(t=this.animation).commitStyles)==null||e.call(t)}get duration(){var e,i;const t=((i=(e=this.animation.effect)==null?void 0:e.getComputedTiming)==null?void 0:i.call(e).duration)||0;return Ut(Number(t))}get time(){return Ut(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Lt(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:e}){var i;return this.allowFlatten&&((i=this.animation.effect)==null||i.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&Sy()?(this.animation.timeline=t,We):e(this)}}const uc={anticipate:zl,backInOut:Nl,circInOut:Ul};function ky(s){return s in uc}function Ry(s){typeof s.ease=="string"&&ky(s.ease)&&(s.ease=uc[s.ease])}const Fo=10;class Iy extends Ey{constructor(t){Ry(t),ac(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:e,onUpdate:i,onComplete:n,element:r,...a}=this.options;if(!e)return;if(t!==void 0){e.set(t);return}const o=new kr({...a,autoplay:!1}),h=Lt(this.finishedTime??this.time);e.setWithVelocity(o.sample(h-Fo).value,o.sample(h).value,Fo),o.stop()}}const Bo=(s,t)=>t==="zIndex"?!1:!!(typeof s=="number"||Array.isArray(s)||typeof s=="string"&&($e.test(s)||s==="0")&&!s.startsWith("url("));function Fy(s){const t=s[0];if(s.length===1)return!0;for(let e=0;e<s.length;e++)if(s[e]!==t)return!0}function By(s,t,e,i){const n=s[0];if(n===null)return!1;if(t==="display"||t==="visibility")return!0;const r=s[s.length-1],a=Bo(n,t),o=Bo(r,t);return!a||!o?!1:Fy(s)||(e==="spring"||Ir(e))&&i}function Ly(s){return Rl(s)&&"offsetHeight"in s}const Oy=new Set(["opacity","clipPath","filter","transform"]),Vy=xr(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Dy(s){var l;const{motionValue:t,name:e,repeatDelay:i,repeatType:n,damping:r,type:a}=s;if(!Ly((l=t==null?void 0:t.owner)==null?void 0:l.current))return!1;const{onUpdate:o,transformTemplate:h}=t.owner.getProps();return Vy()&&e&&Oy.has(e)&&(e!=="transform"||!h)&&!o&&!i&&n!=="mirror"&&r!==0&&a!=="inertia"}const Ny=40;class zy extends Er{constructor({autoplay:t=!0,delay:e=0,type:i="keyframes",repeat:n=0,repeatDelay:r=0,repeatType:a="loop",keyframes:o,name:h,motionValue:l,element:c,...u}){var m;super(),this.stop=()=>{var g,p;this._animation&&(this._animation.stop(),(g=this.stopTimeline)==null||g.call(this)),(p=this.keyframeResolver)==null||p.cancel()},this.createdAt=bt.now();const d={autoplay:t,delay:e,type:i,repeat:n,repeatDelay:r,repeatType:a,name:h,motionValue:l,element:c,...u},f=(c==null?void 0:c.KeyframeResolver)||Rr;this.keyframeResolver=new f(o,(g,p,y)=>this.onKeyframesResolved(g,p,d,!y),h,l,c),(m=this.keyframeResolver)==null||m.scheduleResolve()}onKeyframesResolved(t,e,i,n){this.keyframeResolver=void 0;const{name:r,type:a,velocity:o,delay:h,isHandoff:l,onUpdate:c}=i;this.resolvedAt=bt.now(),By(t,r,a,o)||((Wt.instantAnimations||!h)&&(c==null||c(Mr(t,i,e))),t[0]=t[t.length-1],i.duration=0,i.repeat=0);const d={startTime:n?this.resolvedAt?this.resolvedAt-this.createdAt>Ny?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:e,...i,keyframes:t},f=!l&&Dy(d)?new Iy({...d,element:d.motionValue.owner.current}):new kr(d);f.finished.then(()=>this.notifyFinished()).catch(We),this.pendingTimeline&&(this.stopTimeline=f.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=f}get finished(){return this._animation?this.animation.finished:this._finished}then(t,e){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),wy()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}class Uy{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>t.finished))}getAll(t){return this.animations[0][t]}setAll(t,e){for(let i=0;i<this.animations.length;i++)this.animations[i][t]=e}attachTimeline(t){const e=this.animations.map(i=>i.attachTimeline(t));return()=>{e.forEach((i,n)=>{i&&i(),this.animations[n].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get state(){return this.getAll("state")}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let e=0;e<this.animations.length;e++)t=Math.max(t,this.animations[e].duration);return t}runAll(t){this.animations.forEach(e=>e[t]())}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Gy extends Uy{then(t,e){return this.finished.finally(t).then(()=>{})}}const Wy=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Hy(s){const t=Wy.exec(s);if(!t)return[,];const[,e,i,n]=t;return[`--${e??i}`,n]}function dc(s,t,e=1){const[i,n]=Hy(s);if(!i)return;const r=window.getComputedStyle(t).getPropertyValue(i);if(r){const a=r.trim();return kl(a)?parseFloat(a):a}return Cr(n)?dc(n,t,e+1):n}function fc(s,t){return(s==null?void 0:s[t])??(s==null?void 0:s.default)??s}const pc=new Set(["width","height","top","left","right","bottom",...Ye]),$y={test:s=>s==="auto",parse:s=>s},mc=s=>t=>t.test(s),gc=[He,O,Re,Qt,Og,Lg,$y],Lo=s=>gc.find(mc(s));function Yy(s){return typeof s=="number"?s===0:s!==null?s==="none"||s==="0"||Il(s):!0}const jy=new Set(["brightness","contrast","saturate","opacity"]);function Xy(s){const[t,e]=s.slice(0,-1).split("(");if(t==="drop-shadow")return s;const[i]=e.match(Sr)||[];if(!i)return s;const n=e.replace(i,"");let r=jy.has(t)?1:0;return i!==e&&(r*=100),t+"("+r+n+")"}const Ky=/\b([a-z-]*)\(.*?\)/gu,Xn={...$e,getAnimatableNone:s=>{const t=s.match(Ky);return t?t.map(Xy).join(" "):s}},Oo={...He,transform:Math.round},qy={rotate:Qt,rotateX:Qt,rotateY:Qt,rotateZ:Qt,scale:Js,scaleX:Js,scaleY:Js,scaleZ:Js,skew:Qt,skewX:Qt,skewY:Qt,distance:O,translateX:O,translateY:O,translateZ:O,x:O,y:O,z:O,perspective:O,transformPerspective:O,opacity:As,originX:Co,originY:Co,originZ:O},Fr={borderWidth:O,borderTopWidth:O,borderRightWidth:O,borderBottomWidth:O,borderLeftWidth:O,borderRadius:O,radius:O,borderTopLeftRadius:O,borderTopRightRadius:O,borderBottomRightRadius:O,borderBottomLeftRadius:O,width:O,maxWidth:O,height:O,maxHeight:O,top:O,right:O,bottom:O,left:O,padding:O,paddingTop:O,paddingRight:O,paddingBottom:O,paddingLeft:O,margin:O,marginTop:O,marginRight:O,marginBottom:O,marginLeft:O,backgroundPositionX:O,backgroundPositionY:O,...qy,zIndex:Oo,fillOpacity:As,strokeOpacity:As,numOctaves:Oo},Zy={...Fr,color:st,backgroundColor:st,outlineColor:st,fill:st,stroke:st,borderColor:st,borderTopColor:st,borderRightColor:st,borderBottomColor:st,borderLeftColor:st,filter:Xn,WebkitFilter:Xn},yc=s=>Zy[s];function xc(s,t){let e=yc(s);return e!==Xn&&(e=$e),e.getAnimatableNone?e.getAnimatableNone(t):void 0}const Qy=new Set(["auto","none","0"]);function Jy(s,t,e){let i=0,n;for(;i<s.length&&!n;){const r=s[i];typeof r=="string"&&!Qy.has(r)&&Ts(r).values.length&&(n=s[i]),i++}if(n&&e)for(const r of t)s[r]=xc(e,n)}class tx extends Rr{constructor(t,e,i,n,r){super(t,e,i,n,r,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:e,name:i}=this;if(!e||!e.current)return;super.readKeyframes();for(let h=0;h<t.length;h++){let l=t[h];if(typeof l=="string"&&(l=l.trim(),Cr(l))){const c=dc(l,e.current);c!==void 0&&(t[h]=c),h===t.length-1&&(this.finalKeyframe=l)}}if(this.resolveNoneKeyframes(),!pc.has(i)||t.length!==2)return;const[n,r]=t,a=Lo(n),o=Lo(r);if(a!==o)if(Ro(a)&&Ro(o))for(let h=0;h<t.length;h++){const l=t[h];typeof l=="string"&&(t[h]=parseFloat(l))}else me[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:e}=this,i=[];for(let n=0;n<t.length;n++)(t[n]===null||Yy(t[n]))&&i.push(n);i.length&&Jy(t,i,e)}measureInitialState(){const{element:t,unresolvedKeyframes:e,name:i}=this;if(!t||!t.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=me[i](t.measureViewportBox(),window.getComputedStyle(t.current)),e[0]=this.measuredOrigin;const n=e[e.length-1];n!==void 0&&t.getValue(i,n).jump(n,!1)}measureEndState(){var o;const{element:t,name:e,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const n=t.getValue(e);n&&n.jump(this.measuredOrigin,!1);const r=i.length-1,a=i[r];i[r]=me[e](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([h,l])=>{t.getValue(h).set(l)}),this.resolveNoneKeyframes()}}function ex(s,t,e){if(s instanceof EventTarget)return[s];if(typeof s=="string"){let i=document;const n=(e==null?void 0:e[s])??i.querySelectorAll(s);return n?Array.from(n):[]}return Array.from(s)}const _c=(s,t)=>t&&typeof s=="number"?t.transform(s):s,Vo=30,sx=s=>!isNaN(parseFloat(s));class ix{constructor(t,e={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,n=!0)=>{var a,o;const r=bt.now();if(this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current),this.dependents))for(const h of this.dependents)h.dirty();n&&((o=this.events.renderRequest)==null||o.notify(this.current))},this.hasAnimated=!1,this.setCurrent(t),this.owner=e.owner}setCurrent(t){this.current=t,this.updatedAt=bt.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=sx(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,e){this.events[t]||(this.events[t]=new Fl);const i=this.events[t].add(e);return t==="change"?()=>{i(),Ht.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,e){this.passiveEffect=t,this.stopPassiveEffect=e}set(t,e=!0){!e||!this.passiveEffect?this.updateAndNotify(t,e):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,e,i){this.set(e),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-i}jump(t,e=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,e&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=bt.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Vo)return 0;const e=Math.min(this.updatedAt-this.prevUpdatedAt,Vo);return Bl(parseFloat(this.current)-parseFloat(this.prevFrameValue),e)}start(t){return this.stop(),new Promise(e=>{this.hasAnimated=!0,this.animation=t(e),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,e;(t=this.dependents)==null||t.clear(),(e=this.events.destroy)==null||e.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ms(s,t){return new ix(s,t)}function bc(s){return Rl(s)&&"ownerSVGElement"in s}function nx(s){return bc(s)&&s.tagName==="svg"}const dt=s=>!!(s&&s.getVelocity),rx=[...gc,st,$e],ax=s=>rx.find(mc(s));function Br(s){return typeof s=="object"&&!Array.isArray(s)}function wc(s,t,e,i){return typeof s=="string"&&Br(t)?ex(s,e,i):s instanceof NodeList?Array.from(s):Array.isArray(s)?s:[s]}function ox(s,t,e){return s*(t+1)}function Do(s,t,e,i){return typeof t=="number"?t:t.startsWith("-")||t.startsWith("+")?Math.max(0,s+parseFloat(t)):t==="<"?e:t.startsWith("<")?Math.max(0,e+parseFloat(t.slice(1))):i.get(t)??s}function hx(s,t,e){for(let i=0;i<s.length;i++){const n=s[i];n.at>t&&n.at<e&&(El(s,n),i--)}}function lx(s,t,e,i,n,r){hx(s,n,r);for(let a=0;a<t.length;a++)s.push({value:t[a],at:Ls(n,r,i[a]),easing:Hl(e,a)})}function cx(s,t){for(let e=0;e<s.length;e++)s[e]=s[e]/(t+1)}function ux(s,t){return s.at===t.at?s.value===null?1:t.value===null?-1:0:s.at-t.at}const dx="easeInOut";function fx(s,{defaultTransition:t={},...e}={},i,n){const r=t.duration||.3,a=new Map,o=new Map,h={},l=new Map;let c=0,u=0,d=0;for(let f=0;f<s.length;f++){const m=s[f];if(typeof m=="string"){l.set(m,u);continue}else if(!Array.isArray(m)){l.set(m.name,Do(u,m.at,c,l));continue}let[g,p,y={}]=m;y.at!==void 0&&(u=Do(u,y.at,c,l));let x=0;const _=(b,C,w,v=0,T=0)=>{const k=px(b),{delay:M=0,times:E=rc(k),type:U="keyframes",repeat:L,repeatType:rt,repeatDelay:Yt=0,...B}=C;let{ease:F=t.ease||"easeOut",duration:wt}=C;const H=typeof M=="function"?M(v,T):M,vt=k.length,jt=Ir(U)?U:n==null?void 0:n[U||"keyframes"];if(vt<=2&&jt){let Mt=100;if(vt===2&&yx(k)){const qt=k[1]-k[0];Mt=Math.abs(qt)}const Et={...B};wt!==void 0&&(Et.duration=Lt(wt));const te=sc(Et,Mt,jt);F=te.ease,wt=te.duration}wt??(wt=r);const Xt=u+H;E.length===1&&E[0]===0&&(E[1]=1);const Kt=E.length-k.length;if(Kt>0&&nc(E,Kt),k.length===1&&k.unshift(null),L){wt=ox(wt,L);const Mt=[...k],Et=[...E];F=Array.isArray(F)?[...F]:[F];const te=[...F];for(let qt=0;qt<L;qt++){k.push(...Mt);for(let kt=0;kt<Mt.length;kt++)E.push(Et[kt]+(qt+1)),F.push(kt===0?"linear":Hl(te,kt-1))}cx(E,L)}const Xe=Xt+wt;lx(w,k,F,E,Xt,Xe),x=Math.max(H+wt,x),d=Math.max(Xe,d)};if(dt(g)){const b=No(g,o);_(p,y,zo("default",b))}else{const b=wc(g,p,i,h),C=b.length;for(let w=0;w<C;w++){p=p,y=y;const v=b[w],T=No(v,o);for(const k in p)_(p[k],mx(y,k),zo(k,T),w,C)}}c=u,u+=x}return o.forEach((f,m)=>{for(const g in f){const p=f[g];p.sort(ux);const y=[],x=[],_=[];for(let C=0;C<p.length;C++){const{at:w,value:v,easing:T}=p[C];y.push(v),x.push(br(0,d,w)),_.push(T||"easeOut")}x[0]!==0&&(x.unshift(0),y.unshift(y[0]),_.unshift(dx)),x[x.length-1]!==1&&(x.push(1),y.push(null)),a.has(m)||a.set(m,{keyframes:{},transition:{}});const b=a.get(m);b.keyframes[g]=y,b.transition[g]={...t,duration:d,ease:_,times:x,...e}}}),a}function No(s,t){return!t.has(s)&&t.set(s,{}),t.get(s)}function zo(s,t){return t[s]||(t[s]=[]),t[s]}function px(s){return Array.isArray(s)?s:[s]}function mx(s,t){return s&&s[t]?{...s,...s[t]}:{...s}}const gx=s=>typeof s=="number",yx=s=>s.every(gx),Es=new WeakMap,xx=s=>Array.isArray(s);function Uo(s){const t=[{},{}];return s==null||s.values.forEach((e,i)=>{t[0][i]=e.get(),t[1][i]=e.getVelocity()}),t}function vc(s,t,e,i){if(typeof t=="function"){const[n,r]=Uo(i);t=t(e!==void 0?e:s.custom,n,r)}if(typeof t=="string"&&(t=s.variants&&s.variants[t]),typeof t=="function"){const[n,r]=Uo(i);t=t(e!==void 0?e:s.custom,n,r)}return t}function _x(s,t,e){const i=s.getProps();return vc(i,t,i.custom,s)}function bx(s,t,e){s.hasValue(t)?s.getValue(t).set(e):s.addValue(t,Ms(e))}function wx(s){return xx(s)?s[s.length-1]||0:s}function vx(s,t){const e=_x(s,t);let{transitionEnd:i={},transition:n={},...r}=e||{};r={...r,...i};for(const a in r){const o=wx(r[a]);bx(s,a,o)}}function Cx(s){return!!(dt(s)&&s.add)}function Sx(s,t){const e=s.getValue("willChange");if(Cx(e))return e.add(t);if(!e&&Wt.WillChange){const i=new Wt.WillChange("auto");s.addValue("willChange",i),i.add(t)}}const Lr=s=>s.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Ax="framerAppearId",Tx="data-"+Lr(Ax);function Px(s){return s.props[Tx]}const Mx=s=>s!==null;function Ex(s,{repeat:t,repeatType:e="loop"},i){const n=s.filter(Mx),r=t&&e!=="loop"&&t%2===1?0:n.length-1;return n[r]}const kx={type:"spring",stiffness:500,damping:25,restSpeed:10},Rx=s=>({type:"spring",stiffness:550,damping:s===0?2*Math.sqrt(550):30,restSpeed:10}),Ix={type:"keyframes",duration:.8},Fx={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Bx=(s,{keyframes:t})=>t.length>2?Ix:je.has(s)?s.startsWith("scale")?Rx(t[1]):kx:Fx;function Lx({when:s,delay:t,delayChildren:e,staggerChildren:i,staggerDirection:n,repeat:r,repeatType:a,repeatDelay:o,from:h,elapsed:l,...c}){return!!Object.keys(c).length}const Cc=(s,t,e,i={},n,r)=>a=>{const o=fc(i,s)||{},h=o.delay||i.delay||0;let{elapsed:l=0}=i;l=l-Lt(h);const c={keyframes:Array.isArray(e)?e:[null,e],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-l,onUpdate:d=>{t.set(d),o.onUpdate&&o.onUpdate(d)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:s,motionValue:t,element:r?void 0:n};Lx(o)||Object.assign(c,Bx(s,c)),c.duration&&(c.duration=Lt(c.duration)),c.repeatDelay&&(c.repeatDelay=Lt(c.repeatDelay)),c.from!==void 0&&(c.keyframes[0]=c.from);let u=!1;if((c.type===!1||c.duration===0&&!c.repeatDelay)&&(c.duration=0,c.delay===0&&(u=!0)),(Wt.instantAnimations||Wt.skipAnimations)&&(u=!0,c.duration=0,c.delay=0),c.allowFlatten=!o.type&&!o.ease,u&&!r&&t.get()!==void 0){const d=Ex(c.keyframes,o);if(d!==void 0){Ht.update(()=>{c.onUpdate(d),c.onComplete()});return}}return o.isSync?new kr(c):new zy(c)};function Ox({protectedKeys:s,needsAnimating:t},e){const i=s.hasOwnProperty(e)&&t[e]!==!0;return t[e]=!1,i}function Vx(s,t,{delay:e=0,transitionOverride:i,type:n}={}){let{transition:r=s.getDefaultTransition(),transitionEnd:a,...o}=t;i&&(r=i);const h=[],l=n&&s.animationState&&s.animationState.getState()[n];for(const c in o){const u=s.getValue(c,s.latestValues[c]??null),d=o[c];if(d===void 0||l&&Ox(l,c))continue;const f={delay:e,...fc(r||{},c)},m=u.get();if(m!==void 0&&!u.isAnimating&&!Array.isArray(d)&&d===m&&!f.velocity)continue;let g=!1;if(window.MotionHandoffAnimation){const y=Px(s);if(y){const x=window.MotionHandoffAnimation(y,c,Ht);x!==null&&(f.startTime=x,g=!0)}}Sx(s,c),u.start(Cc(c,u,d,s.shouldReduceMotion&&pc.has(c)?{type:!1}:f,s,g));const p=u.animation;p&&h.push(p)}return a&&Promise.all(h).then(()=>{Ht.update(()=>{a&&vx(s,a)})}),h}function Dx({top:s,left:t,right:e,bottom:i}){return{x:{min:t,max:e},y:{min:s,max:i}}}function Nx(s,t){if(!t)return s;const e=t({x:s.left,y:s.top}),i=t({x:s.right,y:s.bottom});return{top:e.y,left:e.x,bottom:i.y,right:i.x}}function zx(s,t){return Dx(Nx(s.getBoundingClientRect(),t))}const Go={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Kn={};for(const s in Go)Kn[s]={isEnabled:t=>Go[s].some(e=>!!t[e])};const Wo=()=>({min:0,max:0}),Or=()=>({x:Wo(),y:Wo()}),Ux=typeof window<"u",qn={current:null},Sc={current:!1};function Gx(){if(Sc.current=!0,!!Ux)if(window.matchMedia){const s=window.matchMedia("(prefers-reduced-motion)"),t=()=>qn.current=s.matches;s.addEventListener("change",t),t()}else qn.current=!1}function Wx(s){return s!==null&&typeof s=="object"&&typeof s.start=="function"}function Hx(s){return typeof s=="string"||Array.isArray(s)}const $x=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Yx=["initial",...$x];function Ac(s){return Wx(s.animate)||Yx.some(t=>Hx(s[t]))}function jx(s){return!!(Ac(s)||s.variants)}function Xx(s,t,e){for(const i in t){const n=t[i],r=e[i];if(dt(n))s.addValue(i,n);else if(dt(r))s.addValue(i,Ms(n,{owner:s}));else if(r!==n)if(s.hasValue(i)){const a=s.getValue(i);a.liveStyle===!0?a.jump(n):a.hasAnimated||a.set(n)}else{const a=s.getStaticValue(i);s.addValue(i,Ms(a!==void 0?a:n,{owner:s}))}}for(const i in e)t[i]===void 0&&s.removeValue(i);return t}const Ho=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Tc{scrapeMotionValuesFromProps(t,e,i){return{}}constructor({parent:t,props:e,presenceContext:i,reducedMotionConfig:n,blockInitialAnimation:r,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Rr,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const d=bt.now();this.renderScheduledAt<d&&(this.renderScheduledAt=d,Ht.render(this.render,!1,!0))};const{latestValues:h,renderState:l}=a;this.latestValues=h,this.baseTarget={...h},this.initialValues=e.initial?{...h}:{},this.renderState=l,this.parent=t,this.props=e,this.presenceContext=i,this.depth=t?t.depth+1:0,this.reducedMotionConfig=n,this.options=o,this.blockInitialAnimation=!!r,this.isControllingVariants=Ac(e),this.isVariantNode=jx(e),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:c,...u}=this.scrapeMotionValuesFromProps(e,{},this);for(const d in u){const f=u[d];h[d]!==void 0&&dt(f)&&f.set(h[d],!1)}}mount(t){this.current=t,Es.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,i)=>this.bindToMotionValue(i,e)),Sc.current||Gx(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:qn.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),On(this.notifyUpdate),On(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const e=this.features[t];e&&(e.unmount(),e.isMounted=!1)}this.current=null}bindToMotionValue(t,e){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const i=je.has(t);i&&this.onBindTransform&&this.onBindTransform();const n=e.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&Ht.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),r=e.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,e)),this.valueSubscriptions.set(t,()=>{n(),r(),a&&a(),e.owner&&e.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Kn){const e=Kn[t];if(!e)continue;const{isEnabled:i,Feature:n}=e;if(!this.features[t]&&n&&i(this.props)&&(this.features[t]=new n(this)),this.features[t]){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Or()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,e){this.latestValues[t]=e}update(t,e){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=e;for(let i=0;i<Ho.length;i++){const n=Ho[i];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const r="on"+n,a=t[r];a&&(this.propEventSubscriptions[n]=this.on(n,a))}this.prevMotionValues=Xx(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const e=this.getClosestVariantNode();if(e)return e.variantChildren&&e.variantChildren.add(t),()=>e.variantChildren.delete(t)}addValue(t,e){const i=this.values.get(t);e!==i&&(i&&this.removeValue(t),this.bindToMotionValue(t,e),this.values.set(t,e),this.latestValues[t]=e.get())}removeValue(t){this.values.delete(t);const e=this.valueSubscriptions.get(t);e&&(e(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,e){if(this.props.values&&this.props.values[t])return this.props.values[t];let i=this.values.get(t);return i===void 0&&e!==void 0&&(i=Ms(e===null?void 0:e,{owner:this}),this.addValue(t,i)),i}readValue(t,e){let i=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return i!=null&&(typeof i=="string"&&(kl(i)||Il(i))?i=parseFloat(i):!ax(i)&&$e.test(e)&&(i=xc(t,e)),this.setBaseTarget(t,dt(i)?i.get():i)),dt(i)?i.get():i}setBaseTarget(t,e){this.baseTarget[t]=e}getBaseTarget(t){var r;const{initial:e}=this.props;let i;if(typeof e=="string"||typeof e=="object"){const a=vc(this.props,e,(r=this.presenceContext)==null?void 0:r.custom);a&&(i=a[t])}if(e&&i!==void 0)return i;const n=this.getBaseTargetFromProps(this.props,t);return n!==void 0&&!dt(n)?n:this.initialValues[t]!==void 0&&i===void 0?void 0:this.baseTarget[t]}on(t,e){return this.events[t]||(this.events[t]=new Fl),this.events[t].add(e)}notify(t,...e){this.events[t]&&this.events[t].notify(...e)}}class Pc extends Tc{constructor(){super(...arguments),this.KeyframeResolver=tx}sortInstanceNodePosition(t,e){return t.compareDocumentPosition(e)&2?1:-1}getBaseTargetFromProps(t,e){return t.style?t.style[e]:void 0}removeValueFromRenderState(t,{vars:e,style:i}){delete e[t],delete i[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;dt(t)&&(this.childSubscription=t.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}const Kx={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},qx=Ye.length;function Zx(s,t,e){let i="",n=!0;for(let r=0;r<qx;r++){const a=Ye[r],o=s[a];if(o===void 0)continue;let h=!0;if(typeof o=="number"?h=o===(a.startsWith("scale")?1:0):h=parseFloat(o)===0,!h||e){const l=_c(o,Fr[a]);if(!h){n=!1;const c=Kx[a]||a;i+=`${c}(${l}) `}e&&(t[a]=l)}}return i=i.trim(),e?i=e(t,n?"":i):n&&(i="none"),i}function Mc(s,t,e){const{style:i,vars:n,transformOrigin:r}=s;let a=!1,o=!1;for(const h in t){const l=t[h];if(je.has(h)){a=!0;continue}else if(jl(h)){n[h]=l;continue}else{const c=_c(l,Fr[h]);h.startsWith("origin")?(o=!0,r[h]=c):i[h]=c}}if(t.transform||(a||e?i.transform=Zx(t,s.transform,e):i.transform&&(i.transform="none")),o){const{originX:h="50%",originY:l="50%",originZ:c=0}=r;i.transformOrigin=`${h} ${l} ${c}`}}function Ec(s,{style:t,vars:e},i,n){const r=s.style;let a;for(a in t)r[a]=t[a];n==null||n.applyProjectionStyles(r,i);for(a in e)r.setProperty(a,e[a])}const Qx={};function Jx(s,{layout:t,layoutId:e}){return je.has(s)||s.startsWith("origin")||(t||e!==void 0)&&(!!Qx[s]||s==="opacity")}function kc(s,t,e){var r;const{style:i}=s,n={};for(const a in i)(dt(i[a])||t.style&&dt(t.style[a])||Jx(a,s)||((r=e==null?void 0:e.getValue(a))==null?void 0:r.liveStyle)!==void 0)&&(n[a]=i[a]);return n}function t0(s){return window.getComputedStyle(s)}class e0 extends Pc{constructor(){super(...arguments),this.type="html",this.renderInstance=Ec}readValueFromInstance(t,e){var i;if(je.has(e))return(i=this.projection)!=null&&i.isProjecting?Wn(e):gy(t,e);{const n=t0(t),r=(jl(e)?n.getPropertyValue(e):n[e])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(t,{transformPagePoint:e}){return zx(t,e)}build(t,e,i){Mc(t,e,i.transformTemplate)}scrapeMotionValuesFromProps(t,e,i){return kc(t,e,i)}}function s0(s,t){return s in t}class i0 extends Tc{constructor(){super(...arguments),this.type="object"}readValueFromInstance(t,e){if(s0(e,t)){const i=t[e];if(typeof i=="string"||typeof i=="number")return i}}getBaseTargetFromProps(){}removeValueFromRenderState(t,e){delete e.output[t]}measureInstanceViewportBox(){return Or()}build(t,e){Object.assign(t.output,e)}renderInstance(t,{output:e}){Object.assign(t,e)}sortInstanceNodePosition(){return 0}}const n0={offset:"stroke-dashoffset",array:"stroke-dasharray"},r0={offset:"strokeDashoffset",array:"strokeDasharray"};function a0(s,t,e=1,i=0,n=!0){s.pathLength=1;const r=n?n0:r0;s[r.offset]=O.transform(-i);const a=O.transform(t),o=O.transform(e);s[r.array]=`${a} ${o}`}function o0(s,{attrX:t,attrY:e,attrScale:i,pathLength:n,pathSpacing:r=1,pathOffset:a=0,...o},h,l,c){if(Mc(s,o,l),h){s.style.viewBox&&(s.attrs.viewBox=s.style.viewBox);return}s.attrs=s.style,s.style={};const{attrs:u,style:d}=s;u.transform&&(d.transform=u.transform,delete u.transform),(d.transform||u.transformOrigin)&&(d.transformOrigin=u.transformOrigin??"50% 50%",delete u.transformOrigin),d.transform&&(d.transformBox=(c==null?void 0:c.transformBox)??"fill-box",delete u.transformBox),t!==void 0&&(u.x=t),e!==void 0&&(u.y=e),i!==void 0&&(u.scale=i),n!==void 0&&a0(u,n,r,a,!1)}const Rc=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),h0=s=>typeof s=="string"&&s.toLowerCase()==="svg";function l0(s,t,e,i){Ec(s,t,void 0,i);for(const n in t.attrs)s.setAttribute(Rc.has(n)?n:Lr(n),t.attrs[n])}function c0(s,t,e){const i=kc(s,t,e);for(const n in s)if(dt(s[n])||dt(t[n])){const r=Ye.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;i[r]=s[n]}return i}class u0 extends Pc{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Or}getBaseTargetFromProps(t,e){return t[e]}readValueFromInstance(t,e){if(je.has(e)){const i=yc(e);return i&&i.default||0}return e=Rc.has(e)?e:Lr(e),t.getAttribute(e)}scrapeMotionValuesFromProps(t,e,i){return c0(t,e,i)}build(t,e,i){o0(t,e,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(t,e,i,n){l0(t,e,i,n)}mount(t){this.isSVGTag=h0(t.tagName),super.mount(t)}}function d0(s){const t={presenceContext:null,props:{},visualState:{renderState:{transform:{},transformOrigin:{},style:{},vars:{},attrs:{}},latestValues:{}}},e=bc(s)&&!nx(s)?new u0(t):new e0(t);e.mount(s),Es.set(s,e)}function f0(s){const t={presenceContext:null,props:{},visualState:{renderState:{output:{}},latestValues:{}}},e=new i0(t);e.mount(s),Es.set(s,e)}function p0(s,t,e){const i=dt(s)?s:Ms(s);return i.start(Cc("",i,t,e)),i.animation}function m0(s,t){return dt(s)||typeof s=="number"||typeof s=="string"&&!Br(t)}function Ic(s,t,e,i){const n=[];if(m0(s,t))n.push(p0(s,Br(t)&&t.default||t,e&&(e.default||e)));else{const r=wc(s,t,i),a=r.length;for(let o=0;o<a;o++){const h=r[o],l=h instanceof Element?d0:f0;Es.has(h)||l(h);const c=Es.get(h),u={...e};"delay"in u&&typeof u.delay=="function"&&(u.delay=u.delay(o,a)),n.push(...Vx(c,{...t,transition:u},{}))}}return n}function g0(s,t,e){const i=[];return fx(s,t,e,{spring:Ps}).forEach(({keyframes:r,transition:a},o)=>{i.push(...Ic(o,r,a))}),i}function y0(s){return Array.isArray(s)&&s.some(Array.isArray)}function x0(s){function t(e,i,n){let r=[];return y0(e)?r=g0(e,i,s):r=Ic(e,i,n,s),new Gy(r)}return t}const Zn=x0();class Fc extends ft{constructor(){super();A(this,"pixiLogo");A(this,"progressBar");this.progressBar=new fg({backgroundColor:"#3d3d3d",fillColor:"#e72264",radius:100,lineWidth:15,value:20,backgroundAlpha:.5,fillAlpha:.8,cap:"round"}),this.progressBar.x+=this.progressBar.width/2,this.progressBar.y+=-this.progressBar.height/2,this.addChild(this.progressBar),this.pixiLogo=new _t({texture:D.from("logo.svg"),anchor:.5,scale:.2}),this.addChild(this.pixiLogo)}onLoad(e){this.progressBar.progress=e}resize(e,i){this.pixiLogo.position.set(e*.5,i*.5),this.progressBar.position.set(e*.5,i*.5)}async show(){this.alpha=1}async hide(){await Zn(this,{alpha:0},{duration:.3,ease:"linear",delay:1})}}A(Fc,"assetBundles",["preload"]);class G{constructor(t,e,i,n,r,a,o,h=0,l=0,c=0,u=0){A(this,"id");A(this,"name");A(this,"type");A(this,"rarity");A(this,"cost");A(this,"damage");A(this,"description");A(this,"shieldChance");A(this,"shieldAmount");A(this,"returnChance");A(this,"shieldPierce");this.id=t,this.name=e,this.type=i,this.rarity=n,this.cost=r,this.damage=a,this.description=o,this.shieldChance=Math.max(0,Math.min(1,h)),this.shieldAmount=Math.max(0,l),this.returnChance=Math.max(0,Math.min(1,c)),this.shieldPierce=Math.max(0,u)}getDamage(){return this.damage}shouldGrantShield(){return Math.random()<this.shieldChance}shouldReturnToHand(){return Math.random()<this.returnChance}}const S={ROCK:"rock",PAPER:"paper",SCISSORS:"scissors",RUBBER_BAND:"rubber_band",CANDLE:"candle",COLA:"cola",PLANT:"plant",SPECTACLES:"spectacles",JELLY_CUP:"jelly_cup"},z={COMMON:"common",UNCOMMON:"uncommon",RARE:"rare"},P={SUPER_EFFECTIVE:2,EFFECTIVE:1.5,NEUTRAL:1,NOT_EFFECTIVE:.75,NOT_VERY_EFFECTIVE:.5},_0={[S.ROCK]:{[S.ROCK]:P.NEUTRAL,[S.PAPER]:P.NOT_VERY_EFFECTIVE,[S.SCISSORS]:P.SUPER_EFFECTIVE,[S.RUBBER_BAND]:P.EFFECTIVE,[S.CANDLE]:P.NOT_EFFECTIVE,[S.COLA]:P.NOT_VERY_EFFECTIVE,[S.PLANT]:P.SUPER_EFFECTIVE,[S.SPECTACLES]:P.EFFECTIVE,[S.JELLY_CUP]:P.NEUTRAL},[S.PAPER]:{[S.ROCK]:P.SUPER_EFFECTIVE,[S.PAPER]:P.NEUTRAL,[S.SCISSORS]:P.NOT_VERY_EFFECTIVE,[S.RUBBER_BAND]:P.NOT_EFFECTIVE,[S.CANDLE]:P.EFFECTIVE,[S.COLA]:P.NEUTRAL,[S.PLANT]:P.EFFECTIVE,[S.SPECTACLES]:P.NOT_VERY_EFFECTIVE,[S.JELLY_CUP]:P.NEUTRAL},[S.SCISSORS]:{[S.ROCK]:P.NOT_VERY_EFFECTIVE,[S.PAPER]:P.SUPER_EFFECTIVE,[S.SCISSORS]:P.NEUTRAL,[S.RUBBER_BAND]:P.NEUTRAL,[S.CANDLE]:P.SUPER_EFFECTIVE,[S.COLA]:P.NOT_VERY_EFFECTIVE,[S.PLANT]:P.EFFECTIVE,[S.SPECTACLES]:P.EFFECTIVE,[S.JELLY_CUP]:P.NOT_EFFECTIVE},[S.RUBBER_BAND]:{[S.ROCK]:P.NOT_EFFECTIVE,[S.PAPER]:P.EFFECTIVE,[S.SCISSORS]:P.NEUTRAL,[S.RUBBER_BAND]:P.NEUTRAL,[S.CANDLE]:P.EFFECTIVE,[S.COLA]:P.NOT_EFFECTIVE,[S.PLANT]:P.NOT_EFFECTIVE,[S.SPECTACLES]:P.NOT_VERY_EFFECTIVE,[S.JELLY_CUP]:P.SUPER_EFFECTIVE},[S.CANDLE]:{[S.ROCK]:P.EFFECTIVE,[S.PAPER]:P.EFFECTIVE,[S.SCISSORS]:P.NOT_EFFECTIVE,[S.RUBBER_BAND]:P.NOT_VERY_EFFECTIVE,[S.CANDLE]:P.NEUTRAL,[S.COLA]:P.NOT_VERY_EFFECTIVE,[S.PLANT]:P.SUPER_EFFECTIVE,[S.SPECTACLES]:P.SUPER_EFFECTIVE,[S.JELLY_CUP]:P.EFFECTIVE},[S.COLA]:{[S.ROCK]:P.SUPER_EFFECTIVE,[S.PAPER]:P.NEUTRAL,[S.SCISSORS]:P.EFFECTIVE,[S.RUBBER_BAND]:P.EFFECTIVE,[S.CANDLE]:P.SUPER_EFFECTIVE,[S.COLA]:P.NEUTRAL,[S.PLANT]:P.NOT_VERY_EFFECTIVE,[S.SPECTACLES]:P.NOT_VERY_EFFECTIVE,[S.JELLY_CUP]:P.NEUTRAL},[S.PLANT]:{[S.ROCK]:P.NOT_EFFECTIVE,[S.PAPER]:P.NOT_VERY_EFFECTIVE,[S.SCISSORS]:P.EFFECTIVE,[S.RUBBER_BAND]:P.SUPER_EFFECTIVE,[S.CANDLE]:P.NOT_VERY_EFFECTIVE,[S.COLA]:P.SUPER_EFFECTIVE,[S.PLANT]:P.NEUTRAL,[S.SPECTACLES]:P.NOT_VERY_EFFECTIVE,[S.JELLY_CUP]:P.EFFECTIVE},[S.SPECTACLES]:{[S.ROCK]:P.EFFECTIVE,[S.PAPER]:P.SUPER_EFFECTIVE,[S.SCISSORS]:P.NOT_VERY_EFFECTIVE,[S.RUBBER_BAND]:P.NOT_EFFECTIVE,[S.CANDLE]:P.NOT_VERY_EFFECTIVE,[S.COLA]:P.EFFECTIVE,[S.PLANT]:P.NOT_EFFECTIVE,[S.SPECTACLES]:P.NEUTRAL,[S.JELLY_CUP]:P.SUPER_EFFECTIVE},[S.JELLY_CUP]:{[S.ROCK]:P.NOT_VERY_EFFECTIVE,[S.PAPER]:P.NOT_EFFECTIVE,[S.SCISSORS]:P.SUPER_EFFECTIVE,[S.RUBBER_BAND]:P.NEUTRAL,[S.CANDLE]:P.NOT_EFFECTIVE,[S.COLA]:P.EFFECTIVE,[S.PLANT]:P.EFFECTIVE,[S.SPECTACLES]:P.NOT_EFFECTIVE,[S.JELLY_CUP]:P.NEUTRAL}};function $o(s,t){return _0[s][t]}const b0=[new G(1,"Pebble Toss",S.ROCK,z.COMMON,1,2,"A small rock that grants a small shield when it wins.",.4,3,0,0),new G(2,"Stone Throw",S.ROCK,z.COMMON,2,3,"A medium-sized rock with decent shield potential.",.5,4,0,0),new G(3,"Rock Slide",S.ROCK,z.COMMON,2,4,"Multiple rocks that provide good protection.",.6,5,0,0),new G(4,"Boulder Push",S.ROCK,z.COMMON,3,5,"A heavy boulder that creates strong defenses.",.7,6,0,0),new G(5,"Granite Strike",S.ROCK,z.COMMON,3,6,"Hard granite that offers excellent protection.",.8,7,0,0),new G(6,"Mountain Crush",S.ROCK,z.COMMON,4,7,"A massive rock formation with incredible shielding.",.9,8,0,0),new G(7,"Crystal Barrier",S.ROCK,z.UNCOMMON,3,5,"Crystalline rock that grants shields and has a chance to return.",.8,8,.2,0),new G(8,"Obsidian Wall",S.ROCK,z.UNCOMMON,4,6,"Dark obsidian that provides massive protection.",.9,10,0,1),new G(9,"Diamond Defense",S.ROCK,z.UNCOMMON,4,7,"Precious diamond that offers the best protection.",1,12,0,0),new G(10,"Titan's Shield",S.ROCK,z.RARE,5,8,"Legendary rock that grants massive shields and can return.",1,15,.3,2)],w0=[new G(11,"Paper Cut",S.PAPER,z.COMMON,1,3,"A simple paper cut that might return to your hand.",0,0,.3,0),new G(12,"Note Throw",S.PAPER,z.COMMON,2,4,"A folded note with decent return potential.",0,0,.4,0),new G(13,"Scroll Strike",S.PAPER,z.COMMON,2,5,"An ancient scroll that often returns to its owner.",0,0,.5,0),new G(14,"Book Slam",S.PAPER,z.COMMON,3,6,"A heavy book that frequently returns to your collection.",0,0,.6,0),new G(15,"Document Storm",S.PAPER,z.COMMON,3,7,"A flurry of documents with high return probability.",0,0,.7,0),new G(16,"Library Tome",S.PAPER,z.COMMON,4,8,"A massive tome that almost always returns to the library.",0,0,.8,0),new G(17,"Origami Blade",S.PAPER,z.UNCOMMON,3,6,"Folded paper that cuts deep and returns reliably.",0,0,.8,1),new G(18,"Parchment Whip",S.PAPER,z.UNCOMMON,4,7,"Ancient parchment that strikes and returns with precision.",0,0,.9,0),new G(19,"Scroll of Return",S.PAPER,z.UNCOMMON,4,8,"A magical scroll that almost always returns to its caster.",0,0,.95,0),new G(20,"Infinite Paper",S.PAPER,z.RARE,5,9,"Legendary paper that always returns and grants small shields.",.3,3,1,2)],v0=[new G(21,"Paper Clip",S.SCISSORS,z.COMMON,1,4,"A simple paper clip that can pierce weak shields.",0,0,0,1),new G(22,"Safety Scissors",S.SCISSORS,z.COMMON,2,5,"Child-safe scissors with moderate piercing power.",0,0,0,2),new G(23,"Kitchen Shears",S.SCISSORS,z.COMMON,2,6,"Heavy-duty shears that cut through most defenses.",0,0,0,3),new G(24,"Garden Clippers",S.SCISSORS,z.COMMON,3,7,"Sharp clippers that slice through thick barriers.",0,0,0,4),new G(25,"Industrial Cutters",S.SCISSORS,z.COMMON,3,8,"Heavy machinery that destroys any shield in its path.",0,0,0,5),new G(26,"Steel Shears",S.SCISSORS,z.COMMON,4,9,"Reinforced steel scissors that ignore most defenses.",0,0,0,6),new G(27,"Laser Cutter",S.SCISSORS,z.UNCOMMON,4,8,"Precise laser that cuts through shields with ease.",0,0,0,8),new G(28,"Plasma Blade",S.SCISSORS,z.UNCOMMON,4,9,"Energy blade that vaporizes shields and deals massive damage.",0,0,0,10),new G(29,"Quantum Scissors",S.SCISSORS,z.UNCOMMON,5,10,"Advanced scissors that exist in multiple dimensions.",0,0,0,12),new G(30,"Reality Cutter",S.SCISSORS,z.RARE,6,12,"Legendary scissors that cut through reality itself.",0,0,0,15)],Yo=[...b0,...w0,...v0];class jo{constructor(){A(this,"cards",[]);this.cards=[...Yo],this.shuffle()}shuffle(){for(let t=this.cards.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[this.cards[t],this.cards[e]]=[this.cards[e],this.cards[t]]}}drawCard(){return this.cards.length===0?null:this.cards.pop()||null}drawCards(t){const e=[];for(let i=0;i<t&&this.cards.length>0;i++){const n=this.drawCard();n&&e.push(n)}return e}addCardToBottom(t){this.cards.unshift(t)}addCardToTop(t){this.cards.push(t)}addCards(t){this.cards.push(...t)}getCardCount(){return this.cards.length}isEmpty(){return this.cards.length===0}reset(){this.cards=[...Yo],this.shuffle()}peekCards(){return[...this.cards]}}class C0{constructor(t,e){A(this,"player");A(this,"computer");A(this,"playerDeck");A(this,"computerDeck");A(this,"playerHand",[]);A(this,"computerHand",[]);A(this,"selectedPlayerCard",null);A(this,"selectedComputerCard",null);A(this,"turnNumber",1);A(this,"isBattleOver",!1);A(this,"winner",null);this.player=t,this.computer=e,this.playerDeck=new jo,this.computerDeck=new jo,this.dealInitialHands()}dealInitialHands(){this.playerHand=this.playerDeck.drawCards(5),this.computerHand=this.computerDeck.drawCards(5)}drawPlayerCard(){const t=this.playerDeck.drawCard();return t&&this.playerHand.push(t),t}drawComputerCard(){const t=this.computerDeck.drawCard();return t&&this.computerHand.push(t),t}selectPlayerCard(t){if(t>=0&&t<this.playerHand.length){const e=this.playerHand[t];if(this.player.spendEnergy(e.cost))return this.selectedPlayerCard=e,this.playerHand.splice(t,1),!0}return!1}selectComputerCard(){for(let t=0;t<this.computerHand.length;t++){const e=this.computerHand[t];if(this.computer.spendEnergy(e.cost)){this.selectedComputerCard=e,this.computerHand.splice(t,1);break}}}executeTurn(){if(!this.selectedPlayerCard||!this.selectedComputerCard)throw new Error("No cards selected for turn execution");const t=this.selectedPlayerCard,e=this.selectedComputerCard,i=t.getDamage(),n=e.getDamage(),r=$o(t.type,e.type),a=$o(e.type,t.type),o=i*r,h=n*a;let l=null,c=0,u=!1,d=!1,f=!1,m=!1;if(o>h){l=this.player,c=Math.floor(o-h);const g=this.handleWin(this.player,this.computer,t,c);u=g.shieldCreated,f=g.cardReturned}else if(h>o){l=this.computer,c=Math.floor(h-o);const g=this.handleWin(this.computer,this.player,e,c);d=g.shieldCreated,m=g.cardReturned}return this.checkBattleEnd(),this.selectedPlayerCard=null,this.selectedComputerCard=null,this.turnNumber++,this.player.restoreEnergy(3),this.computer.restoreEnergy(3),this.drawPlayerCard(),this.drawComputerCard(),{playerCard:t,computerCard:e,playerDamage:i,computerDamage:n,playerEffectiveness:r,computerEffectiveness:a,playerFinalDamage:o,computerFinalDamage:h,winner:l===this.player?"player":l===this.computer?"computer":"tie",damageDealt:c,isBattleOver:this.isBattleOver,winnerCharacter:this.winner,playerShieldCreated:u,computerShieldCreated:d,playerCardReturned:f,computerCardReturned:m}}handleWin(t,e,i,n){const r=Math.max(0,e.shield-i.shieldPierce),a=Math.max(0,n-r);e.removeShield(Math.min(e.shield,n)),e.takeDamage(a);let o=!1;i.shouldGrantShield()&&(t.addShield(i.shieldAmount),o=!0);let h=!1;return i.shouldReturnToHand()&&(t===this.player?this.playerHand.push(i):this.computerHand.push(i),h=!0),{shieldCreated:o,cardReturned:h}}checkBattleEnd(){this.player.isAlive()?this.computer.isAlive()||(this.isBattleOver=!0,this.winner=this.player):(this.isBattleOver=!0,this.winner=this.computer)}getBattleState(){var t;return{playerHealth:this.player.currentHealth,playerEnergy:this.player.currentEnergy,playerShield:this.player.shield,computerHealth:this.computer.currentHealth,computerEnergy:this.computer.currentEnergy,computerShield:this.computer.shield,turnNumber:this.turnNumber,isBattleOver:this.isBattleOver,winner:((t=this.winner)==null?void 0:t.name)||null}}reset(){this.player.reset(),this.computer.reset(),this.playerDeck.reset(),this.computerDeck.reset(),this.playerHand=[],this.computerHand=[],this.selectedPlayerCard=null,this.selectedComputerCard=null,this.turnNumber=1,this.isBattleOver=!1,this.winner=null,this.dealInitialHands()}}class Xo{constructor(t,e,i){A(this,"name");A(this,"maxHealth");A(this,"currentHealth");A(this,"maxEnergy");A(this,"currentEnergy");A(this,"shield",0);this.name=t,this.maxHealth=e,this.currentHealth=e,this.maxEnergy=i,this.currentEnergy=i,this.shield=0}takeDamage(t){this.currentHealth=Math.max(0,this.currentHealth-t)}addShield(t){this.shield=Math.max(0,this.shield+t)}removeShield(t){this.shield=Math.max(0,this.shield-t)}heal(t){this.currentHealth=Math.min(this.maxHealth,this.currentHealth+t)}spendEnergy(t){return this.currentEnergy>=t?(this.currentEnergy-=t,!0):!1}restoreEnergy(t){this.currentEnergy=Math.min(this.maxEnergy,this.currentEnergy+t)}isAlive(){return this.currentHealth>0}reset(){this.currentHealth=this.maxHealth,this.currentEnergy=this.maxEnergy,this.shield=0}}class nt{static async load(){this.rockImg=await ht.get("rock.png"),this.paperImg=await ht.get("paper.png"),this.scissorsImg=await ht.get("scissors.png"),this.cardImgs.push(void 0);for(let t=1;t<=30;t++)this.cardImgs.push(await ht.get(`${t}.png`));this.bgImg=await ht.get("bg.png"),this.playImg=await ht.get("play.png"),this.playerImg=await ht.get("player.png"),this.enemyImg=await ht.get("enemy.png")}}A(nt,"bgImg"),A(nt,"playImg"),A(nt,"rockImg"),A(nt,"paperImg"),A(nt,"scissorsImg"),A(nt,"playerImg"),A(nt,"enemyImg"),A(nt,"cardImgs",[]);class fn extends ft{constructor(t,e,i,n,r,a=!1){super();const o=-20,h=0,l=n?o:0;let c;switch(t.rarity){case z.COMMON:c=8947848;break;case z.UNCOMMON:c=1034567;break;case z.RARE:c=35071;break;default:c=8947848}const u=new De;u.beginFill(16777215),u.lineStyle(4,c),u.drawRoundedRect(0,0,e,i,4),u.endFill(),u.alpha=1,this.addChild(u);let d;if(t.type==="rock"?d=nt.rockImg:t.type==="paper"?d=nt.paperImg:t.type==="scissors"&&(d=nt.scissorsImg),d){const y=_t.from(d);y.width=e,y.height=i,u.addChild(y)}if(nt.cardImgs[t.id]){const y=nt.cardImgs[t.id],x=_t.from(y);x.width=60,x.height=60,x.position.set(42,82),u.addChild(x)}const f=new gt(t.name.toUpperCase(),{fontSize:16,fontWeight:"bold",fill:0,align:"center",wordWrap:!0,wordWrapWidth:e-30});f.anchor.set(.5,0),f.height==18?f.position.set(e/2,23):f.position.set(e/2,13),this.addChild(f);const m=new gt(`${t.damage}`,{fontSize:20,fontWeight:"bold",fill:6949386,align:"center"});m.anchor.set(.5,0),m.position.set(22,167),this.addChild(m);const g=new gt(`${t.cost}`,{fontSize:20,fontWeight:"bold",fill:658026,align:"center"});g.anchor.set(.5,0),g.position.set(e-22,167),this.addChild(g);const p=[];if(t.shieldChance>0&&p.push(`${Math.round(t.shieldChance*100)}% S`),t.returnChance>0&&p.push(`${Math.round(t.returnChance*100)}% R`),t.shieldPierce>0&&p.push(`${t.shieldPierce} P`),p.length>0){const y=new gt(p.join("; "),{fontSize:p.length>1?10:14,fill:4473924,align:"center"});y.anchor.set(.5,0),y.position.set(e/2,157),this.addChild(y)}this.position.set(h,l),this.interactive=!a,this.cursor=a?"default":"pointer",a||this.on("pointerdown",r)}}var S0=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,A0=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}`,T0=`precision highp float;
in vec2 vTextureCoord;
out vec4 finalColor;

uniform sampler2D uTexture;
uniform vec4 uLine;
uniform vec2 uNoise;
uniform vec3 uVignette;
uniform float uSeed;
uniform float uTime;
uniform vec2 uDimensions;

uniform vec4 uInputSize;

const float SQRT_2 = 1.414213;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

float vignette(vec3 co, vec2 coord)
{
    float outter = SQRT_2 - uVignette[0] * SQRT_2;
    vec2 dir = vec2(0.5) - coord;
    dir.y *= uDimensions.y / uDimensions.x;
    float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + uVignette[2] * SQRT_2), 0.0, 1.0);
    return darker + (1.0 - darker) * (1.0 - uVignette[1]);
}

float noise(vec2 coord)
{
    vec2 pixelCoord = coord * uInputSize.xy;
    pixelCoord.x = floor(pixelCoord.x / uNoise[1]);
    pixelCoord.y = floor(pixelCoord.y / uNoise[1]);
    return (rand(pixelCoord * uNoise[1] * uSeed) - 0.5) * uNoise[0];
}

vec3 interlaceLines(vec3 co, vec2 coord)
{
    vec3 color = co;

    float curvature = uLine[0];
    float lineWidth = uLine[1];
    float lineContrast = uLine[2];
    float verticalLine = uLine[3];

    vec2 dir = vec2(coord * uInputSize.xy / uDimensions - 0.5);

    float _c = curvature > 0. ? curvature : 1.;
    float k = curvature > 0. ? (length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;
    vec2 uv = dir * k;
    float v = verticalLine > 0.5 ? uv.x * uDimensions.x : uv.y * uDimensions.y;
    v *= min(1.0, 2.0 / lineWidth ) / _c;
    float j = 1. + cos(v * 1.2 - uTime) * 0.5 * lineContrast;
    color *= j;

    float segment = verticalLine > 0.5 ? mod((dir.x + .5) * uDimensions.x, 4.) : mod((dir.y + .5) * uDimensions.y, 4.);
    color *= 0.99 + ceil(segment) * 0.015;

    return color;
}

void main(void)
{
    finalColor = texture(uTexture, vTextureCoord);
    vec2 coord = vTextureCoord * uInputSize.xy / uDimensions;

    if (uNoise[0] > 0.0 && uNoise[1] > 0.0)
    {
        float n = noise(vTextureCoord);
        finalColor += vec4(n, n, n, finalColor.a);
    }

    if (uVignette[0] > 0.)
    {
        float v = vignette(finalColor.rgb, coord);
        finalColor *= vec4(v, v, v, finalColor.a);
    }

    if (uLine[1] > 0.0)
    {
        finalColor = vec4(interlaceLines(finalColor.rgb, vTextureCoord), finalColor.a);  
    }
}
`,P0=`struct CRTUniforms {
    uLine: vec4<f32>,
    uNoise: vec2<f32>,
    uVignette: vec3<f32>,
    uSeed: f32,
    uTime: f32,
    uDimensions: vec2<f32>,
};

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;

@group(0) @binding(1) var uTexture: texture_2d<f32>; 
@group(0) @binding(2) var uSampler: sampler;
@group(1) @binding(0) var<uniform> crtUniforms : CRTUniforms;

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  @location(0) uv : vec2<f32>
) -> @location(0) vec4<f32> {
    
  var color: vec4<f32> = textureSample(uTexture, uSampler, uv);
  let coord: vec2<f32> = uv * gfu.uInputSize.xy / crtUniforms.uDimensions;

  let uNoise = crtUniforms.uNoise;

  if (uNoise[0] > 0.0 && uNoise[1] > 0.0)
  {
    color += vec4<f32>(vec3<f32>(noise(uv)), color.a);
  }

  if (crtUniforms.uVignette[0] > 0.)
  {
    color *= vec4<f32>(vec3<f32>(vignette(color.rgb, coord)), color.a);
  }

  if (crtUniforms.uLine[1] > 0.0)
  {
    color = vec4<f32>(vec3<f32>(interlaceLines(color.rgb, uv)), color.a);  
  }

  return color;
}

const SQRT_2: f32 = 1.414213;

fn modulo(x: f32, y: f32) -> f32
{
  return x - y * floor(x/y);
}

fn rand(co: vec2<f32>) -> f32
{
  return fract(sin(dot(co, vec2<f32>(12.9898, 78.233))) * 43758.5453);
}

fn vignette(co: vec3<f32>, coord: vec2<f32>) -> f32
{
  let uVignette = crtUniforms.uVignette;
  let uDimensions = crtUniforms.uDimensions;
  
  let outter: f32 = SQRT_2 - uVignette[0] * SQRT_2;
  var dir: vec2<f32> = vec2<f32>(0.5) - coord;
  dir.y *= uDimensions.y / uDimensions.x;
  let darker: f32 = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + uVignette[2] * SQRT_2), 0.0, 1.0);
  return darker + (1.0 - darker) * (1.0 - uVignette[1]);
}

fn noise(coord: vec2<f32>) -> f32
{
  let uNoise = crtUniforms.uNoise;
  let uSeed = crtUniforms.uSeed;

  var pixelCoord: vec2<f32> = coord * gfu.uInputSize.xy;
  pixelCoord.x = floor(pixelCoord.x / uNoise[1]);
  pixelCoord.y = floor(pixelCoord.y / uNoise[1]);
  return (rand(pixelCoord * uNoise[1] * uSeed) - 0.5) * uNoise[0];
}

fn interlaceLines(co: vec3<f32>, coord: vec2<f32>) -> vec3<f32>
{
  var color = co;

  let uDimensions = crtUniforms.uDimensions;

  let curvature: f32 = crtUniforms.uLine[0];
  let lineWidth: f32 = crtUniforms.uLine[1];
  let lineContrast: f32 = crtUniforms.uLine[2];
  let verticalLine: f32 = crtUniforms.uLine[3];

  let dir: vec2<f32> = vec2<f32>(coord * gfu.uInputSize.xy / uDimensions - 0.5);

  let _c: f32 = select(1., curvature, curvature > 0.);
  let k: f32 = select(1., (length(dir * dir) * 0.25 * _c * _c + 0.935 * _c), curvature > 0.);
  let uv: vec2<f32> = dir * k;
  let v: f32 = select(uv.y * uDimensions.y, uv.x * uDimensions.x, verticalLine > 0.5) * min(1.0, 2.0 / lineWidth ) / _c;
  let j: f32 = 1. + cos(v * 1.2 - crtUniforms.uTime) * 0.5 * lineContrast;
  color *= j;

  let segment: f32 = select(modulo((dir.y + .5) * uDimensions.y, 4.), modulo((dir.x + .5) * uDimensions.x, 4.), verticalLine > 0.5);
  color *= 0.99 + ceil(segment) * 0.015;

  return color;
}`,M0=Object.defineProperty,E0=(s,t,e)=>t in s?M0(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,ni=(s,t,e)=>(E0(s,typeof t!="symbol"?t+"":t,e),e);const Bc=class Lc extends bd{constructor(t){t={...Lc.DEFAULT_OPTIONS,...t};const e=ze.from({vertex:{source:A0,entryPoint:"mainVertex"},fragment:{source:P0,entryPoint:"mainFragment"}}),i=bi.from({vertex:S0,fragment:T0,name:"crt-filter"});super({gpuProgram:e,glProgram:i,resources:{crtUniforms:{uLine:{value:new Float32Array(4),type:"vec4<f32>"},uNoise:{value:new Float32Array(2),type:"vec2<f32>"},uVignette:{value:new Float32Array(3),type:"vec3<f32>"},uSeed:{value:t.seed,type:"f32"},uTime:{value:t.time,type:"f32"},uDimensions:{value:new Float32Array(2),type:"vec2<f32>"}}}}),ni(this,"uniforms"),ni(this,"seed"),ni(this,"time"),this.uniforms=this.resources.crtUniforms.uniforms,Object.assign(this,t)}apply(t,e,i,n){this.uniforms.uDimensions[0]=e.frame.width,this.uniforms.uDimensions[1]=e.frame.height,this.uniforms.uSeed=this.seed,this.uniforms.uTime=this.time,t.applyFilter(this,e,i,n)}get curvature(){return this.uniforms.uLine[0]}set curvature(t){this.uniforms.uLine[0]=t}get lineWidth(){return this.uniforms.uLine[1]}set lineWidth(t){this.uniforms.uLine[1]=t}get lineContrast(){return this.uniforms.uLine[2]}set lineContrast(t){this.uniforms.uLine[2]=t}get verticalLine(){return this.uniforms.uLine[3]>.5}set verticalLine(t){this.uniforms.uLine[3]=t?1:0}get noise(){return this.uniforms.uNoise[0]}set noise(t){this.uniforms.uNoise[0]=t}get noiseSize(){return this.uniforms.uNoise[1]}set noiseSize(t){this.uniforms.uNoise[1]=t}get vignetting(){return this.uniforms.uVignette[0]}set vignetting(t){this.uniforms.uVignette[0]=t}get vignettingAlpha(){return this.uniforms.uVignette[1]}set vignettingAlpha(t){this.uniforms.uVignette[1]=t}get vignettingBlur(){return this.uniforms.uVignette[2]}set vignettingBlur(t){this.uniforms.uVignette[2]=t}};ni(Bc,"DEFAULT_OPTIONS",{curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0,seed:0});let k0=Bc;class Oc extends ft{constructor(){super();A(this,"mainContainer");A(this,"bg");A(this,"battle");A(this,"paused",!1);A(this,"initialized",!1);A(this,"playerHealthText");A(this,"playerEnergyText");A(this,"playerShieldText");A(this,"computerHealthText");A(this,"computerEnergyText");A(this,"computerShieldText");A(this,"playerSprite");A(this,"enemySprite");A(this,"turnText");A(this,"statusText");A(this,"turnResultText");A(this,"cardButtons",[]);A(this,"selectedCardIndex",-1);A(this,"endTurnButton");A(this,"currentHeight");A(this,"currentWidth");A(this,"playedCardsContainer",new ft);A(this,"lastPlayerCard",null);A(this,"lastComputerCard",null);A(this,"filter");this.filter=new k0({noise:.1,time:10,lineContrast:.1,vignetting:.4}),this.filters=[this.filter],nt.load().then(()=>{this.bg=new _t(nt.bgImg),this.bg.width=window.innerWidth,this.bg.height=window.innerHeight,this.addChild(this.bg),this.mainContainer=new ft,this.addChild(this.mainContainer),this.mainContainer.addChild(this.playedCardsContainer),this.battle=new C0(new Xo("Player",100,10),new Xo("Computer",100,10)),this.createUI(),this.updateUI(),this.updateCardButtons()})}createUI(){this.playerHealthText=new gt("Player HP: 100",{fontSize:24,fill:65280}),this.mainContainer.addChild(this.playerHealthText),this.playerEnergyText=new gt("Player Energy: 10",{fontSize:20,fill:35071}),this.mainContainer.addChild(this.playerEnergyText),this.playerShieldText=new gt("Player Shield: 0",{fontSize:20,fill:8947848}),this.mainContainer.addChild(this.playerShieldText),this.computerHealthText=new gt("Computer HP: 100",{fontSize:24,fill:16711680}),this.mainContainer.addChild(this.computerHealthText),this.computerEnergyText=new gt("Computer Energy: 10",{fontSize:20,fill:35071}),this.mainContainer.addChild(this.computerEnergyText),this.computerShieldText=new gt("Computer Shield: 0",{fontSize:20,fill:8947848}),this.mainContainer.addChild(this.computerShieldText),this.turnText=new gt("Turn: 1",{fontSize:28,fill:16777215}),this.mainContainer.addChild(this.turnText),this.statusText=new gt("Select a card to play!",{fontSize:24,fill:16776960}),this.mainContainer.addChild(this.statusText),this.turnResultText=new gt("",{fontSize:18,fill:16777215,align:"center",wordWrap:!0,wordWrapWidth:700}),this.turnResultText.alpha=0,this.mainContainer.addChild(this.turnResultText),this.endTurnButton=new cg(_t.from(nt.playImg)),this.endTurnButton.view.width=200,this.endTurnButton.view.height=91,this.endTurnButton.onPress.connect(()=>this.executeTurn()),this.endTurnButton.view.alpha=.5,this.endTurnButton.view.interactive=!1,this.mainContainer.addChild(this.endTurnButton.view),this.playerSprite=_t.from(nt.playerImg),this.playerSprite.width=200,this.playerSprite.height=300,this.mainContainer.addChild(this.playerSprite),this.enemySprite=_t.from(nt.enemyImg),this.enemySprite.width=200,this.enemySprite.height=300,this.mainContainer.addChild(this.enemySprite),this.initialized=!0}updateUI(){const e=this.battle.getBattleState();this.playerHealthText.text=`Player HP: ${e.playerHealth}`,this.playerEnergyText.text=`Player Energy: ${e.playerEnergy}`,this.playerShieldText.text=`Player Shield: ${e.playerShield}`,this.computerHealthText.text=`Computer HP: ${e.computerHealth}`,this.computerEnergyText.text=`Computer Energy: ${e.computerEnergy}`,this.computerShieldText.text=`Computer Shield: ${e.computerShield}`,this.turnText.text=`Turn: ${e.turnNumber}`,e.isBattleOver?(this.statusText.text=`Battle Over! ${e.winner} wins!`,this.statusText.style.fill=16755200):this.selectedCardIndex!==-1?(this.statusText.text="Card selected! Click End Turn to continue.",this.statusText.style.fill=65280):(this.statusText.text="Select a card to play!",this.statusText.style.fill=16776960),this.selectedCardIndex!==-1&&!e.isBattleOver?(this.endTurnButton.view.alpha=1,this.endTurnButton.view.interactive=!0):(this.endTurnButton.view.alpha=.5,this.endTurnButton.view.interactive=!1),this.updateLayout()}updateCardButtons(){this.cardButtons.forEach(l=>{this.mainContainer.removeChild(l)}),this.cardButtons=[];const e=140,i=200,n=this.battle.playerHand.length,r=20,o=-(n*e+(n-1)*r)/2,h=this.currentHeight?this.currentHeight-100-i:50;this.battle.playerHand.forEach((l,c)=>{const u=this.selectedCardIndex===c,d=this.battle.player.currentEnergy<l.cost,f=new fn(l,e,i,u,()=>this.onCardClick(c),d),m=o+c*(e+r);f.position.set(m,h+(u?-20:0)),this.mainContainer.addChild(f),this.cardButtons.push(f)}),this.updateLayout()}onCardClick(e){this.selectedCardIndex===e?this.selectedCardIndex=-1:this.selectedCardIndex=e,this.updateUI()}executeTurn(){if(this.selectedCardIndex===-1){this.statusText.text="Please select a card first!",this.statusText.style.fill=16711680;return}if(this.battle.selectPlayerCard(this.selectedCardIndex)){this.battle.selectComputerCard();const e=this.battle.executeTurn();this.selectedCardIndex=-1,this.updateUI(),this.showTurnResults(e),e.isBattleOver&&(this.endTurnButton.onPress.disconnectAll(),this.endTurnButton.onPress.connect(()=>this.resetBattle()))}else this.statusText.text="Not enough energy for that card!",this.statusText.style.fill=16711680;this.updateCardButtons()}showTurnResults(e){this.lastPlayerCard=e.playerCard,this.lastComputerCard=e.computerCard,this.renderPlayedCards();let i=`Player played: ${e.playerCard.name} (${e.playerDamage} DMG)`;e.playerEffectiveness!==1&&(i+=` [${e.playerEffectiveness>1?"Super Effective":"Not Very Effective"}]`),i+=`
Computer played: ${e.computerCard.name} (${e.computerDamage} DMG)`,e.computerEffectiveness!==1&&(i+=` [${e.computerEffectiveness>1?"Super Effective":"Not Very Effective"}]`),i+=`

`,e.winner==="player"?i+=`Player wins! Dealt ${e.damageDealt} damage`:e.winner==="computer"?i+=`Computer wins! Dealt ${e.damageDealt} damage`:i+="It's a tie! No damage dealt";const n=[];e.playerShieldCreated&&n.push(`Player gained ${e.playerCard.shieldAmount} shield`),e.computerShieldCreated&&n.push(`Computer gained ${e.computerCard.shieldAmount} shield`),e.playerCardReturned&&n.push("Player's card returned to hand"),e.computerCardReturned&&n.push("Computer's card returned to hand"),n.length>0&&(i+=`

${n.join(`
`)}`),this.turnResultText.text=i,this.turnResultText.alpha=1}renderPlayedCards(){if(this.playedCardsContainer.removeChildren(),!this.lastPlayerCard||!this.lastComputerCard)return;const e=140,i=200,n=60,r=-340/2,a=(this.currentHeight?this.currentHeight:800)/2-i-40,o=new fn(this.lastPlayerCard,e,i,!1,()=>{},!0),h=new fn(this.lastComputerCard,e,i,!1,()=>{},!0);o.position.set(r,a),h.position.set(r+e+n,a),this.playedCardsContainer.addChild(o,h)}resetBattle(){this.battle.reset(),this.selectedCardIndex=-1,this.turnResultText.alpha=0,this.endTurnButton.onPress.disconnectAll(),this.endTurnButton.onPress.connect(()=>this.executeTurn()),this.updateUI()}prepare(){}update(e){this.paused||(this.filter.seed=Math.random(),this.filter.time+=.1)}async pause(){this.mainContainer.interactiveChildren=!1,this.paused=!0}async resume(){this.mainContainer.interactiveChildren=!0,this.paused=!1}reset(){this.battle.reset(),this.selectedCardIndex=-1,this.turnResultText.alpha=0,this.updateUI()}resize(e,i){this.currentWidth=e,this.currentHeight=i,this.updateLayout()}updateLayout(){if(!this.currentWidth||!this.currentHeight||!this.initialized)return;const e=this.currentWidth,i=this.currentHeight;var n=this.bg.width/this.bg.height,r=e/i;r>n?(this.bg.height=this.bg.height/(this.bg.width/e),this.bg.width=e,this.bg.position.x=0,this.bg.position.y=(i-this.bg.height)/2):(this.bg.width=this.bg.width/(this.bg.height/i),this.bg.height=i,this.bg.position.y=0,this.bg.position.x=(e-this.bg.width)/2);const a=e*.5;this.mainContainer.x=a,this.mainContainer.y=0;const o=-e*.5+50,h=e*.5-50,l=Math.max(50,i*.1),c=i-50;this.playerHealthText.position.set(o+350,l),this.playerEnergyText.position.set(o+350,l+30),this.playerShieldText.position.set(o+350,l+60),this.computerHealthText.position.set(h-this.computerHealthText.width-350,l),this.computerEnergyText.position.set(h-this.computerEnergyText.width-350,l+30),this.computerShieldText.position.set(h-this.computerShieldText.width-350,l+60),this.turnText.position.set(0-this.turnText.width/2,l),this.statusText.position.set(0-this.statusText.width/2,l+40),this.turnResultText.position.set(0-this.turnResultText.width/2,l+400),this.turnResultText.style.wordWrapWidth=500,this.endTurnButton.view.position.set(-100,c-60),this.playerSprite.position.set(o+150,c-250),this.enemySprite.position.set(h-350,c-230);const u=140,d=200,f=20,m=this.battle.playerHand.length,p=-(m*u+(m-1)*f)/2,y=i-130-d;this.cardButtons.forEach((x,_)=>{const b=p+_*(u+f),C=this.selectedCardIndex===_;x.position.set(b,y+(C?-20:0))})}async show(){oe().audio.bgm.play("main/sounds/bgm-main.mp3",{volume:.3})}async hide(){}}A(Oc,"assetBundles",["main"]);class R0{getString(t){return localStorage.getItem(t)??void 0}setString(t,e){localStorage.setItem(t,e)}getNumber(t){const e=this.getString(t)??void 0,i=Number(e);return isNaN(i)?null:i}setNumber(t,e){this.setString(t,String(e))}getBool(t){const e=localStorage.getItem(t);return e?!!e.toLowerCase():void 0}setBool(t,e){localStorage.setItem(t,String(e))}getObject(t){const e=this.getString(t);if(e)try{return JSON.parse(e)}catch(i){console.warn(i);return}}setObject(t,e){this.setString(t,JSON.stringify(e))}}const Se=new R0,Ko="volume-master",qo="volume-bgm",Zo="volume-sfx";class I0{init(){oe().audio.setMasterVolume(this.getMasterVolume()),oe().audio.bgm.setVolume(this.getBgmVolume()),oe().audio.sfx.setVolume(this.getSfxVolume())}getMasterVolume(){return Se.getNumber(Ko)??.5}setMasterVolume(t){oe().audio.setMasterVolume(t),Se.setNumber(Ko,t)}getBgmVolume(){return Se.getNumber(qo)??1}setBgmVolume(t){oe().audio.bgm.setVolume(t),Se.setNumber(qo,t)}getSfxVolume(){return Se.getNumber(Zo)??1}setSfxVolume(t){oe().audio.sfx.setVolume(t),Se.setNumber(Zo,t)}}const F0=new I0;Y.add(ar);Y.add(Jh);const B0=[{name:"default",assets:[]},{name:"game",assets:[{alias:["game/cards/1.png","1.png"],src:["game/cards/1@0.5x.webp","game/cards/1@0.5x.png","game/cards/1.webp","game/cards/1.png"],data:{tags:{m:!0}}},{alias:["game/cards/10.png","10.png"],src:["game/cards/10@0.5x.webp","game/cards/10@0.5x.png","game/cards/10.webp","game/cards/10.png"],data:{tags:{m:!0}}},{alias:["game/cards/11.png","11.png"],src:["game/cards/11@0.5x.webp","game/cards/11@0.5x.png","game/cards/11.webp","game/cards/11.png"],data:{tags:{m:!0}}},{alias:["game/cards/12.png","12.png"],src:["game/cards/12@0.5x.webp","game/cards/12@0.5x.png","game/cards/12.webp","game/cards/12.png"],data:{tags:{m:!0}}},{alias:["game/cards/13.png","13.png"],src:["game/cards/13@0.5x.webp","game/cards/13@0.5x.png","game/cards/13.webp","game/cards/13.png"],data:{tags:{m:!0}}},{alias:["game/cards/14.png","14.png"],src:["game/cards/14@0.5x.webp","game/cards/14@0.5x.png","game/cards/14.webp","game/cards/14.png"],data:{tags:{m:!0}}},{alias:["game/cards/15.png","15.png"],src:["game/cards/15@0.5x.webp","game/cards/15@0.5x.png","game/cards/15.webp","game/cards/15.png"],data:{tags:{m:!0}}},{alias:["game/cards/16.png","16.png"],src:["game/cards/16@0.5x.webp","game/cards/16@0.5x.png","game/cards/16.webp","game/cards/16.png"],data:{tags:{m:!0}}},{alias:["game/cards/17.png","17.png"],src:["game/cards/17@0.5x.webp","game/cards/17@0.5x.png","game/cards/17.webp","game/cards/17.png"],data:{tags:{m:!0}}},{alias:["game/cards/18.png","18.png"],src:["game/cards/18@0.5x.webp","game/cards/18@0.5x.png","game/cards/18.webp","game/cards/18.png"],data:{tags:{m:!0}}},{alias:["game/cards/19.png","19.png"],src:["game/cards/19@0.5x.webp","game/cards/19@0.5x.png","game/cards/19.webp","game/cards/19.png"],data:{tags:{m:!0}}},{alias:["game/cards/2.png","2.png"],src:["game/cards/2@0.5x.webp","game/cards/2@0.5x.png","game/cards/2.webp","game/cards/2.png"],data:{tags:{m:!0}}},{alias:["game/cards/20.png","20.png"],src:["game/cards/20@0.5x.webp","game/cards/20@0.5x.png","game/cards/20.webp","game/cards/20.png"],data:{tags:{m:!0}}},{alias:["game/cards/21.png","21.png"],src:["game/cards/21@0.5x.webp","game/cards/21@0.5x.png","game/cards/21.webp","game/cards/21.png"],data:{tags:{m:!0}}},{alias:["game/cards/22.png","22.png"],src:["game/cards/22@0.5x.webp","game/cards/22@0.5x.png","game/cards/22.webp","game/cards/22.png"],data:{tags:{m:!0}}},{alias:["game/cards/23.png","23.png"],src:["game/cards/23@0.5x.webp","game/cards/23@0.5x.png","game/cards/23.webp","game/cards/23.png"],data:{tags:{m:!0}}},{alias:["game/cards/24.png","24.png"],src:["game/cards/24@0.5x.webp","game/cards/24@0.5x.png","game/cards/24.webp","game/cards/24.png"],data:{tags:{m:!0}}},{alias:["game/cards/25.png","25.png"],src:["game/cards/25@0.5x.webp","game/cards/25@0.5x.png","game/cards/25.webp","game/cards/25.png"],data:{tags:{m:!0}}},{alias:["game/cards/26.png","26.png"],src:["game/cards/26@0.5x.webp","game/cards/26@0.5x.png","game/cards/26.webp","game/cards/26.png"],data:{tags:{m:!0}}},{alias:["game/cards/27.png","27.png"],src:["game/cards/27@0.5x.webp","game/cards/27@0.5x.png","game/cards/27.webp","game/cards/27.png"],data:{tags:{m:!0}}},{alias:["game/cards/28.png","28.png"],src:["game/cards/28@0.5x.webp","game/cards/28@0.5x.png","game/cards/28.webp","game/cards/28.png"],data:{tags:{m:!0}}},{alias:["game/cards/29.png","29.png"],src:["game/cards/29@0.5x.webp","game/cards/29@0.5x.png","game/cards/29.webp","game/cards/29.png"],data:{tags:{m:!0}}},{alias:["game/cards/3.png","3.png"],src:["game/cards/3@0.5x.webp","game/cards/3@0.5x.png","game/cards/3.webp","game/cards/3.png"],data:{tags:{m:!0}}},{alias:["game/cards/30.png","30.png"],src:["game/cards/30@0.5x.webp","game/cards/30@0.5x.png","game/cards/30.webp","game/cards/30.png"],data:{tags:{m:!0}}},{alias:["game/cards/4.png","4.png"],src:["game/cards/4@0.5x.webp","game/cards/4@0.5x.png","game/cards/4.webp","game/cards/4.png"],data:{tags:{m:!0}}},{alias:["game/cards/5.png","5.png"],src:["game/cards/5@0.5x.webp","game/cards/5@0.5x.png","game/cards/5.webp","game/cards/5.png"],data:{tags:{m:!0}}},{alias:["game/cards/6.png","6.png"],src:["game/cards/6@0.5x.webp","game/cards/6@0.5x.png","game/cards/6.webp","game/cards/6.png"],data:{tags:{m:!0}}},{alias:["game/cards/7.png","7.png"],src:["game/cards/7@0.5x.webp","game/cards/7@0.5x.png","game/cards/7.webp","game/cards/7.png"],data:{tags:{m:!0}}},{alias:["game/cards/8.png","8.png"],src:["game/cards/8@0.5x.webp","game/cards/8@0.5x.png","game/cards/8.webp","game/cards/8.png"],data:{tags:{m:!0}}},{alias:["game/cards/9.png","9.png"],src:["game/cards/9@0.5x.webp","game/cards/9@0.5x.png","game/cards/9.webp","game/cards/9.png"],data:{tags:{m:!0}}},{alias:["game/cards/enemy.png","enemy.png"],src:["game/cards/enemy@0.5x.webp","game/cards/enemy@0.5x.png","game/cards/enemy.webp","game/cards/enemy.png"],data:{tags:{m:!0}}},{alias:["game/cards/paper.png","paper.png"],src:["game/cards/paper@0.5x.webp","game/cards/paper@0.5x.png","game/cards/paper.webp","game/cards/paper.png"],data:{tags:{m:!0}}},{alias:["game/cards/play.png","play.png"],src:["game/cards/play@0.5x.webp","game/cards/play@0.5x.png","game/cards/play.webp","game/cards/play.png"],data:{tags:{m:!0}}},{alias:["game/cards/player.png","player.png"],src:["game/cards/player@0.5x.webp","game/cards/player@0.5x.png","game/cards/player.webp","game/cards/player.png"],data:{tags:{m:!0}}},{alias:["game/cards/rock.png","rock.png"],src:["game/cards/rock@0.5x.webp","game/cards/rock@0.5x.png","game/cards/rock.webp","game/cards/rock.png"],data:{tags:{m:!0}}},{alias:["game/cards/scissors.png","scissors.png"],src:["game/cards/scissors@0.5x.webp","game/cards/scissors@0.5x.png","game/cards/scissors.webp","game/cards/scissors.png"],data:{tags:{m:!0}}}]},{name:"main",assets:[{alias:["main/logo-white.svg","logo-white.svg"],src:["main/logo-white.svg"],data:{tags:{m:!0}}},{alias:["main/sounds/bgm-main.mp3","bgm-main.mp3"],src:["main/sounds/bgm-main.ogg","main/sounds/bgm-main.mp3"],data:{tags:{m:!0}}},{alias:["main/sounds/sfx-hover.wav","sfx-hover.wav"],src:["main/sounds/sfx-hover.ogg","main/sounds/sfx-hover.mp3"],data:{tags:{m:!0}}},{alias:["main/sounds/sfx-press.wav","sfx-press.wav"],src:["main/sounds/sfx-press.ogg","main/sounds/sfx-press.mp3"],data:{tags:{m:!0}}},{alias:["main/ui","ui"],src:["main/ui@0.5x.webp.json","main/ui@0.5x.png.json","main/ui.webp.json","main/ui.png.json"],data:{tags:{m:!0,tps:!0}}}]},{name:"preload",assets:[{alias:["preload/bg.png","bg.png"],src:["preload/bg@0.5x.webp","preload/bg@0.5x.png","preload/bg.webp","preload/bg.png"],data:{tags:{m:!0}}},{alias:["preload/logo.svg","logo.svg"],src:["preload/logo.svg"],data:{tags:{m:!0}}}]}],Qo={bundles:B0};let Vc;function L0(s){return Vc=s,s}function ks(){return Vc}class Qn{static setParamValue(t,e){if(t.setValueAtTime){const i=ks().context;t.setValueAtTime(e,i.audioContext.currentTime)}else t.value=e;return e}}class O0 extends ct{constructor(){super(...arguments),this.speed=1,this.muted=!1,this.volume=1,this.paused=!1}refresh(){this.emit("refresh")}refreshPaused(){this.emit("refreshPaused")}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(t){console.warn("HTML Audio does not support filters")}get audioContext(){return console.warn("HTML Audio does not support audioContext"),null}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this.paused}destroy(){this.removeAllListeners()}}let V0=0;const Jn=class extends ct{constructor(s){super(),this.id=V0++,this.init(s)}set(s,t){if(this[s]===void 0)throw new Error(`Property with name ${s} does not exist.`);switch(s){case"speed":this.speed=t;break;case"volume":this.volume=t;break;case"paused":this.paused=t;break;case"loop":this.loop=t;break;case"muted":this.muted=t;break}return this}get progress(){const{currentTime:s}=this._source;return s/this._duration}get paused(){return this._paused}set paused(s){this._paused=s,this.refreshPaused()}_onPlay(){this._playing=!0}_onPause(){this._playing=!1}init(s){this._playing=!1,this._duration=s.source.duration;const t=this._source=s.source.cloneNode(!1);t.src=s.parent.url,t.onplay=this._onPlay.bind(this),t.onpause=this._onPause.bind(this),s.context.on("refresh",this.refresh,this),s.context.on("refreshPaused",this.refreshPaused,this),this._media=s}_internalStop(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())}stop(){this._internalStop(),this._source&&this.emit("stop")}get speed(){return this._speed}set speed(s){this._speed=s,this.refresh()}get volume(){return this._volume}set volume(s){this._volume=s,this.refresh()}get loop(){return this._loop}set loop(s){this._loop=s,this.refresh()}get muted(){return this._muted}set muted(s){this._muted=s,this.refresh()}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(s){console.warn("HTML Audio does not support filters")}refresh(){const s=this._media.context,t=this._media.parent;this._source.loop=this._loop||t.loop;const e=s.volume*(s.muted?0:1),i=t.volume*(t.muted?0:1),n=this._volume*(this._muted?0:1);this._source.volume=n*e*i,this._source.playbackRate=this._speed*s.speed*t.speed}refreshPaused(){const s=this._media.context,t=this._media.parent,e=this._paused||t.paused||s.paused;e!==this._pausedReal&&(this._pausedReal=e,e?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",e))}play(s){const{start:t,end:e,speed:i,loop:n,volume:r,muted:a}=s;e&&console.assert(e>t,"End time is before start time"),this._speed=i,this._volume=r,this._loop=!!n,this._muted=a,this.refresh(),this.loop&&e!==null&&(console.warn('Looping not support when specifying an "end" time'),this.loop=!1),this._start=t,this._end=e||this._duration,this._start=Math.max(0,this._start-Jn.PADDING),this._end=Math.min(this._end+Jn.PADDING,this._duration),this._source.onloadedmetadata=()=>{this._source&&(this._source.currentTime=t,this._source.onloadedmetadata=null,this.emit("progress",t/this._duration,this._duration),At.shared.add(this._onUpdate,this))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")}_onUpdate(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()}_onComplete(){At.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)}destroy(){At.shared.remove(this._onUpdate,this),this.removeAllListeners();const s=this._source;s&&(s.onended=null,s.onplay=null,s.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)}toString(){return`[HTMLAudioInstance id=${this.id}]`}};let Dc=Jn;Dc.PADDING=.1;class D0 extends ct{init(t){this.parent=t,this._source=t.options.source||new Audio,t.url&&(this._source.src=t.url)}create(){return new Dc(this)}get isPlayable(){return!!this._source&&this._source.readyState===4}get duration(){return this._source.duration}get context(){return this.parent.context}get filters(){return null}set filters(t){console.warn("HTML Audio does not support filters")}destroy(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)}get source(){return this._source}load(t){const e=this._source,i=this.parent;if(e.readyState===4){i.isLoaded=!0;const h=i.autoPlayStart();t&&setTimeout(()=>{t(null,i,h)},0);return}if(!i.url){t(new Error("sound.url or sound.source must be set"));return}e.src=i.url;const n=()=>{o(),i.isLoaded=!0;const h=i.autoPlayStart();t&&t(null,i,h)},r=()=>{o(),t&&t(new Error("Sound loading has been aborted"))},a=()=>{o();const h=`Failed to load audio element (code: ${e.error.code})`;t?t(new Error(h)):console.error(h)},o=()=>{e.removeEventListener("canplaythrough",n),e.removeEventListener("load",n),e.removeEventListener("abort",r),e.removeEventListener("error",a)};e.addEventListener("canplaythrough",n,!1),e.addEventListener("load",n,!1),e.addEventListener("abort",r,!1),e.addEventListener("error",a,!1),e.load()}}class N0{constructor(t,e){this.parent=t,Object.assign(this,e),this.duration=this.end-this.start,console.assert(this.duration>0,"End time must be after start time")}play(t){return this.parent.play({complete:t,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})}destroy(){this.parent=null}}const gi=["ogg","oga","opus","m4a","mp3","mpeg","wav","aiff","wma","mid","caf"],z0=["audio/mpeg","audio/ogg"],yi={};function U0(s){const t={m4a:"audio/mp4",oga:"audio/ogg",opus:'audio/ogg; codecs="opus"',caf:'audio/x-caf; codecs="opus"'},e=document.createElement("audio"),i={},n=/^no$/;gi.forEach(r=>{const a=e.canPlayType(`audio/${r}`).replace(n,""),o=t[r]?e.canPlayType(t[r]).replace(n,""):"";i[r]=!!a||!!o}),Object.assign(yi,i)}U0();let G0=0;class W0 extends ct{constructor(t){super(),this.id=G0++,this._media=null,this._paused=!1,this._muted=!1,this._elapsed=0,this.init(t)}set(t,e){if(this[t]===void 0)throw new Error(`Property with name ${t} does not exist.`);switch(t){case"speed":this.speed=e;break;case"volume":this.volume=e;break;case"muted":this.muted=e;break;case"loop":this.loop=e;break;case"paused":this.paused=e;break}return this}stop(){this._source&&(this._internalStop(),this.emit("stop"))}get speed(){return this._speed}set speed(t){this._speed=t,this.refresh(),this._update(!0)}get volume(){return this._volume}set volume(t){this._volume=t,this.refresh()}get muted(){return this._muted}set muted(t){this._muted=t,this.refresh()}get loop(){return this._loop}set loop(t){this._loop=t,this.refresh()}get filters(){return this._filters}set filters(t){var e;this._filters&&((e=this._filters)==null||e.filter(i=>i).forEach(i=>i.disconnect()),this._filters=null,this._source.connect(this._gain)),this._filters=t!=null&&t.length?t.slice(0):null,this.refresh()}refresh(){if(!this._source)return;const t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;const i=t.volume*(t.muted?0:1),n=e.volume*(e.muted?0:1),r=this._volume*(this._muted?0:1);Qn.setParamValue(this._gain.gain,r*n*i),Qn.setParamValue(this._source.playbackRate,this._speed*e.speed*t.speed),this.applyFilters()}applyFilters(){var t;if((t=this._filters)!=null&&t.length){this._source.disconnect();let e=this._source;this._filters.forEach(i=>{e.connect(i.destination),e=i}),e.connect(this._gain)}}refreshPaused(){const t=this._media.context,e=this._media.parent,i=this._paused||e.paused||t.paused;i!==this._pausedReal&&(this._pausedReal=i,i?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",i))}play(t){const{start:e,end:i,speed:n,loop:r,volume:a,muted:o,filters:h}=t;i&&console.assert(i>e,"End time is before start time"),this._paused=!1;const{source:l,gain:c}=this._media.nodes.cloneBufferSource();this._source=l,this._gain=c,this._speed=n,this._volume=a,this._loop=!!r,this._muted=o,this._filters=h,this.refresh();const u=this._source.buffer.duration;this._duration=u,this._end=i,this._lastUpdate=this._now(),this._elapsed=e,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=i,this._source.loopStart=e,this._source.start(0,e)):i?this._source.start(0,e,i-e):this._source.start(0,e),this.emit("start"),this._update(!0),this.enableTicker(!0)}enableTicker(t){At.shared.remove(this._updateListener,this),t&&At.shared.add(this._updateListener,this)}get progress(){return this._progress}get paused(){return this._paused}set paused(t){this._paused=t,this.refreshPaused()}destroy(){var t;this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),(t=this._filters)==null||t.forEach(e=>e.disconnect()),this._filters=null,this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1}toString(){return`[WebAudioInstance id=${this.id}]`}_now(){return this._media.context.audioContext.currentTime}_updateListener(){this._update()}_update(t=!1){if(this._source){const e=this._now(),i=e-this._lastUpdate;if(i>0||t){const n=this._source.playbackRate.value;this._elapsed+=i*n,this._lastUpdate=e;const r=this._duration;let a;if(this._source.loopStart){const o=this._source.loopEnd-this._source.loopStart;a=(this._source.loopStart+this._elapsed%o)/r}else a=this._elapsed%r/r;this._progress=a,this.emit("progress",this._progress,r)}}}init(t){this._media=t,t.context.events.on("refresh",this.refresh,this),t.context.events.on("refreshPaused",this.refreshPaused,this)}_internalStop(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.stop(0),this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null}}_onComplete(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}}this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)}}class Nc{constructor(t,e){this._output=e,this._input=t}get destination(){return this._input}get filters(){return this._filters}set filters(t){if(this._filters&&(this._filters.forEach(e=>{e&&e.disconnect()}),this._filters=null,this._input.connect(this._output)),t&&t.length){this._filters=t.slice(0),this._input.disconnect();let e=null;t.forEach(i=>{e===null?this._input.connect(i.destination):e.connect(i.destination),e=i}),e.connect(this._output)}}destroy(){this.filters=null,this._input=null,this._output=null}}const zc=class extends Nc{constructor(s){const t=s.audioContext,e=t.createBufferSource(),i=t.createGain(),n=t.createAnalyser();e.connect(n),n.connect(i),i.connect(s.destination),super(n,i),this.context=s,this.bufferSource=e,this.gain=i,this.analyser=n}get script(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(zc.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script}destroy(){super.destroy(),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null}cloneBufferSource(){const s=this.bufferSource,t=this.context.audioContext.createBufferSource();t.buffer=s.buffer,Qn.setParamValue(t.playbackRate,s.playbackRate.value),t.loop=s.loop;const e=this.context.audioContext.createGain();return t.connect(e),e.connect(this.destination),{source:t,gain:e}}get bufferSize(){return this.script.bufferSize}};let Uc=zc;Uc.BUFFER_SIZE=0;class H0{init(t){this.parent=t,this._nodes=new Uc(this.context),this._source=this._nodes.bufferSource,this.source=t.options.source}destroy(){this.parent=null,this._nodes.destroy(),this._nodes=null;try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null,this.source=null}create(){return new W0(this)}get context(){return this.parent.context}get isPlayable(){return!!this._source&&!!this._source.buffer}get filters(){return this._nodes.filters}set filters(t){this._nodes.filters=t}get duration(){return console.assert(this.isPlayable,"Sound not yet playable, no duration"),this._source.buffer.duration}get buffer(){return this._source.buffer}set buffer(t){this._source.buffer=t}get nodes(){return this._nodes}load(t){this.source?this._decode(this.source,t):this.parent.url?this._loadUrl(t):t?t(new Error("sound.url or sound.source must be set")):console.error("sound.url or sound.source must be set")}async _loadUrl(t){const e=this.parent.url,i=await q.get().fetch(e);this._decode(await i.arrayBuffer(),t)}_decode(t,e){const i=(n,r)=>{if(n)e&&e(n);else{this.parent.isLoaded=!0,this.buffer=r;const a=this.parent.autoPlayStart();e&&e(null,this.parent,a)}};t instanceof AudioBuffer?i(null,t):this.parent.context.decode(t,i)}}const Te=class{static from(s){let t={};typeof s=="string"?t.url=s:s instanceof ArrayBuffer||s instanceof AudioBuffer||s instanceof HTMLAudioElement?t.source=s:Array.isArray(s)?t.url=s:t=s,t={autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1,...t},Object.freeze(t);const e=ks().useLegacy?new D0:new H0;return new Te(e,t)}constructor(s,t){this.media=s,this.options=t,this._instances=[],this._sprites={},this.media.init(this);const e=t.complete;this._autoPlayOptions=e?{complete:e}:null,this.isLoaded=!1,this._preloadQueue=null,this.isPlaying=!1,this.autoPlay=t.autoPlay,this.singleInstance=t.singleInstance,this.preload=t.preload||this.autoPlay,this.url=Array.isArray(t.url)?this.preferUrl(t.url):t.url,this.speed=t.speed,this.volume=t.volume,this.loop=t.loop,t.sprites&&this.addSprites(t.sprites),this.preload&&this._preload(t.loaded)}preferUrl(s){const[t]=s.map(e=>({url:e,ext:ot.extname(e).slice(1)})).filter(({ext:e})=>yi[e]).sort((e,i)=>gi.indexOf(e.ext)-gi.indexOf(i.ext));if(!t)throw new Error("No supported file type found");return t.url}get context(){return ks().context}pause(){return this.isPlaying=!1,this.paused=!0,this}resume(){return this.isPlaying=this._instances.length>0,this.paused=!1,this}get paused(){return this._paused}set paused(s){this._paused=s,this.refreshPaused()}get speed(){return this._speed}set speed(s){this._speed=s,this.refresh()}get filters(){return this.media.filters}set filters(s){this.media.filters=s}addSprites(s,t){if(typeof s=="object"){const i={};for(const n in s)i[n]=this.addSprites(n,s[n]);return i}console.assert(!this._sprites[s],`Alias ${s} is already taken`);const e=new N0(this,t);return this._sprites[s]=e,e}destroy(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null}removeSprites(s){if(s){const t=this._sprites[s];t!==void 0&&(t.destroy(),delete this._sprites[s])}else for(const t in this._sprites)this.removeSprites(t);return this}get isPlayable(){return this.isLoaded&&this.media&&this.media.isPlayable}stop(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(let s=this._instances.length-1;s>=0;s--)this._instances[s].stop();return this}play(s,t){let e;if(typeof s=="string"?e={sprite:s,loop:this.loop,complete:t}:typeof s=="function"?(e={},e.complete=s):e=s,e={complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1,...e||{}},e.sprite){const n=e.sprite;console.assert(!!this._sprites[n],`Alias ${n} is not available`);const r=this._sprites[n];e.start=r.start+(e.start||0),e.end=r.end,e.speed=r.speed||1,e.loop=r.loop||e.loop,delete e.sprite}if(e.offset&&(e.start=e.offset),!this.isLoaded)return this._preloadQueue?new Promise(n=>{this._preloadQueue.push(()=>{n(this.play(e))})}):(this._preloadQueue=[],this.autoPlay=!0,this._autoPlayOptions=e,new Promise((n,r)=>{this._preload((a,o,h)=>{this._preloadQueue.forEach(l=>l()),this._preloadQueue=null,a?r(a):(e.loaded&&e.loaded(a,o,h),n(h))})}));(this.singleInstance||e.singleInstance)&&this._removeInstances();const i=this._createInstance();return this._instances.push(i),this.isPlaying=!0,i.once("end",()=>{e.complete&&e.complete(this),this._onComplete(i)}),i.once("stop",()=>{this._onComplete(i)}),i.play(e),i}refresh(){const s=this._instances.length;for(let t=0;t<s;t++)this._instances[t].refresh()}refreshPaused(){const s=this._instances.length;for(let t=0;t<s;t++)this._instances[t].refreshPaused()}get volume(){return this._volume}set volume(s){this._volume=s,this.refresh()}get muted(){return this._muted}set muted(s){this._muted=s,this.refresh()}get loop(){return this._loop}set loop(s){this._loop=s,this.refresh()}_preload(s){this.media.load(s)}get instances(){return this._instances}get sprites(){return this._sprites}get duration(){return this.media.duration}autoPlayStart(){let s;return this.autoPlay&&(s=this.play(this._autoPlayOptions)),s}_removeInstances(){for(let s=this._instances.length-1;s>=0;s--)this._poolInstance(this._instances[s]);this._instances.length=0}_onComplete(s){if(this._instances){const t=this._instances.indexOf(s);t>-1&&this._instances.splice(t,1),this.isPlaying=this._instances.length>0}this._poolInstance(s)}_createInstance(){if(Te._pool.length>0){const s=Te._pool.pop();return s.init(this.media),s}return this.media.create()}_poolInstance(s){s.destroy(),Te._pool.indexOf(s)<0&&Te._pool.push(s)}};let xi=Te;xi._pool=[];class Rs extends Nc{constructor(){const t=window,e=new Rs.AudioContext,i=e.createDynamicsCompressor(),n=e.createAnalyser();n.connect(i),i.connect(e.destination),super(n,i),this.autoPause=!0,this._ctx=e,this._offlineCtx=new Rs.OfflineAudioContext(1,2,t.OfflineAudioContext?Math.max(8e3,Math.min(96e3,e.sampleRate)):44100),this.compressor=i,this.analyser=n,this.events=new ct,this.volume=1,this.speed=1,this.muted=!1,this.paused=!1,this._locked=e.state==="suspended"&&("ontouchstart"in globalThis||"onclick"in globalThis),this._locked&&(this._unlock(),this._unlock=this._unlock.bind(this),document.addEventListener("mousedown",this._unlock,!0),document.addEventListener("touchstart",this._unlock,!0),document.addEventListener("touchend",this._unlock,!0)),this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),globalThis.addEventListener("focus",this.onFocus),globalThis.addEventListener("blur",this.onBlur)}onFocus(){if(!this.autoPause)return;const t=this._ctx.state;(t==="suspended"||t==="interrupted"||!this._locked)&&(this.paused=this._pausedOnBlur,this.refreshPaused())}onBlur(){this.autoPause&&(this._locked||(this._pausedOnBlur=this._paused,this.paused=!0,this.refreshPaused()))}_unlock(){this._locked&&(this.playEmptySound(),this._ctx.state==="running"&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._locked=!1))}playEmptySound(){const t=this._ctx.createBufferSource();t.buffer=this._ctx.createBuffer(1,1,22050),t.connect(this._ctx.destination),t.start(0,0,0),t.context.state==="suspended"&&t.context.resume()}static get AudioContext(){const t=window;return t.AudioContext||t.webkitAudioContext||null}static get OfflineAudioContext(){const t=window;return t.OfflineAudioContext||t.webkitOfflineAudioContext||null}destroy(){super.destroy();const t=this._ctx;typeof t.close<"u"&&t.close(),globalThis.removeEventListener("focus",this.onFocus),globalThis.removeEventListener("blur",this.onBlur),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null}get audioContext(){return this._ctx}get offlineContext(){return this._offlineCtx}set paused(t){t&&this._ctx.state==="running"?this._ctx.suspend():!t&&this._ctx.state==="suspended"&&this._ctx.resume(),this._paused=t}get paused(){return this._paused}refresh(){this.events.emit("refresh")}refreshPaused(){this.events.emit("refreshPaused")}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this._paused}decode(t,e){const i=r=>{e(new Error((r==null?void 0:r.message)||"Unable to decode file"))},n=this._offlineCtx.decodeAudioData(t,r=>{e(null,r)},i);n&&n.catch(i)}}class $0{constructor(){this.init()}init(){return this.supported&&(this._webAudioContext=new Rs),this._htmlAudioContext=new O0,this._sounds={},this.useLegacy=!this.supported,this}get context(){return this._context}get filtersAll(){return this.useLegacy?[]:this._context.filters}set filtersAll(t){this.useLegacy||(this._context.filters=t)}get supported(){return Rs.AudioContext!==null}add(t,e){if(typeof t=="object"){const r={};for(const a in t){const o=this._getOptions(t[a],e);r[a]=this.add(a,o)}return r}if(console.assert(!this._sounds[t],`Sound with alias ${t} already exists.`),e instanceof xi)return this._sounds[t]=e,e;const i=this._getOptions(e),n=xi.from(i);return this._sounds[t]=n,n}_getOptions(t,e){let i;return typeof t=="string"?i={url:t}:Array.isArray(t)?i={url:t}:t instanceof ArrayBuffer||t instanceof AudioBuffer||t instanceof HTMLAudioElement?i={source:t}:i=t,i={...i,...e||{}},i}get useLegacy(){return this._useLegacy}set useLegacy(t){this._useLegacy=t,this._context=!t&&this.supported?this._webAudioContext:this._htmlAudioContext}get disableAutoPause(){return!this._webAudioContext.autoPause}set disableAutoPause(t){this._webAudioContext.autoPause=!t}remove(t){return this.exists(t,!0),this._sounds[t].destroy(),delete this._sounds[t],this}get volumeAll(){return this._context.volume}set volumeAll(t){this._context.volume=t,this._context.refresh()}get speedAll(){return this._context.speed}set speedAll(t){this._context.speed=t,this._context.refresh()}togglePauseAll(){return this._context.togglePause()}pauseAll(){return this._context.paused=!0,this._context.refreshPaused(),this}resumeAll(){return this._context.paused=!1,this._context.refreshPaused(),this}toggleMuteAll(){return this._context.toggleMute()}muteAll(){return this._context.muted=!0,this._context.refresh(),this}unmuteAll(){return this._context.muted=!1,this._context.refresh(),this}removeAll(){for(const t in this._sounds)this._sounds[t].destroy(),delete this._sounds[t];return this}stopAll(){for(const t in this._sounds)this._sounds[t].stop();return this}exists(t,e=!1){const i=!!this._sounds[t];return e&&console.assert(i,`No sound matching alias '${t}'.`),i}isPlaying(){for(const t in this._sounds)if(this._sounds[t].isPlaying)return!0;return!1}find(t){return this.exists(t,!0),this._sounds[t]}play(t,e){return this.find(t).play(e)}stop(t){return this.find(t).stop()}pause(t){return this.find(t).pause()}resume(t){return this.find(t).resume()}volume(t,e){const i=this.find(t);return e!==void 0&&(i.volume=e),i.volume}speed(t,e){const i=this.find(t);return e!==void 0&&(i.speed=e),i.speed}duration(t){return this.find(t).duration}close(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this}}const Jo=s=>{var i;const t=s.src;let e=(i=s==null?void 0:s.alias)==null?void 0:i[0];return(!e||s.src===e)&&(e=ot.basename(t,ot.extname(t))),e},Y0={extension:R.Asset,detection:{test:async()=>!0,add:async s=>[...s,...gi.filter(t=>yi[t])],remove:async s=>s.filter(t=>s.includes(t))},loader:{name:"sound",extension:{type:[R.LoadParser],priority:$t.High},test(s){const t=ot.extname(s).slice(1);return!!yi[t]||z0.some(e=>s.startsWith(`data:${e}`))},async load(s,t){const e=await new Promise((i,n)=>xi.from({...t.data,url:s,preload:!0,loaded(r,a){var o,h;r?n(r):i(a),(h=(o=t.data)==null?void 0:o.loaded)==null||h.call(o,r,a)}}));return ks().add(Jo(t),e),e},async unload(s,t){ks().remove(Jo(t))}}};Y.add(Y0);const Me=L0(new $0);class j0{constructor(){A(this,"currentAlias");A(this,"current");A(this,"volume",1)}async play(t,e){if(this.currentAlias!==t){if(this.current){const i=this.current;Zn(i,{volume:0},{duration:1,ease:"linear"}).then(()=>{i.stop()})}this.current=Me.find(t),this.currentAlias=t,this.current.play({loop:!0,...e}),this.current.volume=0,Zn(this.current,{volume:this.volume},{duration:1,ease:"linear"})}}getVolume(){return this.volume}setVolume(t){this.volume=t,this.current&&(this.current.volume=this.volume)}}class X0{constructor(){A(this,"volume",1)}play(t,e){const i=this.volume*((e==null?void 0:e.volume)??1);Me.play(t,{...e,volume:i})}getVolume(){return this.volume}setVolume(t){this.volume=t}}class Gc{static init(){const t=this;t.audio={bgm:new j0,sfx:new X0,getMasterVolume:()=>Me.volumeAll,setMasterVolume:e=>{Me.volumeAll=e,e?Me.unmuteAll():Me.muteAll()}}}static destroy(){const t=this;t.audio=null}}A(Gc,"extension",R.Application);class K0{constructor(){A(this,"app");A(this,"container",new ft);A(this,"width",0);A(this,"height",0);A(this,"background");A(this,"currentScreen");A(this,"currentPopup")}init(t){this.app=t}setBackground(t){this.background=new t,this.addAndShowScreen(this.background)}async addAndShowScreen(t){this.container.parent||this.app.stage.addChild(this.container),this.container.addChild(t),t.prepare&&t.prepare(),t.resize&&t.resize(this.width,this.height),t.update&&this.app.ticker.add(t.update,t),t.show&&(t.interactiveChildren=!1,await t.show(),t.interactiveChildren=!0)}async hideAndRemoveScreen(t){t.interactiveChildren=!1,t.hide&&await t.hide(),t.update&&this.app.ticker.remove(t.update,t),t.parent&&t.parent.removeChild(t),t.reset&&t.reset()}async showScreen(t){var e;this.currentScreen&&(this.currentScreen.interactiveChildren=!1),t.assetBundles&&await ht.loadBundle(t.assetBundles,i=>{var n;(n=this.currentScreen)!=null&&n.onLoad&&this.currentScreen.onLoad(i*100)}),(e=this.currentScreen)!=null&&e.onLoad&&this.currentScreen.onLoad(100),this.currentScreen&&await this.hideAndRemoveScreen(this.currentScreen),this.currentScreen=Bt.get(t),await this.addAndShowScreen(this.currentScreen)}resize(t,e){var i,n,r,a,o,h;this.width=t,this.height=e,(n=(i=this.currentScreen)==null?void 0:i.resize)==null||n.call(i,t,e),(a=(r=this.currentPopup)==null?void 0:r.resize)==null||a.call(r,t,e),(h=(o=this.background)==null?void 0:o.resize)==null||h.call(o,t,e)}async presentPopup(t){var e,i;this.currentScreen&&(this.currentScreen.interactiveChildren=!1,await((i=(e=this.currentScreen).pause)==null?void 0:i.call(e))),this.currentPopup&&await this.hideAndRemoveScreen(this.currentPopup),this.currentPopup=new t,await this.addAndShowScreen(this.currentPopup)}async dismissPopup(){var e,i;if(!this.currentPopup)return;const t=this.currentPopup;this.currentPopup=void 0,await this.hideAndRemoveScreen(t),this.currentScreen&&(this.currentScreen.interactiveChildren=!0,(i=(e=this.currentScreen).resume)==null||i.call(e))}blur(){var t,e,i,n,r,a;(e=(t=this.currentScreen)==null?void 0:t.blur)==null||e.call(t),(n=(i=this.currentPopup)==null?void 0:i.blur)==null||n.call(i),(a=(r=this.background)==null?void 0:r.blur)==null||a.call(r)}focus(){var t,e,i,n,r,a;(e=(t=this.currentScreen)==null?void 0:t.focus)==null||e.call(t),(n=(i=this.currentPopup)==null?void 0:i.focus)==null||n.call(i),(a=(r=this.background)==null?void 0:r.focus)==null||a.call(r)}}class tr{static init(){const t=this;t.navigation=new K0,t.navigation.init(t),this._onResize=()=>t.navigation.resize(t.renderer.width,t.renderer.height),t.renderer.on("resize",this._onResize),t.resize()}static destroy(){const t=this;t.navigation=null}}A(tr,"extension",R.Application),A(tr,"_onResize");function q0(s,t,e,i,n){const r=e/i;let a=s,o=t;n&&(e<i?(o=window.innerHeight,a=Math.min(window.innerWidth,e,o*r)):(a=window.innerWidth,o=Math.min(window.innerHeight,i,a/r)));const h=a<e?e/a:1,l=o<i?i/o:1,c=h>l?h:l,u=Math.floor(a*c),d=Math.floor(o*c);return{width:u,height:d}}class ps{static init(t){const e=this;Object.defineProperty(e,"resizeTo",{set(i){globalThis.removeEventListener("resize",e.queueResize),this._resizeTo=i,i&&(globalThis.addEventListener("resize",e.queueResize),e.resize())},get(){return this._resizeTo}}),e.queueResize=()=>{this._resizeTo&&(this._cancelResize(),this._resizeId=requestAnimationFrame(()=>e.resize()))},e.resize=()=>{if(!this._resizeTo)return;this._cancelResize();let i,n;if(this._resizeTo===globalThis.window)i=globalThis.innerWidth,n=globalThis.innerHeight;else{const{clientWidth:o,clientHeight:h}=this._resizeTo;i=o,n=h}const{width:r,height:a}=q0(i,n,e.resizeOptions.minWidth,e.resizeOptions.minHeight,e.resizeOptions.letterbox);e.renderer.canvas.style.width=`${i}px`,e.renderer.canvas.style.height=`${n}px`,window.scrollTo(0,0),e.renderer.resize(r,a)},this._cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this._resizeId=null,this._resizeTo=null,e.resizeOptions={minWidth:768,minHeight:1024,letterbox:!0,...t.resizeOptions},e.resizeTo=t.resizeTo||null}static destroy(){const t=this;globalThis.removeEventListener("resize",t.queueResize),this._cancelResize(),this._cancelResize=null,t.queueResize=null,t.resizeTo=null,t.resize=null}}A(ps,"extension",R.Application),A(ps,"_resizeId"),A(ps,"_resizeTo"),A(ps,"_cancelResize");function Z0(){let s=Math.max(window.devicePixelRatio,2);return s%1!==0&&(s=2),s}Y.remove(ar);Y.add(ps);Y.add(Gc);Y.add(tr);class Q0 extends Qh{async init(t){t.resizeTo??(t.resizeTo=window),t.resolution??(t.resolution=Z0()),await super.init(t),document.getElementById("pixi-container").appendChild(this.canvas),await ht.init({manifest:Qo,basePath:"assets"}),await ht.loadBundle("preload");const e=Qo.bundles.map(i=>i.name);await ht.loadBundle(e)}destroy(t=!1,e=!1){super.destroy(t,e)}}const ri=new Q0;jc(ri);(async()=>(await ri.init({background:"#1E1E1E",resizeOptions:{minWidth:768,minHeight:1024,letterbox:!1}}),F0.init(),await ri.navigation.showScreen(Fc),await ri.navigation.showScreen(Oc)))();export{et as $,Xh as A,pt as B,ft as C,q as D,R as E,bd as F,ze as G,dh as H,Tt as I,Du as J,Jr as K,_t as L,N as M,cd as N,vd as O,lt as P,tt as Q,Cn as R,_d as S,At as T,oi as U,K as V,zd as W,ea as X,Bi as Y,sa as Z,Uu as _,ct as a,mh as a0,Kh as a1,V as a2,W as a3,$d as a4,mf as a5,hf as a6,Bf as a7,Of as a8,Uf as a9,Wf as aa,Hf as ab,Ve as ac,ul as ad,Ea as ae,Pa as af,Fe as ag,to as ah,Ft as ai,jp as aj,J as ak,De as al,hu as am,co as an,pl as ao,rf as b,Cs as c,si as d,Y as e,Ma as f,ef as g,rr as h,Ni as i,$h as j,Ah as k,Pt as l,Dh as m,ui as n,Ff as o,Lf as p,Nf as q,wu as r,Gf as s,wi as t,D as u,ou as v,$ as w,bi as x,Yf as y,Bt as z};
